!function(t){"use strict";function e(t,e){function i(){}i.prototype=t;var s=new i;for(var n in e)s[n]=e[n];return e.toString!==Object.prototype.toString&&(s.toString=e.toString),s}function i(t){return t instanceof Array?function(){return a.iter(t)}:"function"==typeof t.iterator?s(t,t.iterator):t.iterator}function s(t,e){if(null==e)return null;null==e.__id__&&(e.__id__=yr++);var i;return null==t.hx__closures__?t.hx__closures__={}:i=t.hx__closures__[e.__id__],null==i&&(i=function(){return i.method.apply(i.scope,arguments)},i.scope=t,i.method=e,t.hx__closures__[e.__id__]=i),i}var n={},r=function(){return re.__string_rec(this,"")},o=function(t,e){e=e.split("u").join(""),this.r=new RegExp(t,e)};n.EReg=o,o.__name__=["EReg"],o.prototype={match:function(t){return this.r.global&&(this.r.lastIndex=0),this.r.m=this.r.exec(t),this.r.s=t,null!=this.r.m},matched:function(t){if(null!=this.r.m&&t>=0&&t<this.r.m.length)return this.r.m[t];throw new ne("EReg::matched")},matchedRight:function(){if(null==this.r.m)throw new ne("No string matched");var t=this.r.m.index+this.r.m[0].length;return a.substr(this.r.s,t,this.r.s.length-t)},replace:function(t,e){return t.replace(this.r,e)},__class__:o};var a=function(){};n.HxOverrides=a,a.__name__=["HxOverrides"],a.strDate=function(t){var e=t.length;switch(e){case 8:var i=t.split(":"),s=new Date;return s.setTime(0),s.setUTCHours(i[0]),s.setUTCMinutes(i[1]),s.setUTCSeconds(i[2]),s;case 10:var n=t.split("-");return new Date(n[0],n[1]-1,n[2],0,0,0);case 19:var r=t.split(" "),o=r[0].split("-"),a=r[1].split(":");return new Date(o[0],o[1]-1,o[2],a[0],a[1],a[2]);default:throw new ne("Invalid date format : "+t)}},a.cca=function(t,e){var i=t.charCodeAt(e);return i!=i?void 0:i},a.substr=function(t,e,i){return null!=e&&0!=e&&null!=i&&0>i?"":(null==i&&(i=t.length),0>e?(e=t.length+e,0>e&&(e=0)):0>i&&(i=t.length+i-e),t.substr(e,i))},a.indexOf=function(t,e,i){var s=t.length;for(0>i&&(i+=s,0>i&&(i=0));s>i;){if(t[i]===e)return i;i++}return-1},a.remove=function(t,e){var i=a.indexOf(t,e,0);return-1==i?!1:(t.splice(i,1),!0)},a.iter=function(t){return{cur:0,arr:t,hasNext:function(){return this.cur<this.arr.length},next:function(){return this.arr[this.cur++]}}};var h=function(){};n.Lambda=h,h.__name__=["Lambda"],h.has=function(t,e){for(var s=i(t)();s.hasNext();){var n=s.next();if(n==e)return!0}return!1},h.count=function(t,e){var s=0;if(null==e)for(var n=i(t)();n.hasNext();){{n.next()}s++}else for(var r=i(t)();r.hasNext();){var o=r.next();e(o)&&s++}return s};var l=function(){this.length=0};n.List=l,l.__name__=["List"],l.prototype={add:function(t){var e=[t];null==this.h?this.h=e:this.q[1]=e,this.q=e,this.length++},push:function(t){var e=[t,this.h];this.h=e,null==this.q&&(this.q=e),this.length++},remove:function(t){for(var e=null,i=this.h;null!=i;){if(i[0]==t)return null==e?this.h=i[1]:e[1]=i[1],this.q==i&&(this.q=e),this.length--,!0;e=i,i=i[1]}return!1},__class__:l};var _=function(){};n.Luxe=_,_.__name__=["Luxe"],_.__properties__={set_alpha:"set_alpha",get_alpha:"get_alpha",set_cur_frame_start:"set_cur_frame_start",get_cur_frame_start:"get_cur_frame_start",set_current_time:"set_current_time",get_current_time:"get_current_time",set_last_frame_start:"set_last_frame_start",get_last_frame_start:"get_last_frame_start",set_delta_sim:"set_delta_sim",get_delta_sim:"get_delta_sim",set_dt:"set_dt",get_dt:"get_dt",set_max_frame_time:"set_max_frame_time",get_max_frame_time:"get_max_frame_time",set_update_rate:"set_update_rate",get_update_rate:"get_update_rate",set_fixed_delta:"set_fixed_delta",get_fixed_delta:"get_fixed_delta",set_timescale:"set_timescale",get_timescale:"get_timescale",get_screen:"get_screen",get_time:"get_time",get_snow:"get_snow"},_.on=function(t,e){_.core.emitter.on(t,e)},_.off=function(t,e){return _.core.emitter.off(t,e)},_.next=function(t){Nn.next(t)},_.shutdown=function(){_.core.shutdown()},_.showConsole=function(t){_.core.show_console(t)},_.get_snow=function(){return _.core.app},_.get_screen=function(){return _.core.screen},_.get_time=function(){return Nn.core.timestamp()},_.get_timescale=function(){return _.core.timescale},_.get_fixed_delta=function(){return _.core.fixed_delta},_.get_update_rate=function(){return _.core.update_rate},_.get_max_frame_time=function(){return _.core.max_frame_time},_.get_dt=function(){return _.core.delta_time},_.get_delta_sim=function(){return _.core.delta_sim},_.get_last_frame_start=function(){return _.core.last_frame_start},_.get_current_time=function(){return _.core.current_time},_.get_cur_frame_start=function(){return _.core.cur_frame_start},_.get_alpha=function(){return _.core.alpha},_.set_timescale=function(t){return _.core.timescale=t},_.set_fixed_delta=function(t){return _.core.fixed_delta=t},_.set_update_rate=function(t){return _.core.update_rate=t},_.set_max_frame_time=function(t){return _.core.max_frame_time=t},_.set_dt=function(t){return _.core.delta_time=t},_.set_delta_sim=function(t){return _.core.delta_sim=t},_.set_last_frame_start=function(t){return _.core.last_frame_start=t},_.set_current_time=function(t){return _.core.current_time=t},_.set_cur_frame_start=function(t){return _.core.cur_frame_start=t},_.set_alpha=function(t){return _.core.alpha=t};var u=function(){};n.LuxeApp=u,u.__name__=["LuxeApp"],u.main=function(){u._conf={window:{width:960,height:640,fullscreen:!1,resizable:!0,borderless:!1,title:"luxe app"}},u._conf.window.width=960,u._conf.window.height=540,u._conf.window.fullscreen=!1,u._conf.window.resizable=!0,u._conf.window.borderless=!1,u._conf.window.title="luxe.platformer",u._snow=new Nn,u._game=new f,u._core=new ve(u._game,u._conf);var t={has_loop:!0,config_custom_assets:!1,config_custom_runtime:!1,config_runtime_path:"config.json",config_assets_path:"manifest",app_package:"com.luxeengine.platformer"};u._snow.init(t,u._core)};var c=function(){this._checking=!1,this._to_remove=new l,this.connected=new l,this.bindings=new U};n["luxe.Emitter"]=c,c.__name__=["luxe","Emitter"],c.prototype={emit:function(t,e){this._check();var i=this.bindings.h[t];if(null!=i&&i.length>0)for(var s=0;s<i.length;){var n=i[s];++s,n(e)}this._check()},on:function(t,e){if(this._check(),this.bindings.h.hasOwnProperty(t)){var i=this.bindings.h[t];-1==a.indexOf(i,e,0)&&(i.push(e),this.connected.push({handler:e,event:t}))}else this.bindings.h[t]=[e],this.connected.push({handler:e,event:t})},off:function(t,e){this._check();var i=!1;if(this.bindings.h.hasOwnProperty(t)){this._to_remove.push({event:t,handler:e});for(var s=this.connected.h,n=null;null!=s;){var r;r=function(){var t;return n=s[0],s=s[1],t=n}(this),r.event==t&&r.handler==e&&this.connected.remove(r)}i=!0}return i},connections:function(t){for(var e=[],i=this.connected.h,s=null;null!=i;){var n;n=function(){var t;return s=i[0],i=i[1],t=s}(this),n.handler==t&&e.push(n)}return e},_check:function(){if(!this._checking){if(this._checking=!0,this._to_remove.length>0){for(var t=this._to_remove.h,e=null;null!=t;){var i;i=function(){var i;return e=t[0],t=t[1],i=e}(this);var s=this.bindings.h[i.event];a.remove(s,i.handler),0==s.length&&this.bindings.remove(i.event)}this._to_remove=null,this._to_remove=new l}this._checking=!1}},__class__:c};var d=function(){c.call(this)};n["luxe.Game"]=d,d.__name__=["luxe","Game"],d.__super__=c,d.prototype=e(c.prototype,{config:function(t){return t},ready:function(){},update:function(){},onevent:function(){},ondestroy:function(){},onprerender:function(){},onrender:function(){},onpostrender:function(){},oninputdown:function(){},oninputup:function(){},onmousedown:function(){},onmouseup:function(){},onmousewheel:function(){},onmousemove:function(){},onkeydown:function(){},onkeyup:function(){},ontextinput:function(){},ontouchdown:function(){},ontouchup:function(){},ontouchmove:function(){},ongamepadaxis:function(){},ongamepaddown:function(){},ongamepadup:function(){},ongamepaddevice:function(){},onwindowmoved:function(){},onwindowresized:function(){},onwindowsized:function(){},onwindowminimized:function(){},onwindowrestored:function(){},__class__:d});var f=function(){this.jumpsAvailable=0,this.damp_air=.9,this.damp=.72,this.jump_force=200,this.move_spd=600,this.air_vel=60,this.max_vel=50,this.teleportDisabled=!1,this.map_scale=1,d.call(this)};n.Main=f,f.__name__=["Main"],f.__super__=d,f.prototype=e(d.prototype,{ready:function(){_.renderer.clear_color.rgb(1580063),_.camera.set_size(new un(256,144)),this.sim=_.physics.add_engine(g),this.sim.set_draw(!1),this.sim.player_collider=ei.rectangle(0,0,8,8),this.create_map(),this.create_map_collision(),this.bind_input(),_.events.listen("simulation.triggers.collide",s(this,this.ontrigger)),this.sim.set_paused(!1)},bind_input:function(){_.input.bind_key("left",Wn.key_a),_.input.bind_key("left",Wn.left),_.input.bind_key("right",Wn.key_d),_.input.bind_key("right",Wn.right),_.input.bind_key("jump",Wn.key_w),_.input.bind_key("jump",Wn.up),_.input.bind_key("jump",Wn.space),_.input.bind_key("jump",Wn.key_z),_.input.bind_key("jump",Wn.key_x)},create_map_collision:function(){for(var t=this.map.layer("collision").bounds_fitted(),e=0;e<t.length;){var i=t[e];++e;var s=i;s.set_x(s.x*this.map.tile_width*this.map_scale);var n=i;n.set_y(n.y*this.map.tile_height*this.map_scale);var r=i;r.set_w(r.w*this.map.tile_width*this.map_scale);var o=i;o.set_h(o.h*this.map.tile_height*this.map_scale),this.sim.obstacle_colliders.push(ei.rectangle(i.x,i.y,i.w,i.h,!1))}},create_map:function(){var t=_.resources.cache.get("assets/tilemap.tmx").asset.text;this.map=new wi({format:"tmx",tiled_file_data:t}),this.map.display({scale:this.map_scale,filter:9728});for(var e=0,i=this.map.tiledmap_data.object_groups;e<i.length;){var s=i[e];++e;for(var n=0,r=s.objects;n<r.length;){var o=r[n];++n;var a=o.type;switch(a){case"spawn":this.spawn_pos=new un(o.pos.x,o.pos.y),this.sim.player_collider._position.copy_from(this.spawn_pos),this.player_sprite=new Ve({pos:this.spawn_pos.clone(),size:new un(8,8),depth:2,texture:_.resources.cache.get("assets/player.png")});break;case"exit":var h=o.pos.y;this.exit=new Ve({centered:!1,depth:8,pos:new un(o.pos.x,h+2),texture:_.resources.cache.get("assets/exit.png")}),hs.tween(this.exit.get_pos(),1.5,{y:h}).reflect().repeat();var l=ei.rectangle(o.pos.x*this.map_scale,o.pos.y*this.map_scale,o.width*this.map_scale,o.height*this.map_scale,!1);l.tags.set("type","exit"),this.sim.trigger_colliders.push(l);break;case"portal":null==this.portals&&(this.portals=new U),this.portals.h[o.id]=o.pos;var u=ei.rectangle(o.pos.x*this.map_scale,o.pos.y*this.map_scale,o.width*this.map_scale,o.height*this.map_scale,!1),c=v.parseInt(o.properties.get("target"));u.data={target:c},u.tags.set("type","portal"),this.sim.trigger_colliders.push(u)}}}for(var d=0,f=this.map.tiledmap_data.image_layers;d<f.length;){var p=f[d];++d,new Ve({name:"image_layer."+p.name,centered:!1,depth:-1,pos:new un(this.map.pos.x+p.x*this.map_scale,this.map.pos.y+p.y*this.map_scale),scale:new un(this.map_scale,this.map_scale),texture:_.resources.cache.get("assets/"+p.image.source),color:new ai(1,1,1,p.opacity),visible:p.visible})}for(var m=this.map.visual.geometry_for_layer("visualfg"),g=0;g<m.length;){var y=m[g];++g;for(var w=0;w<y.length;){var x=y[w];++w,null!=x&&x.set_depth(5)}}},ontrigger:function(t){0==t.length&&(this.teleportDisabled=!1);for(var e=0;e<t.length;){var i=t[e];++e;var s=i.shape2.tags.get("type");switch(s){case"portal":if(!this.teleportDisabled){var n,r=i.shape2.data.target;n=this.portals.h[r],this.sim.player_collider._position.set_x(n.x),this.sim.player_collider._position.set_y(n.y+4),this.teleportDisabled=!0}break;case"exit":}}},onkeyup:function(t){t.keycode==Wn.key_0&&this.sim.set_draw(!this.sim.get_draw()),t.keycode==Wn.key_r&&(this.sim.player_collider._position.copy_from(this.spawn_pos),this.sim.player_velocity.set_xy(0,0)),t.keycode==Wn.escape&&_.shutdown()},update:function(t){this.apply_input(t),this.sim.player_can_jump&&(this.jumpsAvailable=2),this.jumpsAvailable>0&&_.input.inputpressed("jump")&&(this.sim.player_velocity.set_y(-this.jump_force),this.jumpsAvailable-=1),this.sim.player_collider._position.set_x(Es.clamp(this.sim.player_collider._position.x,4,252)),this.player_sprite.get_pos().copy_from(this.sim.player_collider._position);var e;e=this.sim.player_can_jump?this.max_vel:this.air_vel,this.sim.player_velocity.set_x(Es.clamp(this.sim.player_velocity.x,-e,e))},apply_input:function(t){if(_.input.inputdown("left")){var e=this.sim.player_velocity;e.set_x(e.x-this.move_spd*t),this.player_sprite.set_flipx(!1)}else if(_.input.inputdown("right")){var i=this.sim.player_velocity;i.set_x(i.x+this.move_spd*t),this.player_sprite.set_flipx(!0)}else if(this.sim.player_can_jump){var s=this.sim.player_velocity;s.set_x(s.x*this.damp)}else{var n=this.sim.player_velocity;n.set_x(n.x*this.damp_air)}},config:function(t){return t.window.width=720,t.window.height=405,t.preload.textures.push({id:"assets/collisionTiles.png"}),t.preload.textures.push({id:"assets/player.png",filter_min:9728,filter_mag:9728}),t.preload.textures.push({id:"assets/exit.png",filter_min:9728,filter_mag:9728}),t.preload.textures.push({id:"assets/background.png",filter_min:9728,filter_mag:9728}),t.preload.textures.push({id:"assets/tilesheet.png"}),t.preload.texts.push({id:"assets/tilemap.tmx"}),t},__class__:f}),Math.__name__=["Math"];var p=function(){};n.Reflect=p,p.__name__=["Reflect"],p.field=function(t,e){try{return t[e]}catch(i){return i instanceof ne&&(i=i.val),null}},p.setField=function(t,e,i){t[e]=i},p.getProperty=function(t,e){var i;return null==t?null:t.__properties__&&(i=t.__properties__["get_"+e])?t[i]():t[e]},p.setProperty=function(t,e,i){var s;t.__properties__&&(s=t.__properties__["set_"+e])?t[s](i):t[e]=i},p.callMethod=function(t,e,i){return e.apply(t,i)},p.fields=function(t){var e=[];if(null!=t){var i=Object.prototype.hasOwnProperty;for(var s in t)"__id__"!=s&&"hx__closures__"!=s&&i.call(t,s)&&e.push(s)}return e},p.isFunction=function(t){return"function"==typeof t&&!(t.__name__||t.__ename__)},p.deleteField=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)?(delete t[e],!0):!1};var m=function(){this.draw=!0,this.paused=!1,this.name="engine",this.set_gravity(new un(0,-9.8,0)),_.on(8,s(this,this._render))};n["luxe.PhysicsEngine"]=m,m.__name__=["luxe","PhysicsEngine"],m.prototype={init:function(){},_render:function(){this.render()},process:function(){},update:function(){},render:function(){},destroy:function(){},get_paused:function(){return this.paused},set_paused:function(t){return this.paused=t},get_draw:function(){return this.draw},set_draw:function(t){return this.draw=t},get_gravity:function(){return this.gravity},set_gravity:function(t){return this.gravity=t},__class__:m,__properties__:{set_draw:"set_draw",get_draw:"get_draw",set_gravity:"set_gravity",get_gravity:"get_gravity",set_paused:"set_paused",get_paused:"get_paused"}};var g=function(){this.player_can_jump=!1,m.call(this),this.set_paused(!0),this.obstacle_colliders=[],this.trigger_colliders=[],this.player_velocity=new un};n.Simulation=g,g.__name__=["Simulation"],g.__super__=m,g.prototype=e(m.prototype,{init:function(){this.get_gravity().set_xyz(0,800,0)},update:function(){this.get_paused()||(this.handle_physics(),this.update_colliders(),this.handle_collision())},handle_physics:function(){var t=this.player_velocity;t.set_x(t.x+this.get_gravity().x*_.physics.step_delta);var e=this.player_velocity;e.set_y(e.y+this.get_gravity().y*_.physics.step_delta)},update_colliders:function(){var t=this.player_collider._position;t.set_x(t.x+this.player_velocity.x*_.physics.step_delta);var e=this.player_collider._position;e.set_y(e.y+this.player_velocity.y*_.physics.step_delta)},handle_collision:function(){this.player_can_jump=!1;for(var t=Ze.shapeWithShapes(this.player_collider,this.obstacle_colliders),e=0;e<t.length;){var i=t[e];++e,this.player_collider.set_position(this.player_collider._position.add(i.separation)),0!=i.unitVector.x&&this.player_velocity.set_x(0),0!=i.unitVector.y&&(i.unitVector.y>=0?1:-1)!=(this.player_velocity.y>=0?1:-1)&&(this.player_velocity.set_y(0),i.unitVector.y<0&&(this.player_can_jump=!0))}t=Ze.shapeWithShapes(this.player_collider,this.trigger_colliders),_.events.fire("simulation.triggers.collide",t)},render:function(){if(this.get_draw()){for(var t=0,e=this.obstacle_colliders;t<e.length;){var i=e[t];++t,this.draw_collider_polygon(i)}for(var s=0,n=this.trigger_colliders;s<n.length;){var r=n[s];++s,this.draw_collider_polygon(r)}this.draw_collider_polygon(this.player_collider)}},draw_collider_polygon:function(t){var e=_.draw.poly({solid:!1,close:!0,depth:100,points:t.get_vertices(),immediate:!0});e.transform.local.pos.copy_from(t._position)},__class__:g});var v=function(){};n.Std=v,v.__name__=["Std"],v.string=function(t){return re.__string_rec(t,"")},v["int"]=function(t){return 0|t},v.parseInt=function(t){var e=parseInt(t,10);return 0!=e||120!=a.cca(t,1)&&88!=a.cca(t,1)||(e=parseInt(t)),isNaN(e)?null:e},v.parseFloat=function(t){return parseFloat(t)},v.random=function(t){return 0>=t?0:Math.floor(Math.random()*t)};var y=function(){this.b=""};n.StringBuf=y,y.__name__=["StringBuf"],y.prototype={add:function(t){this.b+=v.string(t)},addSub:function(t,e,i){this.b+=null==i?a.substr(t,e,null):a.substr(t,e,i)},__class__:y};var w=function(){};n.StringTools=w,w.__name__=["StringTools"],w.isSpace=function(t,e){var i=a.cca(t,e);return i>8&&14>i||32==i},w.ltrim=function(t){for(var e=t.length,i=0;e>i&&w.isSpace(t,i);)i++;return i>0?a.substr(t,i,e-i):t},w.rtrim=function(t){for(var e=t.length,i=0;e>i&&w.isSpace(t,e-i-1);)i++;return i>0?a.substr(t,0,e-i):t},w.trim=function(t){return w.ltrim(w.rtrim(t))},w.rpad=function(t,e,i){if(e.length<=0)return t;for(;t.length<i;)t+=e;return t},w.replace=function(t,e,i){return t.split(e).join(i)},w.fastCodeAt=function(t,e){return t.charCodeAt(e)};var x=n.ValueType={__ename__:["ValueType"],__constructs__:["TNull","TInt","TFloat","TBool","TObject","TFunction","TClass","TEnum","TUnknown"]};x.TNull=["TNull",0],x.TNull.toString=r,x.TNull.__enum__=x,x.TInt=["TInt",1],x.TInt.toString=r,x.TInt.__enum__=x,x.TFloat=["TFloat",2],x.TFloat.toString=r,x.TFloat.__enum__=x,x.TBool=["TBool",3],x.TBool.toString=r,x.TBool.__enum__=x,x.TObject=["TObject",4],x.TObject.toString=r,x.TObject.__enum__=x,x.TFunction=["TFunction",5],x.TFunction.toString=r,x.TFunction.__enum__=x,x.TClass=function(t){var e=["TClass",6,t];return e.__enum__=x,e.toString=r,e},x.TEnum=function(t){var e=["TEnum",7,t];return e.__enum__=x,e.toString=r,e},x.TUnknown=["TUnknown",8],x.TUnknown.toString=r,x.TUnknown.__enum__=x;var b=function(){};n.Type=b,b.__name__=["Type"],b.getClass=function(t){return null==t?null:re.getClass(t)},b.getClassName=function(t){var e=t.__name__;return null==e?null:e.join(".")},b.getEnumName=function(t){var e=t.__ename__;return e.join(".")},b.resolveClass=function(t){var e=n[t];return null!=e&&e.__name__?e:null},b.resolveEnum=function(t){var e=n[t];return null!=e&&e.__ename__?e:null},b.createInstance=function(t,e){var i=e.length;switch(i){case 0:return new t;case 1:return new t(e[0]);case 2:return new t(e[0],e[1]);case 3:return new t(e[0],e[1],e[2]);case 4:return new t(e[0],e[1],e[2],e[3]);case 5:return new t(e[0],e[1],e[2],e[3],e[4]);case 6:return new t(e[0],e[1],e[2],e[3],e[4],e[5]);case 7:return new t(e[0],e[1],e[2],e[3],e[4],e[5],e[6]);case 8:return new t(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]);default:throw new ne("Too many arguments")}return null},b.createEmptyInstance=function(t){function e(){}return e.prototype=t.prototype,new e},b.createEnum=function(t,e,i){var s=p.field(t,e);if(null==s)throw new ne("No such constructor "+e);if(p.isFunction(s)){if(null==i)throw new ne("Constructor "+e+" need parameters");return p.callMethod(t,s,i)}if(null!=i&&0!=i.length)throw new ne("Constructor "+e+" does not need parameters");return s},b.getEnumConstructs=function(t){var e=t.__constructs__;return e.slice()},b["typeof"]=function(t){var e=typeof t;switch(e){case"boolean":return x.TBool;case"string":return x.TClass(String);case"number":return Math.ceil(t)==t%2147483648?x.TInt:x.TFloat;case"object":if(null==t)return x.TNull;var i=t.__enum__;if(null!=i)return x.TEnum(i);var s=re.getClass(t);return null!=s?x.TClass(s):x.TObject;case"function":return t.__name__||t.__ename__?x.TObject:x.TFunction;case"undefined":return x.TNull;default:return x.TUnknown}};var k={};n["_UInt.UInt_Impl_"]=k,k.__name__=["_UInt","UInt_Impl_"],k.toFloat=function(t){var e=t;return 0>e?4294967296+e:e+0};var z=function(t){this.nodeType=t,this.children=[],this.attributeMap=new V};n.Xml=z,z.__name__=["Xml"],z.parse=function(t){return Y.parse(t)},z.createElement=function(t){var e=new z(z.Element);if(e.nodeType!=z.Element)throw new ne("Bad node type, expected Element but found "+e.nodeType);return e.nodeName=t,e},z.createPCData=function(t){var e=new z(z.PCData);if(e.nodeType==z.Document||e.nodeType==z.Element)throw new ne("Bad node type, unexpected "+e.nodeType);return e.nodeValue=t,e},z.createCData=function(t){var e=new z(z.CData);if(e.nodeType==z.Document||e.nodeType==z.Element)throw new ne("Bad node type, unexpected "+e.nodeType);return e.nodeValue=t,e},z.createComment=function(t){var e=new z(z.Comment);if(e.nodeType==z.Document||e.nodeType==z.Element)throw new ne("Bad node type, unexpected "+e.nodeType);return e.nodeValue=t,e},z.createDocType=function(t){var e=new z(z.DocType);if(e.nodeType==z.Document||e.nodeType==z.Element)throw new ne("Bad node type, unexpected "+e.nodeType);return e.nodeValue=t,e},z.createProcessingInstruction=function(t){var e=new z(z.ProcessingInstruction);if(e.nodeType==z.Document||e.nodeType==z.Element)throw new ne("Bad node type, unexpected "+e.nodeType);return e.nodeValue=t,e},z.createDocument=function(){return new z(z.Document)},z.prototype={get_nodeValue:function(){if(this.nodeType==z.Document||this.nodeType==z.Element)throw new ne("Bad node type, unexpected "+this.nodeType);return this.nodeValue},get:function(t){if(this.nodeType!=z.Element)throw new ne("Bad node type, expected Element but found "+this.nodeType);return this.attributeMap.get(t)},set:function(t,e){if(this.nodeType!=z.Element)throw new ne("Bad node type, expected Element but found "+this.nodeType);this.attributeMap.set(t,e)},exists:function(t){if(this.nodeType!=z.Element)throw new ne("Bad node type, expected Element but found "+this.nodeType);return this.attributeMap.exists(t)},elements:function(){if(this.nodeType!=z.Document&&this.nodeType!=z.Element)throw new ne("Bad node type, expected Element or Document but found "+this.nodeType);for(var t,e=[],i=0,s=this.children;i<s.length;){var n=s[i];++i,n.nodeType==z.Element&&e.push(n)}return t=e,a.iter(t)},firstElement:function(){if(this.nodeType!=z.Document&&this.nodeType!=z.Element)throw new ne("Bad node type, expected Element or Document but found "+this.nodeType);for(var t=0,e=this.children;t<e.length;){var i=e[t];if(++t,i.nodeType==z.Element)return i}return null},addChild:function(t){if(this.nodeType!=z.Document&&this.nodeType!=z.Element)throw new ne("Bad node type, expected Element or Document but found "+this.nodeType);null!=t.parent&&t.parent.removeChild(t),this.children.push(t),t.parent=this},removeChild:function(t){if(this.nodeType!=z.Document&&this.nodeType!=z.Element)throw new ne("Bad node type, expected Element or Document but found "+this.nodeType);return a.remove(this.children,t)?(t.parent=null,!0):!1},__class__:z,__properties__:{get_nodeValue:"get_nodeValue"}};var E=n["haxe.StackItem"]={__ename__:["haxe","StackItem"],__constructs__:["CFunction","Module","FilePos","Method","LocalFunction"]};E.CFunction=["CFunction",0],E.CFunction.toString=r,E.CFunction.__enum__=E,E.Module=function(t){var e=["Module",1,t];return e.__enum__=E,e.toString=r,e},E.FilePos=function(t,e,i){var s=["FilePos",2,t,e,i];return s.__enum__=E,s.toString=r,s},E.Method=function(t,e){var i=["Method",3,t,e];return i.__enum__=E,i.toString=r,i},E.LocalFunction=function(t){var e=["LocalFunction",4,t];return e.__enum__=E,e.toString=r,e};var A=function(){};n["haxe.CallStack"]=A,A.__name__=["haxe","CallStack"],A.getStack=function(t){if(null==t)return[];var e=Error.prepareStackTrace;Error.prepareStackTrace=function(t,e){for(var i=[],s=0;s<e.length;){var n=e[s];++s,null!=A.wrapCallSite&&(n=A.wrapCallSite(n));var r=null,o=n.getFunctionName();if(null!=o){var h=o.lastIndexOf(".");if(h>=0){var l=a.substr(o,0,h),_=a.substr(o,h+1,null);r=E.Method(l,_)}}i.push(E.FilePos(r,n.getFileName(),n.getLineNumber()))}return i};var i=A.makeStack(t.stack);return Error.prepareStackTrace=e,i},A.callStack=function(){try{throw new Error}catch(t){t instanceof ne&&(t=t.val);var e=A.getStack(t);return e.shift(),e}},A.makeStack=function(t){if(null==t)return[];if("string"==typeof t){var e=t.split("\n");"Error"==e[0]&&e.shift();for(var i=[],s=new o("^   at ([A-Za-z0-9_. ]+) \\(([^)]+):([0-9]+):([0-9]+)\\)$",""),n=0;n<e.length;){var r=e[n];if(++n,s.match(r)){var a=s.matched(1).split("."),h=a.pop(),l=s.matched(2),_=v.parseInt(s.matched(3));i.push(E.FilePos("Anonymous function"==h?E.LocalFunction():"Global code"==h?null:E.Method(a.join("."),h),l,_))}else i.push(E.Module(w.trim(r)))}return i}return t};var C=function(){};n["haxe.IMap"]=C,C.__name__=["haxe","IMap"],C.prototype={__class__:C};var T=function(t,e){this.high=t,this.low=e};n["haxe._Int64.___Int64"]=T,T.__name__=["haxe","_Int64","___Int64"],T.prototype={__class__:T};var S=function(){};n["haxe.Log"]=S,S.__name__=["haxe","Log"],S.trace=function(t,e){re.__trace(t,e)};var I=function(){};n["haxe.Resource"]=I,I.__name__=["haxe","Resource"],I.getString=function(t){for(var e=0,i=I.content;e<i.length;){var s=i[e];if(++e,s.name==t){if(null!=s.str)return s.str;var n=L.decode(s.data);return n.toString()}}return null};var N=function(){this.buf=new y,this.cache=[],this.useCache=N.USE_CACHE,this.useEnumIndex=N.USE_ENUM_INDEX,this.shash=new V,this.scount=0};n["haxe.Serializer"]=N,N.__name__=["haxe","Serializer"],N.run=function(t){var e=new N;return e.serialize(t),e.toString()},N.prototype={toString:function(){return this.buf.b},serializeString:function(t){var e=this.shash.get(t);return null!=e?(this.buf.b+="R",void(this.buf.b+=null==e?"null":""+e)):(this.shash.set(t,this.scount++),this.buf.b+="y",t=encodeURIComponent(t),this.buf.b+=null==t.length?"null":""+t.length,this.buf.b+=":",void(this.buf.b+=null==t?"null":""+t))},serializeRef:function(t){for(var e=typeof t,i=0,s=this.cache.length;s>i;){var n=i++,r=this.cache[n];if(typeof r==e&&r==t)return this.buf.b+="r",this.buf.b+=null==n?"null":""+n,!0}return this.cache.push(t),!1},serializeFields:function(t){for(var e=0,i=p.fields(t);e<i.length;){var s=i[e];++e,this.serializeString(s),this.serialize(p.field(t,s))}this.buf.b+="g"},serialize:function(t){var e=b["typeof"](t);switch(e[1]){case 0:this.buf.b+="n";break;case 1:var i=t;if(0==i)return void(this.buf.b+="z");this.buf.b+="i",this.buf.b+=null==i?"null":""+i;break;case 2:var s=t;isNaN(s)?this.buf.b+="k":isFinite(s)?(this.buf.b+="d",this.buf.b+=null==s?"null":""+s):this.buf.b+=0>s?"m":"p";break;case 3:this.buf.b+=t?"t":"f";break;case 6:var n=e[2];if(n==String)return void this.serializeString(t);if(this.useCache&&this.serializeRef(t))return;switch(n){case Array:var r=0;this.buf.b+="a";for(var o=t.length,a=0;o>a;){var h=a++;null==t[h]?r++:(r>0&&(1==r?this.buf.b+="n":(this.buf.b+="u",this.buf.b+=null==r?"null":""+r),r=0),this.serialize(t[h]))}r>0&&(1==r?this.buf.b+="n":(this.buf.b+="u",this.buf.b+=null==r?"null":""+r)),this.buf.b+="h";break;case l:this.buf.b+="l";for(var _=t,u=_.h,c=null;null!=u;){var d;c=u[0],u=u[1],d=c,this.serialize(d)}this.buf.b+="h";break;case Date:var f=t;this.buf.b+="v",this.buf.add(f.getTime());break;case V:this.buf.b+="b";for(var m=t,g=m.keys();g.hasNext();){var w=g.next();this.serializeString(w),this.serialize(null!=Ar[w]?m.getReserved(w):m.h[w])}this.buf.b+="h";break;case U:this.buf.b+="q";for(var x=t,k=x.keys();k.hasNext();){var z=k.next();this.buf.b+=":",this.buf.b+=null==z?"null":""+z,this.serialize(x.h[z])}this.buf.b+="h";break;case G:this.buf.b+="M";for(var E=t,A=E.keys();A.hasNext();){var C=A.next(),T=p.field(C,"__id__");p.deleteField(C,"__id__"),this.serialize(C),C.__id__=T,this.serialize(E.h[C.__id__])}this.buf.b+="h";break;case F:for(var S=t,I=0,M=S.length-2,R=new y,B=N.BASE64;M>I;){var P=S.get(I++),L=S.get(I++),O=S.get(I++);R.add(B.charAt(P>>2)),R.add(B.charAt(63&(P<<4|L>>4))),R.add(B.charAt(63&(L<<2|O>>6))),R.add(B.charAt(63&O))}if(I==M){var D=S.get(I++),j=S.get(I++);R.add(B.charAt(D>>2)),R.add(B.charAt(63&(D<<4|j>>4))),R.add(B.charAt(j<<2&63))}else if(I==M+1){var q=S.get(I++);R.add(B.charAt(q>>2)),R.add(B.charAt(q<<4&63))}var X=R.b;this.buf.b+="s",this.buf.b+=null==X.length?"null":""+X.length,this.buf.b+=":",this.buf.b+=null==X?"null":""+X;break;default:this.useCache&&this.cache.pop(),null!=t.hxSerialize?(this.buf.b+="C",this.serializeString(b.getClassName(n)),this.useCache&&this.cache.push(t),t.hxSerialize(this),this.buf.b+="g"):(this.buf.b+="c",this.serializeString(b.getClassName(n)),this.useCache&&this.cache.push(t),this.serializeFields(t))}break;case 4:if(re.__instanceof(t,zr)){var Z=b.getClassName(t);this.buf.b+="A",this.serializeString(Z)}else if(re.__instanceof(t,Er))this.buf.b+="B",this.serializeString(b.getEnumName(t));else{if(this.useCache&&this.serializeRef(t))return;this.buf.b+="o",this.serializeFields(t)}break;case 7:var H=e[2];if(this.useCache){if(this.serializeRef(t))return;this.cache.pop()}this.buf.b+=this.useEnumIndex?"j":"w",this.serializeString(b.getEnumName(H)),this.useEnumIndex?(this.buf.b+=":",this.buf.b+=v.string(t[1])):this.serializeString(t[0]),this.buf.b+=":";var K=t.length;this.buf.b+=v.string(K-2);for(var W=2;K>W;){var Q=W++;this.serialize(t[Q])}this.useCache&&this.cache.push(t);break;case 5:throw new ne("Cannot serialize function");default:throw new ne("Cannot serialize "+v.string(t))}},__class__:N};var M=function(){};n["haxe.Timer"]=M,M.__name__=["haxe","Timer"],M.stamp=function(){return(new Date).getTime()/1e3};var R=function(t){this.buf=t,this.length=t.length,this.pos=0,this.scache=[],this.cache=[];var e=R.DEFAULT_RESOLVER;null==e&&(e=b,R.DEFAULT_RESOLVER=e),this.setResolver(e)};n["haxe.Unserializer"]=R,R.__name__=["haxe","Unserializer"],R.initCodes=function(){for(var t=[],e=0,i=R.BASE64.length;i>e;){var s=e++;t[R.BASE64.charCodeAt(s)]=s}return t},R.run=function(t){return new R(t).unserialize()},R.prototype={setResolver:function(t){this.resolver=null==t?{resolveClass:function(){return null},resolveEnum:function(){return null}}:t},get:function(t){return this.buf.charCodeAt(t)},readDigits:function(){for(var t=0,e=!1,i=this.pos;;){var s=this.buf.charCodeAt(this.pos);if(s!=s)break;if(45!=s){if(48>s||s>57)break;t=10*t+(s-48),this.pos++}else{if(this.pos!=i)break;e=!0,this.pos++}}return e&&(t*=-1),t},readFloat:function(){for(var t=this.pos;;){var e=this.buf.charCodeAt(this.pos);if(!(e>=43&&58>e||101==e||69==e))break;this.pos++}return v.parseFloat(a.substr(this.buf,t,this.pos-t))},unserializeObject:function(t){for(;;){if(this.pos>=this.length)throw new ne("Invalid object");if(103==this.buf.charCodeAt(this.pos))break;var e=this.unserialize();if("string"!=typeof e)throw new ne("Invalid object key");var i=this.unserialize();t[e]=i}this.pos++},unserializeEnum:function(t,e){if(58!=this.get(this.pos++))throw new ne("Invalid enum format");var i=this.readDigits();if(0==i)return b.createEnum(t,e);for(var s=[];i-->0;)s.push(this.unserialize());return b.createEnum(t,e,s)},unserialize:function(){var t=this.get(this.pos++);switch(t){case 110:return null;case 116:return!0;case 102:return!1;case 122:return 0;case 105:return this.readDigits();case 100:return this.readFloat();case 121:var e=this.readDigits();if(58!=this.get(this.pos++)||this.length-this.pos<e)throw new ne("Invalid string length");var i=a.substr(this.buf,this.pos,e);return this.pos+=e,i=decodeURIComponent(i.split("+").join(" ")),this.scache.push(i),i;case 107:return 0/0;case 109:return-1/0;case 112:return 1/0;case 97:var s=(this.buf,[]);for(this.cache.push(s);;){var n=this.buf.charCodeAt(this.pos);if(104==n){this.pos++;break}if(117==n){this.pos++;var r=this.readDigits();
s[s.length+r-1]=null}else s.push(this.unserialize())}return s;case 111:var o={};return this.cache.push(o),this.unserializeObject(o),o;case 114:var h=this.readDigits();if(0>h||h>=this.cache.length)throw new ne("Invalid reference");return this.cache[h];case 82:var _=this.readDigits();if(0>_||_>=this.scache.length)throw new ne("Invalid string reference");return this.scache[_];case 120:throw new ne(this.unserialize());case 99:var u=this.unserialize(),c=this.resolver.resolveClass(u);if(null==c)throw new ne("Class not found "+u);var d=b.createEmptyInstance(c);return this.cache.push(d),this.unserializeObject(d),d;case 119:var f=this.unserialize(),p=this.resolver.resolveEnum(f);if(null==p)throw new ne("Enum not found "+f);var m=this.unserializeEnum(p,this.unserialize());return this.cache.push(m),m;case 106:var g=this.unserialize(),v=this.resolver.resolveEnum(g);if(null==v)throw new ne("Enum not found "+g);this.pos++;var y=this.readDigits(),x=b.getEnumConstructs(v)[y];if(null==x)throw new ne("Unknown enum index "+g+"@"+y);var k=this.unserializeEnum(v,x);return this.cache.push(k),k;case 108:var z=new l;this.cache.push(z);for(this.buf;104!=this.buf.charCodeAt(this.pos);)z.add(this.unserialize());return this.pos++,z;case 98:var E=new V;this.cache.push(E);for(this.buf;104!=this.buf.charCodeAt(this.pos);){var A=this.unserialize();E.set(A,this.unserialize())}return this.pos++,E;case 113:var C=new U;this.cache.push(C);for(var T=(this.buf,this.get(this.pos++));58==T;){var S=this.readDigits();C.set(S,this.unserialize()),T=this.get(this.pos++)}if(104!=T)throw new ne("Invalid IntMap format");return C;case 77:var I=new G;this.cache.push(I);for(this.buf;104!=this.buf.charCodeAt(this.pos);){var N=this.unserialize();I.set(N,this.unserialize())}return this.pos++,I;case 118:var M;if(this.buf.charCodeAt(this.pos)>=48&&this.buf.charCodeAt(this.pos)<=57&&this.buf.charCodeAt(this.pos+1)>=48&&this.buf.charCodeAt(this.pos+1)<=57&&this.buf.charCodeAt(this.pos+2)>=48&&this.buf.charCodeAt(this.pos+2)<=57&&this.buf.charCodeAt(this.pos+3)>=48&&this.buf.charCodeAt(this.pos+3)<=57&&45==this.buf.charCodeAt(this.pos+4)){var B=a.substr(this.buf,this.pos,19);M=a.strDate(B),this.pos+=19}else{var P=this.readFloat(),L=new Date;L.setTime(P),M=L}return this.cache.push(M),M;case 115:var O=this.readDigits(),D=this.buf;if(58!=this.get(this.pos++)||this.length-this.pos<O)throw new ne("Invalid bytes length");var j=R.CODES;null==j&&(j=R.initCodes(),R.CODES=j);var q,X=this.pos,Z=3&O;q=3*(O>>2)+(Z>=2?Z-1:0);for(var H=X+(O-Z),K=F.alloc(q),W=0;H>X;){var Q=j[w.fastCodeAt(D,X++)],Y=j[w.fastCodeAt(D,X++)];K.set(W++,Q<<2|Y>>4);var J=j[w.fastCodeAt(D,X++)];K.set(W++,Y<<4|J>>2);var $=j[w.fastCodeAt(D,X++)];K.set(W++,J<<6|$)}if(Z>=2){var te=j[w.fastCodeAt(D,X++)],ee=j[w.fastCodeAt(D,X++)];if(K.set(W++,te<<2|ee>>4),3==Z){var ie=j[w.fastCodeAt(D,X++)];K.set(W++,ee<<4|ie>>2)}}return this.pos+=O,this.cache.push(K),K;case 67:var se=this.unserialize(),re=this.resolver.resolveClass(se);if(null==re)throw new ne("Class not found "+se);var oe=b.createEmptyInstance(re);if(this.cache.push(oe),oe.hxUnserialize(this),103!=this.get(this.pos++))throw new ne("Invalid custom data");return oe;case 65:var ae=this.unserialize(),he=this.resolver.resolveClass(ae);if(null==he)throw new ne("Class not found "+ae);return he;case 66:var le=this.unserialize(),_e=this.resolver.resolveEnum(le);if(null==_e)throw new ne("Enum not found "+le);return _e}throw this.pos--,new ne("Invalid char "+this.buf.charAt(this.pos)+" at position "+this.pos)},__class__:R};var B=function(){this.__b=""};n["haxe.Utf8"]=B,B.__name__=["haxe","Utf8"],B.prototype={__class__:B};var P=function(){this.a1=1,this.a2=0};n["haxe.crypto.Adler32"]=P,P.__name__=["haxe","crypto","Adler32"],P.read=function(t){var e=new P,i=t.readByte(),s=t.readByte(),n=t.readByte(),r=t.readByte();return e.a1=n<<8|r,e.a2=i<<8|s,e},P.prototype={update:function(t,e,i){for(var s=this.a1,n=this.a2,r=e,o=e+i;o>r;){var a=r++,h=t.b[a];s=(s+h)%65521,n=(n+s)%65521}this.a1=s,this.a2=n},equals:function(t){return t.a1==this.a1&&t.a2==this.a2},__class__:P};var F=function(t){this.length=t.byteLength,this.b=new Tr(t),this.b.bufferValue=t,t.hxBytes=this,t.bytes=this.b};n["haxe.io.Bytes"]=F,F.__name__=["haxe","io","Bytes"],F.alloc=function(t){return new F(new Cr(t))},F.ofString=function(t){for(var e=[],i=0;i<t.length;){var s=w.fastCodeAt(t,i++);s>=55296&&56319>=s&&(s=s-55232<<10|1023&w.fastCodeAt(t,i++)),127>=s?e.push(s):2047>=s?(e.push(192|s>>6),e.push(128|63&s)):65535>=s?(e.push(224|s>>12),e.push(128|s>>6&63),e.push(128|63&s)):(e.push(240|s>>18),e.push(128|s>>12&63),e.push(128|s>>6&63),e.push(128|63&s))}return new F(new Tr(e).buffer)},F.prototype={get:function(t){return this.b[t]},set:function(t,e){this.b[t]=255&e},blit:function(t,e,i,s){if(0>t||0>i||0>s||t+s>this.length||i+s>e.length)throw new ne(K.OutsideBounds);0==i&&s==e.length?this.b.set(e.b,t):this.b.set(e.b.subarray(i,i+s),t)},getString:function(t,e){if(0>t||0>e||t+e>this.length)throw new ne(K.OutsideBounds);for(var i="",s=this.b,n=String.fromCharCode,r=t,o=t+e;o>r;){var a=s[r++];if(128>a){if(0==a)break;i+=n(a)}else if(224>a)i+=n((63&a)<<6|127&s[r++]);else if(240>a){var h=s[r++];i+=n((31&a)<<12|(127&h)<<6|127&s[r++])}else{var l=s[r++],_=s[r++],u=(15&a)<<18|(127&l)<<12|(127&_)<<6|127&s[r++];i+=n((u>>10)+55232),i+=n(1023&u|56320)}}return i},toString:function(){return this.getString(0,this.length)},__class__:F};var L=function(){};n["haxe.crypto.Base64"]=L,L.__name__=["haxe","crypto","Base64"],L.decode=function(t,e){if(null==e&&(e=!0),e)for(;61==a.cca(t,t.length-1);)t=a.substr(t,0,-1);return new O(L.BYTES).decodeBytes(F.ofString(t))};var O=function(t){for(var e=t.length,i=1;e>1<<i;)i++;if(i>8||e!=1<<i)throw new ne("BaseCode : base length must be a power of two.");this.base=t,this.nbits=i};n["haxe.crypto.BaseCode"]=O,O.__name__=["haxe","crypto","BaseCode"],O.prototype={initTable:function(){for(var t=[],e=0;256>e;){var i=e++;t[i]=-1}for(var s=0,n=this.base.length;n>s;){var r=s++;t[this.base.b[r]]=r}this.tbl=t},decodeBytes:function(t){{var e=this.nbits;this.base}null==this.tbl&&this.initTable();for(var i=this.tbl,s=t.length*e>>3,n=F.alloc(s),r=0,o=0,a=0,h=0;s>h;){for(;8>o;){o+=e,r<<=e;var l=i[t.get(a++)];if(-1==l)throw new ne("BaseCode : invalid encoded char");r|=l}o-=8,n.set(h++,r>>o&255)}return n},__class__:O};var D=function(){};n["haxe.crypto.Md5"]=D,D.__name__=["haxe","crypto","Md5"],D.encode=function(t){var e=new D,i=e.doEncode(D.str2blks(t));return e.hex(i)},D.str2blks=function(t){for(var e=(t.length+8>>6)+1,i=[],s=16*e,n=0;s>n;){var r=n++;i[r]=0}for(var o=0;o<t.length;)i[o>>2]|=a.cca(t,o)<<(8*t.length+o)%4*8,o++;i[o>>2]|=128<<(8*t.length+o)%4*8;var h=8*t.length,l=16*e-2;return i[l]=255&h,i[l]|=(h>>>8&255)<<8,i[l]|=(h>>>16&255)<<16,i[l]|=(h>>>24&255)<<24,i},D.prototype={bitOR:function(t,e){var i=1&t|1&e,s=t>>>1|e>>>1;return s<<1|i},bitXOR:function(t,e){var i=1&t^1&e,s=t>>>1^e>>>1;return s<<1|i},bitAND:function(t,e){var i=1&t&(1&e),s=t>>>1&e>>>1;return s<<1|i},addme:function(t,e){var i=(65535&t)+(65535&e),s=(t>>16)+(e>>16)+(i>>16);return s<<16|65535&i},hex:function(t){for(var e="",i="0123456789abcdef",s=0;s<t.length;){var n=t[s];++s;for(var r=0;4>r;){var o=r++;e+=i.charAt(n>>8*o+4&15)+i.charAt(n>>8*o&15)}}return e},rol:function(t,e){return t<<e|t>>>32-e},cmn:function(t,e,i,s,n,r){return this.addme(this.rol(this.addme(this.addme(e,t),this.addme(s,r)),n),i)},ff:function(t,e,i,s,n,r,o){return this.cmn(this.bitOR(this.bitAND(e,i),this.bitAND(~e,s)),t,e,n,r,o)},gg:function(t,e,i,s,n,r,o){return this.cmn(this.bitOR(this.bitAND(e,s),this.bitAND(i,~s)),t,e,n,r,o)},hh:function(t,e,i,s,n,r,o){return this.cmn(this.bitXOR(this.bitXOR(e,i),s),t,e,n,r,o)},ii:function(t,e,i,s,n,r,o){return this.cmn(this.bitXOR(i,this.bitOR(e,~s)),t,e,n,r,o)},doEncode:function(t){for(var e,i=1732584193,s=-271733879,n=-1732584194,r=271733878,o=0;o<t.length;){var a=i,h=s,l=n,_=r;e=0,i=this.ff(i,s,n,r,t[o],7,-680876936),r=this.ff(r,i,s,n,t[o+1],12,-389564586),n=this.ff(n,r,i,s,t[o+2],17,606105819),s=this.ff(s,n,r,i,t[o+3],22,-1044525330),i=this.ff(i,s,n,r,t[o+4],7,-176418897),r=this.ff(r,i,s,n,t[o+5],12,1200080426),n=this.ff(n,r,i,s,t[o+6],17,-1473231341),s=this.ff(s,n,r,i,t[o+7],22,-45705983),i=this.ff(i,s,n,r,t[o+8],7,1770035416),r=this.ff(r,i,s,n,t[o+9],12,-1958414417),n=this.ff(n,r,i,s,t[o+10],17,-42063),s=this.ff(s,n,r,i,t[o+11],22,-1990404162),i=this.ff(i,s,n,r,t[o+12],7,1804603682),r=this.ff(r,i,s,n,t[o+13],12,-40341101),n=this.ff(n,r,i,s,t[o+14],17,-1502002290),s=this.ff(s,n,r,i,t[o+15],22,1236535329),i=this.gg(i,s,n,r,t[o+1],5,-165796510),r=this.gg(r,i,s,n,t[o+6],9,-1069501632),n=this.gg(n,r,i,s,t[o+11],14,643717713),s=this.gg(s,n,r,i,t[o],20,-373897302),i=this.gg(i,s,n,r,t[o+5],5,-701558691),r=this.gg(r,i,s,n,t[o+10],9,38016083),n=this.gg(n,r,i,s,t[o+15],14,-660478335),s=this.gg(s,n,r,i,t[o+4],20,-405537848),i=this.gg(i,s,n,r,t[o+9],5,568446438),r=this.gg(r,i,s,n,t[o+14],9,-1019803690),n=this.gg(n,r,i,s,t[o+3],14,-187363961),s=this.gg(s,n,r,i,t[o+8],20,1163531501),i=this.gg(i,s,n,r,t[o+13],5,-1444681467),r=this.gg(r,i,s,n,t[o+2],9,-51403784),n=this.gg(n,r,i,s,t[o+7],14,1735328473),s=this.gg(s,n,r,i,t[o+12],20,-1926607734),i=this.hh(i,s,n,r,t[o+5],4,-378558),r=this.hh(r,i,s,n,t[o+8],11,-2022574463),n=this.hh(n,r,i,s,t[o+11],16,1839030562),s=this.hh(s,n,r,i,t[o+14],23,-35309556),i=this.hh(i,s,n,r,t[o+1],4,-1530992060),r=this.hh(r,i,s,n,t[o+4],11,1272893353),n=this.hh(n,r,i,s,t[o+7],16,-155497632),s=this.hh(s,n,r,i,t[o+10],23,-1094730640),i=this.hh(i,s,n,r,t[o+13],4,681279174),r=this.hh(r,i,s,n,t[o],11,-358537222),n=this.hh(n,r,i,s,t[o+3],16,-722521979),s=this.hh(s,n,r,i,t[o+6],23,76029189),i=this.hh(i,s,n,r,t[o+9],4,-640364487),r=this.hh(r,i,s,n,t[o+12],11,-421815835),n=this.hh(n,r,i,s,t[o+15],16,530742520),s=this.hh(s,n,r,i,t[o+2],23,-995338651),i=this.ii(i,s,n,r,t[o],6,-198630844),r=this.ii(r,i,s,n,t[o+7],10,1126891415),n=this.ii(n,r,i,s,t[o+14],15,-1416354905),s=this.ii(s,n,r,i,t[o+5],21,-57434055),i=this.ii(i,s,n,r,t[o+12],6,1700485571),r=this.ii(r,i,s,n,t[o+3],10,-1894986606),n=this.ii(n,r,i,s,t[o+10],15,-1051523),s=this.ii(s,n,r,i,t[o+1],21,-2054922799),i=this.ii(i,s,n,r,t[o+8],6,1873313359),r=this.ii(r,i,s,n,t[o+15],10,-30611744),n=this.ii(n,r,i,s,t[o+6],15,-1560198380),s=this.ii(s,n,r,i,t[o+13],21,1309151649),i=this.ii(i,s,n,r,t[o+4],6,-145523070),r=this.ii(r,i,s,n,t[o+11],10,-1120210379),n=this.ii(n,r,i,s,t[o+2],15,718787259),s=this.ii(s,n,r,i,t[o+9],21,-343485551),i=this.addme(i,a),s=this.addme(s,h),n=this.addme(n,l),r=this.addme(r,_),o+=16}return[i,s,n,r]},__class__:D};var U=function(){this.h={}};n["haxe.ds.IntMap"]=U,U.__name__=["haxe","ds","IntMap"],U.__interfaces__=[C],U.prototype={set:function(t,e){this.h[t]=e},get:function(t){return this.h[t]},exists:function(t){return this.h.hasOwnProperty(t)},remove:function(t){return this.h.hasOwnProperty(t)?(delete this.h[t],!0):!1},keys:function(){var t=[];for(var e in this.h)this.h.hasOwnProperty(e)&&t.push(0|e);return a.iter(t)},iterator:function(){return{ref:this.h,it:this.keys(),hasNext:function(){return this.it.hasNext()},next:function(){var t=this.it.next();return this.ref[t]}}},__class__:U};var G=function(){this.h={},this.h.__keys__={}};n["haxe.ds.ObjectMap"]=G,G.__name__=["haxe","ds","ObjectMap"],G.__interfaces__=[C],G.prototype={set:function(t,e){var i=t.__id__||(t.__id__=++G.count);this.h[i]=e,this.h.__keys__[i]=t},get:function(t){return this.h[t.__id__]},exists:function(t){return null!=this.h.__keys__[t.__id__]},remove:function(t){var e=t.__id__;return null==this.h.__keys__[e]?!1:(delete this.h[e],delete this.h.__keys__[e],!0)},keys:function(){var t=[];for(var e in this.h.__keys__)this.h.hasOwnProperty(e)&&t.push(this.h.__keys__[e]);return a.iter(t)},iterator:function(){return{ref:this.h,it:this.keys(),hasNext:function(){return this.it.hasNext()},next:function(){var t=this.it.next();return this.ref[t.__id__]}}},__class__:G};var j=function(t,e){this.map=t,this.keys=e,this.index=0,this.count=e.length};n["haxe.ds._StringMap.StringMapIterator"]=j,j.__name__=["haxe","ds","_StringMap","StringMapIterator"],j.prototype={hasNext:function(){return this.index<this.count},next:function(){return this.map.get(this.keys[this.index++])},__class__:j};var V=function(){this.h={}};n["haxe.ds.StringMap"]=V,V.__name__=["haxe","ds","StringMap"],V.__interfaces__=[C],V.prototype={set:function(t,e){null!=Ar[t]?this.setReserved(t,e):this.h[t]=e},get:function(t){return null!=Ar[t]?this.getReserved(t):this.h[t]},exists:function(t){return null!=Ar[t]?this.existsReserved(t):this.h.hasOwnProperty(t)},setReserved:function(t,e){null==this.rh&&(this.rh={}),this.rh["$"+t]=e},getReserved:function(t){return null==this.rh?null:this.rh["$"+t]},existsReserved:function(t){return null==this.rh?!1:this.rh.hasOwnProperty("$"+t)},remove:function(t){return null!=Ar[t]?(t="$"+t,null!=this.rh&&this.rh.hasOwnProperty(t)?(delete this.rh[t],!0):!1):this.h.hasOwnProperty(t)?(delete this.h[t],!0):!1},keys:function(){var t=this.arrayKeys();return a.iter(t)},arrayKeys:function(){var t=[];for(var e in this.h)this.h.hasOwnProperty(e)&&t.push(e);if(null!=this.rh)for(var e in this.rh)36==e.charCodeAt(0)&&t.push(e.substr(1));return t},iterator:function(){return new j(this,this.arrayKeys())},__class__:V};var q=function(){this.b=[]};n["haxe.io.BytesBuffer"]=q,q.__name__=["haxe","io","BytesBuffer"],q.prototype={addBytes:function(t,e,i){if(0>e||0>i||e+i>t.length)throw new ne(K.OutsideBounds);for(var s=(this.b,t.b),n=e,r=e+i;r>n;){var o=n++;this.b.push(s[o])}},getBytes:function(){var t=new F(new Tr(this.b).buffer);return this.b=null,t},__class__:q};var X=function(){};n["haxe.io.Input"]=X,X.__name__=["haxe","io","Input"],X.prototype={readByte:function(){throw new ne("Not implemented")},readBytes:function(t,e,i){var s=i,n=t.b;if(0>e||0>i||e+i>t.length)throw new ne(K.OutsideBounds);for(;s>0;)n[e]=this.readByte(),e++,s--;return i},read:function(t){for(var e=F.alloc(t),i=0;t>0;){var s=this.readBytes(e,i,t);if(0==s)throw new ne(K.Blocked);i+=s,t-=s}return e},readUInt16:function(){var t=this.readByte(),e=this.readByte();return this.bigEndian?e|t<<8:t|e<<8},__class__:X};var Z=function(t,e,i){if(null==e&&(e=0),null==i&&(i=t.length-e),0>e||0>i||e+i>t.length)throw new ne(K.OutsideBounds);this.b=t.b,this.pos=e,this.len=i,this.totlen=i};n["haxe.io.BytesInput"]=Z,Z.__name__=["haxe","io","BytesInput"],Z.__super__=X,Z.prototype=e(X.prototype,{readByte:function(){if(0==this.len)throw new ne(new H);return this.len--,this.b[this.pos++]},readBytes:function(t,e,i){if(0>e||0>i||e+i>t.length)throw new ne(K.OutsideBounds);if(0==this.len&&i>0)throw new ne(new H);this.len<i&&(i=this.len);for(var s=this.b,n=t.b,r=0;i>r;){var o=r++;n[e+o]=s[this.pos+o]}return this.pos+=i,this.len-=i,i},__class__:Z});var H=function(){};n["haxe.io.Eof"]=H,H.__name__=["haxe","io","Eof"],H.prototype={toString:function(){return"Eof"},__class__:H};var K=n["haxe.io.Error"]={__ename__:["haxe","io","Error"],__constructs__:["Blocked","Overflow","OutsideBounds","Custom"]};K.Blocked=["Blocked",0],K.Blocked.toString=r,K.Blocked.__enum__=K,K.Overflow=["Overflow",1],K.Overflow.toString=r,K.Overflow.__enum__=K,K.OutsideBounds=["OutsideBounds",2],K.OutsideBounds.toString=r,K.OutsideBounds.__enum__=K,K.Custom=function(t){var e=["Custom",3,t];return e.__enum__=K,e.toString=r,e};var W=function(){};n["haxe.io.FPHelper"]=W,W.__name__=["haxe","io","FPHelper"],W.i32ToFloat=function(t){var e=1-(t>>>31<<1),i=t>>>23&255,s=8388607&t;return 0==s&&0==i?0:e*(1+Math.pow(2,-23)*s)*Math.pow(2,i-127)},W.floatToI32=function(t){if(0==t)return 0;var e;e=0>t?-t:t;var i=Math.floor(Math.log(e)/.6931471805599453);-127>i?i=-127:i>128&&(i=128);var s=8388607&Math.round(8388608*(e/Math.pow(2,i)-1));return(0>t?-2147483648:0)|i+127<<23|s},W.i64ToDouble=function(t,e){var i=1-(e>>>31<<1),s=(e>>20&2047)-1023,n=4294967296*(1048575&e)+2147483648*(t>>>31)+(2147483647&t);return 0==n&&-1023==s?0:i*(1+Math.pow(2,-52)*n)*Math.pow(2,s)},W.doubleToI64=function(t){var e=W.i64tmp;if(0==t)e.low=0,e.high=0;else{var i;i=0>t?-t:t;var s,n=Math.floor(Math.log(i)/.6931471805599453),r=4503599627370496*(i/Math.pow(2,n)-1);s=Math.round(r);var o=0|s,a=s/4294967296|0;e.low=o,e.high=(0>t?-2147483648:0)|n+1023<<20|a}return e};var Q=function(t){switch(t){case".":case"..":return this.dir=t,void(this.file="")}var e=t.lastIndexOf("/"),i=t.lastIndexOf("\\");i>e?(this.dir=a.substr(t,0,i),t=a.substr(t,i+1,null),this.backslash=!0):e>i?(this.dir=a.substr(t,0,e),t=a.substr(t,e+1,null)):this.dir=null;var s=t.lastIndexOf(".");-1!=s?(this.ext=a.substr(t,s+1,null),this.file=a.substr(t,0,s)):(this.ext=null,this.file=t)};n["haxe.io.Path"]=Q,Q.__name__=["haxe","io","Path"],Q.directory=function(t){var e=new Q(t);return null==e.dir?"":e.dir},Q.extension=function(t){var e=new Q(t);return null==e.ext?"":e.ext},Q.join=function(t){var e=t.filter(function(t){return null!=t&&""!=t});if(0==e.length)return"";for(var i=e[0],s=1,n=e.length;n>s;){var r=s++;i=Q.addTrailingSlash(i),i+=e[r]}return Q.normalize(i)},Q.normalize=function(t){var e="/";if(t=t.split("\\").join("/"),null==t||t==e)return e;for(var i=[],s=0,n=t.split(e);s<n.length;){var r=n[s];++s,".."==r&&i.length>0&&".."!=i[i.length-1]?i.pop():"."!=r&&i.push(r)}for(var h=i.join(e),l=new o("([^:])/+","g"),_=(l.replace(h,"$1"+e),new y),u=!1,c=!1,d=0,f=h.length;f>d;){var p=d++,m=a.cca(h,p),g=m;if(null!=m)switch(m){case 58:_.b+=":",u=!0;break;case 47:0==u?c=!0:(u=!1,c&&(_.b+="/",c=!1),_.add(String.fromCharCode(g)));break;default:u=!1,c&&(_.b+="/",c=!1),_.add(String.fromCharCode(g))}else u=!1,c&&(_.b+="/",c=!1),_.add(String.fromCharCode(g))}var v=_.b;return v},Q.addTrailingSlash=function(t){if(0==t.length)return"/";var e=t.lastIndexOf("/"),i=t.lastIndexOf("\\");return i>e?i!=t.length-1?t+"\\":t:e!=t.length-1?t+"/":t},Q.prototype={__class__:Q};var Y=function(){};n["haxe.xml.Parser"]=Y,Y.__name__=["haxe","xml","Parser"],Y.parse=function(t,e){null==e&&(e=!1);var i=z.createDocument();return Y.doParse(t,e,0,i),i},Y.doParse=function(t,e,i,s){null==i&&(i=0);for(var n=null,r=1,o=1,h=null,l=0,_=0,u=0,c=t.charCodeAt(i),d=new y,f=1,p=-1;c==c;){switch(r){case 0:switch(c){case 10:case 13:case 9:case 32:break;default:r=o;continue}break;case 1:switch(c){case 60:r=0,o=2;break;default:l=i,r=13;continue}break;case 13:if(60==c){d.addSub(t,l,i-l);var m=z.createPCData(d.b);d=new y,s.addChild(m),_++,r=0,o=2}else 38==c&&(d.addSub(t,l,i-l),r=18,f=13,l=i+1);break;case 17:if(93==c&&93==t.charCodeAt(i+1)&&62==t.charCodeAt(i+2)){var g=z.createCData(a.substr(t,l,i-l));s.addChild(g),_++,i+=2,r=1}break;case 2:switch(c){case 33:if(91==t.charCodeAt(i+1)){if(i+=2,"CDATA["!=a.substr(t,i,6).toUpperCase())throw new ne("Expected <![CDATA[");i+=5,r=17,l=i+1}else if(68==t.charCodeAt(i+1)||100==t.charCodeAt(i+1)){if("OCTYPE"!=a.substr(t,i+2,6).toUpperCase())throw new ne("Expected <!DOCTYPE");i+=8,r=16,l=i+1}else{if(45!=t.charCodeAt(i+1)||45!=t.charCodeAt(i+2))throw new ne("Expected <!--");i+=2,r=15,l=i+1}break;case 63:r=14,l=i;break;case 47:if(null==s)throw new ne("Expected node name");l=i+1,r=0,o=10;break;default:r=3,l=i;continue}break;case 3:if(!(c>=97&&122>=c||c>=65&&90>=c||c>=48&&57>=c||58==c||46==c||95==c||45==c)){if(i==l)throw new ne("Expected node name");n=z.createElement(a.substr(t,l,i-l)),s.addChild(n),_++,r=0,o=4;continue}break;case 4:switch(c){case 47:r=11;break;case 62:r=9;break;default:r=5,l=i;continue}break;case 5:if(!(c>=97&&122>=c||c>=65&&90>=c||c>=48&&57>=c||58==c||46==c||95==c||45==c)){var x;if(l==i)throw new ne("Expected attribute name");if(x=a.substr(t,l,i-l),h=x,n.exists(h))throw new ne("Duplicate attribute");r=0,o=6;continue}break;case 6:switch(c){case 61:r=0,o=7;break;default:throw new ne("Expected =")}break;case 7:switch(c){case 34:case 39:d=new y,r=8,l=i+1,p=c;break;default:throw new ne('Expected "')}break;case 8:switch(c){case 38:d.addSub(t,l,i-l),r=18,f=8,l=i+1;break;case 62:if(e)throw new ne("Invalid unescaped "+String.fromCharCode(c)+" in attribute value");if(c==p){d.addSub(t,l,i-l);var b=d.b;d=new y,n.set(h,b),r=0,o=4}break;case 60:if(e)throw new ne("Invalid unescaped "+String.fromCharCode(c)+" in attribute value");if(c==p){d.addSub(t,l,i-l);var k=d.b;d=new y,n.set(h,k),r=0,o=4}break;default:if(c==p){d.addSub(t,l,i-l);var E=d.b;d=new y,n.set(h,E),r=0,o=4}}break;case 9:i=Y.doParse(t,e,i,n),l=i,r=1;break;case 11:switch(c){case 62:r=1;break;default:throw new ne("Expected >")}break;case 12:switch(c){case 62:return 0==_&&s.addChild(z.createPCData("")),i;default:throw new ne("Expected >")}break;case 10:if(!(c>=97&&122>=c||c>=65&&90>=c||c>=48&&57>=c||58==c||46==c||95==c||45==c)){if(l==i)throw new ne("Expected node name");var A=a.substr(t,l,i-l);if(A!=function(){var t;if(s.nodeType!=z.Element)throw new ne("Bad node type, expected Element but found "+s.nodeType);return t=s.nodeName}(this))throw new ne("Expected </"+function(){var t;if(s.nodeType!=z.Element)throw"Bad node type, expected Element but found "+s.nodeType;return t=s.nodeName}(this)+">");r=0,o=12;continue}break;case 15:if(45==c&&45==t.charCodeAt(i+1)&&62==t.charCodeAt(i+2)){var C=z.createComment(a.substr(t,l,i-l));s.addChild(C),_++,i+=2,r=1}break;case 16:if(91==c)u++;else if(93==c)u--;else if(62==c&&0==u){var T=z.createDocType(a.substr(t,l,i-l));s.addChild(T),_++,r=1}break;case 14:if(63==c&&62==t.charCodeAt(i+1)){i++;var S=a.substr(t,l+1,i-l-2),I=z.createProcessingInstruction(S);s.addChild(I),_++,r=1}break;case 18:if(59==c){var N=a.substr(t,l,i-l);if(35==N.charCodeAt(0)){var M;M=v.parseInt(120==N.charCodeAt(1)?"0"+a.substr(N,1,N.length-1):a.substr(N,1,N.length-1)),d.b+=String.fromCharCode(M)}else if(Y.escapes.exists(N))d.add(Y.escapes.get(N));else{if(e)throw new ne("Undefined entity: "+N);d.b+=v.string("&"+N+";")}l=i+1,r=f}else if(!(c>=97&&122>=c||c>=65&&90>=c||c>=48&&57>=c||58==c||46==c||95==c||45==c)&&35!=c){if(e)throw new ne("Invalid character in entity: "+String.fromCharCode(c));d.b+="&",d.addSub(t,l,i-l),i--,l=i+1,r=f}}c=w.fastCodeAt(t,++i)}if(1==r&&(l=i,r=13),13==r){if(i!=l||0==_){d.addSub(t,l,i-l);var R=z.createPCData(d.b);s.addChild(R),_++}return i}if(!e&&18==r&&13==f){d.b+="&",d.addSub(t,l,i-l);var B=z.createPCData(d.b);return s.addChild(B),_++,i}throw new ne("Unexpected end")};var J=n["haxe.zip.Huffman"]={__ename__:["haxe","zip","Huffman"],__constructs__:["Found","NeedBit","NeedBits"]};J.Found=function(t){var e=["Found",0,t];return e.__enum__=J,e.toString=r,e},J.NeedBit=function(t,e){var i=["NeedBit",1,t,e];return i.__enum__=J,i.toString=r,i},J.NeedBits=function(t,e){var i=["NeedBits",2,t,e];return i.__enum__=J,i.toString=r,i};var $=function(){};n["haxe.zip.HuffTools"]=$,$.__name__=["haxe","zip","HuffTools"],$.prototype={treeDepth:function(t){switch(t[1]){case 0:return 0;case 2:throw new ne("assert");case 1:var e=t[3],i=t[2],s=this.treeDepth(i),n=this.treeDepth(e);return 1+(n>s?s:n)}},treeCompress:function(t){var e=this.treeDepth(t);if(0==e)return t;if(1==e)switch(t[1]){case 1:var i=t[3],s=t[2];return J.NeedBit(this.treeCompress(s),this.treeCompress(i));default:throw new ne("assert")}for(var n=1<<e,r=[],o=0;n>o;){{o++}r.push(J.Found(-1))}return this.treeWalk(r,0,0,e,t),J.NeedBits(e,r)},treeWalk:function(t,e,i,s,n){switch(n[1]){case 1:var r=n[3],o=n[2];s>0?(this.treeWalk(t,e,i+1,s-1,o),this.treeWalk(t,e|1<<i,i+1,s-1,r)):t[e]=this.treeCompress(n);break;default:t[e]=this.treeCompress(n)}},treeMake:function(t,e,i,s){if(s>e)throw new ne("Invalid huffman");var n=i<<5|s;return t.h.hasOwnProperty(n)?J.Found(t.h[n]):(i<<=1,s+=1,J.NeedBit(this.treeMake(t,e,i,s),this.treeMake(t,e,1|i,s)))},make:function(t,e,i,s){var n=[],r=[];if(s>32)throw new ne("Invalid huffman");for(var o=0;s>o;){{o++}n.push(0),r.push(0)}for(var a=0;i>a;){var h=a++,l=t[h+e];if(l>=s)throw new ne("Invalid huffman");n[l]++}for(var _=0,u=1,c=s-1;c>u;){var d=u++;_=_+n[d]<<1,r[d]=_}for(var f=new U,p=0;i>p;){var m=p++,g=t[m+e];if(0!=g){var v=r[g-1];r[g-1]=v+1,f.h[v<<5|g]=m}}return this.treeCompress(J.NeedBit(this.treeMake(f,s,0,1),this.treeMake(f,s,1,1)))},__class__:$};var te=function(t){this.buffer=F.alloc(65536),this.pos=0,t&&(this.crc=new P)};n["haxe.zip._InflateImpl.Window"]=te,te.__name__=["haxe","zip","_InflateImpl","Window"],te.prototype={slide:function(){null!=this.crc&&this.crc.update(this.buffer,0,32768);var t=F.alloc(65536);this.pos-=32768,t.blit(0,this.buffer,32768,this.pos),this.buffer=t},addBytes:function(t,e,i){this.pos+i>65536&&this.slide(),this.buffer.blit(this.pos,t,e,i),this.pos+=i},addByte:function(t){65536==this.pos&&this.slide(),this.buffer.b[this.pos]=255&t,this.pos++},getLastChar:function(){return this.buffer.b[this.pos-1]},available:function(){return this.pos},checksum:function(){return null!=this.crc&&this.crc.update(this.buffer,0,this.pos),this.crc},__class__:te};var ee=n["haxe.zip._InflateImpl.State"]={__ename__:["haxe","zip","_InflateImpl","State"],__constructs__:["Head","Block","CData","Flat","Crc","Dist","DistOne","Done"]};ee.Head=["Head",0],ee.Head.toString=r,ee.Head.__enum__=ee,ee.Block=["Block",1],ee.Block.toString=r,ee.Block.__enum__=ee,ee.CData=["CData",2],ee.CData.toString=r,ee.CData.__enum__=ee,ee.Flat=["Flat",3],ee.Flat.toString=r,ee.Flat.__enum__=ee,ee.Crc=["Crc",4],ee.Crc.toString=r,ee.Crc.__enum__=ee,ee.Dist=["Dist",5],ee.Dist.toString=r,ee.Dist.__enum__=ee,ee.DistOne=["DistOne",6],ee.DistOne.toString=r,ee.DistOne.__enum__=ee,ee.Done=["Done",7],ee.Done.toString=r,ee.Done.__enum__=ee;var ie=function(t,e,i){null==i&&(i=!0),null==e&&(e=!0),this["final"]=!1,this.htools=new $,this.huffman=this.buildFixedHuffman(),this.huffdist=null,this.len=0,this.dist=0,this.state=e?ee.Head:ee.Block,this.input=t,this.bits=0,this.nbits=0,this.needed=0,this.output=null,this.outpos=0,this.lengths=[];for(var s=0;19>s;){{s++}this.lengths.push(-1)}this.window=new te(i)};n["haxe.zip.InflateImpl"]=ie,ie.__name__=["haxe","zip","InflateImpl"],ie.run=function(t,e){null==e&&(e=65536);for(var i=F.alloc(e),s=new q,n=new ie(t);;){var r=n.readBytes(i,0,e);if(s.addBytes(i,0,r),e>r)break}return s.getBytes()},ie.prototype={buildFixedHuffman:function(){if(null!=ie.FIXED_HUFFMAN)return ie.FIXED_HUFFMAN;for(var t=[],e=0;288>e;){var i=e++;t.push(143>=i?8:255>=i?9:279>=i?7:8)}return ie.FIXED_HUFFMAN=this.htools.make(t,0,288,10),ie.FIXED_HUFFMAN},readBytes:function(t,e,i){if(this.needed=i,this.outpos=e,this.output=t,i>0)for(;this.inflateLoop(););return i-this.needed},getBits:function(t){for(;this.nbits<t;)this.bits|=this.input.readByte()<<this.nbits,this.nbits+=8;var e=this.bits&(1<<t)-1;return this.nbits-=t,this.bits>>=t,e},getBit:function(){0==this.nbits&&(this.nbits=8,this.bits=this.input.readByte());var t=1==(1&this.bits);return this.nbits--,this.bits>>=1,t},getRevBits:function(t){return 0==t?0:this.getBit()?1<<t-1|this.getRevBits(t-1):this.getRevBits(t-1)},resetBits:function(){this.bits=0,this.nbits=0},addBytes:function(t,e,i){this.window.addBytes(t,e,i),this.output.blit(this.outpos,t,e,i),this.needed-=i,this.outpos+=i},addByte:function(t){this.window.addByte(t),this.output.b[this.outpos]=255&t,this.needed--,this.outpos++},addDistOne:function(t){for(var e=this.window.getLastChar(),i=0;t>i;){{i++}this.addByte(e)}},addDist:function(t,e){this.addBytes(this.window.buffer,this.window.pos-t,e)},applyHuffman:function(t){switch(t[1]){case 0:var e=t[2];return e;case 1:var i=t[3],s=t[2];return this.applyHuffman(this.getBit()?i:s);case 2:var n=t[3],r=t[2];return this.applyHuffman(n[this.getBits(r)])}},inflateLengths:function(t,e){for(var i=0,s=0;e>i;){var n=this.applyHuffman(this.huffman);switch(n){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 12:case 13:case 14:case 15:s=n,t[i]=n,i++;break;case 16:var r=i+3+this.getBits(2);if(r>e)throw new ne("Invalid data");for(;r>i;)t[i]=s,i++;break;case 17:if(i+=3+this.getBits(3),i>e)throw new ne("Invalid data");break;case 18:if(i+=11+this.getBits(7),i>e)throw new ne("Invalid data");break;default:throw new ne("Invalid data")}}},inflateLoop:function(){var t=this.state;switch(t[1]){case 0:var e=this.input.readByte(),i=15&e;if(8!=i)throw new ne("Invalid data");var s=this.input.readByte(),n=0!=(32&s);if(((e<<8)+s)%31!=0)throw new ne("Invalid data");if(n)throw new ne("Unsupported dictionary");return this.state=ee.Block,!0;case 4:var r=this.window.checksum();if(null==r)return this.state=ee.Done,!0;var o=P.read(this.input);if(!r.equals(o))throw new ne("Invalid CRC");return this.state=ee.Done,!0;case 7:return!1;case 1:this["final"]=this.getBit();var a=this.getBits(2);switch(a){case 0:this.len=this.input.readUInt16();var h=this.input.readUInt16();if(h!=65535-this.len)throw new ne("Invalid data");this.state=ee.Flat;var l=this.inflateLoop();return this.resetBits(),l;case 1:return this.huffman=this.buildFixedHuffman(),this.huffdist=null,this.state=ee.CData,!0;case 2:for(var _=this.getBits(5)+257,u=this.getBits(5)+1,c=this.getBits(4)+4,d=0;c>d;){var f=d++;this.lengths[ie.CODE_LENGTHS_POS[f]]=this.getBits(3)}for(var p=c;19>p;){var m=p++;this.lengths[ie.CODE_LENGTHS_POS[m]]=0}this.huffman=this.htools.make(this.lengths,0,19,8);for(var g=[],v=0,y=_+u;y>v;){{v++}g.push(0)}return this.inflateLengths(g,_+u),this.huffdist=this.htools.make(g,_,u,16),this.huffman=this.htools.make(g,0,_,16),this.state=ee.CData,!0;default:throw new ne("Invalid data")}break;case 3:var w;w=this.len<this.needed?this.len:this.needed;var x=this.input.read(w);return this.len-=w,this.addBytes(x,0,w),0==this.len&&(this.state=this["final"]?ee.Crc:ee.Block),this.needed>0;case 6:var b;return b=this.len<this.needed?this.len:this.needed,this.addDistOne(b),this.len-=b,0==this.len&&(this.state=ee.CData),this.needed>0;case 5:for(;this.len>0&&this.needed>0;){var k;k=this.len<this.dist?this.len:this.dist;var z;z=this.needed<k?this.needed:k,this.addDist(this.dist,z),this.len-=z}return 0==this.len&&(this.state=ee.CData),this.needed>0;case 2:var E=this.applyHuffman(this.huffman);if(256>E)return this.addByte(E),this.needed>0;if(256==E)return this.state=this["final"]?ee.Crc:ee.Block,!0;E-=257;var A=ie.LEN_EXTRA_BITS_TBL[E];if(-1==A)throw new ne("Invalid data");this.len=ie.LEN_BASE_VAL_TBL[E]+this.getBits(A);var C;if(C=null==this.huffdist?this.getRevBits(5):this.applyHuffman(this.huffdist),A=ie.DIST_EXTRA_BITS_TBL[C],-1==A)throw new ne("Invalid data");if(this.dist=ie.DIST_BASE_VAL_TBL[C]+this.getBits(A),this.dist>this.window.available())throw new ne("Invalid data");return this.state=1==this.dist?ee.DistOne:ee.Dist,!0}},__class__:ie};var se=function(){};n["haxe.zip.Uncompress"]=se,se.__name__=["haxe","zip","Uncompress"],se.run=function(t,e){return ie.run(new Z(t),e)};var ne=function(t){Error.call(this),this.val=t,this.message=String(t),Error.captureStackTrace&&Error.captureStackTrace(this,ne)};n["js._Boot.HaxeError"]=ne,ne.__name__=["js","_Boot","HaxeError"],ne.__super__=Error,ne.prototype=e(Error.prototype,{__class__:ne});var re=function(){};n["js.Boot"]=re,re.__name__=["js","Boot"],re.__unhtml=function(t){return t.split("&").join("&amp;").split("<").join("&lt;").split(">").join("&gt;")},re.__trace=function(e,i){var s;if(s=null!=i?i.fileName+":"+i.lineNumber+": ":"",s+=re.__string_rec(e,""),null!=i&&null!=i.customParams)for(var n=0,r=i.customParams;n<r.length;){var o=r[n];++n,s+=","+re.__string_rec(o,"")}var a;"undefined"!=typeof document&&null!=(a=document.getElementById("haxe:trace"))?a.innerHTML+=re.__unhtml(s)+"<br/>":"undefined"!=typeof t&&null!=t.log&&t.log(s)},re.getClass=function(t){if(t instanceof Array&&null==t.__enum__)return Array;var e=t.__class__;if(null!=e)return e;var i=re.__nativeClassName(t);return null!=i?re.__resolveNativeClass(i):null},re.__string_rec=function(t,e){if(null==t)return"null";if(e.length>=5)return"<...>";var i=typeof t;switch("function"==i&&(t.__name__||t.__ename__)&&(i="object"),i){case"object":if(t instanceof Array){if(t.__enum__){if(2==t.length)return t[0];var s=t[0]+"(";e+="	";for(var n=2,r=t.length;r>n;){var o=n++;s+=2!=o?","+re.__string_rec(t[o],e):re.__string_rec(t[o],e)}return s+")"}var a=t.length,h="[";e+="	";for(var l=0;a>l;){var _=l++;h+=(_>0?",":"")+re.__string_rec(t[_],e)}return h+="]"}var u;try{u=t.toString}catch(c){return c instanceof ne&&(c=c.val),"???"}if(null!=u&&u!=Object.toString&&"function"==typeof u){var d=t.toString();
if("[object Object]"!=d)return d}var f=null,p="{\n";e+="	";var m=null!=t.hasOwnProperty;for(var f in t)(!m||t.hasOwnProperty(f))&&"prototype"!=f&&"__class__"!=f&&"__super__"!=f&&"__interfaces__"!=f&&"__properties__"!=f&&(2!=p.length&&(p+=", \n"),p+=e+f+" : "+re.__string_rec(t[f],e));return e=e.substring(1),p+="\n"+e+"}";case"function":return"<function>";case"string":return t;default:return String(t)}},re.__interfLoop=function(t,e){if(null==t)return!1;if(t==e)return!0;var i=t.__interfaces__;if(null!=i)for(var s=0,n=i.length;n>s;){var r=s++,o=i[r];if(o==e||re.__interfLoop(o,e))return!0}return re.__interfLoop(t.__super__,e)},re.__instanceof=function(t,e){if(null==e)return!1;switch(e){case wr:return(0|t)===t;case br:return"number"==typeof t;case kr:return"boolean"==typeof t;case String:return"string"==typeof t;case Array:return t instanceof Array&&null==t.__enum__;case xr:return!0;default:if(null==t)return!1;if("function"==typeof e){if(t instanceof e)return!0;if(re.__interfLoop(re.getClass(t),e))return!0}else if("object"==typeof e&&re.__isNativeObj(e)&&t instanceof e)return!0;return e==zr&&null!=t.__name__?!0:e==Er&&null!=t.__ename__?!0:t.__enum__==e}},re.__cast=function(t,e){if(re.__instanceof(t,e))return t;throw new ne("Cannot cast "+v.string(t)+" to "+v.string(e))},re.__nativeClassName=function(t){var e=re.__toStr.call(t).slice(8,-1);return"Object"==e||"Function"==e||"Math"==e||"JSON"==e?null:e},re.__isNativeObj=function(t){return null!=re.__nativeClassName(t)},re.__resolveNativeClass=function(t){return Function("return typeof "+t+' != "undefined" ? '+t+" : null")()};var oe=function(){};n["js.html._CanvasElement.CanvasUtil"]=oe,oe.__name__=["js","html","_CanvasElement","CanvasUtil"],oe.getContextWebGL=function(t,e){for(var i=0,s=["webgl","experimental-webgl"];i<s.length;){var n=s[i];++i;var r=t.getContext(n,e);if(null!=r)return r}return null};var ae=function(t){if(t instanceof Array&&null==t.__enum__)this.a=t,this.byteLength=t.length;else{var e=t;this.a=[];for(var i=0;e>i;){var s=i++;this.a[s]=0}this.byteLength=e}};n["js.html.compat.ArrayBuffer"]=ae,ae.__name__=["js","html","compat","ArrayBuffer"],ae.sliceImpl=function(t,e){var i=new Tr(this,t,null==e?null:e-t),s=new Cr(i.byteLength),n=new Tr(s);return n.set(i),s},ae.prototype={slice:function(t,e){return new ae(this.a.slice(t,e))},__class__:ae};var he=function(t,e,i){if(this.buf=t,this.offset=null==e?0:e,this.length=null==i?t.byteLength-this.offset:i,this.offset<0||this.length<0||this.offset+this.length>t.byteLength)throw new ne(K.OutsideBounds)};n["js.html.compat.DataView"]=he,he.__name__=["js","html","compat","DataView"],he.prototype={getInt8:function(t){var e=this.buf.a[this.offset+t];return e>=128?e-256:e},getUint8:function(t){return this.buf.a[this.offset+t]},getInt16:function(t,e){var i=this.getUint16(t,e);return i>=32768?i-65536:i},getUint16:function(t,e){return e?this.buf.a[this.offset+t]|this.buf.a[this.offset+t+1]<<8:this.buf.a[this.offset+t]<<8|this.buf.a[this.offset+t+1]},getInt32:function(t,e){var i=this.offset+t,s=this.buf.a[i++],n=this.buf.a[i++],r=this.buf.a[i++],o=this.buf.a[i++];return e?s|n<<8|r<<16|o<<24:o|r<<8|n<<16|s<<24},getUint32:function(t,e){var i=this.getInt32(t,e);return 0>i?i+4294967296:i},getFloat32:function(t,e){return W.i32ToFloat(this.getInt32(t,e))},getFloat64:function(t,e){var i=this.getInt32(t,e),s=this.getInt32(t+4,e);return W.i64ToDouble(e?i:s,e?s:i)},setInt8:function(t,e){this.buf.a[t+this.offset]=0>e?e+128&255:255&e},setUint8:function(t,e){this.buf.a[t+this.offset]=255&e},setInt16:function(t,e,i){this.setUint16(t,0>e?e+65536:e,i)},setUint16:function(t,e,i){var s=t+this.offset;i?(this.buf.a[s]=255&e,this.buf.a[s++]=e>>8&255):(this.buf.a[s++]=e>>8&255,this.buf.a[s]=255&e)},setInt32:function(t,e,i){this.setUint32(t,e,i)},setUint32:function(t,e,i){var s=t+this.offset;i?(this.buf.a[s++]=255&e,this.buf.a[s++]=e>>8&255,this.buf.a[s++]=e>>16&255,this.buf.a[s++]=e>>>24):(this.buf.a[s++]=e>>>24,this.buf.a[s++]=e>>16&255,this.buf.a[s++]=e>>8&255,this.buf.a[s++]=255&e)},setFloat32:function(t,e,i){this.setUint32(t,W.floatToI32(e),i)},setFloat64:function(t,e,i){var s=W.doubleToI64(e);i?(this.setUint32(t,s.low),this.setUint32(t,s.high)):(this.setUint32(t,s.high),this.setUint32(t,s.low))},__class__:he};var le=function(){};n["js.html.compat.Uint8Array"]=le,le.__name__=["js","html","compat","Uint8Array"],le._new=function(t,e,i){var s;if("number"==typeof t){s=[];for(var n=0;t>n;){var r=n++;s[r]=0}s.byteLength=s.length,s.byteOffset=0,s.buffer=new ae(s)}else if(re.__instanceof(t,ae)){var o=t;null==e&&(e=0),null==i&&(i=o.byteLength-e),s=0==e?o.a:o.a.slice(e,e+i),s.byteLength=s.length,s.byteOffset=e,s.buffer=o}else{if(!(t instanceof Array&&null==t.__enum__))throw new ne("TODO "+v.string(t));s=t.slice(),s.byteLength=s.length,s.byteOffset=0,s.buffer=new ae(s)}return s.subarray=le._subarray,s.set=le._set,s},le._set=function(t,e){var i=this;if(re.__instanceof(t.buffer,ae)){var s=t;if(t.byteLength+e>i.byteLength)throw new ne("set() outside of range");for(var n=0,r=t.byteLength;r>n;){var o=n++;i[o+e]=s[o]}}else{if(!(t instanceof Array&&null==t.__enum__))throw new ne("TODO");var a=t;if(a.length+e>i.byteLength)throw new ne("set() outside of range");for(var h=0,l=a.length;l>h;){var _=h++;i[_+e]=a[_]}}},le._subarray=function(t,e){var i=this,s=le._new(i.slice(t,e));return s.byteOffset=t,s};var _e=function(t){this.core=t};n["luxe.Audio"]=_e,_e.__name__=["luxe","Audio"],_e.prototype={init:function(){},destroy:function(){},create:function(t,e,i){return null==i&&(i=!1),null==e&&(e=""),this.core.app.audio.create(t,e,i)},create_from_bytes:function(t,e,i){return null==t&&(t=""),this.core.app.audio.create_from_bytes(t,e,i)},uncreate:function(t){this.core.app.audio.uncreate(t)},add:function(t){this.core.app.audio.add(t)},on:function(t,e,i){this.core.app.audio.on(t,e,i)},off:function(t,e,i){this.core.app.audio.off(t,e,i)},get:function(t){return this.core.app.audio.get(t)},exists:function(t){return null!=this.get(t)},loop:function(t){this.core.app.audio.loop(t)},stop:function(t){this.core.app.audio.stop(t)},play:function(t){this.core.app.audio.play(t)},pause:function(t){this.core.app.audio.pause(t)},toggle:function(t){this.core.app.audio.toggle(t)},volume:function(t,e){return this.core.app.audio.volume(t,e)},pan:function(t,e){return this.core.app.audio.pan(t,e)},pitch:function(t,e){return this.core.app.audio.pitch(t,e)},position:function(t,e){return this.core.app.audio.position(t,e)},duration:function(t){return this.core.app.audio.duration(t)},process:function(){},__class__:_e};var ue=n["luxe.SizeMode"]={__ename__:["luxe","SizeMode"],__constructs__:["fit","cover","contain"]};ue.fit=["fit",0],ue.fit.toString=r,ue.fit.__enum__=ue,ue.cover=["cover",1],ue.cover.toString=r,ue.cover.__enum__=ue,ue.contain=["contain",2],ue.contain.toString=r,ue.contain.__enum__=ue;var ce=function(t,e){null==e&&(e=""),null==t&&(t=""),this.name="",this.id="",c.call(this),this.set_name(t),this.set_id(""==e?_.utils.uniqueid():e)};n["luxe.Objects"]=ce,ce.__name__=["luxe","Objects"],ce.__super__=c,ce.prototype=e(c.prototype,{set_name:function(t){return this.name=t},set_id:function(t){return this.id=t},get_name:function(){return this.name},get_id:function(){return this.id},__class__:ce,__properties__:{set_name:"set_name",get_name:"get_name",set_id:"set_id",get_id:"get_id"}});var de=function(t){this.component_count=0,this.active=!0,this.fixed_rate=0,this.started=!1,this.inited=!1,this.destroyed=!1,ce.call(this,"entity");var e=this;if(e.set_name(e.get_name()+("."+this.get_id())),this.options=t,this._components=new si(this),this.children=[],this.events=new be,this.set_transform(null!=this.options&&null!=this.options.transform?this.options.transform:new ln),this.get_transform().listen_pos(s(this,this.set_pos_from_transform)),this.get_transform().listen_scale(s(this,this.set_scale_from_transform)),this.get_transform().listen_origin(s(this,this.set_origin_from_transform)),this.get_transform().listen_parent(s(this,this.set_parent_from_transform)),this.get_transform().listen_rotation(s(this,this.set_rotation_from_transform)),null!=this.options){if(null==this.options.name_unique&&(this.options.name_unique=!1),this.options.name_unique,null!=this.options.name&&(this.set_name(this.options.name),this.options.name_unique)){var i=this;i.set_name(i.get_name()+("."+this.get_id()))}if(null!=this.options.pos){var n=this.options.pos;this.set_pos(new un(n.x,n.y,n.z,n.w))}if(null!=this.options.scale){var r=this.options.scale;this.set_scale(new un(r.x,r.y,r.z,r.w))}var o=!0;null!=this.options.no_scene&&1==this.options.no_scene&&(o=!1),null!=this.options.parent&&(o=!1,this.set_parent(this.options.parent)),o&&this.set_scene(null!=this.options.scene?this.options.scene:_.scene)}else this.set_scene(_.scene);null!=this.get_scene()&&this.get_scene().add(this)};n["luxe.Entity"]=de,de.__name__=["luxe","Entity"],de.__super__=ce,de.prototype=e(ce.prototype,{init:function(){},update:function(){},onfixedupdate:function(){},onreset:function(){},ondestroy:function(){},onkeyup:function(){},onkeydown:function(){},ontextinput:function(){},oninputdown:function(){},oninputup:function(){},onmousedown:function(){},onmouseup:function(){},onmousemove:function(){},onmousewheel:function(){},ontouchdown:function(){},ontouchup:function(){},ontouchmove:function(){},ongamepadup:function(){},ongamepaddown:function(){},ongamepadaxis:function(){},ongamepaddevice:function(){},onwindowmoved:function(){},onwindowresized:function(){},onwindowsized:function(){},onwindowminimized:function(){},onwindowrestored:function(){},add:function(t){return this.component_count++,this._components.add(t)},remove:function(t){return this.component_count--,this._components.remove(t)},get:function(t,e){return null==e&&(e=!1),this._components.get(t,e)},get_any:function(t,e,i){return null==i&&(i=!0),null==e&&(e=!1),this._components.get_any(t,e,i)},has:function(t){return this._components.has(t)},_init:function(){if(this.init(),this.emit(2),this.component_count>0)for(var t=0,e=this._components.components;t<e._keys.length;){var i=e.get(e._keys[t++]);i.init()}if(this.children.length>0)for(var s=0,n=this.children;s<n.length;){var r=n[s];++s,r._init()}this.inited=!0},_reset:function(t){if(this.onreset(),this.emit(3),this.component_count>0)for(var e=0,i=this._components.components;e<i._keys.length;){var s=i.get(i._keys[e++]);s.onreset()}if(this.children.length>0)for(var n=0,r=this.children;n<r.length;){var o=r[n];++n,o._reset(t)}this._set_fixed_rate_timer(this.fixed_rate),this.started=!0},destroy:function(t){if(null==t&&(t=!1),this.children.length>0)for(var e=0,i=this.children;e<i.length;){var s=i[e];++e,s.destroy(!0)}if(this.children=null,this.children=[],this.component_count>0)for(var n=0,r=this._components.components;n<r._keys.length;){var o=r.get(r._keys[n++]);o.onremoved(),o.ondestroy()}this.emit(6),this.ondestroy(),null==this.get_parent()||t||this.get_parent()._remove_child(this),null!=this.fixed_rate_timer&&(this.fixed_rate_timer.stop(),this.fixed_rate_timer=null),this.destroyed=!0,this.inited=!1,this.started=!1,null!=this.get_scene()&&this.get_scene().remove(this),null!=this.events&&(this.events.destroy(),this.events=null)},_update:function(t){if(!this.destroyed&&this.get_active()&&this.inited&&this.started){if(this.get_transform().clean_check(),this.update(t),null!=this.events&&this.events.process(),this.component_count>0)for(var e=0,i=this._components.components;e<i._keys.length;){var s=i.get(i._keys[e++]);s.update(t)}if(this.children.length>0)for(var n=0,r=this.children;n<r.length;){var o=r[n];++n,o._update(t)}}},_fixed_update:function(){if(!this.destroyed&&this.get_active()&&this.inited&&this.started){if(this.emit(5),this.onfixedupdate(this.fixed_rate),this.component_count>0)for(var t=0,e=this._components.components;t<e._keys.length;){var i=e.get(e._keys[t++]);i.onfixedupdate(this.fixed_rate)}if(this.children.length>0)for(var s=0,n=this.children;s<n.length;){var r=n[s];++s,r._fixed_update()}}},_find_emit_source:function(t){null==t&&(t=!1);var e=null;if(null!=this.get_scene())e=this.get_scene();else if(null!=this.get_parent())for(var i=!0;i;){if(null!=this.get_parent().get_scene()){e=this.get_parent().get_scene(),i=!1;break}if(null==this.get_parent().get_parent()){t||S.trace("   i / entity / entity has no parent or scene, currently no core events will reach it.",{fileName:"Entity.hx",lineNumber:496,className:"luxe.Entity",methodName:"_find_emit_source"}),i=!1;break}}else t||S.trace("   i / entity / entity has no parent or scene, currently no core events will reach it.",{fileName:"Entity.hx",lineNumber:517,className:"luxe.Entity",methodName:"_find_emit_source"});return e},_listen:function(t,e,i){null==i&&(i=!1),i||this.on(t,e);var n=this._find_emit_source(null);if(null!=n)switch(t){case 11:n.on(t,s(this,this._keyup));break;case 10:n.on(t,s(this,this._keydown));break;case 12:n.on(t,s(this,this._textinput));break;case 15:n.on(t,s(this,this._mousedown));break;case 16:n.on(t,s(this,this._mouseup));break;case 17:n.on(t,s(this,this._mousemove));break;case 18:n.on(t,s(this,this._mousewheel));break;case 19:n.on(t,s(this,this._touchdown));break;case 20:n.on(t,s(this,this._touchup));break;case 21:n.on(t,s(this,this._touchmove));break;case 14:n.on(t,s(this,this._inputup));break;case 13:n.on(t,s(this,this._inputdown));break;case 23:n.on(t,s(this,this._gamepaddown));break;case 24:n.on(t,s(this,this._gamepadup));break;case 22:n.on(t,s(this,this._gamepadaxis));break;case 25:n.on(t,s(this,this._gamepaddevice));break;case 27:n.on(t,s(this,this._windowmoved));break;case 28:n.on(t,s(this,this._windowresized));break;case 29:n.on(t,s(this,this._windowsized));break;case 30:n.on(t,s(this,this._windowminimized));break;case 31:n.on(t,s(this,this._windowrestored))}},_unlisten:function(t,e,i){null==i&&(i=!1);var n=this._find_emit_source(!0);if(i||this.off(t,e),null!=n)switch(t){case 11:n.off(t,s(this,this._keyup));break;case 10:n.off(t,s(this,this._keydown));break;case 12:n.off(t,s(this,this._textinput));break;case 15:n.off(t,s(this,this._mousedown));break;case 16:n.off(t,s(this,this._mouseup));break;case 17:n.off(t,s(this,this._mousemove));break;case 18:n.off(t,s(this,this._mousewheel));break;case 19:n.off(t,s(this,this._touchdown));break;case 20:n.off(t,s(this,this._touchup));break;case 21:n.off(t,s(this,this._touchmove));break;case 14:n.off(t,s(this,this._inputup));break;case 13:n.off(t,s(this,this._inputdown));break;case 23:n.off(t,s(this,this._gamepaddown));break;case 24:n.off(t,s(this,this._gamepadup));break;case 22:n.off(t,s(this,this._gamepadaxis));break;case 25:n.off(t,s(this,this._gamepaddevice));break;case 27:n.off(t,s(this,this._windowmoved));break;case 28:n.off(t,s(this,this._windowresized));break;case 29:n.off(t,s(this,this._windowsized));break;case 30:n.off(t,s(this,this._windowminimized));break;case 31:n.off(t,s(this,this._windowrestored))}},_detach_scene:function(){null!=this.get_scene()&&(this.get_scene().off(3,s(this,this._reset)),this.get_scene().off(6,s(this,this.destroy)),this.get_scene().off(11,s(this,this._keyup)),this.get_scene().off(10,s(this,this._keydown)),this.get_scene().off(12,s(this,this._textinput)),this.get_scene().off(15,s(this,this._mousedown)),this.get_scene().off(16,s(this,this._mouseup)),this.get_scene().off(17,s(this,this._mousemove)),this.get_scene().off(18,s(this,this._mousewheel)),this.get_scene().off(19,s(this,this._touchdown)),this.get_scene().off(20,s(this,this._touchup)),this.get_scene().off(21,s(this,this._touchmove)),this.get_scene().off(14,s(this,this._inputup)),this.get_scene().off(13,s(this,this._inputdown)),this.get_scene().off(23,s(this,this._gamepaddown)),this.get_scene().off(24,s(this,this._gamepadup)),this.get_scene().off(22,s(this,this._gamepadaxis)),this.get_scene().off(25,s(this,this._gamepaddevice)),this.get_scene().off(27,s(this,this._windowmoved)),this.get_scene().off(28,s(this,this._windowresized)),this.get_scene().off(29,s(this,this._windowsized)),this.get_scene().off(30,s(this,this._windowminimized)),this.get_scene().off(31,s(this,this._windowrestored)))},_attach_scene:function(){null!=this.get_scene()&&(this.get_scene().on(3,s(this,this._reset)),this.get_scene().on(6,s(this,this.destroy)))},_keyup:function(t){this.get_active()&&this.inited&&this.started&&(this.onkeyup(t),this.emit(11,t))},_keydown:function(t){this.get_active()&&this.inited&&this.started&&(this.onkeydown(t),this.emit(10,t))},_textinput:function(t){this.get_active()&&this.inited&&this.started&&(this.ontextinput(t),this.emit(12,t))},_mousedown:function(t){this.get_active()&&this.inited&&this.started&&(this.onmousedown(t),this.emit(15,t))},_mouseup:function(t){this.get_active()&&this.inited&&this.started&&(this.onmouseup(t),this.emit(16,t))},_mousewheel:function(t){this.get_active()&&this.inited&&this.started&&(this.onmousewheel(t),this.emit(18,t))},_mousemove:function(t){this.get_active()&&this.inited&&this.started&&(this.onmousemove(t),this.emit(17,t))},_touchdown:function(t){this.get_active()&&this.inited&&this.started&&(this.ontouchdown(t),this.emit(19,t))},_touchup:function(t){this.get_active()&&this.inited&&this.started&&(this.ontouchup(t),this.emit(20,t))},_touchmove:function(t){this.get_active()&&this.inited&&this.started&&(this.ontouchmove(t),this.emit(21,t))},_gamepadaxis:function(t){this.get_active()&&this.inited&&this.started&&(this.ongamepadaxis(t),this.emit(22,t))},_gamepaddown:function(t){this.get_active()&&this.inited&&this.started&&(this.ongamepaddown(t),this.emit(23,t))},_gamepadup:function(t){this.get_active()&&this.inited&&this.started&&(this.ongamepadup(t),this.emit(24,t))},_gamepaddevice:function(t){this.get_active()&&this.inited&&this.started&&(this.ongamepaddevice(t),this.emit(25,t))},_windowmoved:function(t){this.get_active()&&this.inited&&this.started&&(this.onwindowmoved(t),this.emit(27,t))},_windowresized:function(t){this.get_active()&&this.inited&&this.started&&(this.onwindowresized(t),this.emit(28,t))},_windowsized:function(t){this.get_active()&&this.inited&&this.started&&(this.onwindowsized(t),this.emit(29,t))},_windowminimized:function(t){this.get_active()&&this.inited&&this.started&&(this.onwindowminimized(t),this.emit(30,t))},_windowrestored:function(t){this.get_active()&&this.inited&&this.started&&(this.onwindowrestored(t),this.emit(31,t))},_inputdown:function(t){this.get_active()&&this.inited&&this.started&&(this.oninputdown(t.name,t.event),this.emit(13,t))},_inputup:function(t){this.get_active()&&this.inited&&this.started&&(this.oninputup(t.name,t.event),this.emit(14,t))},get_fixed_rate:function(){return this.fixed_rate},set_fixed_rate:function(t){return this.fixed_rate=t,this.started&&(null!=this.fixed_rate_timer&&(this.fixed_rate_timer.stop(),this.fixed_rate_timer=null),0==t||null!=this.get_parent()||this.destroyed||(this.fixed_rate_timer=new Dn(t),this.fixed_rate_timer.run=s(this,this._fixed_update))),this.fixed_rate},_stop_fixed_rate_timer:function(){null!=this.fixed_rate_timer&&(this.fixed_rate_timer.stop(),this.fixed_rate_timer=null)},_set_fixed_rate_timer:function(t){null!=this.fixed_rate_timer&&(this.fixed_rate_timer.stop(),this.fixed_rate_timer=null),0==t||null!=this.get_parent()||this.destroyed||(this.fixed_rate_timer=new Dn(t),this.fixed_rate_timer.run=s(this,this._fixed_update))},get_components:function(){return this._components.components},_add_child:function(t){if(this.children.push(t),null!=t.get_scene()){t.get_scene().remove(t)}},_remove_child:function(t){a.remove(this.children,t)},set_pos_from_transform:function(t){if(this.component_count>0)for(var e=0,i=this._components.components;e<i._keys.length;){var s=i.get(i._keys[e++]);s.entity_pos_change(t)}},set_rotation_from_transform:function(t){if(this.component_count>0)for(var e=0,i=this._components.components;e<i._keys.length;){var s=i.get(i._keys[e++]);s.entity_rotation_change(t)}},set_scale_from_transform:function(t){if(this.component_count>0)for(var e=0,i=this._components.components;e<i._keys.length;){var s=i.get(i._keys[e++]);s.entity_scale_change(t)}},set_origin_from_transform:function(t){if(this.component_count>0)for(var e=0,i=this._components.components;e<i._keys.length;){var s=i.get(i._keys[e++]);s.entity_origin_change(t)}},set_parent_from_transform:function(t){if(this.component_count>0)for(var e=0,i=this._components.components;e<i._keys.length;){var s=i.get(i._keys[e++]);s.entity_parent_change(t)}},set_pos:function(t){return this.get_transform().set_pos(t)},get_pos:function(){return this.get_transform().get_pos()},set_rotation:function(t){return this.get_transform().set_rotation(t)},get_rotation:function(){return this.get_transform().get_rotation()},set_scale:function(t){return this.get_transform().set_scale(t)},get_scale:function(){return this.get_transform().get_scale()},set_origin:function(t){return this.get_transform().set_origin(t)},get_origin:function(){return this.get_transform().get_origin()},set_transform:function(t){return this.transform=t},get_transform:function(){return this.transform},set_parent:function(t){if(t==this)throw new ne(Re.assertion("other != this ( Entity setting itself as parent makes no sense )"));return null!=this.get_parent()&&this.get_parent()._remove_child(this),this.parent=t,null!=this.get_parent()?(this.get_parent()._add_child(this),this.get_transform().set_parent(this.get_parent().get_transform())):this.get_transform().set_parent(null),this.get_parent()},get_parent:function(){return this.parent},set_scene:function(t){return this._detach_scene(),this.scene=t,this._attach_scene(),this.get_scene()},get_scene:function(){return this.scene},set_name:function(t){if(null==t)throw new ne(Re.null_assertion("_name was null"));var e=this.get_scene();if(null!=e){var i=this.get_name();e.entities.remove(i),e.entities.set(t,this),e.entities.exists(t)&&S.trace("    i / scene / "+(""+e.get_name()+" / adding a second entity named "+t+"!\n                This will replace the existing one, possibly leaving the previous one in limbo."),{fileName:"Scene.hx",lineNumber:91,className:"luxe.Scene",methodName:"handle_duplicate_warning"}),e._has_changed=!0}return this.name=t},set_active:function(t){return this.active=t},get_active:function(){return this.active},__class__:de,__properties__:e(ce.prototype.__properties__,{set_origin:"set_origin",get_origin:"get_origin",set_scale:"set_scale",get_scale:"get_scale",set_rotation:"set_rotation",get_rotation:"get_rotation",set_pos:"set_pos",get_pos:"get_pos",set_transform:"set_transform",get_transform:"get_transform",set_active:"set_active",get_active:"get_active",set_scene:"set_scene",get_scene:"get_scene",set_parent:"set_parent",get_parent:"get_parent",set_fixed_rate:"set_fixed_rate",get_fixed_rate:"get_fixed_rate",get_components:"get_components"})});var fe=function(t){this._connected=!1,this.minimum_shake=.1,this.shaking=!1,this._size_factor=new un,this._rotation_radian=new un,this._rotation_cache=new Ys,this.set_size_mode(ue.fit);var e="untitled camera";null!=t?null!=t.name&&(e=t.name):t={no_scene:!1},null==t.view&&(t.view=new qs(t)),this.view=t.view,de.call(this,{name:e,no_scene:t.no_scene}),this._final_pos=this.view.get_pos()};n["luxe.Camera"]=fe,fe.__name__=["luxe","Camera"],fe.__super__=de,fe.prototype=e(de.prototype,{get_viewport:function(){return this.view.get_viewport()},set_viewport:function(t){return this.view.set_viewport(t)},get_center:function(){return this.view.get_center()},set_center:function(t){return this.set_pos(new un(t.x-this.get_viewport().w/2,t.y-this.get_viewport().h/2)),this.view.set_center(t)},get_minimum_zoom:function(){return this.view.minimum_zoom},set_minimum_zoom:function(t){return this.view.minimum_zoom=t},get_zoom:function(){return this.view.zoom},set_zoom:function(t){if(this.view.set_zoom(t),null!=this.get_size()){var e=this.view.get_scale();e.set_x(e.x*(1/this._size_factor.x));var i=this.view.get_scale();i.set_y(i.y*(1/this._size_factor.y))}return this.view.zoom},get_size:function(){return this.size},get_size_mode:function(){return this.size_mode},set_size_mode:function(t){return null!=this.get_size_mode()&&(this.size_mode=t,null!=this.get_size()&&this.set_size(this.get_size())),this.size_mode=t},_onwindowsized:function(t){null!=this.get_size()&&(this.set_viewport(new $s(this.get_viewport().x,this.get_viewport().y,t.event.x,t.event.y)),this.set_size(this.get_size()))},set_size:function(t){if(null==t)return this.set_center(new un(this.get_viewport().w/2,this.get_viewport().h/2)),this.size=t,this._size_factor.set_x(this._size_factor.set_y(1)),this.set_zoom(this.get_zoom()),this._connected=!1,_.off(29,s(this,this._onwindowsized)),this.get_size();this._connected||(_.on(29,s(this,this._onwindowsized)),this._connected=!0);var e=this.get_viewport().w/t.x,i=this.get_viewport().h/t.y,n=Math.max(e,i),r=Math.min(e,i),o=this.get_size_mode();switch(o[1]){case 0:e=i=r;break;case 1:e=i=n;break;case 2:}return this._size_factor.set_x(e),this._size_factor.set_y(i),this.view.get_scale().set_x(1/(this._size_factor.x*this.get_zoom())),this.view.get_scale().set_y(1/(this._size_factor.y*this.get_zoom())),this.set_center(new un(t.x/2,t.y/2)),this.size=new un(t.x,t.y,t.z,t.w)},focus:function(t,e,i){null==e&&(e=.6);var s=this;hs.tween(this.view.get_center(),e,{x:t.x,y:t.y},!0).onComplete(i).ease(rs.get_easeInOut()).onUpdate(function(){s.get_transform().get_pos().set_xy(s.view.get_pos().x,s.view.get_pos().y)})},screen_point_to_world:function(t){return this.view.screen_point_to_world(t)},world_point_to_screen:function(t,e){return this.view.world_point_to_screen(t,e)},set_pos_from_transform:function(t){var e=this.view.get_viewport().w,i=this.view.get_viewport().h,s=e/2,n=i/2,r=t.x,o=t.y;null!=this.bounds&&(r<this.bounds.x&&(r=this.bounds.x),o<this.bounds.y&&(o=this.bounds.y),r+s>this.bounds.w-e&&(r=this.bounds.w-e-s),o+n>this.bounds.h-i&&(o=this.bounds.h-i-n));var a=t.ignore_listeners;t.ignore_listeners=!0,t.set_xy(r,o),t.ignore_listeners=a,de.prototype.set_pos_from_transform.call(this,t),this.update_view_pos=t},set_rotation_from_transform:function(t){de.prototype.set_rotation_from_transform.call(this,t),null!=this.view&&this.view.set_rotation(t)},set_scale_from_transform:function(t){de.prototype.set_scale_from_transform.call(this,t),null!=this.view&&this.view.set_scale(t)},shake:function(t){this.shake_amount=t,this.shaking=!0},update:function(){if(this.shaking){this._final_pos.set_xyz(this.get_transform().get_pos().x,this.get_transform().get_pos().y,this.get_transform().get_pos().z),this.shake_vector=_.utils.geometry.random_point_in_unit_circle();var t=this.shake_vector;t.set_x(t.x*this.shake_amount);var e=this.shake_vector;e.set_y(e.y*this.shake_amount);var i=this.shake_vector;i.set_z(i.z*this.shake_amount),this.shake_amount*=.9,this.shake_amount<=this.minimum_shake&&(this.shake_amount=0,this.shaking=!1),this._final_pos.set_xyz(this._final_pos.x+this.shake_vector.x,this._final_pos.y+this.shake_vector.y,this._final_pos.z+this.shake_vector.z),this.update_view_pos=this._final_pos}null!=this.update_view_pos&&null!=this.view&&(this.view.set_pos(this.update_view_pos.clone()),this.update_view_pos=null)},init:function(){de.prototype.init.call(this)},ondestroy:function(){de.prototype.ondestroy.call(this)},__class__:fe,__properties__:e(de.prototype.__properties__,{set_size_mode:"set_size_mode",get_size_mode:"get_size_mode",set_size:"set_size",get_size:"get_size",set_minimum_zoom:"set_minimum_zoom",get_minimum_zoom:"get_minimum_zoom",set_zoom:"set_zoom",get_zoom:"get_zoom",set_center:"set_center",get_center:"get_center",set_viewport:"set_viewport",get_viewport:"get_viewport"})});var pe=function(t,e){null==e&&(e=""),null==t&&(t=""),this.name="",this.name=t,this.id=""==e?_.utils.uniqueid():e};n["luxe.ID"]=pe,pe.__name__=["luxe","ID"],pe.prototype={__class__:pe};var me=function(t){var e="";null!=t&&null!=t.name&&(e=t.name),pe.call(this,""==e?_.utils.uniqueid():e)};n["luxe.Component"]=me,me.__name__=["luxe","Component"],me.__super__=pe,me.prototype=e(pe.prototype,{init:function(){},update:function(){},onadded:function(){},onremoved:function(){},onfixedupdate:function(){},onreset:function(){},ondestroy:function(){},onkeyup:function(){},onkeydown:function(){},ontextinput:function(){},oninputdown:function(){},oninputup:function(){},onmousedown:function(){},onmouseup:function(){},onmousemove:function(){},onmousewheel:function(){},ontouchdown:function(){},ontouchup:function(){},ontouchmove:function(){},ongamepadup:function(){},ongamepaddown:function(){},ongamepadaxis:function(){},ongamepaddevice:function(){},onwindowmoved:function(){},onwindowresized:function(){},onwindowsized:function(){},onwindowminimized:function(){},onwindowrestored:function(){},add:function(t){return this.get_entity().add(t)},remove:function(t){return this.get_entity().remove(t)},get:function(t,e){return null==e&&(e=!1),this.get_entity().get(t,e)},get_any:function(t,e,i){return null==i&&(i=!0),null==e&&(e=!1),this.get_entity().get_any(t,e,i)},has:function(t){return this.get_entity().has(t)},_detach_entity:function(){null!=this.get_entity()},_attach_entity:function(){null!=this.get_entity()},set_entity:function(t){return this._detach_entity(),this.entity=t,this._attach_entity(),this.get_entity()},get_entity:function(){return this.entity},set_pos:function(t){return this.get_entity().get_transform().set_pos(t)},get_pos:function(){return this.get_entity().get_transform().get_pos()},set_rotation:function(t){return this.get_entity().get_transform().set_rotation(t)},get_rotation:function(){return this.get_entity().get_transform().get_rotation()},set_scale:function(t){return this.get_entity().get_transform().set_scale(t)},get_scale:function(){return this.get_entity().get_transform().get_scale()},set_origin:function(t){return this.get_entity().get_transform().set_origin(t)},get_origin:function(){return this.get_entity().get_transform().get_origin()},set_transform:function(t){return this.get_entity().set_transform(t)},get_transform:function(){return this.get_entity().get_transform()},entity_pos_change:function(){},entity_scale_change:function(){},entity_rotation_change:function(){},entity_origin_change:function(){},entity_parent_change:function(){},__class__:me,__properties__:{set_origin:"set_origin",get_origin:"get_origin",set_scale:"set_scale",get_scale:"get_scale",set_rotation:"set_rotation",get_rotation:"get_rotation",set_pos:"set_pos",get_pos:"get_pos",set_entity:"set_entity",get_entity:"get_entity"}});var ge=function(){this.next_render=0,this.next_tick=0,this.alpha=1,this.cur_frame_start=0,this.current_time=0,this.last_frame_start=0,this.delta_sim=.016666666666666666,this.delta_time=.016666666666666666,this.max_frame_time=.25,this.update_rate=0,this.render_rate=-1,this.fixed_delta=0,this.timescale=1};n["snow.App"]=ge,ge.__name__=["snow","App"],ge.prototype={config:function(t){return t},ready:function(){},update:function(){},ondestroy:function(){},onevent:function(){},onkeydown:function(){},onkeyup:function(){},ontextinput:function(){},onmousedown:function(){},onmouseup:function(){},onmousewheel:function(){},onmousemove:function(){},ontouchdown:function(){},ontouchup:function(){},ontouchmove:function(){},ongamepadaxis:function(){},ongamepaddown:function(){},ongamepadup:function(){},ongamepaddevice:function(){},on_internal_init:function(){this.cur_frame_start=Nn.core.timestamp(),this.last_frame_start=this.cur_frame_start,this.current_time=0,this.delta_time=.016},on_internal_update:function(){if(0!=this.update_rate){if(Nn.core.timestamp()<this.next_tick)return;this.next_tick=Nn.core.timestamp()+this.update_rate}this.cur_frame_start=Nn.core.timestamp(),this.delta_time=this.cur_frame_start-this.last_frame_start,this.last_frame_start=this.cur_frame_start,this.delta_time>this.max_frame_time&&(this.delta_time=this.max_frame_time);var t;t=0==this.fixed_delta?this.delta_time:this.fixed_delta,t*=this.timescale,this.delta_sim=t,this.current_time+=t,this.app.do_internal_update(t)},on_internal_render:function(){0!=this.render_rate&&(this.render_rate<0||this.next_render<Nn.core.timestamp())&&(this.app.render(),this.next_render+=this.render_rate)
},__class__:ge};var ve=function(t,e){this.inited=!1,this.has_shutdown=!1,this.shutting_down=!1,this.headless=!1,this.console_visible=!1,ge.call(this),this.init_config=e,this.game=t,this.game.app=this,this.emitter=new c,_.core=this,_.utils=new Cs(this)};n["luxe.Core"]=ve,ve.__name__=["luxe","Core"],ve.__super__=ge,ve.prototype=e(ge.prototype,{ready:function(){_.version=I.getString("version"),_.build=_.version+I.getString("build"),S.trace("     i / luxe / "+(""+_.build+" / debug:"+v.string(this.app.debug)+" / os:"+this.app.os+" / platform:"+this.app.platform),{fileName:"Core.hx",lineNumber:112,className:"luxe.Core",methodName:"ready"}),this.headless=null==this.app.window,this.init(null)},ondestroy:function(){this.shutting_down=!0,S.trace("     i / luxe / shutting down...",{fileName:"Core.hx",lineNumber:151,className:"luxe.Core",methodName:"ondestroy"}),this.game.ondestroy(),this.emitter.emit(6),null!=this.renderer&&this.renderer.destroy(),this.physics.destroy(),this.input.destroy(),this.audio.destroy(),this.timer.destroy(),this.events.destroy(),this.debug.destroy(),this.emitter=null,this.input=null,this.audio=null,this.events=null,this.timer=null,this.debug=null,_.utils=null,this.has_shutdown=!0,S.trace("     i / luxe / goodbye.",{fileName:"Core.hx",lineNumber:183,className:"luxe.Core",methodName:"ondestroy"})},init:function(t){_.debug=this.debug=new we(this),_.io=this.io=new Ee(this),this.draw=new xe(this),this.timer=new Xe(this),this.events=new be,this.audio=new _e(this),this.input=new Ie(this),this.physics=new Le(this),this.resources=new Oe,_.resources=this.resources,this.headless||(this.app.window.onevent=s(this,this.window_event),this.renderer=new rn(this,t),_.renderer=this.renderer);var e=0,i=0;null!=this.app.window&&(e=this.app.window.width,i=this.app.window.height),this.screen=new Ge(this,e,i),this.debug.init(),this.io.init(),this.timer.init(),this.audio.init(),this.input.init(),this.headless||this.renderer.init(),this.physics.init(),_.audio=this.audio,_.draw=this.draw,_.events=this.events,_.timer=this.timer,_.input=this.input,this.headless||(_.camera=new fe({name:"default camera",view:this.renderer.camera})),_.physics=this.physics,this.scene=new Ue("default scene"),_.scene=this.scene,this.headless||(this.scene.add(_.camera),this.debug.create_debug_console()),this.internal_pre_ready()},internal_pre_ready:function(){if(this.headless)this.internal_ready(null);else{S.trace("     i / luxe / opengl "+rr.versionString(),{fileName:"Core.hx",lineNumber:276,className:"luxe.Core",methodName:"internal_pre_ready"});var t=new Fe({id:"default_parcel",system:this.resources,bytes:this.appconfig.preload.bytes,texts:this.appconfig.preload.texts,jsons:this.appconfig.preload.jsons,textures:this.appconfig.preload.textures,fonts:this.appconfig.preload.fonts,shaders:this.appconfig.preload.shaders,sounds:this.appconfig.preload.sounds,oncomplete:s(this,this.internal_ready),onfailed:function(t){throw S.trace("     i / luxe / config / preload / failed to load",{fileName:"Core.hx",lineNumber:293,className:"luxe.Core",methodName:"internal_pre_ready"}),new ne(gr.error(t))}});t.load()}},internal_ready:function(){null==this.app.window||this.headless||(this.app.window.onrender=s(this,this.render),this.debug.start(ye.update,50),this.debug.start(ye.renderdt,50)),this.game.ready(),this.shutting_down||(this.emitter.emit(2),this.inited=!0,this.physics.reset(),this.app.snow_config.has_loop||this.shutdown())},shutdown:function(){this.shutting_down=!0,Nn.next((vr=this.app,s(vr,vr.shutdown)))},on:function(t,e){this.emitter.on(t,e)},off:function(t,e){return this.emitter.off(t,e)},emit:function(t,e){this.emitter.emit(t,e)},onevent:function(t){this.game.onevent(t)},update:function(t){this.has_shutdown||this.inited&&(this.debug.end(ye.update),this.debug.start(ye.update),this.timer.process(),this.input.process(),this.audio.process(),this.events.process(),this.physics.process(),this.debug.start(ye.updates),this.emitter.emit(4,t),this.debug.end(ye.updates),this.debug.start(ye.game_update),this.game.update(t),this.debug.end(ye.game_update),this.debug.process())},window_event:function(t){if(!this.shutting_down&&this.inited){this.emitter.emit(26,t);var e=t.type;if(null!=e)switch(e){case 5:this.emitter.emit(27,t),this.game.onwindowmoved(t);break;case 6:this.screen.internal_resized(t.event.x,t.event.y),this.renderer.internal_resized(t.event.x,t.event.y),this.emitter.emit(28,t),this.game.onwindowresized(t);break;case 7:this.screen.internal_resized(t.event.x,t.event.y),this.renderer.internal_resized(t.event.x,t.event.y),this.emitter.emit(29,t),this.game.onwindowsized(t);break;case 8:this.emitter.emit(30,t),this.game.onwindowminimized(t);break;case 10:this.emitter.emit(31,t),this.game.onwindowrestored(t)}}},render:function(){this.shutting_down||this.inited&&(this.debug.end(ye.renderdt),this.debug.start(ye.renderdt),this.headless||(this.debug.start(ye.render),this.emitter.emit(7),this.game.onprerender(),this.emitter.emit(8),this.game.onrender(),this.renderer.process(),this.emitter.emit(9),this.game.onpostrender(),this.debug.end(ye.render)))},show_console:function(t){null==t&&(t=!0),this.console_visible=t,this.debug.show_console(this.console_visible)},onkeydown:function(t,e,i,s,n,r){if(this.inited){var o={scancode:e,keycode:t,state:Ae.down,mod:s,repeat:i,timestamp:n,window_id:r};this.shutting_down||(this.input.check_named_keys(o,!0),this.emitter.emit(10,o),this.game.onkeydown(o),e==Kn.grave&&this.show_console(!this.console_visible))}},onkeyup:function(t,e,i,s,n,r){if(this.inited){var o={scancode:e,keycode:t,state:Ae.up,mod:s,repeat:i,timestamp:n,window_id:r};this.shutting_down||(this.input.check_named_keys(o),this.emitter.emit(11,o),this.game.onkeyup(o))}},ontextinput:function(t,e,i,s,n,r){if(this.inited){var o=Ce.unknown;switch(s){case 1:o=Ce.edit;break;case 2:o=Ce.input;break;default:return}var a={text:t,start:e,length:i,type:o,timestamp:n,window_id:r};this.shutting_down||(this.emitter.emit(12,a),this.game.ontextinput(a))}},oninputdown:function(t,e){this.inited&&(this.shutting_down||(this.emitter.emit(13,{name:t,event:e}),this.game.oninputdown(t,e)))},oninputup:function(t,e){this.inited&&(this.shutting_down||(this.emitter.emit(14,{name:t,event:e}),this.game.oninputup(t,e)))},onmousedown:function(t,e,i,s,n){if(this.inited){this.screen.cursor.set_internal(new un(t,e));var r={timestamp:s,window_id:n,state:Ae.down,button:i,x:t,y:e,xrel:t,yrel:e,pos:this.screen.cursor.get_pos()};this.shutting_down||(this.input.check_named_mouse(r,!0),this.emitter.emit(15,r),this.game.onmousedown(r))}},onmouseup:function(t,e,i,s,n){if(this.inited){this.screen.cursor.set_internal(new un(t,e));var r={timestamp:s,window_id:n,state:Ae.up,button:i,x:t,y:e,xrel:t,yrel:e,pos:this.screen.cursor.get_pos()};this.shutting_down||(this.input.check_named_mouse(r),this.emitter.emit(16,r),this.game.onmouseup(r))}},onmousemove:function(t,e,i,s,n,r){if(this.inited){this.screen.cursor.set_internal(new un(t,e));var o={timestamp:n,window_id:r,state:Ae.move,button:0,x:t,y:e,xrel:i,yrel:s,pos:this.screen.cursor.get_pos()};this.shutting_down||(this.emitter.emit(17,o),this.game.onmousemove(o))}},onmousewheel:function(t,e,i,s){if(this.inited){var n={timestamp:i,window_id:s,state:Ae.wheel,button:0,x:t,y:e,xrel:t,yrel:e,pos:this.screen.cursor.get_pos()};this.shutting_down||(this.input.check_named_mouse(n,!1),this.emitter.emit(18,n),this.game.onmousewheel(n))}},ontouchdown:function(t,e,i,s){if(this.inited){this._touch_pos=new un(t,e);var n={state:Ae.down,timestamp:s,touch_id:i,x:t,y:e,dx:t,dy:e,pos:this._touch_pos};this.shutting_down||(this.emitter.emit(19,n),this.game.ontouchdown(n))}},ontouchup:function(t,e,i,s){if(this.inited){this._touch_pos=new un(t,e);var n={state:Ae.up,timestamp:s,touch_id:i,x:t,y:e,dx:t,dy:e,pos:this._touch_pos};this.shutting_down||(this.emitter.emit(20,n),this.game.ontouchup(n))}},ontouchmove:function(t,e,i,s,n,r){if(this.inited){this._touch_pos=new un(t,e);var o={state:Ae.move,timestamp:r,touch_id:n,x:t,y:e,dx:i,dy:s,pos:this._touch_pos};this.shutting_down||(this.emitter.emit(21,o),this.game.ontouchmove(o))}},ongamepadaxis:function(t,e,i,s){if(this.inited){var n={timestamp:s,type:Te.axis,state:Ae.axis,gamepad:t,button:-1,axis:e,value:i};this.shutting_down||(this.emitter.emit(22,n),this.game.ongamepadaxis(n))}},ongamepaddown:function(t,e,i,s){if(this.inited){var n={timestamp:s,type:Te.button,state:Ae.down,gamepad:t,button:e,axis:-1,value:i};this.shutting_down||(this.input.check_named_gamepad_buttons(n,!0),this.emitter.emit(23,n),this.game.ongamepaddown(n))}},ongamepadup:function(t,e,i,s){if(this.inited){var n={timestamp:s,type:Te.button,state:Ae.up,gamepad:t,button:e,axis:-1,value:i};this.shutting_down||(this.input.check_named_gamepad_buttons(n,!1),this.emitter.emit(24,n),this.game.ongamepadup(n))}},ongamepaddevice:function(t,e,i){if(this.inited){var s=Te.unknown;switch(e){case 1:s=Te.device_added;break;case 2:s=Te.device_removed;break;case 3:s=Te.device_remapped}var n={timestamp:i,type:s,state:Ae.none,gamepad:t,button:-1,axis:-1,value:0};this.shutting_down||this.game.ongamepaddevice(n)}},config:function(t){return this.appconfig=t,this.appconfig.window.width=this.init_config.window.width,this.appconfig.window.height=this.init_config.window.height,this.appconfig.window.fullscreen=this.init_config.window.fullscreen,this.appconfig.window.borderless=this.init_config.window.borderless,this.appconfig.window.resizable=this.init_config.window.resizable,this.appconfig.window.title=this.init_config.window.title,this.appconfig.preload={bytes:[],texts:[],jsons:[],textures:[],fonts:[],shaders:[],sounds:[]},this.appconfig=this.game.config(this.appconfig),this.appconfig},runtime_info:function(){return""+_.build+" / debug:"+v.string(this.app.debug)+" / os:"+this.app.os+" / platform:"+this.app.platform},__class__:ve});var ye=function(){};n["luxe.Tag"]=ye,ye.__name__=["luxe","Tag"];var we=function(t){this.last_cursor_grab=!1,this.last_cursor_shown=!0,this.profiling=!1,this.profile_path="profile.txt",this.started=!1,this.last_view_index=0,this.current_view_index=0,this.dt_average_count=0,this.dt_average_span=60,this.dt_average_accum=0,this.dt_average=0,this.visible=!1,this.core=t};n["luxe.Debug"]=we,we.__name__=["luxe","Debug"],we.internal_trace=function(e,i){var s=w.rpad(null==i.lineNumber?"null":""+i.lineNumber," ",4);if(t.log(""+i.fileName+"::"+s+" "+v.string(e)),!we.shut_down)for(var n=we.trace_callbacks.iterator();n.hasNext();){var r=n.next();r(e,i)}},we.prototype={init:function(){we.trace_callbacks=new V,we.views=[],S.trace=we.internal_trace},get_view:function(t){for(var e=0,i=we.views;e<i.length;){var s=i[e];if(++e,s.get_name()==t)return s}return null},start:function(){},end:function(){},remove_trace_listener:function(t){we.trace_callbacks.remove(t)},add_trace_listener:function(t,e){we.trace_callbacks.set(t,e)},create_debug_console:function(){},mouseup:function(t){if(this.visible)for(var e=0,i=we.views;e<i.length;){var s=i[e];++e,s.onmouseup(t)}},mousedown:function(t){if(this.visible)for(var e=0,i=we.views;e<i.length;){var s=i[e];++e,s.onmousedown(t)}},mousewheel:function(t){if(this.visible)for(var e=0,i=we.views;e<i.length;){var s=i[e];++e,s.onmousewheel(t)}},mousemove:function(t){if(this.visible)for(var e=0,i=we.views;e<i.length;){var s=i[e];++e,s.onmousemove(t)}},keyup:function(t){if(this.visible)for(var e=0,i=we.views;e<i.length;){var s=i[e];++e,s.onkeyup(t)}},keydown:function(t){if(this.visible){t.keycode==Wn.key_1&&this.core.console_visible&&this.switch_view();for(var e=0,i=we.views;e<i.length;){var s=i[e];++e,s.onkeydown(t)}}},refresh:function(){null!=this.current_view&&this.current_view.refresh()},switch_view:function(){this.last_view_index=this.current_view_index,this.current_view_index++,this.current_view_index>we.views.length-1&&(this.current_view_index=0),we.views[this.last_view_index].hide(),this.current_view=we.views[this.current_view_index],this.current_view.show()},show_console:function(t){null==t&&(t=!0)},destroy:function(){this.core.off(11,s(this,this.keyup)),this.core.off(10,s(this,this.keydown)),this.core.off(16,s(this,this.mouseup)),this.core.off(15,s(this,this.mousedown)),this.core.off(17,s(this,this.mousemove)),this.core.off(18,s(this,this.mousewheel)),we.shut_down=!0},process:function(){if(this.dt_average_accum+=_.core.delta_time,this.dt_average_count++,this.dt_average_count==this.dt_average_span-1&&(this.dt_average=this.dt_average_accum/this.dt_average_span,this.dt_average_accum=this.dt_average,this.dt_average_count=0),this.visible){this.debug_inspector._title_text.set_text("["+this.current_view.get_name()+"] / "+Math.round(1/this.dt_average)+" / "+Es.fixed(_.core.delta_time,5)+" / "+Es.fixed(this.dt_average,5));for(var t=0,e=we.views;t<e.length;){var i=e[t];++t,i.process()}}},__class__:we};var xe=function(t){this.core=t};n["luxe.Draw"]=xe,xe.__name__=["luxe","Draw"],xe.prototype={line:function(t){if(null==t.p0)throw new ne(Re.null_assertion("options.p0 was null ( draw.line requires p0:Vector, and p1:Vector )"));if(null==t.p1)throw new ne(Re.null_assertion("options.p1 was null ( draw.line requires p0:Vector, and p1:Vector )"));return null==t.id&&(t.id="line.geometry"),t.id,null==t.batcher&&(t.batcher=_.renderer.batcher),t.batcher,new wn(t)},rectangle:function(t){return null==t.id&&(t.id="rectangle.geometry"),t.id,null==t.batcher&&(t.batcher=_.renderer.batcher),t.batcher,new zn(t)},box:function(t){return null==t.id&&(t.id="quad.geometry"),t.id,null==t.batcher&&(t.batcher=_.renderer.batcher),t.batcher,new bn(t)},ring:function(t){return null==t.id&&(t.id="ring.geometry"),t.id,null==t.batcher&&(t.batcher=_.renderer.batcher),t.batcher,new pn(t)},circle:function(t){return null==t.id&&(t.id="circle.geometry"),t.id,null==t.batcher&&(t.batcher=_.renderer.batcher),t.batcher,new fn(t)},arc:function(t){return null==t.id&&(t.id="arc.geometry"),t.id,null==t.batcher&&(t.batcher=_.renderer.batcher),t.batcher,new mn(t)},ngon:function(t){null==t.id&&(t.id="ngon.geometry"),t.id,null==t.batcher&&(t.batcher=_.renderer.batcher),t.batcher;var e=3,i=64,s=!1,n=0,r=0,o=0;null!=t.sides&&(e=t.sides),null!=t.r&&(i=t.r),null!=t.x&&(n=t.x),null!=t.y&&(r=t.y),null!=t.angle&&(o=t.angle),null!=t.solid&&(s=t.solid);var a=new dn(t);a.set_primitive_type(s?6:1);var h=2*Math.PI,l=Math.PI/e,u=h/e,c=.017453292519943278*o;s&&a.add(new Tn(new un(n,r),t.color));var d;d=0==s?e:e+1;for(var f=[],p=0;d>p;){var m=p++,g=i*Math.sin(c+l+m*u),v=i*Math.cos(c+l+m*u),y=new un(n+g,r+v,0);if(a.add(new Tn(y,t.color)),!s&&m>0){{f[m-1]}a.add(new Tn(y,t.color))}f.push(y)}return s||a.add(new Tn(f[0],t.color)),a},poly:function(t){null==t.id&&(t.id="poly.geometry"),t.id,null==t.batcher&&(t.batcher=_.renderer.batcher),t.batcher,null==t.solid&&(t.solid=!0),t.solid,null==t.close&&(t.close=!1),t.close;var e=null,i=null!=t.colors;if(i||(null==t.color&&(t.color=new ai),e=t.color),t.solid){null==t.primitive_type&&(t.primitive_type=6),t.primitive_type;for(var s=new dn(t),n=0,r=(t.points.length,0),o=t.points;r<o.length;){var a=o[r];++r;var h;h=i?t.colors[n]:e,s.add(new Tn(a,h)),++n}return s}null==t.primitive_type&&(t.primitive_type=1),t.primitive_type;for(var l=new dn(t),u=0,c=t.points.length,d=0,f=t.points;d<f.length;){var p=f[d];++d;var m;if(m=i?t.colors[u]:e,l.add(new Tn(p,m)),c-2>u){var g;g=i?t.colors[u+1]:e,l.add(new Tn(t.points[u+1],g))}++u}if(t.close){var v,y=t.points.length-1;v=i?t.colors[0]:e;var w;w=i?t.colors[y]:e,l.add(new Tn(t.points[y],v)),l.add(new Tn(t.points[0],w))}return l},texture:function(t){null==t.id&&(t.id="texture.geometry"),t.id,null==t.batcher&&(t.batcher=_.renderer.batcher),t.batcher;var e=0,i=0,s=0,n=0,r=64,o=64;null!=t.texture&&(r=t.texture.width,o=t.texture.height,null==t.size&&(s=r,n=o)),null!=t.pos&&(e=t.pos.x,i=t.pos.y),null!=t.size&&(s=t.size.x,n=t.size.y),null==t.x&&(t.x=e),t.x,null==t.y&&(t.y=i),t.y,null==t.w&&(t.w=s),t.w,null==t.h&&(t.h=n),t.h;var a=new bn(t),h=0,l=0,u=r,c=o;return null!=t.uv&&(h=t.uv.x,l=t.uv.y,u=t.uv.w,c=t.uv.h),a.uv(new $s(h,l,u,c)),a},text:function(t){return null==t.batcher&&(t.batcher=_.renderer.batcher),t.batcher,new En(t)},plane:function(t){return null==t.id&&(t.id="plane.geometry"),t.id,null==t.batcher&&(t.batcher=_.renderer.batcher),t.batcher,new xn(t)},__class__:xe};var be=function(){this.event_connections=new V,this.event_slots=new V,this.event_filters=new V,this.event_queue=new V,this.event_schedules=new V};n["luxe.Events"]=be,be.__name__=["luxe","Events"],be.prototype={destroy:function(){this.clear()},clear:function(){for(var t=this.event_schedules.iterator();t.hasNext();){var e=t.next();e.stop(),e=null}for(var i=this.event_connections.keys();i.hasNext();){var s=i.next();this.event_connections.remove(s)}for(var n=this.event_filters.keys();n.hasNext();){var r=n.next();this.event_filters.remove(r)}for(var o=this.event_slots.keys();o.hasNext();){var a=o.next();this.event_slots.remove(a)}for(var h=this.event_queue.keys();h.hasNext();){var l=h.next();this.event_queue.remove(l)}},does_filter_event:function(t,e){var i=new o("\\*","gi"),s=i.replace(t,".*?"),n=new o(s,"gi");return n.match(e)},listen:function(t,e){var i=_.utils.uniqueid(),s=new ke(i,t,e);this.event_connections.set(i,s);var n=new o("\\*","gi");return n.match(t)?(this.event_filters.exists(t)||this.event_filters.set(t,[]),this.event_filters.get(t).push(s)):(this.event_slots.exists(t)||this.event_slots.set(t,[]),this.event_slots.get(t).push(s)),i},unlisten:function(t){if(this.event_connections.exists(t)){var e=this.event_connections.get(t),i=this.event_slots.get(e.event_name);if(null!=i)return a.remove(i,e),!0;var s=this.event_filters.get(e.event_name);return null!=s?(a.remove(s,e),!0):!1}return!1},queue:function(t,e){var i=_.utils.uniqueid(),s=new ze(i,t,e);return this.event_queue.set(i,s),i},dequeue:function(t){if(this.event_queue.exists(t)){var e=this.event_queue.get(t);return e=null,this.event_queue.remove(t),!0}return!1},process:function(){for(var t=this.event_queue.iterator();t.hasNext();){var e=t.next();this.fire(e.name,e.properties)}this.event_queue.keys().hasNext()&&(this.event_queue=null,this.event_queue=new V)},fire:function(t,e,i){null==i&&(i=!1);for(var s=!1,n=this.event_filters.iterator();n.hasNext();){var r=n.next();if(r.length>0){var o=r[0].event_name;if(this.does_filter_event(o,t)){i&&(e=this.tag_properties(e,t,r.length));for(var a=0;a<r.length;){var h=r[a];++a,h.listener(e)}s=!0}}}if(this.event_slots.exists(t)){var l=this.event_slots.get(t);i&&(e=this.tag_properties(e,t,l.length));for(var _=0;_<l.length;){var u=l[_];++_,u.listener(e)}s=!0}return s},schedule:function(t,e,i){var n=_.utils.uniqueid(),r=_.timer.schedule(t,function(t,e,i){return function(){return t(e,i)}}(s(this,this.fire),e,i));return this.event_schedules.set(n,r),n},unschedule:function(t){if(this.event_schedules.exists(t)){var e=this.event_schedules.get(t);return e.stop(),this.event_schedules.remove(t),!0}return!1},tag_properties:function(t,e,i){return null==t&&(t={}),t._event_name_=e,t._event_connection_count_=i,t},__class__:be};var ke=function(t,e,i){this.id=t,this.listener=i,this.event_name=e};n["luxe._Events.EventConnection"]=ke,ke.__name__=["luxe","_Events","EventConnection"],ke.prototype={__class__:ke};var ze=function(t,e,i){this.id=t,this.name=e,this.properties=i};n["luxe._Events.EventObject"]=ze,ze.__name__=["luxe","_Events","EventObject"],ze.prototype={__class__:ze};var Ee=function(t){this.core=t};n["luxe.IO"]=Ee,Ee.__name__=["luxe","IO"],Ee.prototype={url_open:function(t){this.core.app.io.module.url_open(t)},string_save:function(t,e,i){return null==i&&(i=0),this.core.app.io.string_save(t,e,i)},string_load:function(t,e){return null==e&&(e=0),this.core.app.io.string_load(t,e)},string_destroy:function(t){return null==t&&(t=0),this.core.app.io.string_destroy(t)},init:function(){},__class__:Ee};var Ae=n["luxe.InteractState"]={__ename__:["luxe","InteractState"],__constructs__:["unknown","none","down","up","move","wheel","axis"]};Ae.unknown=["unknown",0],Ae.unknown.toString=r,Ae.unknown.__enum__=Ae,Ae.none=["none",1],Ae.none.toString=r,Ae.none.__enum__=Ae,Ae.down=["down",2],Ae.down.toString=r,Ae.down.__enum__=Ae,Ae.up=["up",3],Ae.up.toString=r,Ae.up.__enum__=Ae,Ae.move=["move",4],Ae.move.toString=r,Ae.move.__enum__=Ae,Ae.wheel=["wheel",5],Ae.wheel.toString=r,Ae.wheel.__enum__=Ae,Ae.axis=["axis",6],Ae.axis.toString=r,Ae.axis.__enum__=Ae;var Ce=n["luxe.TextEventType"]={__ename__:["luxe","TextEventType"],__constructs__:["unknown","edit","input"]};Ce.unknown=["unknown",0],Ce.unknown.toString=r,Ce.unknown.__enum__=Ce,Ce.edit=["edit",1],Ce.edit.toString=r,Ce.edit.__enum__=Ce,Ce.input=["input",2],Ce.input.toString=r,Ce.input.__enum__=Ce;var Te=n["luxe.GamepadEventType"]={__ename__:["luxe","GamepadEventType"],__constructs__:["unknown","axis","button","device_added","device_removed","device_remapped"]};Te.unknown=["unknown",0],Te.unknown.toString=r,Te.unknown.__enum__=Te,Te.axis=["axis",1],Te.axis.toString=r,Te.axis.__enum__=Te,Te.button=["button",2],Te.button.toString=r,Te.button.__enum__=Te,Te.device_added=["device_added",3],Te.device_added.toString=r,Te.device_added.__enum__=Te,Te.device_removed=["device_removed",4],Te.device_removed.toString=r,Te.device_removed.__enum__=Te,Te.device_remapped=["device_remapped",5],Te.device_remapped.toString=r,Te.device_remapped.__enum__=Te;var Se=n["luxe.InputType"]={__ename__:["luxe","InputType"],__constructs__:["mouse","touch","keys","gamepad"]};Se.mouse=["mouse",0],Se.mouse.toString=r,Se.mouse.__enum__=Se,Se.touch=["touch",1],Se.touch.toString=r,Se.touch.__enum__=Se,Se.keys=["keys",2],Se.keys.toString=r,Se.keys.__enum__=Se,Se.gamepad=["gamepad",3],Se.gamepad.toString=r,Se.gamepad.__enum__=Se;var Ie=function(t){this.core=t};n["luxe.Input"]=Ie,Ie.__name__=["luxe","Input"],Ie.prototype={init:function(){this.key_bindings=new V,this.mouse_bindings=new V,this.gamepad_bindings=new V,this._named_input_down=new V,this._named_input_pressed=new V,this._named_input_released=new V},destroy:function(){},process:function(){for(var t=this._named_input_pressed.keys();t.hasNext();){var e=t.next();this._named_input_pressed.get(e)?this._named_input_pressed.remove(e):this._named_input_pressed.set(e,!0)}for(var i=this._named_input_released.keys();i.hasNext();){var s=i.next();this._named_input_released.get(s)?this._named_input_released.remove(s):this._named_input_released.set(s,!0)}},inputpressed:function(t){return this._named_input_pressed.exists(t)},inputreleased:function(t){return this._named_input_released.exists(t)},inputdown:function(t){return this._named_input_down.exists(t)},keypressed:function(t){return this.core.app.input.keypressed(t)},keyreleased:function(t){return this.core.app.input.keyreleased(t)},keydown:function(t){return this.core.app.input.keydown(t)},scanpressed:function(t){return this.core.app.input.scanpressed(t)},scanreleased:function(t){return this.core.app.input.scanreleased(t)},scandown:function(t){return this.core.app.input.scandown(t)},mousepressed:function(t){return this.core.app.input.mousepressed(t)},mousereleased:function(t){return this.core.app.input.mousereleased(t)},mousedown:function(t){return this.core.app.input.mousedown(t)},gamepadpressed:function(t,e){return this.core.app.input.gamepadpressed(t,e)},gamepadreleased:function(t,e){return this.core.app.input.gamepadreleased(t,e)},gamepaddown:function(t,e){return this.core.app.input.gamepaddown(t,e)},gamepadaxis:function(t,e){return this.core.app.input.gamepadaxis(t,e)},bind_key:function(t,e){if(!this.key_bindings.exists(t)){var i=new U;this.key_bindings.set(t,i)}var s=this.key_bindings.get(t);s.h[e]=!0},bind_mouse:function(t,e){if(!this.mouse_bindings.exists(t)){var i=new U;this.mouse_bindings.set(t,i)}var s=this.mouse_bindings.get(t);s.h[e]=!0},bind_gamepad:function(t,e,i){if(!this.gamepad_bindings.exists(t)){var s=new U;this.gamepad_bindings.set(t,s)}var n=this.gamepad_bindings.get(t);n.h[e]=i},check_named_keys:function(t,e){null==e&&(e=!1);for(var i=[],s=this.key_bindings.keys();s.hasNext();){var n=s.next(),r=this.key_bindings.get(n),o=e&&t.repeat;r.h.hasOwnProperty(t.keycode)&&!o&&(h.has(i,n)||i.push(n))}for(var a=0;a<i.length;){var l=i[a];++a,e?(this._named_input_pressed.set(l,!1),this._named_input_down.set(l,!0),this.core.oninputdown(l,{name:l,type:Se.keys,state:Ae.down,key_event:t})):(this._named_input_released.set(l,!1),this._named_input_down.remove(l),this.core.oninputup(l,{name:l,type:Se.keys,state:Ae.up,key_event:t}))}},check_named_mouse:function(t,e){null==e&&(e=!1);for(var i=[],s=this.mouse_bindings.keys();s.hasNext();){var n=s.next(),r=this.mouse_bindings.get(n);r.h.hasOwnProperty(t.button)&&(h.has(i,n)||i.push(n))}for(var o=0;o<i.length;){var a=i[o];++o,e?(this._named_input_pressed.set(a,!1),this._named_input_down.set(a,!0),this.core.oninputdown(a,{name:a,type:Se.mouse,state:Ae.down,mouse_event:t})):(this._named_input_released.set(a,!1),this._named_input_down.remove(a),this.core.oninputup(a,{name:a,type:Se.mouse,state:Ae.up,mouse_event:t}))}},check_named_gamepad_buttons:function(t,e){null==e&&(e=!1);for(var i=[],s=this.gamepad_bindings.keys();s.hasNext();){var n=s.next(),r=this.gamepad_bindings.get(n);if(r.h.hasOwnProperty(t.button)){var o=r.h[t.button],a=null==o||o==t.gamepad;!h.has(i,n)&&a&&i.push(n)}}for(var l=0;l<i.length;){var _=i[l];++l,e?(this._named_input_pressed.set(_,!1),this._named_input_down.set(_,!0),this.core.oninputdown(_,{name:_,type:Se.gamepad,state:Ae.down,gamepad_event:t})):(this._named_input_released.set(_,!1),this._named_input_down.remove(_),this.core.oninputup(_,{name:_,type:Se.gamepad,state:Ae.up,gamepad_event:t}))}},__class__:Ie};var Ne=n["luxe._Log.LogError"]={__ename__:["luxe","_Log","LogError"],__constructs__:["RequireString"]};Ne.RequireString=function(t){var e=["RequireString",0,t];return e.__enum__=Ne,e.toString=r,e};var Me=function(){};n["luxe.Log"]=Me,Me.__name__=["luxe","Log"],Me._get_spacing=function(t){var e="",i=t.length+4,s=Me._log_width-i;if(s>0)for(var n=0;s>n;){{n++}e+=" "}return e};var Re=n["luxe.DebugError"]={__ename__:["luxe","DebugError"],__constructs__:["assertion","null_assertion"]};Re.assertion=function(t){var e=["assertion",0,t];return e.__enum__=Re,e.toString=r,e},Re.null_assertion=function(t){var e=["null_assertion",1,t];return e.__enum__=Re,e.toString=r,e};var Be=function(t){if(this.ignore_texture_on_geometry_change=!1,this._creating_geometry=!1,this._has_custom_origin=!1,this.radians=0,this.group=0,this.depth=0,this.visible=!0,this.locked=!1,null==t)throw new ne(Re.null_assertion("_options was null ( Visual requires non-null options )"));this._rotation_euler=new un,this._rotation_quat=new Ys,de.call(this,t),this.set_color(new ai),this.set_size(new un),null!=this.options.texture&&this.set_texture(this.options.texture),null!=this.options.shader&&this.set_shader(this.options.shader),null!=this.options.color&&this.set_color(this.options.color),null!=this.options.depth&&this.set_depth(this.options.depth),null!=this.options.group&&this.set_group(this.options.group),null!=this.options.visible&&this.set_visible(this.options.visible),null!=this.options.size?(this.set_size(this.options.size),this._create_geometry()):null!=this.texture?(this.set_size(new un(this.texture.width,this.texture.height)),this._create_geometry()):(this.set_size(new un(64,64)),this._create_geometry())};n["luxe.Visual"]=Be,Be.__name__=["luxe","Visual"],Be.__super__=de,Be.prototype=e(de.prototype,{_create_geometry:function(){if(null==this.options.geometry){if(null==this.options.no_geometry||0==this.options.no_geometry){this._creating_geometry=!0;var t=null;(null==this.options.no_batcher_add||0==this.options.no_batcher_add)&&(t=null!=this.options.batcher?this.options.batcher:_.renderer.batcher),this.set_geometry(new bn({id:this.get_name()+".visual",x:0,y:0,w:this.size.x,h:this.size.y,scale:new un(1,1,1),texture:this.texture,color:this.color,shader:this.shader,batcher:t,depth:null==this.options.depth?0:this.options.depth,group:null==this.options.group?0:this.options.group,visible:null==this.options.visible?this.visible:this.options.visible})),this._creating_geometry=!1,this.on_geometry_created()}}else this.set_geometry(this.options.geometry);null!=this.geometry&&(this.geometry.id=this.get_name()+".visual",this.geometry.transform.id=this.get_name()+".visual.transform"),null!=this.options.origin&&(this._has_custom_origin=!0,this.set_origin(this.options.origin)),null!=this.options.rotation_z&&this.set_rotation_z(this.options.rotation_z)},ondestroy:function(){null!=this.geometry&&this.geometry.added&&this.geometry.drop(!0),this.set_geometry(null),this.set_texture(null)},on_geometry_created:function(){},set_visible:function(t){return this.visible=t,null!=this.geometry&&this.geometry.set_visible(this.visible),this.visible},set_depth:function(t){return null!=this.geometry&&this.geometry.set_depth(t),this.depth=t},set_group:function(t){return null!=this.geometry&&this.geometry.set_group(t),this.group=t},set_color:function(t){return null!=this.color&&null!=this.geometry&&this.geometry.set_color(t),this.color=t},set_texture:function(t){return null!=this.geometry&&this.geometry.state.texture!=t&&this.geometry.set_texture(t),this.texture=t},set_shader:function(t){return null!=this.geometry&&this.geometry.state.shader!=t&&this.geometry.set_shader(t),this.shader=t},set_geometry:function(t){return this.geometry==t?this.geometry:(null!=this.geometry&&this.geometry.drop(),this.geometry=t,null!=this.geometry&&(this.geometry.transform.set_parent(this.get_transform()),0==this._creating_geometry&&(this.geometry.set_color(this.color),this.geometry.set_group(this.group),this.geometry.set_depth(this.depth),this.geometry.set_visible(this.visible),!this.ignore_texture_on_geometry_change)),this.geometry)},set_parent_from_transform:function(t){de.prototype.set_parent_from_transform.call(this,t),null!=this.geometry&&this.geometry.transform.set_parent(this.get_transform())},set_rotation_from_transform:function(t){de.prototype.set_rotation_from_transform.call(this,t),this._rotation_euler.setEulerFromQuaternion(t,null),this._rotation_quat.copy(t)},set_size:function(t){return this.size=t,null!=this.size&&un.Listen(this.size,s(this,this._size_change)),this.size},get_rotation_z:function(){return Es.degrees(this.get_radians())},set_rotation_z:function(t){return this.set_radians(.017453292519943278*t),t},set_radians:function(t){return this._rotation_euler.set_z(t),this._rotation_quat.setFromEuler(this._rotation_euler),this.set_rotation(this._rotation_quat.clone()),this.radians=t},get_radians:function(){return this.radians},set_locked:function(t){return null!=this.geometry&&this.geometry.set_locked(t),this.locked=t},set_clip_rect:function(t){return null!=this.geometry&&this.geometry.set_clip_rect(t),this.clip_rect=t},_size_change:function(){this.set_size(this.size)},init:function(){de.prototype.init.call(this)},__class__:Be,__properties__:e(de.prototype.__properties__,{set_rotation_z:"set_rotation_z",get_rotation_z:"get_rotation_z",set_radians:"set_radians",get_radians:"get_radians",set_clip_rect:"set_clip_rect",set_group:"set_group",set_depth:"set_depth",set_visible:"set_visible",set_color:"set_color",set_shader:"set_shader",set_texture:"set_texture",set_locked:"set_locked",set_geometry:"set_geometry",set_size:"set_size"})});var Pe=function(t){this.added=!1,this.midheight=0,this.midwidth=0,this.is_set=!1,this.source_h=0,this.source_w=0,this.source_y=0,this.source_x=0,this.height=0,this.bottom=32,this.width=0,this.right=32,this.left=32,this.top=32,this.slices=[],null==t?t={no_geometry:!0}:t.no_geometry=!0,this.nineslice_options=t,this._batcher=null!=t.batcher?t.batcher:_.renderer.batcher,Be.call(this,t),null!=t.top&&(this.top=t.top),null!=t.left&&(this.left=t.left),null!=t.right&&(this.right=t.right),null!=t.bottom&&(this.bottom=t.bottom),null!=t.source_x&&(this.source_x=t.source_x),null!=t.source_y&&(this.source_y=t.source_y),this.source_w=null!=t.source_w?t.source_w:this.texture.width,this.source_h=null!=t.source_h?t.source_h:this.texture.height,this.set_geometry(null)};n["luxe.NineSlice"]=Pe,Pe.__name__=["luxe","NineSlice"],Pe.__super__=Be,Pe.prototype=e(Be.prototype,{lock:function(){this.is_set&&null!=this._geometry&&this._geometry.set_locked(!0)
},dirty:function(){this.is_set&&null!=this._geometry&&this._geometry.set_dirty(!0)},update_size:function(t,e){this.width=t,this.height=e,this.midwidth=Math.abs(this.width-this.left-this.right),this.midheight=Math.abs(this.height-this.top-this.bottom),this.slices[0].source_width=this.left,this.slices[0].source_height=this.top,this.slices[0].source_x=this.source_x,this.slices[0].source_y=this.source_y,this.slices[0].pos.set_xy(0,0),this.slices[0].width=this.left,this.slices[0].height=this.top,this.slices[1].source_width=this.source_w-this.left-this.right,this.slices[1].source_height=this.top,this.slices[1].source_x=this.source_x+this.left,this.slices[1].source_y=this.source_y,this.slices[1].pos.set_xy(this.left,0),this.slices[1].width=this.width-this.left-this.right,this.slices[1].height=this.top,this.slices[2].source_width=this.right,this.slices[2].source_height=this.top,this.slices[2].source_x=this.source_x+(this.source_w-this.right),this.slices[2].source_y=this.source_y,this.slices[2].pos.set_xy(this.left+this.midwidth,0),this.slices[2].width=this.right,this.slices[2].height=this.top,this.slices[3].source_width=this.left,this.slices[3].source_height=this.source_h-this.top-this.bottom,this.slices[3].source_x=this.source_x,this.slices[3].source_y=this.source_y+this.top,this.slices[3].pos.set_xy(0,this.top),this.slices[3].width=this.left,this.slices[3].height=this.height-this.top-this.bottom,this.slices[4].source_width=this.source_w-this.left-this.right,this.slices[4].source_height=this.source_h-this.top-this.bottom,this.slices[4].source_x=this.source_x+this.left,this.slices[4].source_y=this.source_y+this.top,this.slices[4].pos.set_xy(this.left,this.top),this.slices[4].width=this.width-this.left-this.right,this.slices[4].height=this.height-this.top-this.bottom,this.slices[5].source_width=this.right,this.slices[5].source_height=this.source_h-this.top-this.bottom,this.slices[5].source_x=this.source_x+(this.source_w-this.right),this.slices[5].source_y=this.source_y+this.top,this.slices[5].pos.set_xy(this.left+this.midwidth,this.top),this.slices[5].width=this.right,this.slices[5].height=this.height-this.top-this.bottom,this.slices[6].source_width=this.left,this.slices[6].source_height=this.bottom,this.slices[6].source_x=this.source_x,this.slices[6].source_y=this.source_y+(this.source_h-this.bottom),this.slices[6].pos.set_xy(0,this.top+this.midheight),this.slices[6].width=this.left,this.slices[6].height=this.bottom,this.slices[7].source_width=this.source_w-this.left-this.right,this.slices[7].source_height=this.bottom,this.slices[7].source_x=this.source_x+this.left,this.slices[7].source_y=this.source_y+(this.source_h-this.bottom),this.slices[7].pos.set_xy(this.left,this.top+this.midheight),this.slices[7].width=this.width-this.left-this.right,this.slices[7].height=this.bottom,this.slices[8].source_width=this.right,this.slices[8].source_height=this.bottom,this.slices[8].source_x=this.source_x+(this.source_w-this.right),this.slices[8].source_y=this.source_y+(this.source_h-this.bottom),this.slices[8].pos.set_xy(this.left+this.midwidth,this.top+this.midheight),this.slices[8].width=this.right,this.slices[8].height=this.bottom},set:function(t,e){this.added&&(this._geometry.drop(),this.added=!1),this.slices.splice(0,this.slices.length),this.width=t,this.height=e,this.midwidth=Math.abs(this.width-this.left-this.right),this.midheight=Math.abs(this.height-this.top-this.bottom),this.slices.push({source_width:this.left,source_height:this.top,source_x:this.source_x,source_y:this.source_y,pos:new un(0,0),width:this.left,height:this.top,geometry_id:0}),this.slices.push({source_width:this.source_w-this.left-this.right,source_height:this.top,source_x:this.source_x+this.left,source_y:this.source_y,pos:new un(this.left,0),width:this.width-this.left-this.right,height:this.top,geometry_id:0}),this.slices.push({source_width:this.right,source_height:this.top,source_x:this.source_x+(this.source_w-this.right),source_y:this.source_y,pos:new un(this.left+this.midwidth,0),width:this.right,height:this.top,geometry_id:0}),this.slices.push({source_width:this.left,source_height:this.source_h-this.top-this.bottom,source_x:this.source_x,source_y:this.source_y+this.top,pos:new un(0,this.top),width:this.left,height:this.height-this.top-this.bottom,geometry_id:0}),this.slices.push({source_width:this.source_w-this.left-this.right,source_height:this.source_h-this.top-this.bottom,source_x:this.source_x+this.left,source_y:this.source_y+this.top,pos:new un(this.left,this.top),width:this.width-this.left-this.right,height:this.height-this.top-this.bottom,geometry_id:0}),this.slices.push({source_width:this.right,source_height:this.source_h-this.top-this.bottom,source_x:this.source_x+(this.source_w-this.right),source_y:this.source_y+this.top,pos:new un(this.left+this.midwidth,this.top),width:this.right,height:this.height-this.top-this.bottom,geometry_id:0}),this.slices.push({source_width:this.left,source_height:this.bottom,source_x:this.source_x,source_y:this.source_y+(this.source_h-this.bottom),pos:new un(0,this.top+this.midheight),width:this.left,height:this.bottom,geometry_id:0}),this.slices.push({source_width:this.source_w-this.left-this.right,source_height:this.bottom,source_x:this.source_x+this.left,source_y:this.source_y+(this.source_h-this.bottom),pos:new un(this.left,this.top+this.midheight),width:this.width-this.left-this.right,height:this.bottom,geometry_id:0}),this.slices.push({source_width:this.right,source_height:this.bottom,source_x:this.source_x+(this.source_w-this.right),source_y:this.source_y+(this.source_h-this.bottom),pos:new un(this.left+this.midwidth,this.top+this.midheight),width:this.right,height:this.bottom,geometry_id:0}),this.is_set=!0},set_size:function(t){if(!this.is_set)return t;this.update_size(t.x,t.y);for(var e=0,i=this.slices;e<i.length;){var s=i[e];++e,null!=this._geometry&&this._geometry.quad_resize(s.geometry_id,new $s(s.pos.x,s.pos.y,s.width,s.height))}return t},_create:function(t,e,i,s){null==s&&(s=!1),(!this.is_set||s)&&this.set(e,i);var n=new ai;this._geometry=new kn({texture:this.texture,color:n,depth:this.nineslice_options.depth,group:this.nineslice_options.group,visible:this.nineslice_options.visible,batcher:this._batcher});for(var r=0,o=this.slices;r<o.length;){var a=o[r];++r,a.geometry_id=this._geometry.quad_add({x:a.pos.x,y:a.pos.y,w:a.width,h:a.height,color:this.nineslice_options.color,uv:new $s(a.source_x,a.source_y,a.source_width,a.source_height)})}this._geometry.id="NineSlice"+this._geometry.id,this.set_geometry(this._geometry),this.set_pos(t),this.added=!0,this.is_set=!0},create:function(t,e,i,s){null==s&&(s=!1),null!=this.texture&&this._create(t,e,i,s)},init:function(){Be.prototype.init.call(this)},ondestroy:function(){Be.prototype.ondestroy.call(this)},__class__:Pe});var Fe=function(t){this.load_start_delay=.2,this.load_time_spacing=.05,this.start_load=0,this.time_to_load=0,null==t&&(t={}),null==t.system&&(t.system=_.resources),t.system,null==t.id&&(t.id=_.utils.uniqueid()),t.id,null!=t.oncomplete&&(this.oncomplete=t.oncomplete),null!=t.onprogress&&(this.onprogress=t.onprogress),null!=t.onfailed&&(this.onfailed=t.onfailed),null!=t.load_time_spacing&&(this.load_time_spacing=t.load_time_spacing),null!=t.load_start_delay&&(this.load_start_delay=t.load_start_delay),this.state=0,this.loaded=[],this.emitter=new c,this.system=t.system,this.id=t.id,this.list=this.empty_list(),null!=t.bytes&&(this.list.bytes=t.bytes),null!=t.texts&&(this.list.texts=t.texts),null!=t.jsons&&(this.list.jsons=t.jsons),null!=t.textures&&(this.list.textures=t.textures),null!=t.fonts&&(this.list.fonts=t.fonts),null!=t.shaders&&(this.list.shaders=t.shaders),null!=t.sounds&&(this.list.sounds=t.sounds),this.system.track(this)};n["luxe.Parcel"]=Fe,Fe.__name__=["luxe","Parcel"],Fe.prototype={on:function(t,e){this.emitter.on(t,e)},off:function(t,e){this.emitter.off(t,e)},emit:function(t,e){this.emitter.emit(t,e)},is_loaded:function(t){return-1!=a.indexOf(this.loaded,t,0)},load:function(t){var e=this;this.state=1,_.timer.schedule(this.load_start_delay,function(){if(e.start_load=Nn.core.timestamp(),null==t&&(t=e.id),e.list.bytes.length+e.list.texts.length+e.list.jsons.length+e.list.textures.length+e.list.shaders.length+e.list.fonts.length+e.list.sounds.length==0)return e.state=2,e.time_to_load=Nn.core.timestamp()-e.start_load,e.emitter.emit(2,e),void(null!=e.oncomplete&&e.oncomplete(e));for(var i=0,s=0,n=e.list.bytes;s<n.length;){var r=[n[s]];++s,-1==a.indexOf(e.loaded,r[0].id,0)?(e.loaded.push(r[0].id),_.timer.schedule(e.load_time_spacing,function(s){return function(){var n=s[0].id,r=e.system.load_bytes(s[0].id);r.then(function(){return function(s){e.one_loaded(n,t,s,++i,e.list.bytes.length+e.list.texts.length+e.list.jsons.length+e.list.textures.length+e.list.shaders.length+e.list.fonts.length+e.list.sounds.length)}}(),function(){return function(s){e.one_failed(n,t,s,++i,e.list.bytes.length+e.list.texts.length+e.list.jsons.length+e.list.textures.length+e.list.shaders.length+e.list.fonts.length+e.list.sounds.length)}}())}}(r))):(S.trace("   i / parcel / "+(""+e.id+" / already had "+r[0].id+" loaded, skipped"),{fileName:"Parcel.hx",lineNumber:195,className:"luxe.Parcel",methodName:"load"}),e.one_loaded(r[0].id,t,e.system.cache.get(r[0].id),++i,e.list.bytes.length+e.list.texts.length+e.list.jsons.length+e.list.textures.length+e.list.shaders.length+e.list.fonts.length+e.list.sounds.length))}for(var o=0,h=e.list.texts;o<h.length;){var l=[h[o]];++o,-1==a.indexOf(e.loaded,l[0].id,0)?(e.loaded.push(l[0].id),_.timer.schedule(e.load_time_spacing*i,function(s){return function(){var n=s[0].id,r=e.system.load_text(s[0].id);r.then(function(){return function(s){e.one_loaded(n,t,s,++i,e.list.bytes.length+e.list.texts.length+e.list.jsons.length+e.list.textures.length+e.list.shaders.length+e.list.fonts.length+e.list.sounds.length)}}(),function(){return function(s){e.one_failed(n,t,s,++i,e.list.bytes.length+e.list.texts.length+e.list.jsons.length+e.list.textures.length+e.list.shaders.length+e.list.fonts.length+e.list.sounds.length)}}())}}(l))):(S.trace("   i / parcel / "+(""+e.id+" / already had "+l[0].id+" loaded, skipped"),{fileName:"Parcel.hx",lineNumber:215,className:"luxe.Parcel",methodName:"load"}),e.one_loaded(l[0].id,t,e.system.cache.get(l[0].id),++i,e.list.bytes.length+e.list.texts.length+e.list.jsons.length+e.list.textures.length+e.list.shaders.length+e.list.fonts.length+e.list.sounds.length))}for(var u=0,c=e.list.jsons;u<c.length;){var d=[c[u]];++u,-1==a.indexOf(e.loaded,d[0].id,0)?(e.loaded.push(d[0].id),_.timer.schedule(e.load_time_spacing*i,function(s){return function(){var n=s[0].id,r=e.system.load_json(s[0].id);r.then(function(){return function(s){e.one_loaded(n,t,s,++i,e.list.bytes.length+e.list.texts.length+e.list.jsons.length+e.list.textures.length+e.list.shaders.length+e.list.fonts.length+e.list.sounds.length)}}(),function(){return function(s){e.one_failed(n,t,s,++i,e.list.bytes.length+e.list.texts.length+e.list.jsons.length+e.list.textures.length+e.list.shaders.length+e.list.fonts.length+e.list.sounds.length)}}())}}(d))):(S.trace("   i / parcel / "+(""+e.id+" / already had "+d[0].id+" loaded, skipped"),{fileName:"Parcel.hx",lineNumber:235,className:"luxe.Parcel",methodName:"load"}),e.one_loaded(d[0].id,t,e.system.cache.get(d[0].id),++i,e.list.bytes.length+e.list.texts.length+e.list.jsons.length+e.list.textures.length+e.list.shaders.length+e.list.fonts.length+e.list.sounds.length))}for(var f=0,p=e.list.textures;f<p.length;){var m=[p[f]];++f,-1==a.indexOf(e.loaded,m[0].id,0)?(e.loaded.push(m[0].id),_.timer.schedule(e.load_time_spacing*i,function(s){return function(){var n=e.system.load_texture(s[0].id,{load_premultiply_alpha:s[0].load_premultiply_alpha,filter_min:s[0].filter_min,filter_mag:s[0].filter_mag,clamp_s:s[0].clamp_s,clamp_t:s[0].clamp_t}),r=s[0].id;n.then(function(){return function(s){e.one_loaded(r,t,s,++i,e.list.bytes.length+e.list.texts.length+e.list.jsons.length+e.list.textures.length+e.list.shaders.length+e.list.fonts.length+e.list.sounds.length)}}(),function(){return function(s){e.one_failed(r,t,s,++i,e.list.bytes.length+e.list.texts.length+e.list.jsons.length+e.list.textures.length+e.list.shaders.length+e.list.fonts.length+e.list.sounds.length)}}())}}(m))):(S.trace("   i / parcel / "+(""+e.id+" / already had "+m[0].id+" loaded, skipped"),{fileName:"Parcel.hx",lineNumber:263,className:"luxe.Parcel",methodName:"load"}),e.one_loaded(m[0].id,t,e.system.cache.get(m[0].id),++i,e.list.bytes.length+e.list.texts.length+e.list.jsons.length+e.list.textures.length+e.list.shaders.length+e.list.fonts.length+e.list.sounds.length))}for(var g=0,v=e.list.fonts;g<v.length;){var y=[v[g]];++g,-1==a.indexOf(e.loaded,y[0].id,0)?(e.loaded.push(y[0].id),_.timer.schedule(e.load_time_spacing*i,function(s){return function(){var n=e.system.load_font(s[0].id,{texture_path:s[0].texture_path}),r=s[0].id;n.then(function(){return function(s){e.one_loaded(r,t,s,++i,e.list.bytes.length+e.list.texts.length+e.list.jsons.length+e.list.textures.length+e.list.shaders.length+e.list.fonts.length+e.list.sounds.length)}}(),function(){return function(s){e.one_failed(r,t,s,++i,e.list.bytes.length+e.list.texts.length+e.list.jsons.length+e.list.textures.length+e.list.shaders.length+e.list.fonts.length+e.list.sounds.length)}}())}}(y))):(S.trace("   i / parcel / "+(""+e.id+" / already had "+y[0].id+" loaded, skipped"),{fileName:"Parcel.hx",lineNumber:287,className:"luxe.Parcel",methodName:"load"}),e.one_loaded(y[0].id,t,e.system.cache.get(y[0].id),++i,e.list.bytes.length+e.list.texts.length+e.list.jsons.length+e.list.textures.length+e.list.shaders.length+e.list.fonts.length+e.list.sounds.length))}for(var w=0,x=e.list.shaders;w<x.length;){var b=[x[w]];++w,-1==a.indexOf(e.loaded,b[0].id,0)?(e.loaded.push(b[0].id),_.timer.schedule(e.load_time_spacing*i,function(s){return function(){var n=e.system.load_shader(s[0].id,{frag_id:s[0].frag_id,vert_id:s[0].vert_id}),r=s[0].id;n.then(function(){return function(s){e.one_loaded(r,t,s,++i,e.list.bytes.length+e.list.texts.length+e.list.jsons.length+e.list.textures.length+e.list.shaders.length+e.list.fonts.length+e.list.sounds.length)}}(),function(){return function(s){e.one_failed(r,t,s,++i,e.list.bytes.length+e.list.texts.length+e.list.jsons.length+e.list.textures.length+e.list.shaders.length+e.list.fonts.length+e.list.sounds.length)}}())}}(b))):(S.trace("   i / parcel / "+(""+e.id+" / already had "+b[0].id+" loaded, skipped"),{fileName:"Parcel.hx",lineNumber:312,className:"luxe.Parcel",methodName:"load"}),e.one_loaded(b[0].id,t,e.system.cache.get(b[0].id),++i,e.list.bytes.length+e.list.texts.length+e.list.jsons.length+e.list.textures.length+e.list.shaders.length+e.list.fonts.length+e.list.sounds.length))}for(var k=0,z=e.list.sounds;k<z.length;){var E=[z[k]];++k,_.audio.exists(E[0].name)?(S.trace("   i / parcel / "+(""+e.id+" / already had "+E[0].id+" ("+E[0].name+") loaded, skipped"),{fileName:"Parcel.hx",lineNumber:342,className:"luxe.Parcel",methodName:"load"}),e.one_loaded(E[0].id,t,null,++i,e.list.bytes.length+e.list.texts.length+e.list.jsons.length+e.list.textures.length+e.list.shaders.length+e.list.fonts.length+e.list.sounds.length)):_.timer.schedule(e.load_time_spacing*i,function(s){return function(){var n=_.audio.create(s[0].id,s[0].name,s[0].is_stream);n.then(function(s){return function(){e.one_loaded(s[0].id,t,null,++i,e.list.bytes.length+e.list.texts.length+e.list.jsons.length+e.list.textures.length+e.list.shaders.length+e.list.fonts.length+e.list.sounds.length)}}(s),function(s){return function(n){e.one_failed(s[0].id,t,n,++i,e.list.bytes.length+e.list.texts.length+e.list.jsons.length+e.list.textures.length+e.list.shaders.length+e.list.fonts.length+e.list.sounds.length)}}(s))}}(E))}})},unload:function(t){null==t&&(t=!1);for(var e=this,i=0,s=this.list.bytes;i<s.length;){var n=s[i];++i;var r=n.id;e.system.destroy(r),a.remove(e.loaded,r)}for(var o=0,h=this.list.texts;o<h.length;){var l=h[o];++o;var u=l.id;e.system.destroy(u),a.remove(e.loaded,u)}for(var c=0,d=this.list.jsons;c<d.length;){var f=d[c];++c;var p=f.id;e.system.destroy(p),a.remove(e.loaded,p)}for(var m=0,g=this.list.textures;m<g.length;){var v=g[m];++m;var y=v.id;e.system.destroy(y),a.remove(e.loaded,y)}for(var w=0,x=this.list.fonts;w<x.length;){var b=x[w];++w;var k=b.id;e.system.destroy(k),a.remove(e.loaded,k)}for(var z=0,E=this.list.shaders;z<E.length;){var A=E[z];++z;var C=A.id;e.system.destroy(C),a.remove(e.loaded,C)}for(var T=0,S=this.list.sounds;T<S.length;){var I=S[T];++T,_.audio.uncreate(I.name)}t&&(this.list=null,this.list=this.empty_list()),this.state=0},from_json:function(t){if(null==t)throw new ne(Re.null_assertion("_json_object was null"));if(null!=t.bytes)for(var e=t.bytes,i=0;i<e.length;){var s=e[i];if(++i,null!=s){if(null==s)throw new ne(Re.null_assertion("item was null"));if(null==s.id)throw new ne(Re.null_assertion("item.id was null"));this.list.bytes.push(s)}}if(null!=t.text)for(var n=t.text,r=0;r<n.length;){var o=n[r];if(++r,null!=o){if(null==o)throw new ne(Re.null_assertion("item was null"));if(null==o.id)throw new ne(Re.null_assertion("item.id was null"));this.list.texts.push(o)}}if(null!=t.json)for(var a=t.json,h=0;h<a.length;){var l=a[h];if(++h,null!=l){if(null==l)throw new ne(Re.null_assertion("item was null"));if(null==l.id)throw new ne(Re.null_assertion("item.id was null"));this.list.jsons.push(l)}}if(null!=t.textures)for(var _=t.textures,u=0;u<_.length;){var c=_[u];if(++u,null==c)throw new ne(Re.null_assertion("item was null"));if(null==c.id)throw new ne(Re.null_assertion("item.id was null"));this.list.textures.push({id:c.id,filter_min:function(t){var e,i=c.filter_min;return e=null==i?null:function(t){var e;if("nearest"!=i&&"linear"!=i)throw new ne(Re.assertion("_filter_type == 'nearest' || _filter_type == 'linear'"));return e=function(){var t;switch(i){case"nearest":t=9728;break;case"linear":t=9729;break;default:t=null}return t}(t)}(t)}(this),filter_mag:function(t){var e,i=c.filter_mag;return e=null==i?null:function(t){var e;if("nearest"!=i&&"linear"!=i)throw new ne(Re.assertion("_filter_type == 'nearest' || _filter_type == 'linear'"));return e=function(){var t;switch(i){case"nearest":t=9728;break;case"linear":t=9729;break;default:t=null}return t}(t)}(t)}(this),clamp_s:function(t){var e,i=c.clamp_s;return e=null==i?null:function(t){var e;if("edge"!=i&&"repeat"!=i&&"mirror"!=i)throw new ne(Re.assertion("_clamp_type == 'edge' || _clamp_type == 'repeat' || _clamp_type == 'mirror'"));return e=function(){var t;switch(i){case"edge":t=33071;break;case"mirror":t=33648;break;case"repeat":t=10497;break;default:t=null}return t}(t)}(t)}(this),clamp_t:function(t){var e,i=c.clamp_t;return e=null==i?null:function(t){var e;if("edge"!=i&&"repeat"!=i&&"mirror"!=i)throw new ne(Re.assertion("_clamp_type == 'edge' || _clamp_type == 'repeat' || _clamp_type == 'mirror'"));return e=function(){var t;switch(i){case"edge":t=33071;break;case"mirror":t=33648;break;case"repeat":t=10497;break;default:t=null}return t}(t)}(t)}(this),load_premultiply_alpha:c.load_premultiply_alpha})}if(null!=t.fonts)for(var d=t.fonts,f=0;f<d.length;){var p=d[f];if(++f,null!=p){if(null==p)throw new ne(Re.null_assertion("item was null"));if(null==p.id)throw new ne(Re.null_assertion("item.id was null"));this.list.fonts.push(p)}}if(null!=t.shaders)for(var m=t.shaders,g=0;g<m.length;){var v=m[g];if(++g,null!=v){if(null==v)throw new ne(Re.null_assertion("item was null"));if(null==v.id)throw new ne(Re.null_assertion("item.id was null"));if(null==v.frag_id)throw new ne(Re.null_assertion("item.frag_id was null"));if(null==v.vert_id)throw new ne(Re.null_assertion("item.vert_id was null"));this.list.shaders.push(v)}}if(null!=t.sounds)for(var y=t.sounds,w=0;w<y.length;){var x=y[w];if(++w,null!=x){if(null==x)throw new ne(Re.null_assertion("item was null"));if(null==x.id)throw new ne(Re.null_assertion("item.id was null"));if(null==x.name)throw new ne(Re.null_assertion("item.name was null"));this.list.sounds.push(x)}}},one_loaded:function(t,e,i,s,n){var r={id:t,load_id:e,resource:i,index:s,total:n};this.emitter.emit(1,r),null!=this.onprogress&&this.onprogress(r),s==n&&(this.state=2,this.time_to_load=Nn.core.timestamp()-this.start_load,this.emitter.emit(2,this),null!=this.oncomplete&&this.oncomplete(this))},one_failed:function(t,e,i,s,n){var r={id:t,load_id:e,error:i,index:s,total:n};this.emitter.emit(3,r),null!=this.onfailed&&this.onfailed(r)},get_listed:function(){for(var t=[],e=0,i=this.list.bytes;e<i.length;){var s=i[e];++e,t.push(s.id)}for(var n=0,r=this.list.texts;n<r.length;){var o=r[n];++n,t.push(o.id)}for(var a=0,h=this.list.jsons;a<h.length;){var l=h[a];++a,t.push(l.id)}for(var _=0,u=this.list.textures;_<u.length;){var c=u[_];++_,t.push(c.id)}for(var d=0,f=this.list.fonts;d<f.length;){var p=f[d];++d,t.push(p.id)}for(var m=0,g=this.list.shaders;m<g.length;){var v=g[m];++m,t.push(v.id)}return t},get_length:function(){return this.list.bytes.length+this.list.texts.length+this.list.jsons.length+this.list.textures.length+this.list.shaders.length+this.list.fonts.length+this.list.sounds.length},do_complete:function(){this.state=2,this.time_to_load=Nn.core.timestamp()-this.start_load,this.emitter.emit(2,this),null!=this.oncomplete&&this.oncomplete(this)},empty_list:function(){return{bytes:[],texts:[],jsons:[],textures:[],fonts:[],shaders:[],sounds:[]}},__class__:Fe,__properties__:{get_length:"get_length",get_listed:"get_listed"}};var Le=function(t){this.step_delta=.016666666666666666,this.step_rate=.016666666666666666,this.core=t};n["luxe.Physics"]=Le,Le.__name__=["luxe","Physics"],Le.prototype={init:function(){this.engines=[]},reset:function(){null!=this.timer&&(this.timer.stop(),this.timer=null),0!=this.step_rate&&(this.timer=_.timer.schedule(this.step_rate,s(this,this.fixed_update),!0))},fixed_update:function(){_.debug.start(Le.tag_physics),this.update(),_.debug.end(Le.tag_physics)},add_engine:function(t,e){var i=b.createInstance(t,[e]),s=i;return s.init(),this.engines.push(s),i},update:function(){for(var t=0,e=this.engines;t<e.length;){var i=e[t];++t,i.update()}},process:function(){for(var t=0,e=this.engines;t<e.length;){var i=e[t];++t,i.process()}},render:function(){for(var t=0,e=this.engines;t<e.length;){var i=e[t];++t,i.render()}},destroy:function(){null!=this.timer&&this.timer.stop(),this.timer=null;for(var t=0,e=this.engines;t<e.length;){var i=e[t];++t,i.destroy()}},set_step_rate:function(t){return this.step_rate=t,this.step_delta=this.step_rate,this.reset(),this.step_rate},__class__:Le,__properties__:{set_step_rate:"set_step_rate"}};var Oe=function(){this.parcels=[],this.emitter=new c,this.cache=new V,this.stats=new De};n["luxe.Resources"]=Oe,Oe.__name__=["luxe","Resources"],Oe.prototype={track:function(t){if(null==t)throw new ne(Re.null_assertion("_cache was null"));if(-1!=a.indexOf(this.parcels,t,0))throw new ne(Re.assertion("parcels.indexOf(_cache) == -1"));this.parcels.push(t),this.emit(11,t)},untrack:function(t){if(null==t)throw new ne(Re.null_assertion("_cache was null"));var e=a.remove(this.parcels,t);e&&this.emit(12,t)},add:function(t){if(this.cache.exists(t.id))throw new ne(Re.assertion("!cache.exists(resource.id)"));this.cache.set(t.id,t),this.emit(2,t),this.update_stats(t,1)},remove:function(t){if(!this.cache.exists(t.id))throw new ne(Re.assertion("cache.exists(resource.id)"));return this.emit(7,t),this.update_stats(t,-1),this.cache.remove(t.id)},destroy:function(t,e){null==e&&(e=!1);var i=this.cache.get(t);return null==i?!1:(i.destroy(e),!0)},invalidate:function(t){var e=this.cache.get(t);return null==e?!1:(e.invalidate(),!0)},on:function(t,e){this.emitter.on(t,e)},off:function(t,e){this.emitter.off(t,e)},emit:function(t,e){this.emitter.emit(1,e),this.emitter.emit(t,e)},load_bytes:function(t){if(null==t)throw new ne(Re.null_assertion("_id was null"));var e=this.cache.get(t);if(null!=e){var i=e,s=i.ref;return i.set_ref(s+1),Fn.resolve(e)}return e=new Ri({id:t,system:this,asset:null}),this.add(e),e.reload()},load_text:function(t){if(null==t)throw new ne(Re.null_assertion("_id was null"));var e=this.cache.get(t);if(null!=e){var i=e,s=i.ref;return i.set_ref(s+1),Fn.resolve(e)}return e=new Bi({id:t,system:this,asset:null}),this.add(e),e.reload()},load_json:function(t){if(null==t)throw new ne(Re.null_assertion("_id was null"));var e=this.cache.get(t);if(null!=e){var i=e,s=i.ref;return i.set_ref(s+1),Fn.resolve(e)}return e=new Pi({id:t,system:this,asset:null}),this.add(e),e.reload()},load_texture:function(t,e){if(null==t)throw new ne(Re.null_assertion("_id was null"));var i=this.cache.get(t);if(null!=i){var s=i,n=s.ref;return s.set_ref(n+1),Fn.resolve(i)}var r=null,o=null,a=null,h=null,l=null;return null!=e&&(r=e.filter_min,o=e.filter_mag,a=e.clamp_s,h=e.clamp_t,l=e.load_premultiply_alpha),i=new sn({id:t,system:this,filter_min:r,filter_mag:o,clamp_s:a,clamp_t:h,load_premultiply_alpha:l}),this.add(i),i.reload()},load_font:function(t,e){if(null==t)throw new ne(Re.null_assertion("_id was null"));var i=this.cache.get(t);if(null!=i){var s=i,n=s.ref;return s.set_ref(n+1),Fn.resolve(i)}var r=null;return null!=e&&(r=e.texture_path),i=new js({id:t,system:this,texture_path:r}),this.add(i),i.reload()},load_shader:function(t,e){if(null==t)throw new ne(Re.null_assertion("_id was null"));var i=this.cache.get(t);if(null!=i){var s=i,n=s.ref;return s.set_ref(n+1),Fn.resolve(i)}return i=new an({id:t,system:this,frag_id:e.frag_id,vert_id:e.vert_id}),this.add(i),i.reload()},has:function(t){return this.cache.exists(t)},get:function(t){return this.cache.get(t)},bytes:function(t){return this.cache.get(t)},text:function(t){return this.cache.get(t)},json:function(t){return this.cache.get(t)},texture:function(t){return this.cache.get(t)},font:function(t){return this.cache.get(t)},shader:function(t){return this.cache.get(t)},fetch:function(t){return this.cache.get(t)},update_stats:function(t,e){var i=t.resource_type;switch(i){case 0:this.stats.unknown+=e;break;case 3:this.stats.bytes+=e;break;case 1:this.stats.texts+=e;break;case 2:this.stats.jsons+=e;break;case 4:this.stats.textures+=e;break;case 5:this.stats.render_textures+=e;break;case 6:this.stats.fonts+=e;break;case 7:this.stats.shaders+=e}this.stats.total+=e},__class__:Oe};var De=function(){this.unknown=0,this.bytes=0,this.jsons=0,this.texts=0,this.shaders=0,this.render_textures=0,this.textures=0,this.fonts=0,this.total=0};n["luxe.ResourceStats"]=De,De.__name__=["luxe","ResourceStats"],De.prototype={toString:function(){return"Resource Statistics\n	total : "+this.total+"\n	texture : "+this.textures+" \n	render texture : "+this.render_textures+" \n	font : "+this.fonts+"\n	shader : "+this.shaders+"\n	text : "+this.texts+"\n	json : "+this.jsons+"\n	bytes : "+this.bytes+"\n	unknown : "+this.unknown},reset:function(){this.total=0,this.fonts=0,this.textures=0,this.render_textures=0,this.shaders=0,this.texts=0,this.jsons=0,this.bytes=0,this.unknown=0},__class__:De};var Ue=function(t){null==t&&(t="untitled scene"),this.entity_count=0,this._has_changed=!1,this.length=0,this.started=!1,this.inited=!1,ce.call(this,t),this.entities=new V,this._delayed_init_entities=[],this._delayed_reset_entities=[],_.core.on(2,s(this,this.init)),_.core.on(6,s(this,this._destroy)),_.core.on(4,s(this,this.update)),_.core.on(7,s(this,this.prerender)),_.core.on(9,s(this,this.postrender)),_.core.on(8,s(this,this.render)),_.core.on(10,s(this,this.keydown)),_.core.on(11,s(this,this.keyup)),_.core.on(12,s(this,this.textinput)),_.core.on(14,s(this,this.inputup)),_.core.on(13,s(this,this.inputdown)),_.core.on(16,s(this,this.mouseup)),_.core.on(15,s(this,this.mousedown)),_.core.on(17,s(this,this.mousemove)),_.core.on(18,s(this,this.mousewheel)),_.core.on(20,s(this,this.touchup)),_.core.on(19,s(this,this.touchdown)),_.core.on(21,s(this,this.touchmove)),_.core.on(24,s(this,this.gamepadup)),_.core.on(23,s(this,this.gamepaddown)),_.core.on(22,s(this,this.gamepadaxis)),_.core.on(25,s(this,this.gamepaddevice)),_.core.on(27,s(this,this.windowmoved)),_.core.on(28,s(this,this.windowresized)),_.core.on(29,s(this,this.windowsized)),_.core.on(30,s(this,this.windowminimized)),_.core.on(31,s(this,this.windowrestored)),_.core.inited&&this.init(null);var e=_.core.debug.get_view("Scenes");null!=e&&e.add_scene(this)};n["luxe.Scene"]=Ue,Ue.__name__=["luxe","Scene"],Ue.__super__=ce,Ue.prototype=e(ce.prototype,{handle_duplicate_warning:function(t){this.entities.exists(t)&&S.trace("    i / scene / "+(""+this.get_name()+" / adding a second entity named "+t+"!\n                This will replace the existing one, possibly leaving the previous one in limbo."),{fileName:"Scene.hx",lineNumber:91,className:"luxe.Scene",methodName:"handle_duplicate_warning"})},add:function(t){if(null==t)throw new ne(Re.null_assertion("entity was null ( can't put entity in a scene if the entity is null. )"));this.handle_duplicate_warning(t.get_name()),t.set_scene(this);var e=t.get_name();this.entities.set(e,t),this.entity_count++,this.inited&&this._delayed_init_entities.push(t),this.started&&this._delayed_reset_entities.push(t),this._has_changed=!0},remove:function(t){if(null==t)throw new ne(Re.null_assertion("entity was null ( can't remove entity from a scene if the entity is null. )"));if(this._has_changed=!0,t.get_scene()==this){t.set_scene(null),this.entity_count--;var e=t.get_name();return this.entities.remove(e)}return S.trace("    i / scene / can't remove the entity from this scene, it is not mine (entity.scene != this)",{fileName:"Scene.hx",lineNumber:140,className:"luxe.Scene",methodName:"remove"}),!1},get:function(t){return this.entities.get(t)},empty:function(){if(this.entity_count>0)for(var t=this.entities.iterator();t.hasNext();){var e=t.next();null!=e&&e!=_.camera&&(this.remove(e),e.destroy(),e=null)}},get_named_like:function(t,e){if(this.entity_count>0)for(var i=new o("^((?:"+t+")[.]{1})","g"),s=this.entities.iterator();s.hasNext();){var n=s.next();i.match(n.get_name())&&e.push(n)}return e},render:function(){this.emit(8)},prerender:function(){this.emit(7)},postrender:function(){this.emit(9)},keydown:function(t){this.emit(10,t)},keyup:function(t){this.emit(11,t)},textinput:function(t){this.emit(12,t)},mousedown:function(t){this.emit(15,t)},mousewheel:function(t){this.emit(18,t)},mouseup:function(t){this.emit(16,t)},mousemove:function(t){this.emit(17,t)},touchdown:function(t){this.emit(19,t)},touchup:function(t){this.emit(20,t)},touchmove:function(t){this.emit(21,t)},gamepadaxis:function(t){this.emit(22,t)},gamepadup:function(t){this.emit(24,t)},gamepaddown:function(t){this.emit(23,t)},gamepaddevice:function(t){this.emit(25,t)},windowmoved:function(t){this.emit(27,t)},windowresized:function(t){this.emit(28,t)},windowsized:function(t){this.emit(29,t)},windowminimized:function(t){this.emit(30,t)},windowrestored:function(t){this.emit(31,t)},inputdown:function(t){this.emit(13,t)},inputup:function(t){this.emit(14,t)},_destroy:function(){this.destroy()},destroy:function(){_.core.off(2,s(this,this.init)),_.core.off(6,s(this,this._destroy)),_.core.off(4,s(this,this.update)),_.core.off(7,s(this,this.prerender)),_.core.off(9,s(this,this.postrender)),_.core.off(8,s(this,this.render)),_.core.off(10,s(this,this.keydown)),_.core.off(11,s(this,this.keyup)),_.core.off(12,s(this,this.textinput)),_.core.off(14,s(this,this.inputup)),_.core.off(13,s(this,this.inputdown)),_.core.off(16,s(this,this.mouseup)),_.core.off(15,s(this,this.mousedown)),_.core.off(17,s(this,this.mousemove)),_.core.off(18,s(this,this.mousewheel)),_.core.off(20,s(this,this.touchup)),_.core.off(19,s(this,this.touchdown)),_.core.off(21,s(this,this.touchmove)),_.core.off(24,s(this,this.gamepadup)),_.core.off(23,s(this,this.gamepaddown)),_.core.off(22,s(this,this.gamepadaxis)),_.core.off(25,s(this,this.gamepaddevice)),_.core.off(27,s(this,this.windowmoved)),_.core.off(28,s(this,this.windowresized)),_.core.off(29,s(this,this.windowsized)),_.core.off(30,s(this,this.windowminimized)),_.core.off(31,s(this,this.windowrestored)),this.emit(6);var t=_.core.debug.get_view("Scenes");
null!=t&&t.remove_scene(this)},_do_init:function(){var t=this.get_length();if(this.entity_count>0)for(var e=this.entities.iterator();e.hasNext();){var i=e.next();null!=i&&(i.inited||i._init())}var s=this.get_length();return t!=s},init:function(){for(var t=!0;t;)t=this._do_init();this.inited=!0,this.emit(2),this.reset()},reset:function(){this.started=!1,this.emit(3),this.started=!0},update:function(t){if(_.core.debug.start("scene."+this.get_name()),this.handle_delayed_additions(),this.emit(4,t),this.entity_count>0)for(var e=this.entities.iterator();e.hasNext();){var i=e.next();null!=i&&i._update(t)}_.core.debug.end("scene."+this.get_name())},handle_delayed_additions:function(){if(0!=this._delayed_init_entities.length||0!=this._delayed_reset_entities.length,this._delayed_init_entities.length>0){for(var t=0,e=this._delayed_init_entities;t<e.length;){var i=e[t];++t,i.inited||i._init()}this._delayed_init_entities.splice(0,this._delayed_init_entities.length)}if(this._delayed_reset_entities.length>0){for(var s=0,n=this._delayed_reset_entities;s<n.length;){var r=n[s];++s,r._reset(null)}this._delayed_reset_entities.splice(0,this._delayed_reset_entities.length)}},get_length:function(){return h.count(this.entities)},toString:function(){return"luxe Scene: "+this.get_name()+" / "+this.get_length()+" entities / id: "+this.get_id()},__class__:Ue,__properties__:e(ce.prototype.__properties__,{get_length:"get_length"})});var Ge=function(t,e,i){this.core=t,this.cursor=new je(this),this.width=e,this.height=i};n["luxe.Screen"]=Ge,Ge.__name__=["luxe","Screen"],Ge.prototype={toString:function(){return"luxe.Screen({ w:"+this.get_w()+", h:"+this.get_h()+" })"},point_inside:function(t){return t.x<0?!1:t.y<0?!1:t.x>this.width?!1:t.y>this.height?!1:!0},point_inside_xy:function(t,e){return 0>t?!1:0>e?!1:t>this.width?!1:e>this.height?!1:!0},internal_resized:function(t,e){this.width=t,this.height=e},get_mid:function(){return new un(Math.round(this.get_w()/2),Math.round(this.get_h()/2))},get_size:function(){return new un(this.get_w(),this.get_h())},get_bounds:function(){return new $s(0,0,this.get_w(),this.get_h())},get_w:function(){return 0|this.width},get_h:function(){return 0|this.height},__class__:Ge,__properties__:{get_h:"get_h",get_w:"get_w",get_bounds:"get_bounds",get_size:"get_size",get_mid:"get_mid"}};var je=function(t){this.ignore=!1,this.lock=!1,this.grab=!1,this.visible=!0,this.screen=t,this.set_pos(new un)};n["luxe.Cursor"]=je,je.__name__=["luxe","Cursor"],je.prototype={set_internal:function(t){this.ignore=!0,this.set_pos(t),this.ignore=!1},get_visible:function(){return this.visible},set_visible:function(t){return this.screen.core.app.windowing.enable_cursor(t),this.visible=t},get_grab:function(){return this.grab},get_lock:function(){return this.lock},set_grab:function(t){return this.screen.core.app.window.set_grab(t),this.grab=t},set_lock:function(t){return this.screen.core.app.windowing.enable_cursor_lock(t),this.lock=t},get_pos:function(){return this.pos},set_pos:function(t){return null==this.get_pos()||null==t||this.ignore||this.screen.core.app.window.set_cursor_position(0|t.x,0|t.y),this.pos=t},__class__:je,__properties__:{set_pos:"set_pos",get_pos:"get_pos",set_lock:"set_lock",get_lock:"get_lock",set_grab:"set_grab",get_grab:"get_grab",set_visible:"set_visible",get_visible:"get_visible"}};var Ve=function(t){if(this.flipy=!1,this.flipx=!1,this.centered=!0,this.set_uv(new $s),null==t)throw new ne(Re.null_assertion("options was null ( Sprite requires non-null options )"));null!=t.centered&&this.set_centered(t.centered),null!=t.flipx&&this.set_flipx(t.flipx),null!=t.flipy&&this.set_flipy(t.flipy),Be.call(this,t)};n["luxe.Sprite"]=Ve,Ve.__name__=["luxe","Sprite"],Ve.__super__=Be,Ve.prototype=e(Be.prototype,{on_geometry_created:function(){Be.prototype.on_geometry_created.call(this),null!=this.texture&&(this.set_uv(function(t){var e;return null==t.options.uv&&(t.options.uv=new $s(0,0,t.texture.width,t.texture.height)),e=t.options.uv}(this)),5==this.texture.resource_type&&this.set_flipy(!0)),this.set_centered(!!this.centered),this.set_flipx(!!this.flipx),this.set_flipy(!!this.flipy)},set_geometry:function(t){return this.geometry_quad=t,Be.prototype.set_geometry.call(this,t)},point_inside:function(t){return null==this.geometry?!1:_.utils.geometry.point_in_geometry(t,this.geometry)},point_inside_AABB:function(t){if(null==this.get_pos())return!1;if(null==this.size)return!1;var e=this.size.x*this.get_scale().x,i=this.size.y*this.get_scale().y;if(this.centered){var s=e/2,n=i/2;if(t.x<this.get_pos().x-s)return!1;if(t.y<this.get_pos().y-n)return!1;if(t.x>this.get_pos().x+e-s)return!1;if(t.y>this.get_pos().y+i-n)return!1}else{if(t.x<this.get_pos().x)return!1;if(t.y<this.get_pos().y)return!1;if(t.x>this.get_pos().x+e)return!1;if(t.y>this.get_pos().y+i)return!1}return!0},set_uv:function(t){return null!=this.geometry_quad&&this.geometry_quad.uv(t),this.uv=t,$s.listen(this.uv,s(this,this._uv_change)),this.uv},set_flipy:function(t){return t==this.flipy?this.flipy:(null!=this.geometry_quad&&this.geometry_quad.set_flipy(t),this.flipy=t)},set_flipx:function(t){return t==this.flipx?this.flipx:(null!=this.geometry_quad&&this.geometry_quad.set_flipx(t),this.flipx=t)},set_size:function(t){return null!=this.geometry_quad&&(this.geometry_quad.resize(new un(t.x,t.y)),this._has_custom_origin||this.centered&&this.set_origin(new un(t.x,t.y,t.z,t.w).divideScalar(2))),Be.prototype.set_size.call(this,t)},set_centered:function(t){return null!=this.size&&this.set_origin(t?new un(this.size.x/2,this.size.y/2):new un),this.centered=t},_uv_change:function(){this.set_uv(this.uv)},init:function(){Be.prototype.init.call(this)},ondestroy:function(){Be.prototype.ondestroy.call(this)},__class__:Ve,__properties__:e(Be.prototype.__properties__,{set_uv:"set_uv",set_flipy:"set_flipy",set_flipx:"set_flipx",set_centered:"set_centered"})});var qe=function(t){this.text_options=t,this.text_bounds=new $s;var e=null;(null==t.no_batcher_add||0==t.no_batcher_add)&&(e=null!=t.batcher?t.batcher:_.renderer.batcher),this.geom=new En({batcher:e,depth:t.depth,group:t.group,visible:t.visible,immediate:t.immediate,color:t.color,shader:t.shader,texture:t.texture,text:t.text,font:t.font,point_size:t.point_size,line_spacing:t.line_spacing,letter_spacing:t.letter_spacing,bounds:t.bounds,bounds_wrap:t.bounds_wrap,align:t.align,align_vertical:t.align_vertical,sdf:t.sdf,smoothness:t.smoothness,thickness:t.thickness,outline:t.outline,outline_color:t.outline_color,glow_threshold:t.glow_threshold,glow_amount:t.glow_amount,glow_color:t.glow_color}),this.geom.emitter.on(1,s(this,this.on_geom_text_update)),t.geometry=this.geom,t.shader=this.geom.state.shader,Be.call(this,t),this._update_bounds()};n["luxe.Text"]=qe,qe.__name__=["luxe","Text"],qe.__super__=Be,qe.prototype=e(Be.prototype,{get_text:function(){return this.geom.text},set_text:function(t){return this.geom.set_text(t)},get_font:function(){return this.geom.font},set_font:function(t){return this.geom.font=t},get_point_size:function(){return this.geom.point_size},set_point_size:function(t){return this.geom.set_point_size(t)},get_letter_spacing:function(){return this.geom.letter_spacing},set_letter_spacing:function(t){return this.geom.set_letter_spacing(t)},get_line_spacing:function(){return this.geom.line_spacing},set_line_spacing:function(t){return this.geom.set_line_spacing(t)},get_bounds:function(){return this.geom.bounds},set_bounds:function(t){return this.geom.set_bounds(t)},get_bounds_wrap:function(){return this.geom.bounds_wrap},set_bounds_wrap:function(t){return this.geom.set_bounds_wrap(t)},get_align:function(){return this.geom.align},set_align:function(t){return this.geom.set_align(t)},get_align_vertical:function(){return this.geom.align_vertical},set_align_vertical:function(t){return this.geom.set_align_vertical(t)},get_sdf:function(){return this.geom.sdf},set_sdf:function(t){return this.geom.sdf=t},get_smoothness:function(){return this.geom.smoothness},set_smoothness:function(t){return this.geom.set_smoothness(t)},get_thickness:function(){return this.geom.thickness},set_thickness:function(t){return this.geom.set_thickness(t)},get_outline:function(){return this.geom.outline},set_outline:function(t){return this.geom.set_outline(t)},get_outline_color:function(){return this.geom.outline_color},set_outline_color:function(t){return this.geom.set_outline_color(t)},get_glow_threshold:function(){return this.geom.glow_threshold},set_glow_threshold:function(t){return this.geom.set_glow_threshold(t)},get_glow_amount:function(){return this.geom.glow_amount},set_glow_amount:function(t){return this.geom.set_glow_amount(t)},get_glow_color:function(){return this.geom.glow_color},set_glow_color:function(t){return this.geom.set_glow_color(t)},point_inside:function(t){return this._update_bounds(),this.text_bounds.point_inside(t)},set_pos_from_transform:function(t){Be.prototype.set_pos_from_transform.call(this,t),this._update_bounds(),this.text_options.pos=this.get_pos()},on_geom_text_update:function(){this._update_bounds()},_update_bounds:function(){var t=this.get_pos().x,e=this.get_pos().y,i=this.geom.text_width,s=this.geom.text_height,n=this.geom.text_width,r=this.geom.text_height;if(null!=this.get_bounds()){r=this.get_bounds().h,n=this.get_bounds().w,t=this.get_bounds().x,e=this.get_bounds().y;var o=this.get_align();switch(o){case 2:t+=i/2;break;case 1:t+=i;break;default:t+=0}var a=this.get_align_vertical();switch(a){case 2:e+=r/2-s/2;break;case 4:e+=r-s;break;default:e+=0}}else{var h=this.get_align();switch(h){case 2:t-=i/2;break;case 1:t-=i;break;default:t-=0}var l=this.get_align_vertical();switch(l){case 2:e-=s/2;break;case 4:e-=s;break;default:e-=0}}this.text_bounds.set(t,e,i,s)},init:function(){Be.prototype.init.call(this)},ondestroy:function(){Be.prototype.ondestroy.call(this)},__class__:qe,__properties__:e(Be.prototype.__properties__,{set_glow_color:"set_glow_color",get_glow_color:"get_glow_color",set_glow_amount:"set_glow_amount",get_glow_amount:"get_glow_amount",set_glow_threshold:"set_glow_threshold",get_glow_threshold:"get_glow_threshold",set_outline_color:"set_outline_color",get_outline_color:"get_outline_color",set_outline:"set_outline",get_outline:"get_outline",set_thickness:"set_thickness",get_thickness:"get_thickness",set_smoothness:"set_smoothness",get_smoothness:"get_smoothness",set_sdf:"set_sdf",get_sdf:"get_sdf",set_align_vertical:"set_align_vertical",get_align_vertical:"get_align_vertical",set_align:"set_align",get_align:"get_align",set_bounds_wrap:"set_bounds_wrap",get_bounds_wrap:"get_bounds_wrap",set_bounds:"set_bounds",get_bounds:"get_bounds",set_line_spacing:"set_line_spacing",get_line_spacing:"get_line_spacing",set_letter_spacing:"set_letter_spacing",get_letter_spacing:"get_letter_spacing",set_point_size:"set_point_size",get_point_size:"get_point_size",set_font:"set_font",get_font:"get_font",set_text:"set_text",get_text:"get_text"})});var Xe=function(t){this.core=t,this.timers=[]};n["luxe.Timer"]=Xe,Xe.__name__=["luxe","Timer"],Xe.prototype={init:function(){},destroy:function(){this.reset()},process:function(){},reset:function(){for(var t=0,e=this.timers;t<e.length;){var i=e[t];++t,i.stop(),i=null}this.timers=null,this.timers=[]},schedule:function(t,e,i){null==i&&(i=!1);var s=this,n=new Dn(t);return n.run=function(){i||(n.stop(),a.remove(s.timers,n)),e()},this.timers.push(n),n},__class__:Xe};var Ze=function(){};n["luxe.collision.Collision"]=Ze,Ze.__name__=["luxe","collision","Collision"],Ze.shapeWithShape=function(t,e){return t.test(e)},Ze.shapeWithShapes=function(t,e){for(var i=[],s=0;s<e.length;){var n=e[s];++s;var r=Ze.shapeWithShape(t,n);null!=r&&i.push(r)}return i},Ze.rayWithShape=function(t,e){return e.testRay(t)},Ze.rayWithShapes=function(t,e){for(var i=[],s=0;s<e.length;){var n=e[s];++s;var r=n.testRay(t);null!=r&&i.push(r)}return i},Ze.rayWithRay=function(t,e){return Je.testRayVsRay(t,e)},Ze.rayWithRays=function(t,e){for(var i=[],s=0;s<e.length;){var n=e[s];++s;var r=Je.testRayVsRay(t,n);null!=r&&i.push(r)}return i},Ze.pointInPoly=function(t,e){for(var i=e.get_transformedVertices().length,s=i-1,n=!1,r=0;i>r;){var o=r++;(e.get_transformedVertices()[o].y<t.y&&e.get_transformedVertices()[s].y>=t.y||e.get_transformedVertices()[s].y<t.y&&e.get_transformedVertices()[o].y>=t.y)&&e.get_transformedVertices()[o].x+(t.y-e.get_transformedVertices()[o].y)/(e.get_transformedVertices()[s].y-e.get_transformedVertices()[o].y)*(e.get_transformedVertices()[s].x-e.get_transformedVertices()[o].x)<t.x&&(n=!n),s=o}return n};var He=function(t,e,i,s){this.ray=e,this.shape=t,this.start=i,this.end=s};n["luxe.collision.data.RayCollision"]=He,He.__name__=["luxe","collision","data","RayCollision"],He.prototype={__class__:He};var Ke=function(){};n["luxe.collision.data.RayCollisionHelper"]=Ke,Ke.__name__=["luxe","collision","data","RayCollisionHelper"],Ke.hitStart=function(t){var e=t.ray.get_dir(),i=e.x*t.start,s=e.y*t.start;return new un(t.ray.start.x+i,t.ray.start.y+s)},Ke.hitEnd=function(t){var e=t.ray.get_dir(),i=e.x*t.end,s=e.y*t.end;return new un(t.ray.start.x+i,t.ray.start.y+s)};var We=function(t,e,i,s){this.ray1=t,this.ray2=i,this.u1=e,this.u2=s};n["luxe.collision.data.RayIntersection"]=We,We.__name__=["luxe","collision","data","RayIntersection"],We.prototype={__class__:We};var Qe=function(){this.overlap=0,this.separation=new un,this.unitVector=new un};n["luxe.collision.data.ShapeCollision"]=Qe,Qe.__name__=["luxe","collision","data","ShapeCollision"],Qe.prototype={__class__:Qe};var Ye=function(){};n["luxe.collision.sat.Common"]=Ye,Ye.__name__=["luxe","collision","sat","Common"],Ye.findNormalAxis=function(t,e){var i,s=t[e];i=e>=t.length-1?t[0]:t[e+1];var n=new un(-(i.y-s.y),i.x-s.x);return n.divideScalar(Math.sqrt(n.x*n.x+n.y*n.y+n.z*n.z))};var Je=function(){};n["luxe.collision.sat.SAT2D"]=Je,Je.__name__=["luxe","collision","sat","SAT2D"],Je.testCircleVsPolygon=function(t,e,i){null==i&&(i=!1);var s,n,r,o,a,h,l=1e-10,_=0,u=1073741823,c=0,d=1073741823,f=new un,p=new un,m=1073741823,g=new Qe,v=-1,y=1073741823,w=new un;p=new un(-t._position.x,-t._position.y);var x=e.get_transformedVertices();if(a=x.slice(),2==a.length){var b=new un(-(a[1].y-a[0].y),a[1].x-a[0].x);b.set_length(Math.min(l,Math.sqrt(b.x*b.x+b.y*b.y+b.z*b.z))),a.push(a[1].clone().add(b))}for(var k=0,z=a.length;z>k;){var E=k++;v=(t._position.x-a[E].x)*(t._position.x-a[E].x)+(t._position.y-a[E].y)*(t._position.y-a[E].y),y>v&&(y=v,w.set_x(a[E].x),w.set_y(a[E].y))}f=new un(w.x-t._position.x,w.y-t._position.y),f.divideScalar(Math.sqrt(f.x*f.x+f.y*f.y+f.z*f.z)),_=f.dot(a[0]),u=_;for(var A=1,C=a.length;C>A;){var T=A++;r=f.dot(a[T]),_>r&&(_=r),r>u&&(u=r)}if(d=t.get_transformedRadius(),c-=t.get_transformedRadius(),o=f.x*p.x+f.y*p.y+f.z*p.z,_+=o,u+=o,s=_-d,n=c-u,s>0||n>0)return null;h=-(d-_),i&&(h*=-1),Math.abs(h)<m&&(g.unitVector=f,g.overlap=h,m=Math.abs(h));for(var S=0,I=a.length;I>S;){var N=S++;f=Ye.findNormalAxis(a,N),_=f.dot(a[0]),u=_;for(var M=1,R=a.length;R>M;){var B=M++;r=f.dot(a[B]),_>r&&(_=r),r>u&&(u=r)}if(d=t.get_transformedRadius(),c=-t.get_transformedRadius(),o=f.x*p.x+f.y*p.y+f.z*p.z,_+=o,u+=o,s=_-d,n=c-u,s>0||n>0)return null;h=-(d-_),i&&(h*=-1),Math.abs(h)<m&&(g.unitVector=f,g.overlap=h,m=Math.abs(h))}return g.shape2=i?e:t,g.shape1=i?t:e,g.separation=new un(-g.unitVector.x*g.overlap,-g.unitVector.y*g.overlap),i&&g.unitVector.invert(),g},Je.testCircleVsCircle=function(t,e){var i=t.get_transformedRadius()+e.get_transformedRadius(),s=(t._position.x-e._position.x)*(t._position.x-e._position.x)+(t._position.y-e._position.y)*(t._position.y-e._position.y);if(i*i>s){var n=i-Math.sqrt(s),r=new Qe;return r.shape1=t,r.shape2=e,r.unitVector=new un(t._position.x-e._position.x,t._position.y-e._position.y),r.unitVector.normalize(),r.separation=new un(r.unitVector.x*n,r.unitVector.y*n),r.overlap=r.separation.get_length(),r}return null},Je.testPolygonVsPolygon=function(t,e,i){null==i&&(i=!1);var s=Je.checkPolygons(t,e,i);if(null==s)return null;var n=Je.checkPolygons(e,t,!i);return null==n?null:Math.abs(s.overlap)<Math.abs(n.overlap)?s:n},Je.testRayVsCircle=function(t,e){var i=t.end.clone().subtract(t.start),s=t.start.clone().subtract(e._position),n=i.x*i.x+i.y*i.y+i.z*i.z,r=2*(i.x*s.x+i.y*s.y+i.z*s.z),o=s.x*s.x+s.y*s.y+s.z*s.z-e.get_radius()*e.get_radius(),a=r*r-4*n*o;if(a>=0){a=Math.sqrt(a);var h=(-r-a)/(2*n),l=(-r+a)/(2*n);if(t.infinite||1>=h&&h>=0)return new He(e,t,h,l)}return null},Je.testRayVsPolygon=function(t,e){var i=t.end.clone().subtract(t.start),s=e.get_transformedVertices(),n=1/0,r=0;if(s.length>2){var o=s[s.length-1],a=s[0],h=Je.intersectRayRay(t.start,i,o,new un(a.x,a.y,a.z,a.w).subtract(o));null!=h&&h.ub>=0&&h.ub<=1&&(h.ua<n&&(n=h.ua),h.ua>r&&(r=h.ua));for(var l=1,_=s.length;_>l;){var u=l++;o=s[u-1],a=s[u],h=Je.intersectRayRay(t.start,i,o,new un(a.x,a.y,a.z,a.w).subtract(o)),null!=h&&h.ub>=0&&h.ub<=1&&(h.ua<n&&(n=h.ua),h.ua>r&&(r=h.ua))}if(t.infinite||1>=n&&n>=0)return new He(e,t,n,r)}return null},Je.testRayVsRay=function(t,e){var i=t.end.clone().subtract(t.start),s=e.end.clone().subtract(e.start),n=t.start.clone().subtract(e.start),r=s.y*i.x-s.x*i.y;if(0==r)return null;var o=(s.x*n.y-s.y*n.x)/r,a=(i.x*n.y-i.y*n.x)/r;return(t.infinite||1>=o)&&(e.infinite||1>=a)?new We(t,o,e,a):null},Je.bresenhamLine=function(t,e){var i=[],s=Math.abs(e.y-t.y)>Math.abs(e.x-t.x),n=!1;if(s&&(t=new un(t.y,t.x),e=new un(e.y,e.x)),t.x>e.x){var r=t.x;t.set_x(e.x),e.x=r,e._construct?e.x:(null==e.listen_x||e.ignore_listeners||e.listen_x(r),e.x),r=t.y,t.set_y(e.y),e.y=r,e._construct?e.y:(null==e.listen_y||e.ignore_listeners||e.listen_y(r),e.y),n=!0}var o,a=e.x-t.x,h=Math.abs(e.y-t.y),l=a/2,_=t.y;o=t.y<e.y?1:-1;for(var u=(0|t.x,0|t.x),c=0|e.x;c>u;){var d=u++;i.push(s?new un(_,d):new un(d,_)),l-=h,0>l&&(_+=o,l+=a)}return n&&i.reverse(),i},Je.checkPolygons=function(t,e,i){null==i&&(i=!1);var s,n,r,o,a,h,l,_,u,c,d=1e-10,f=1073741823,p=new Qe,m=t.get_transformedVertices();u=m.slice();var g=e.get_transformedVertices();if(c=g.slice(),2==u.length){var v=new un(-(u[1].y-u[0].y),u[1].x-u[0].x);v.set_length(Math.min(d,Math.sqrt(v.x*v.x+v.y*v.y+v.z*v.z))),u.push(u[1].add(v))}if(2==c.length){var y=new un(-(c[1].y-c[0].y),c[1].x-c[0].x);y.set_length(Math.min(d,Math.sqrt(y.x*y.x+y.y*y.y+y.z*y.z))),c.push(c[1].add(y))}for(var w=0,x=u.length;x>w;){var b=w++;_=Ye.findNormalAxis(u,b),o=_.dot(u[0]),a=o;for(var k=1,z=u.length;z>k;){var E=k++;r=_.dot(u[E]),o>r&&(o=r),r>a&&(a=r)}h=_.dot(c[0]),l=h;for(var A=1,C=c.length;C>A;){var T=A++;r=_.dot(c[T]),h>r&&(h=r),r>l&&(l=r)}if(s=o-l,n=h-a,s>0||n>0)return null;var S=-(l-o);i&&(S*=-1),Math.abs(S)<f&&(p.unitVector=_,p.overlap=S,f=Math.abs(S))}return p.shape1=i?e:t,p.shape2=i?t:e,p.separation=new un(-p.unitVector.x*p.overlap,-p.unitVector.y*p.overlap),i&&p.unitVector.invert(),p},Je.swap=function(t){return new un(t.y,t.x)},Je.intersectRayRay=function(t,e,i,s){var n=new un(t.x,t.y,t.z,t.w).subtract(i),r=s.y*e.x-s.x*e.y;if(0==r)return null;var o=(s.x*n.y-s.y*n.x)/r,a=(e.x*n.y-e.y*n.x)/r;return{ua:o,ub:a}};var $e=function(t,e){this._transformed=!1,this._scaleY=1,this._scaleX=1,this._rotation_radians=0,this._rotation=0,this.name="shape",this.active=!0,this.tags=new V,this._position=new un(t,e),this._scale=new un(1,1),this._rotation_quat=new Ys,this._rotation=0,this._scaleX=1,this._scaleY=1,un.Listen(this._position,s(this,this._pos_changed)),this._transformMatrix=new Qs,this._transformMatrix.makeTranslation(this._position.x,this._position.y,0)};n["luxe.collision.shapes.Shape"]=$e,$e.__name__=["luxe","collision","shapes","Shape"],$e.prototype={test:function(){return null},testCircle:function(t,e){return null==e&&(e=!1),null},testPolygon:function(t,e){return null==e&&(e=!1),null},testRay:function(){return null},destroy:function(){this._position=null,this._scale=null,this._transformMatrix=null,this._rotation_quat=null},refresh_transform:function(){this._rotation_quat.setFromEuler(new un(0,0,this._rotation_radians)),this._transformMatrix.compose(this._position,this._rotation_quat,this._scale),this._transformed=!1},get_position:function(){return this._position},set_position:function(t){return this._position=t,this.refresh_transform(),null!=this._position&&un.Listen(this._position,s(this,this._pos_changed)),this._position},get_x:function(){return this._position.x},set_x:function(t){return this._position.ignore_listeners=!0,this._position.set_x(t),this.refresh_transform(),this._position.ignore_listeners=!1,this._position.x},get_y:function(){return this._position.y},set_y:function(t){return this._position.ignore_listeners=!0,this._position.set_y(t),this.refresh_transform(),this._position.ignore_listeners=!1,this._position.y},get_rotation:function(){return this._rotation},set_rotation:function(t){return this._rotation_radians=t*(Math.PI/180),this.refresh_transform(),this._rotation=t},get_scaleX:function(){return this._scaleX},set_scaleX:function(t){return this._scaleX=t,this._scale.set_x(this._scaleX),this.refresh_transform(),this._scaleX},get_scaleY:function(){return this._scaleY},set_scaleY:function(t){return this._scaleY=t,this._scale.set_y(this._scaleY),this.refresh_transform(),this._scaleY},_pos_changed:function(){this.refresh_transform()},__class__:$e,__properties__:{set_scaleY:"set_scaleY",get_scaleY:"get_scaleY",set_scaleX:"set_scaleX",get_scaleX:"get_scaleX",set_rotation:"set_rotation",get_rotation:"get_rotation",set_y:"set_y",get_y:"get_y",set_x:"set_x",get_x:"get_x",set_position:"set_position",get_position:"get_position"}};var ti=function(t,e,i){$e.call(this,t,e),this._radius=i,this.name="circle "+this._radius};n["luxe.collision.shapes.Circle"]=ti,ti.__name__=["luxe","collision","shapes","Circle"],ti.__super__=$e,ti.prototype=e($e.prototype,{test:function(t){return t.testCircle(this,!0)},testCircle:function(t,e){null==e&&(e=!1);var i;i=e?t:this;var s;return s=e?this:t,Je.testCircleVsCircle(i,s)},testPolygon:function(t,e){return null==e&&(e=!1),Je.testCircleVsPolygon(this,t,e)},testRay:function(t){return Je.testRayVsCircle(t,this)},get_radius:function(){return this._radius},get_transformedRadius:function(){return this._radius*this._scaleX},__class__:ti,__properties__:e($e.prototype.__properties__,{get_transformedRadius:"get_transformedRadius",get_radius:"get_radius"})});var ei=function(t,e,i){$e.call(this,t,e),this.name="polygon(sides:"+i.length+")",this._transformedVertices=[],this._vertices=i};n["luxe.collision.shapes.Polygon"]=ei,ei.__name__=["luxe","collision","shapes","Polygon"],ei.create=function(t,e,i,s){if(null==s&&(s=100),3>i)throw new ne("Polygon - Needs at least 3 sides");for(var n,r,o=2*Math.PI/i,a=[],h=0;i>h;){var l=h++;n=l*o+.5*(Math.PI-o),r=new un,r.set_x(Math.cos(n)*s),r.set_y(Math.sin(n)*s),a.push(r)}return new ei(t,e,a)},ei.rectangle=function(t,e,i,s,n){null==n&&(n=!0);var r=[];return n?(r.push(new un(-i/2,-s/2)),r.push(new un(i/2,-s/2)),r.push(new un(i/2,s/2)),r.push(new un(-i/2,s/2))):(r.push(new un(0,0)),r.push(new un(i,0)),r.push(new un(i,s)),r.push(new un(0,s))),new ei(t,e,r)},ei.square=function(t,e,i,s){return null==s&&(s=!0),ei.rectangle(t,e,i,i,s)},ei.triangle=function(t,e,i){return ei.create(t,e,3,i)},ei.__super__=$e,ei.prototype=e($e.prototype,{test:function(t){return t.testPolygon(this,!0)},testCircle:function(t,e){return null==e&&(e=!1),Je.testCircleVsPolygon(t,this,e)},testPolygon:function(t,e){return null==e&&(e=!1),Je.testPolygonVsPolygon(this,t,e)},testRay:function(t){return Je.testRayVsPolygon(t,this)},destroy:function(){for(var t=this._vertices.length,e=0;t>e;){var i=e++;this._vertices[i]=null}this._transformedVertices=null,this._vertices=null,$e.prototype.destroy.call(this)},get_transformedVertices:function(){if(!this._transformed){this._transformedVertices=[],this._transformed=!0;for(var t=this._vertices.length,e=0;t>e;){var i=e++;this._transformedVertices.push(this._vertices[i].clone().transform(this._transformMatrix))}}return this._transformedVertices},get_vertices:function(){return this._vertices},__class__:ei,__properties__:e($e.prototype.__properties__,{get_vertices:"get_vertices",get_transformedVertices:"get_transformedVertices"})});var ii=function(t,e,i){null==i&&(i=!0),this.start=t,this.end=e,this.infinite=i,this.dir_cache=new un(this.end.x-this.start.x,this.end.y-this.start.y)};n["luxe.collision.shapes.Ray"]=ii,ii.__name__=["luxe","collision","shapes","Ray"],ii.prototype={get_dir:function(){return this.dir_cache.set_x(this.end.x-this.start.x),this.dir_cache.set_y(this.end.y-this.start.y),this.dir_cache},__class__:ii,__properties__:{get_dir:"get_dir"}};var si=function(t){var e=new V;this.components=new Xi(e),this.entity=t};n["luxe.components.Components"]=si,si.__name__=["luxe","components","Components"],si.prototype={add:function(t){return null==t?(S.trace("attempt to add null component to "+this.entity.get_name(),{fileName:"Components.hx",lineNumber:28,className:"luxe.components.Components",methodName:"add"}),t):(t.set_entity(this.entity),this.components.set(t.name,t),t.onadded(),this.entity.inited&&t.init(),this.entity.started&&t.onreset(),t)},remove:function(t){if(!this.components.map.exists(t))return S.trace("attempt to remove "+t+" from "+this.entity.get_name()+" failed because that component was not attached to this entity",{fileName:"Components.hx",lineNumber:61,className:"luxe.components.Components",methodName:"remove"}),!1;var e=this.components.map.get(t);return e.onremoved(),e.set_entity(null),this.components.remove(t)},get:function(t,e){if(null==e&&(e=!1),e){var i=this.components.map.get(t);if(null!=i)return i;for(var s=0,n=this.entity.children;s<n.length;){var r=n[s];++s;var o=r._components.get(t,!0);if(null!=o)return o}return null}return this.components.map.get(t)},get_any:function(t,e,i){null==i&&(i=!0),null==e&&(e=!1);var s=[];if(!e)return[this.components.map.get(t)];var n=this.components.map.get(t);if(null!=n){if(i)return[n];s.push(n)}for(var r=0,o=this.entity.children;r<o.length;){var a=o[r];++r;var h=a._components.get_any(t,!0,i);if(null!=h){if(i&&h.length>0)return[h[0]];s.concat(h)}}return s},has:function(t){return this.components.map.exists(t)},__class__:si};var ni=function(){this.visible=!1,ce.call(this)};n["luxe.debug.DebugView"]=ni,ni.__name__=["luxe","debug","DebugView"],ni.__super__=ce,ni.prototype=e(ce.prototype,{refresh:function(){},process:function(){},onmousedown:function(){},onmousewheel:function(){},onmouseup:function(){},onmousemove:function(){},onkeydown:function(){},onkeyup:function(){},onwindowsized:function(){},create:function(){},show:function(){this.visible=!0},hide:function(){this.visible=!1},__class__:ni});var ri=function(){this.as_immediate=!1,this.dragging=!1,ni.call(this),this.set_name("Batcher Debug")};n["luxe.debug.BatcherDebugView"]=ri,ri.__name__=["luxe","debug","BatcherDebugView"],ri.__super__=ni,ri.prototype=e(ni.prototype,{create:function(){this.batcher=_.renderer.create_batcher({name:"debug_batcher_view",camera:new qs({camera_name:"batcher_debug_view"}),layer:1e3})},refresh:function(){this.clear_batcher_tree(),this.draw_batcher_tree()},onmousedown:function(t){this.dragmstart=t.pos.clone(),this.dragstart=this.batcher.view.get_pos().clone(),this.dragging=!0},onmouseup:function(){this.dragging=!1},onmousemove:function(t){if(this.dragging){var e=un.Subtract(t.pos,this.dragmstart);this.batcher.view.set_pos(un.Subtract(this.dragstart,e))}},onmousewheel:function(t){if(t.y<0){var e=this.batcher.view;e.set_zoom(e.zoom-.1)}else{var i=this.batcher.view;i.set_zoom(i.zoom+.1)}},clear_batcher_tree:function(){null!=this._tree_geom&&(this._tree_geom.drop(),this._tree_geom=null)},keystr:function(t){return"ts: "+t.timestamp+"\nseq: "+t.sequence+"\nprimitive_type: "+t.primitive_type+" "+t.primitive_type+"\ntexture: "+(null==t.texture?"null":v.string(t.texture.texture))+"\ntexture id: "+(null==t.texture?"null":t.texture.id)+"\nshader: "+(null==t.shader?"null":t.shader.id)+"\ngroup: "+t.group+"\ndepth: "+t.depth+"\nclip: "+(null==t.clip?"null":""+t.clip)},draw_geom_node:function(t,e,i,s){null==s&&(s=20);var n=128,r=n/2,o=128,a=e.value,h=new ai(1,1,1,.4).rgb(16777215);a.dropped&&(h=new ai(1,1,1,1).rgb(13369344)),this._tree_geom.add_geometry(_.draw.rectangle({immediate:this.as_immediate,x:i.x-r,y:i.y,w:n,h:o,color:h,batcher:this.batcher,depth:999.4})),this._tree_geom.add_geometry(_.draw.text({immediate:this.as_immediate,bounds:new $s(i.x-r,i.y,n,o),point_size:13,color:h,batcher:this.batcher,depth:999.4,text:this.keystr(e.key,a.key),align:2,align_vertical:2}));var l=new un(i.x,i.y,i.z,i.w).set_xy(i.x,i.y-16),u=new un(i.x,i.y,i.z,i.w).set_xy(i.x,i.y+n+2),c=2;this._tree_geom.add_geometry(_.draw.text({immediate:this.as_immediate,pos:l,point_size:13,color:h,batcher:this.batcher,depth:999.4,text:a.id,align:c}));var d=new ai(1,1,1,.4).rgb(16750916),f="none",p="none";if(null!=e.left){f="node";var m=_.renderer.batcher.compare_rule(e.key,e.left.key);f=_.renderer.batcher.compare_rule_to_string(m)}if(null!=e.right){p="node";var g=_.renderer.batcher.compare_rule(e.key,e.right.key);p=_.renderer.batcher.compare_rule_to_string(g)}this._tree_geom.add_geometry(_.draw.text({immediate:this.as_immediate,pos:u,point_size:13,color:d,batcher:this.batcher,depth:999.4,text:f+" / "+p,align:c}))},draw_geom_leaf:function(t,e,i){if(null!=e){var s=e.nodecount/20,n=25*e.nodecount,r=128,o=148,a=s/2,h=new ai(1,1,1,.4).rgb(16777215);null!=e&&(this.draw_geom_node(t,e,i,s),null!=e.left&&(h=new ai(1,1,1,1).rgb(_.renderer.batcher.geometry_compare(e.left.key,e.key)<0?52224:13369344),this._tree_geom.add_geometry(_.draw.line({immediate:this.as_immediate,p0:new un(i.x-a,i.y+r),p1:new un(i.x-n,i.y+o),color:h,batcher:this.batcher,depth:999.4})),this.draw_geom_leaf(!0,e.left,new un(i.x-n,i.y+o))),null!=e.right&&(h=new ai(1,1,1,1).rgb(_.renderer.batcher.geometry_compare(e.right.key,e.key)>0?52224:13369344),this._tree_geom.add_geometry(_.draw.line({immediate:this.as_immediate,p0:new un(i.x+a,i.y+r),p1:new un(i.x+n,i.y+o),color:h,batcher:this.batcher,depth:999.4})),this.draw_geom_leaf(!1,e.right,new un(i.x+n,i.y+o))))}},draw_batcher_tree:function(){this._tree_geom=null,this._tree_geom=new gn({batcher:this.batcher,immediate:this.as_immediate,depth:999.4});var t=new un(_.core.screen.get_w()/2,2*_.debug.padding.y+10),e=_.renderer.batcher.geometry.root;this.draw_geom_leaf(!0,e,t)},process:function(){this.visible&&_.renderer.batcher.tree_changed&&this.refresh()},show:function(){ni.prototype.show.call(this),this.refresh()},hide:function(){ni.prototype.hide.call(this),this.clear_batcher_tree()},__class__:ri});var oi=function(t){this.title="Inspector",this.font=_.renderer.font,this.set_size(new un(v["int"](.2*_.core.screen.get_w()),v["int"](.6*_.core.screen.get_h()))),this.set_pos(new un(_.core.screen.get_w()/2-this.size.x/2,_.core.screen.get_h()/2-this.size.y/2)),this._batcher=_.renderer.batcher,null!=t&&(null!=t.title&&(this.title=t.title),null!=t.font&&(this.font=t.font),null!=t.pos&&this.set_pos(t.pos),null!=t.size&&this.set_size(t.size),null!=t.batcher&&(this._batcher=t.batcher))};n["luxe.debug.Inspector"]=oi,oi.__name__=["luxe","debug","Inspector"],oi.prototype={refresh:function(){null==this._window&&this._create_window(),null!=this.onrefresh&&this.onrefresh()},show:function(){this.refresh(),this._window.set_visible(!0),this._title_text.set_visible(!0),this._version_text.set_visible(!0)},hide:function(){this._window.set_visible(!1),this._title_text.set_visible(!1),this._version_text.set_visible(!1)},set_size:function(t){return null!=this.size&&null!=this._window&&(this._window.set_size(t),this._window.geometry.set_dirty(!0)),null!=this._version_text&&this._version_text.set_pos(new un(this.pos.x+(t.x-14),this.pos.y+6)),this.size=t},set_pos:function(t){return null!=this.pos&&null!=this._window&&(this._window.set_pos(t),this._window.geometry.set_dirty(!0)),null!=this._title_text&&this._title_text.set_pos(new un(t.x+14,t.y+6)),null!=this._version_text&&this._version_text.set_pos(new un(t.x+(this.size.x-14),t.y+6)),this.pos=t},_create_window:function(){null!=this._window&&this._window.destroy(),this._window=new Ve({centered:!1,depth:999.1,color:(new ai).rgb(1447449),size:this.size,pos:this.pos,no_scene:!0,batcher:this._batcher}),this._window.geometry.id="debug.Inspector",this._window.set_locked(!0),this._title_text=new qe({name:"debug.title",batcher:this._batcher,no_scene:!0,depth:999.2,color:(new ai).rgb(16121979),pos:new un(this.pos.x+14,this.pos.y+6),align:0,font:this.font,text:this.title,point_size:15,visible:!1}),this._version_text=new qe({name:"debug.version",batcher:this._batcher,no_scene:!0,depth:999.2,color:(new ai).rgb(5526617),pos:new un(this.pos.x+(this.size.x-14),this.pos.y+6),align:1,font:this.font,text:""+_.core.runtime_info(),point_size:13,visible:!1}),null!=this._title_text.geometry&&(this._title_text.geometry.id="debug.title.text"),null!=this._version_text.geometry&&(this._version_text.geometry.id="debug.version.text")
},__class__:oi,__properties__:{set_size:"set_size",set_pos:"set_pos"}};var ai=function(t,e,i,s){null==s&&(s=1),null==i&&(i=1),null==e&&(e=1),null==t&&(t=1),this.refreshing=!1,this.is_hsv=!1,this.is_hsl=!1,this.a=1,this.b=1,this.g=1,this.r=1,this.set_r(t),this.set_g(e),this.set_b(i),this.a=s};n["phoenix.Color"]=ai,ai.__name__=["phoenix","Color"],ai.random=function(t){return null==t&&(t=!1),new ai(Math.random(),Math.random(),Math.random(),t?Math.random():1)},ai.prototype={set_r:function(t){if(this.r=t,!this.refreshing)if(this.is_hsl){var e=this;e.fromColor(this)}else if(this.is_hsv){var i=this;i.fromColor(this)}return this.r},set_g:function(t){if(this.g=t,!this.refreshing)if(this.is_hsl){var e=this;e.fromColor(this)}else if(this.is_hsv){var i=this;i.fromColor(this)}return this.g},set_b:function(t){if(this.b=t,!this.refreshing)if(this.is_hsl){var e=this;e.fromColor(this)}else if(this.is_hsv){var i=this;i.fromColor(this)}return this.b},set:function(t,e,i,s){var n=this.r,r=this.g,o=this.b,a=this.a;return null!=t&&(n=t),null!=e&&(r=e),null!=i&&(o=i),null!=s&&(a=s),this.set_r(n),this.set_g(r),this.set_b(o),this.a=a,this},maxRGB:function(){return Math.max(this.r,Math.max(this.g,this.b))},minRGB:function(){return Math.min(this.r,Math.min(this.g,this.b))},tween:function(t,e,i){if(null==i&&(i=!0),null==t&&(t=.5),null!=e){var s=this.r,n=this.g,r=this.b,o=this.a,a=!1,h=!1,l=!1,_=!1;re.__instanceof(e,ai)?(s=e.r,n=e.g,r=e.b,o=e.a,a=!0,h=!0,l=!0,_=!0):(null!=e.r&&(s=e.r,a=!0),null!=e.g&&(n=e.g,h=!0),null!=e.b&&(r=e.b,l=!0),null!=e.a&&(o=e.a,_=!0));var u={};return a&&(u.r=s),h&&(u.g=n),l&&(u.b=r),_&&(u.a=o),hs.tween(this,t,u,i)}throw new ne(" Warning: Color.tween passed a null destination ")},clone:function(){return new ai(this.r,this.g,this.b,this.a)},rgb:function(t){return null==t&&(t=16777215),this.from_int(t),this},toColorHSL:function(){return(new Hs).fromColor(this)},toColorHSV:function(){return(new Ks).fromColor(this)},fromColorHSV:function(t){var e=t.h%360/60;0>e&&(e+=6);var i=Math.floor(e),s=i%6,n=e-i,r=t.v,o=t.v*(1-t.s),a=t.v*(1-n*t.s),h=t.v*(1-(1-n)*t.s);switch(s){case 0:this.set_r(r),this.set_g(h),this.set_b(o);break;case 1:this.set_r(a),this.set_g(r),this.set_b(o);break;case 2:this.set_r(o),this.set_g(r),this.set_b(h);break;case 3:this.set_r(o),this.set_g(a),this.set_b(r);break;case 4:this.set_r(h),this.set_g(o),this.set_b(r);break;case 5:this.set_r(r),this.set_g(o),this.set_b(a)}this.a=t.a},fromColorHSL:function(t){var e=1;e=t.l<.5?t.l*(1+t.s):t.l+t.s-t.l*t.s;for(var i=2*t.l-e,s=t.h%360/360,n=s+.3333333333333333,r=s,o=s-.3333333333333333,a=[n,r,o],h=0,l=a.length;l>h;){var _=h++,u=a[_];0>u&&(u+=1),u>1&&(u-=1),a[_]=.16666666666666666>u?i+6*(e-i)*u:.5>u?e:.6666666666666666>u?i+6*(e-i)*(.6666666666666666-u):i}return this.set_r(a[0]),this.set_g(a[1]),this.set_b(a[2]),this.a=t.a,this},toString:function(){return"{ r:"+this.r+" , g:"+this.g+" , b:"+this.b+" , a:"+this.a+" }"},from_int:function(t){var e=t>>16,i=t>>8&255,s=255&t;this.set_r(e/255),this.set_g(i/255),this.set_b(s/255)},__class__:ai,__properties__:{set_b:"set_b",set_g:"set_g",set_r:"set_r"}};var hi=function(){this._setup=!1,this._byte_levels=["bytes","Kb","MB","GB","TB"],this.minpeak=1,this.peak=1,this.nexttick=0,this.tickamount=.017,this.margin=32,ni.call(this),this.set_name("Profiler"),hi.lists=new V};n["luxe.debug.ProfilerDebugView"]=hi,hi.__name__=["luxe","debug","ProfilerDebugView"],hi.add_offset=function(t,e){var i=hi.lists.get(t),s=hi.lists.get(e);null!=i&&null!=s?i.offsets.push(s):(S.trace("not found for "+t+" or "+e,{fileName:"ProfilerDebugView.hx",lineNumber:158,className:"luxe.debug.ProfilerDebugView",methodName:"add_offset"}),S.trace(v.string(i)+" / "+v.string(s),{fileName:"ProfilerDebugView.hx",lineNumber:159,className:"luxe.debug.ProfilerDebugView",methodName:"add_offset"}))},hi.hide_item=function(t){var e=hi.lists.get(t);null!=e&&(e.hidden=!0,e.bar.hide())},hi.show_item=function(t){var e=hi.lists.get(t);null!=e&&(e.hidden=!1,e.bar.show())},hi.start=function(t,e){var i=hi.lists.get(t);null==i&&(i=new li(t,new ui(t,e,(new ai).rgb(16121979))),i.bar.set_pos(new un(2*_.debug.padding.x,3*_.debug.padding.y+20*h.count(hi.lists))),hi.lists.set(t,i)),i.start=Nn.core.timestamp()},hi.end=function(t){var e=hi.lists.get(t);if(null==e)throw new ne("Debug / profile end called for "+t+" but no start called");e.set()},hi.__super__=ni,hi.prototype=e(ni.prototype,{create:function(){},update_graph:function(t,e){var i=Math.floor(Math.log(e)/Math.log(1024)),s=e/Math.pow(1024,i);s>this.peak&&(this.peak=Math.ceil(s+.1*s)),s<this.minpeak&&(this.minpeak=Math.floor(s-.1*s)),t.max!=this.peak&&t.set_max(this.peak),t.set_ping(Es.fixed(s,4))},process:function(){},show:function(){for(var t=hi.lists.iterator();t.hasNext();){var e=t.next();e.hidden||e.bar.show()}this._setup||(this._setup=!0)},hide:function(){for(var t=hi.lists.iterator();t.hasNext();){var e=t.next();e.bar.hide()}},__class__:hi});var li=function(t,e){this.accum=0,this.count=0,this.hidden=!1,this.avg=10,this.start=0,this.name=t,this.bar=e,this.history=[],this.offsets=[]};n["luxe.debug._ProfilerDebugView.ProfilerValue"]=li,li.__name__=["luxe","debug","_ProfilerDebugView","ProfilerValue"],li.prototype={set:function(){for(var t=Nn.core.timestamp()-this.start,e=0,i=this.offsets;e<i.length;){var s=i[e];++e,t-=s.history[s.history.length-1]}if(this.history.push(t),this.history.length>this.avg&&this.history.shift(),this.count++,this.count==this.avg){var n=this.accum/this.avg;this.bar.set_value(n),this.accum=0,this.count=0}this.accum+=t,this.bar.visible&&this.bar.set_text(v.string(Es.fixed(1e3*t,4)))},__class__:li};var _i=function(t,e){null==e&&(e=!0),this.visible=!1,this.history=33,this.height2=8,this.height=8,this.width=128,this.bg=!0,this.bg=e,this.name=t,this.color=new ai,this.set_max(Es.fixed(16.666666666666668,2))};n["luxe.debug._ProfilerDebugView.ProfilerGraph"]=_i,_i.__name__=["luxe","debug","_ProfilerDebugView","ProfilerGraph"],_i.prototype={create:function(){this.segment=this.width/this.history,this.height2=2*this.height,this.bg&&(this.graphbg_geometry=_.draw.box({color:(new ai).rgb(1052688),depth:999.3,batcher:_.debug.batcher,x:0,y:0,w:this.width-this.segment,h:this.height2})),this.graph_geometry=new dn({color:this.color,depth:999.33,batcher:_.debug.batcher});for(var t=0,e=this.history;e>t;){var i=t++,s=new Tn(new un(this.segment*i,this.height2),this.color);this.graph_geometry.add(s)}this.graph_geometry.set_primitive_type(3),this.hide()},set_max:function(t){var e=this.max;if(this.max=t,null!=this.graph_geometry){var i=1;0!=e&&(i=e/t);for(var s=0,n=this.graph_geometry.vertices;s<n.length;){var r=n[s];if(++s,null!=r){var o=1-r.pos.y/this.height2,a=o*e;o=a/this.max,r.pos.set_y(this.height2*(1-o))}}}return this.max},set_ping:function(t){for(var e=Es.fixed(t,4),i=e/this.max,s=0,n=this.history;n>s;){var r=s++,o=this.graph_geometry.vertices[r];if(r<this.history-1){var a=this.graph_geometry.vertices[r+1];null!=a&&(o.pos.set_y(Math.floor(a.pos.y)),o.color=a.color)}}return i=.001>i?.001:i>1?1:i,this.graph_geometry.vertices[this.history-1].color=i>1?hi.color_red:.2>i?hi.color_green:this.color,this.graph_geometry.vertices[this.history-1].pos.set_y(Math.floor(this.height2*(1-i))),this.ping=t},hide:function(){this.visible=!1,this.graph_geometry.set_visible(!1),null!=this.graphbg_geometry&&this.graphbg_geometry.set_visible(!1)},show:function(){this.visible=!0,this.graph_geometry.set_visible(!0),null!=this.graphbg_geometry&&this.graphbg_geometry.set_visible(!0)},set_pos:function(t){return null!=this.graphbg_geometry&&this.graphbg_geometry.transform.local.pos.copy_from(t),this.graph_geometry.transform.local.pos.copy_from(t),this.pos=t},__class__:_i,__properties__:{set_pos:"set_pos",set_ping:"set_ping",set_max:"set_max"}};var ui=function(t,e,i){this.max=16.7,this.height=8,this.visible=!1,this.name=t,this.graph=new _i(t),this.graph.create(),null!=e&&this.graph.set_max(e),this.text_item=new qe({no_scene:!0,name:"profiler.text."+t,pos:new un(0,0),color:i,point_size:1.8*this.height,depth:999.3,text:"",batcher:_.debug.batcher}),this.bg_geometry=_.draw.box({color:(new ai).rgb(592137),depth:999.3,batcher:_.debug.batcher,x:0,y:0,w:this.graph.width,h:this.graph.height}),this.bar_geometry=_.draw.box({color:i,depth:999.33,batcher:_.debug.batcher,x:1,y:1,w:this.graph.width-2,h:this.graph.height-2}),this.hide()};n["luxe.debug._ProfilerDebugView.ProfilerBar"]=ui,ui.__name__=["luxe","debug","_ProfilerDebugView","ProfilerBar"],ui.prototype={hide:function(){this.visible=!1,this.bar_geometry.set_visible(!1),this.bg_geometry.set_visible(!1),this.text_item.set_visible(!1),this.graph.hide()},show:function(){this.visible=!0,this.bar_geometry.set_visible(!0),this.bg_geometry.set_visible(!0),this.text_item.set_visible(!0),this.graph.show()},set_value:function(t){if(this.graph.set_ping(1e3*t),!this.visible)return this.value=t;var e=Es.fixed(1e3*t,4),i=e/this.max;i=.005>i?.005:i>1?1:i,this.bar_geometry.set_color(i>1?hi.color_red:.15>i?hi.color_green:hi.color_normal);var s=(this.graph.width-2)*i;return this.bar_geometry.resize_xy(s,this.graph.height-2),this.value=t},set_pos:function(t){return this.bg_geometry.transform.local.set_pos(t),this.bar_geometry.transform.local.pos.set_xy(t.x+1,t.y+1),this.text_item.get_pos().set_xy(t.x+2*this.graph.width+10,t.y-6),this.graph.set_pos(new un(t.x,t.y,t.z,t.w).add_xyz(this.graph.width+2,-this.graph.height+4,null)),this.pos=t},set_text:function(t){return this.text_item.set_text(""+this.name+" ("+this.graph.max+"ms) | "+t+"ms"),this.text=t},__class__:ui,__properties__:{set_value:"set_value",set_pos:"set_pos",set_text:"set_text"}};var ci=function(){this.hide_ids=!0,this.font_size=15,this.margin=32,ni.call(this),this.set_name("Scenes"),this.scenes=[]};n["luxe.debug.SceneDebugView"]=ci,ci.__name__=["luxe","debug","SceneDebugView"],ci.__super__=ni,ci.prototype=e(ni.prototype,{create:function(){var t=_.debug;this.items_list=new qe({name:"debug.scene.list",depth:999.3,no_scene:!0,color:new ai(0,0,0,1).rgb(16121979),pos:new un(0,0),font:_.renderer.font,text:this.get_list(),point_size:this.font_size,batcher:t.batcher,visible:!1}),this.items_list.geometry.id="debug.scene.list.geometry",this.resize()},add_scene:function(t){if(-1!=a.indexOf(this.scenes,t,0))throw new ne(Re.assertion("scenes.indexOf(_scene) == -1"));this.scenes.push(t)},remove_scene:function(t){if(-1==a.indexOf(this.scenes,t,0))throw new ne(Re.assertion("scenes.indexOf(_scene) != -1"));var e=a.remove(this.scenes,t);return this.refresh(),e},onkeydown:function(t){t.keycode==Wn.key_2&&this.visible&&this.toggle_ids()},toggle_ids:function(){this.hide_ids=!this.hide_ids,this.refresh()},tabs:function(t){for(var e="",i=0;t>i;){{i++}e+="    "}return e},list_entity:function(t,e,i){null==i&&(i=1);var s;s=e.get_active()?"":"/ inactive";var n;n=1==i?this.tabs(i):this.tabs(i)+"> ";var r;r=this.hide_ids?"":e.get_id();var o=h.count(e._components.components),l=" "+o,_="> "+e.children.length;t+=""+n+r+" "+e.get_name()+" "+_+" "+l+" "+s+"\n";for(var u=a.iter(e._components.components._keys);u.hasNext();){var c,d=u.next(),f=e._components.components.map.get(d);c=this.hide_ids?"":" "+f.id,t+=this.tabs(i+1)+(""+c+" "+f.name+"\n")}for(var p=0,m=e.children;p<m.length;){var g=m[p];++p,t=this.list_entity(t,g,i+2)}return t},get_list:function(){for(var t="",e=0,i=this.scenes;e<i.length;){var s=i[e];++e;var n;n=this.hide_ids?"":""+s.get_id()+" ",t+=n,t+=""+s.get_name()+" ",t+="( "+s.get_length()+" )\n";for(var r=s.entities.iterator();r.hasNext();){var o=r.next();t=this.list_entity(t,o,null)}}return t},refresh:function(){this.items_list.set_text(this.get_list())},process:function(){if(this.visible){for(var t=!1,e=0,i=this.scenes;e<i.length;){var s=i[e];++e,s._has_changed&&(t=!0,s._has_changed=!1)}t&&this.refresh()}},onmousewheel:function(t){var e=this.items_list.text_bounds.h,i=_.debug.debug_inspector.size.y-this.margin,s=e-i,n=this.items_list.get_pos().y,r=_.debug.padding.y+1.5*this.margin,o=r;s>0&&(o=r-(s+2*this.margin)),n-=this.margin/2*t.y,n=o>n?o:n>r?r:n,this.items_list.get_pos().set_y(n)},show:function(){ni.prototype.show.call(this),this.refresh(),this.items_list.set_visible(!0)},hide:function(){ni.prototype.hide.call(this),this.items_list.set_visible(!1)},resize:function(){var t=_.debug,e=new $s(t.debug_inspector.pos.x+this.margin/2,t.debug_inspector.pos.y+1.5*this.margin,t.debug_inspector.size.x-this.margin,t.debug_inspector.size.y-this.margin-1.5*this.margin),i=t.padding.x+this.margin,s=t.padding.y+1.5*this.margin;null!=this.items_list&&(this.items_list.set_pos(new un(i,s)),this.items_list.set_clip_rect(e))},onwindowsized:function(){this.resize()},__class__:ci});var di=function(){this.hide_debug=!0,this.margin=32,this.font_size=15,this.debug_geometry_count=13,this.debug_draw_call_count=3,ni.call(this),this.set_name("Statistics"),this._last_render_stats={batchers:0,geometry_count:0,dynamic_batched_count:0,static_batched_count:0,visible_count:0,draw_calls:0,vert_count:0,group_count:0},this._render_stats={batchers:0,geometry_count:0,dynamic_batched_count:0,static_batched_count:0,visible_count:0,draw_calls:0,vert_count:0,group_count:0}};n["luxe.debug.StatsDebugView"]=di,di.__name__=["luxe","debug","StatsDebugView"],di.__super__=ni,di.prototype=e(ni.prototype,{get_resource_stats_string:function(){return v.string(_.resources.stats)},get_render_stats_string:function(){return"Renderer Statistics\n\nbatcher count : "+this._render_stats.batchers+"\ntotal geometry : "+this._render_stats.geometry_count+"\nvisible geometry : "+this._render_stats.visible_count+"\ndynamic batch count : "+this._render_stats.dynamic_batched_count+"\nstatic batch count : "+this._render_stats.static_batched_count+"\ntotal draw calls : "+this._render_stats.draw_calls+"\ntotal vert count : "+this._render_stats.vert_count},create:function(){var t=this,e=_.debug;this.render_stats_text=new qe({name:"debug.render.stats",depth:999.3,no_scene:!0,color:new ai(0,0,0,1).rgb(16121979),pos:new un(0,0),font:_.renderer.font,text:this.get_render_stats_string(),point_size:this.font_size,batcher:e.batcher,visible:!1}),this.resource_list_text=new qe({name:"debug.resource.stats",depth:999.3,no_scene:!0,color:new ai(0,0,0,1).rgb(16121979),pos:new un(0,0),font:_.renderer.font,text:"",align:1,point_size:.9*this.font_size,batcher:e.batcher,visible:!1}),this.render_stats_text.geometry.id="debug.render.stats.geometry",this.render_stats_text.geometry.id="debug.resource.stats.geometry",this.resize(),_.resources.on(1,function(){t.visible&&t.refresh()})},resize:function(){if(null!=this.resource_list_text&&null!=this.render_stats_text){{var t=_.debug,e=new $s(t.debug_inspector.pos.x+this.margin/2,t.debug_inspector.pos.y+1.5*this.margin,t.debug_inspector.size.x-this.margin,t.debug_inspector.size.y-this.margin-1.5*this.margin),i=t.padding.x+this.margin,s=t.padding.x+t.debug_inspector.size.x-this.margin,n=t.padding.y+1.5*this.margin;this.render_stats_text.text_bounds.w,this.render_stats_text.text_bounds.h}null!=this.resource_list_text&&(this.resource_list_text.set_pos(new un(s,n)),this.resource_list_text.set_clip_rect(e)),null!=this.render_stats_text&&(this.render_stats_text.set_pos(new un(i,n)),this.render_stats_text.set_clip_rect(e)),this.reset_tween()}},onwindowsized:function(){this.resize()},refresh:function(){for(var t="",e="",i="",s="",n="",r="",o="",a=_.resources.cache.iterator();a.hasNext();){var l=a.next(),u=l.resource_type;switch(u){case 3:t+=""+l.id+"  "+l.ref+"	\n";break;case 1:e+=""+l.id+"  "+l.ref+"	\n";break;case 2:i+=""+l.id+"  "+l.ref+"	\n";break;case 4:var c=l;s+="("+c.width_actual+"x"+c.height_actual+" ~"+_.utils.bytes_to_string(c.memory_use())+")    "+c.id+"  "+c.ref+"	\n";break;case 5:var d=l;n+="("+d.width_actual+"x"+d.height_actual+" ~"+_.utils.bytes_to_string(d.memory_use())+")    "+d.id+"  "+d.ref+"	\n";break;case 6:r+=""+l.id+"  "+l.ref+"	\n";break;case 7:var f=l;o+="("+f.vert_id+", "+f.frag_id+")    "+f.id+"  "+f.ref+"	\n"}}var p="Resource list ("+_.resources.stats.total+")\n\n";p+="Bytes ("+_.resources.stats.bytes+")\n",p+=""==t?"-	\n":t,p+="\nText ("+_.resources.stats.texts+")\n",p+=""==e?"-	\n":e,p+="\nJSON ("+_.resources.stats.jsons+")\n",p+=""==i?"-	\n":i,p+="\nTexture ("+_.resources.stats.textures+")\n",p+=""==s?"-	\n":s,p+="\nRenderTexture ("+_.resources.stats.render_textures+")\n",p+=""==n?"-	\n":n,p+="\nFont ("+_.resources.stats.fonts+")\n",p+=""==r?"-	\n":r,p+="\nShader ("+_.resources.stats.shaders+")\n",p+=""==o?"-	\n":o;for(var m="",g=[],v=_.core.app.audio.sound_list.iterator();v.hasNext();){var y=v.next();g.push(y.name)}g.sort(function(t,e){return t==e?0:e>t?-1:1});for(var w=0;w<g.length;){var x=g[w];++w,m+=""+x+" \n"}p+="\n\n---\nAudio list ("+h.count(_.core.app.audio.sound_list)+")\n\n",p+=""==m?"-	\n":m,this.resource_list_text.set_text(p),null!=this.resource_list_text.geometry&&this.resource_list_text.geometry.set_dirty(!0),this.reset_tween()},process:function(){if(this.visible){var t=!1;this.update_render_stats(),this._last_render_stats.batchers!=this._render_stats.batchers&&(t=!0,this._last_render_stats.batchers=this._render_stats.batchers),this._last_render_stats.geometry_count!=this._render_stats.geometry_count&&(t=!0,this._last_render_stats.geometry_count=this._render_stats.geometry_count),this._last_render_stats.dynamic_batched_count!=this._render_stats.dynamic_batched_count&&(t=!0,this._last_render_stats.dynamic_batched_count=this._render_stats.dynamic_batched_count),this._last_render_stats.static_batched_count!=this._render_stats.static_batched_count&&(t=!0,this._last_render_stats.static_batched_count=this._render_stats.static_batched_count),this._last_render_stats.visible_count!=this._render_stats.visible_count&&(t=!0,this._last_render_stats.visible_count=this._render_stats.visible_count),this._last_render_stats.draw_calls!=this._render_stats.draw_calls&&(t=!0,this._last_render_stats.draw_calls=this._render_stats.draw_calls),this._last_render_stats.group_count!=this._render_stats.group_count&&(t=!0,this._last_render_stats.group_count=this._render_stats.group_count),this._last_render_stats.vert_count!=this._render_stats.vert_count&&(t=!0,this._last_render_stats.vert_count=this._render_stats.vert_count),t&&this.refresh_render_stats()}},onmousewheel:function(t){hs.stop(this.resource_list_text.get_pos());var e=this.resource_list_text.text_bounds.h,i=_.debug.debug_inspector.size.y-this.margin,s=e-i,n=this.resource_list_text.get_pos().y,r=_.debug.padding.y+1.5*this.margin,o=r;s>0&&(o=r-(s+2*this.margin)),n-=this.margin/2*t.y,n=o>n?o:n>r?r:n,this.resource_list_text.get_pos().set_y(n)},onkeydown:function(t){t.keycode==Wn.key_2&&this.visible&&this.toggle_debug_stats()},show:function(){ni.prototype.show.call(this),this.refresh(),this.render_stats_text.set_visible(!0),this.resource_list_text.set_visible(!0)},hide:function(){ni.prototype.hide.call(this),this.render_stats_text.set_visible(!1),this.resource_list_text.set_visible(!1),hs.stop(this.resource_list_text.get_pos())},reset_tween:function(){hs.stop(this.resource_list_text.get_pos());var t=this.resource_list_text.text_bounds.h,e=_.debug.debug_inspector.size.y-this.margin,i=t-e,s=_.debug.padding.y+1.5*this.margin;if(this.resource_list_text.get_pos().set_y(s),i>0){var n=s-(i+2*this.margin);hs.tween(this.resource_list_text.get_pos(),8,{y:n}).repeat().delay(4).reflect().ease(ws.get_easeNone())}},refresh_render_stats:function(){this.visible&&(this.render_stats_text.set_text(this.get_render_stats_string()),this.render_stats_text.set_locked(!0),null!=this.render_stats_text.geometry&&this.render_stats_text.geometry.set_dirty(!0))},toggle_debug_stats:function(){this.hide_debug=!this.hide_debug},update_render_stats:function(){this.debug_geometry_count=_.debug.batcher.geometry.size(),this.debug_draw_call_count=_.debug.batcher.draw_calls,this._render_stats.batchers=_.renderer.stats.batchers,this._render_stats.geometry_count=_.renderer.stats.geometry_count,this._render_stats.visible_count=_.renderer.stats.visible_count,this._render_stats.dynamic_batched_count=_.renderer.stats.dynamic_batched_count,this._render_stats.static_batched_count=_.renderer.stats.static_batched_count,this._render_stats.draw_calls=_.renderer.stats.draw_calls,this._render_stats.vert_count=_.renderer.stats.vert_count,this.hide_debug&&(this._render_stats.batchers=this._render_stats.batchers-1,this._render_stats.geometry_count=this._render_stats.geometry_count-this.debug_geometry_count,this._render_stats.visible_count=this._render_stats.visible_count-_.debug.batcher.visible_count,this._render_stats.dynamic_batched_count=this._render_stats.dynamic_batched_count-_.debug.batcher.dynamic_batched_count,this._render_stats.static_batched_count=this._render_stats.static_batched_count-_.debug.batcher.static_batched_count,this._render_stats.draw_calls-=this.debug_draw_call_count,this._render_stats.vert_count-=_.debug.batcher.vert_count)},__class__:di});var fi=function(){this._last_logged_length=0,this.max_lines=35,ni.call(this),this.set_name("Log"),_.debug.add_trace_listener("TraceDebugView",s(this,this.on_trace)),this.logged=[],this.add_line("luxe version "+_.build)};n["luxe.debug.TraceDebugView"]=fi,fi.__name__=["luxe","debug","TraceDebugView"],fi.__super__=ni,fi.prototype=e(ni.prototype,{on_trace:function(t,e){this.add_line(e.fileName+":"+e.lineNumber+" "+v.string(t))},create:function(){var t=_.debug,e=new $s(t.padding.x+20,t.padding.y+40,_.core.screen.get_w()-2*t.padding.x-20,_.core.screen.get_h()-2*t.padding.y-40);this.lines=new qe({name:"debug.log.text",no_scene:!0,depth:999.3,color:(new ai).rgb(8947848),bounds:e,bounds_wrap:!0,font:_.renderer.font,text:"",align_vertical:4,point_size:12,batcher:t.batcher,visible:!1}),null!=this.lines.geometry&&(this.lines.geometry.set_clip_rect(e),this.lines.geometry.set_locked(!0),this.lines.geometry.id="debug.log.text.geometry")},onwindowsized:function(){var t=_.debug,e=new $s(t.padding.x+20,t.padding.y+40,_.core.screen.get_w()-2*t.padding.x-20,_.core.screen.get_h()-2*t.padding.y-40);this.lines.set_bounds(e),this.lines.set_clip_rect(e),null!=this.lines.geometry&&(this.lines.geometry.set_locked(!0),this.lines.geometry.set_dirty(!0))},add_line:function(t){null!=this.logged&&(this.logged.push(t),this.visible&&this.refresh_lines())},refresh_lines:function(){if(this._last_logged_length!=this.logged.length){var t="";if(this.logged.length<=this.max_lines)for(var e=0,i=this.logged;e<i.length;){var s=i[e];++e,t+=s+"\n"}else for(var n=this.logged.length-this.max_lines,r=(this.logged.length,n),o=this.logged.length;o>r;){var a=r++,h=this.logged[a];t+=h+"\n"}this.lines.set_text(t),null!=this.lines.geometry&&(this.lines.geometry.set_locked(!0),this.lines.geometry.set_dirty(!0)),this._last_logged_length=this.logged.length}},refresh:function(){},process:function(){},show:function(){ni.prototype.show.call(this),this.refresh_lines(),this.lines.set_visible(!0)},hide:function(){ni.prototype.hide.call(this),this.lines.set_visible(!1)},__class__:fi});var pi=function(){};n["luxe.importers.bitmapfont.BitmapFontParser"]=pi,pi.__name__=["luxe","importers","bitmapfont","BitmapFontParser"],pi.parse=function(t){if(0==t.length)throw new ne("BitmapFont:Parser: _font_data is 0 length");var e={face:null,chars:new U,point_size:0,base_size:0,char_count:0,line_height:0,pages:[],kernings:new U},i=t.split("\n");if(0==i.length)throw new ne("BitmapFont; invalid font data specified for parser.");var s=i[0];if("info"!=function(){var t,e=w.ltrim(s);return t=a.substr(e,0,4)}(this))throw new ne("BitmapFont; invalid font data specified for parser. Format should be plain ascii text .fnt file only currently.");for(var n=0;n<i.length;){var r=i[n];++n;for(var o=r.split(" "),h=0;h<o.length;){var l=o[h];++h,pi.parse_token(l,o,e)}}return e},pi.parse_token=function(t,e,i){e.shift();var s=pi.tokenize_line(e);switch(t){case"info":i.face=pi.unquote(null!=Ar.face?s.getReserved("face"):s.h.face),i.point_size=v.parseFloat(null!=Ar.size?s.getReserved("size"):s.h.size);break;case"common":i.line_height=v.parseFloat(null!=Ar.lineHeight?s.getReserved("lineHeight"):s.h.lineHeight),i.base_size=v.parseFloat(null!=Ar.base?s.getReserved("base"):s.h.base);break;case"page":i.pages.push({id:v.parseInt(null!=Ar.id?s.getReserved("id"):s.h.id),file:pi.trim(pi.unquote(null!=Ar.file?s.getReserved("file"):s.h.file))});break;case"chars":i.char_count=v.parseInt(null!=Ar.count?s.getReserved("count"):s.h.count);break;case"char":var n={id:v.parseInt(null!=Ar.id?s.getReserved("id"):s.h.id),x:v.parseFloat(null!=Ar.x?s.getReserved("x"):s.h.x),y:v.parseFloat(null!=Ar.y?s.getReserved("y"):s.h.y),width:v.parseFloat(null!=Ar.width?s.getReserved("width"):s.h.width),height:v.parseFloat(null!=Ar.height?s.getReserved("height"):s.h.height),xoffset:v.parseFloat(null!=Ar.xoffset?s.getReserved("xoffset"):s.h.xoffset),yoffset:v.parseFloat(null!=Ar.yoffset?s.getReserved("yoffset"):s.h.yoffset),xadvance:v.parseFloat(null!=Ar.xadvance?s.getReserved("xadvance"):s.h.xadvance),page:v.parseInt(null!=Ar.page?s.getReserved("page"):s.h.page)};i.chars.h[n.id]=n;break;case"kerning":var r=v.parseInt(null!=Ar.first?s.getReserved("first"):s.h.first),o=v.parseInt(null!=Ar.second?s.getReserved("second"):s.h.second),a=v.parseFloat(null!=Ar.amount?s.getReserved("amount"):s.h.amount),h=i.kernings.h[r];null==h&&(h=new U,i.kernings.h[r]=h),h.h[o]=a}},pi.tokenize_line=function(t){for(var e=new V,i=0;i<t.length;){var s=t[i];++i;var n=s.split("=");e.set(n[0],n[1])}return e},pi.trim=function(t){return w.trim(t)},pi.unquote=function(t){return-1!=t.indexOf('"')&&(t=w.replace(t,'"',"")),t};var mi=function(t){this.visible=!0,this.opacity=1,this.y=0,this.x=0,this.name="",this.map=t,this.properties=new V};n["luxe.importers.tiled.TiledImageLayer"]=mi,mi.__name__=["luxe","importers","tiled","TiledImageLayer"],mi.prototype={from_xml:function(t){this.name=t.get("name"),this.x=v.parseInt(t.get("x")),this.y=v.parseInt(t.get("y"));var e=t.get("opacity"),i=t.get("visible");this.opacity=null==e?1:parseFloat(e),this.visible="0"==i?!1:!0;for(var s=function(){var e;if(t.nodeType!=z.Document&&t.nodeType!=z.Element)throw new ne("Bad node type, expected Element or Document but found "+t.nodeType);return e=a.iter(t.children)}(this);s.hasNext();){var n=s.next();if(Si.valid_element(n)){if("properties"==function(){var t;if(n.nodeType!=z.Element)throw new ne("Bad node type, expected Element but found "+n.nodeType);return t=n.nodeName}(this))for(var r=function(){var t;if(n.nodeType!=z.Document&&n.nodeType!=z.Element)throw new ne("Bad node type, expected Element or Document but found "+n.nodeType);return t=a.iter(n.children)}(this);r.hasNext();){var o=r.next();if(Si.valid_element(o)){var h=o.get("name"),l=o.get("value");this.properties.set(h,l)}}if("image"==function(){var t;if(n.nodeType!=z.Element)throw new ne("Bad node type, expected Element but found "+n.nodeType);return t=n.nodeName}(this)){var _=n.get("source"),u=n.get("format"),c=n.get("trans");null==c&&(c=""),c=w.replace(c,"#",""),this.image=new gi(this,u,_,v.parseInt(c))}}}},from_json:function(t){this.name=p.field(t,"name"),this.x=p.field(t,"x"),this.y=p.field(t,"y"),this.opacity=p.field(t,"opacity"),this.visible=p.field(t,"visible");var e=p.field(t,"image"),i=p.field(t,"transparentcolor"),s=p.field(t,"width"),n=p.field(t,"height"),r=p.field(t,"format");null==i&&(i=""),i=w.replace(i,"#",""),this.image=new gi(this,r,e,v.parseInt(i),s,n);var o=p.field(t,"properties");if(null!=o)for(var a=p.fields(o),h=0;h<a.length;){var l=a[h];++h;var _=p.field(o,l);this.properties.set(l,_)}},__class__:mi};var gi=function(t,e,i,s,n,r){this.height=0,this.width=0,this.image_layer=t,this.format=null==e?"":e,this.source=i,this.transparent_color=s,this.width=n,this.height=r};n["luxe.importers.tiled.TiledImage"]=gi,gi.__name__=["luxe","importers","tiled","TiledImage"],gi.prototype={__class__:gi};var vi=function(t){this.visible=!0,this.opacity=1,this.map=t,this.properties=new V,this.tiles=[]};n["luxe.importers.tiled.TiledLayer"]=vi,vi.__name__=["luxe","importers","tiled","TiledLayer"],vi.bytes_get_int32=function(t,e){return t.b[e]|t.b[e+1]<<8|t.b[e+2]<<16|t.b[e+3]<<24},vi.base64_to_array=function(t,e){if(0==vi.base_lookup.length)for(var i=0,s=vi.base_chars.length;s>i;){var n=i++;vi.base_lookup[a.cca(vi.base_chars,n)]=n}for(var r=[],o=F.alloc(t.length/4*3|0),h=0,l=0;l<t.length-3;){var _=t.charAt(l);if(" "!=_&&"\n"!=_){var u=vi.base_lookup[a.cca(t,l)],c=vi.base_lookup[a.cca(t,l+1)],d=vi.base_lookup[a.cca(t,l+2)],f=vi.base_lookup[a.cca(t,l+3)];64>c&&o.set(h++,(u<<2)+((48&c)>>4)),64>d&&o.set(h++,((15&c)<<4)+((60&d)>>2)),64>f&&o.set(h++,((3&d)<<6)+f),l+=4}else l++}if(null!=e&&null!=e)switch(e){case"gzip":throw new ne("TiledMap: gzip compression is not currently supported. Try zlib/zip compression instead.");case"zlib":o=se.run(o)}var p=o.length;for(h=0;p>h;)r.push(o.b[h]|o.b[h+1]<<8|o.b[h+2]<<16|o.b[h+3]<<24),h+=4;return o=null,r},vi.prototype={from_xml:function(t){var e=[],i=t;this.name=i.get("name"),this.width=v.parseInt(i.get("width")),this.height=v.parseInt(i.get("height"));var s=i.get("opacity"),n=i.get("visible");this.opacity=null==s?1:parseFloat(s),this.visible="0"==n?!1:!0;for(var r=function(){var t;if(i.nodeType!=z.Document&&i.nodeType!=z.Element)throw new ne("Bad node type, expected Element or Document but found "+i.nodeType);return t=a.iter(i.children)}(this);r.hasNext();){var o=r.next();if(Si.valid_element(o)){var h;if(o.nodeType!=z.Element)throw new ne("Bad node type, expected Element but found "+o.nodeType);switch(h=o.nodeName){case"properties":for(var l=function(){var t;if(o.nodeType!=z.Document&&o.nodeType!=z.Element)throw new ne("Bad node type, expected Element or Document but found "+o.nodeType);return t=a.iter(o.children)}(this);l.hasNext();){var _=l.next();if(Si.valid_element(_)){var u=_.get("name"),c=_.get("value");this.properties.set(u,c)}}break;case"data":var d;d=o.exists("encoding")?o.get("encoding"):"";var f=function(){var t;if(o.nodeType!=z.Document&&o.nodeType!=z.Element)throw new ne("Bad node type, expected Element or Document but found "+o.nodeType);return t=o.children[0]}(this).get_nodeValue();switch(d){case"base64":e=vi.base64_to_array(f,o.get("compression"));break;case"csv":e=this.csv_to_array(f);break;default:for(var p=function(){var t;if(o.nodeType!=z.Document&&o.nodeType!=z.Element)throw new ne("Bad node type, expected Element or Document but found "+o.nodeType);return t=a.iter(o.children)}(this);p.hasNext();){var m=p.next();if(Si.valid_element(m)){var g=v.parseInt(m.get("gid"));e.push(g)}}}}}}for(var y=0;y<e.length;){var w=e[y];++y,this.tiles.push(new Ci(this,w))}},from_json:function(t){var e=[];this.name=p.field(t,"name"),this.width=v.parseInt(p.field(t,"width")),this.height=v.parseInt(p.field(t,"height")),this.opacity=v.parseFloat(p.field(t,"opacity")),this.visible="false"==p.field(t,"visible")?!1:!0;for(var i=p.fields(t),s=0;s<i.length;){var n=i[s];++s;var r=p.field(t,n);switch(n){case"properties":for(var o=p.fields(r),a=0;a<o.length;){var h=o[a];++a;var l=p.field(r,h);this.properties.set(h,l)}break;case"data":e=r}}for(var _=0;_<e.length;){var u=e[_];++_,this.tiles.push(new Ci(this,0|u))}},csv_to_array:function(t){for(var e=[],i=w.trim(t).split("\n"),s=0;s<i.length;){var n=i[s];if(++s,""!=n)for(var r=w.trim(n).split(","),o=0;o<r.length;){var a=r[o];++o,""!=a&&e.push(v.parseInt(a))}}return e},__class__:vi};var yi=function(t){this.total_height=0,this.total_width=0,this.height=0,this.width=0,this.tile_height=0,this.tile_width=0,this.width=t.w,this.height=t.h,this.tile_width=t.tile_width,this.tile_height=t.tile_height,null!=t.x&&null!=t.y?this.pos=new un(t.x,t.y):(this.pos=new un,null!=t.x&&this.pos.set_x(t.x),null!=t.y&&this.pos.set_y(t.y)),this.orientation=null==t.orientation?ts.none:t.orientation,this.properties=new V,this.tilesets=new V,this.layers=new V,this.layers_ordered=[]};n["luxe.tilemaps.Tilemap"]=yi,yi.__name__=["luxe","tilemaps","Tilemap"],yi.prototype={display:function(t){var e=this.orientation;switch(e[1]){case 0:this.visual=new Qi(this,t);break;case 1:this.visual=new Ki(this,t);break;case 2:}},inside:function(t,e){return 0==this.width||0==this.height?!1:0>t?!1:0>e?!1:e>this.height-1?!1:t>this.width-1?!1:!0
},tile_pos:function(t,e,i,s,n,r){if(null==s&&(s=1),this.inside(e,i)){var o=this.orientation;switch(o[1]){case 0:var a=Wi.tile_coord_to_worldpos(e,i,this.tile_width,this.tile_height,s,n,r);return a.add(this.pos);case 1:var h=Zi.tile_coord_to_worldpos(e,i,this.tile_width,this.tile_height,s,n,r);return h.add(this.pos)}}return new un},tile_at_pos:function(t,e,i){null==i&&(i=1);var s=this.orientation;switch(s[1]){case 0:var n=Wi.worldpos_to_tile_coord(e.x-this.pos.x,e.y-this.pos.y,this.tile_width,this.tile_height,i);return this.tile_at(t,Math.floor(n.x),Math.floor(n.y));case 1:var r=Zi.worldpos_to_tile_coord(e.x-this.pos.x,e.y-this.pos.y,this.tile_width,this.tile_height,i);return this.tile_at(t,Math.floor(r.x),Math.floor(r.y))}return null},worldpos_to_map:function(t,e){null==e&&(e=1);var i=this.orientation;switch(i[1]){case 0:return Wi.worldpos_to_tile_coord(t.x-this.pos.x,t.y-this.pos.y,this.tile_width,this.tile_height,e);case 1:return Zi.worldpos_to_tile_coord(t.x-this.pos.x,t.y-this.pos.y,this.tile_width,this.tile_height,e)}return null},layer:function(t){return this.layers.get(t)},tileset:function(t){return this.tilesets.get(t)},tile_at:function(t,e,i){if(this.inside(e,i)){var s=this.layers.get(t);return null!=s?s.tiles[i][e]:(S.trace("No tile layer called '"+t+"' for tile_at "+e+","+i,{fileName:"Tilemap.hx",lineNumber:650,className:"luxe.tilemaps.Tilemap",methodName:"tile_at"}),null)}return null},iterator:function(){return a.iter(this.layers_ordered)},add_tileset:function(t){var e=new $i(t);return this.tilesets.set(e.name,e),e},tileset_from_id:function(t){for(var e=null,i=0,s=this.tilesets.iterator();s.hasNext();){var n=s.next();t>=n.first_id&&n.first_id>=i&&(i=n.first_id,e=n)}return e},remove_tile:function(t,e,i){if(this.inside(e,i)){var s=this.layer(t);null!=s&&s.tiles[i][e].set_id(0)}return!1},remove_tileset:function(t,e){null==e&&(e=!1);var i=this.tileset(t);return null!=i&&e&&i.texture.destroy(),this.tilesets.remove(t)},remove_layer:function(t){var e=this.layer(t);return null!=e&&a.remove(this.layers_ordered,e),this.layers.remove(t)},add_layer:function(t){null==t.map&&(t.map=this),t.map;var e=new Ji(t);return this.layers.set(e.name,e),this.layers_ordered.push(e),this.sort_layers(),e},add_tiles_fill_by_id:function(t,e){null==e&&(e=0);var i=this.layers.get(t);if(null!=i){i.tiles=null,i.tiles=[];for(var s=0,n=this.height;n>s;){for(var r=s++,o=[],a=0,h=this.width;h>a;){var l=a++,_=new Yi({layer:i,id:e,x:l,y:r});o.push(_)}i.tiles.push(o)}}else S.trace("No tile layer called '"+t+"' for add_tiles_fill_by_id",{fileName:"Tilemap.hx",lineNumber:787,className:"luxe.tilemaps.Tilemap",methodName:"add_tiles_fill_by_id"})},add_tiles_from_grid:function(t,e){if(e.length!=this.height)throw new ne("add_tiles_from_grid requires a grid of integers the same size as the tilemap! height != grid.length");if(0!=e.length&&e[0].length!=this.width)throw new ne("add_tiles_from_grid requires a grid of integers the same size as the tilemap! width != grid[0].length");var i=this.layers.get(t);if(null!=i){i.tiles=null,i.tiles=[];for(var s=0,n=this.height;n>s;){for(var r=s++,o=[],a=0,h=this.width;h>a;){var l=a++,_=e[r][l],u=new Yi({layer:i,id:_,x:l,y:r});o.push(u)}i.tiles.push(o)}}else S.trace("No tile layer called '"+t+"' for add_tiles_from_grid",{fileName:"Tilemap.hx",lineNumber:834,className:"luxe.tilemaps.Tilemap",methodName:"add_tiles_from_grid"})},destroy:function(t){null==t&&(t=!1),this.layers=null,this.layers_ordered=null,this.tilesets=null,this.properties=null,this.orientation=null,this.pos=null,this.tile_width=0,this.tile_height=0,this.width=0,this.height=0,t||this.visual.destroy()},_sort_layers:function(t,e){return t.layer<e.layer?-1:t.layer>=e.layer?1:1},sort_layers:function(){this.layers_ordered.sort(s(this,this._sort_layers))},get_bounds:function(){return new $s(this.pos.x,this.pos.y,this.pos.x+this.get_total_width(),this.pos.y+this.get_total_height())},get_total_width:function(){return this.width*this.tile_width},get_total_height:function(){return this.height*this.tile_height},__class__:yi,__properties__:{get_bounds:"get_bounds",get_total_height:"get_total_height",get_total_width:"get_total_width"}};var wi=function(t){if(null==t.format&&(t.format="xml"),t.format,null==t.asset_path&&(t.asset_path="assets/"),t.asset_path,null==t.pos&&(t.pos=new un),t.pos,null==t.tiled_file_data||0==t.tiled_file_data.length)throw new ne("TiledMap handed invalid file data, pass the text contents of the tmx/json file");this.tiledmap_data=new xi,"json"==t.format?this.tiledmap_data.parseFromJSON(JSON.parse(t.tiled_file_data)):this.tiledmap_data.parseFromXML(z.parse(t.tiled_file_data)),yi.call(this,{x:0|t.pos.x,y:0|t.pos.y,w:this.tiledmap_data.width,h:this.tiledmap_data.height,tile_width:this.tiledmap_data.tile_width,tile_height:this.tiledmap_data.tile_height}),this._load_tilesets(t),this._load_layers(t),this.orientation=this.tiledmap_data.orientation};n["luxe.importers.tiled.TiledMap"]=wi,wi.__name__=["luxe","importers","tiled","TiledMap"],wi.__super__=yi,wi.prototype=e(yi.prototype,{_load_tilesets:function(t){for(var e=0,i=this.tiledmap_data.tilesets;e<i.length;){var s=i[e];++e;var n=Q.join([t.asset_path,s.texture_name]);this.add_tileset({name:s.name,texture:_.resources.cache.get(n),first_id:s.first_id,tile_width:s.tile_width,tile_height:s.tile_height,spacing:s.spacing,margin:s.margin})}},_load_layers:function(){for(var t=0,e=0,i=this.tiledmap_data.layers;e<i.length;){var s=i[e];++e;for(var n=new V,r=s.properties.keys();r.hasNext();){var o=r.next(),a=s.properties.get(o);null!=Ar[o]?n.setReserved(o,a):n.h[o]=a}this.add_layer({name:s.name,layer:t,opacity:s.opacity,visible:s.visible,properties:n}),this.add_tiles_fill_by_id(s.name,0);for(var h=this.layers.get(s.name),l=0,_=0,u=s.height;u>_;)for(var c=_++,d=0,f=s.width;f>d;){var p=d++,m=s.tiles[l];if(0!=m.id){var g=h.tiles[c][p];g.set_id(m.id),g.set_flipx(m.flip_horizontal),g.set_flipy(m.flip_vertical),m.flip_diagonal&&(g.set_angle(90),g.set_flipx(!g.flipx))}l++}t++}},__class__:wi});var xi=function(){this.background_color="",this.version="",this.width=0,this.height=0,this.tile_width=0,this.tile_height=0,this.orientation=ts.none,this.tilesets=[],this.layers=[],this.properties=new V,this.object_groups=[],this.image_layers=[]};n["luxe.importers.tiled.TiledMapData"]=xi,xi.__name__=["luxe","importers","tiled","TiledMapData"],xi.prototype={toString:function(){return"TiledMap : layers("+this.layers.length+") tilesets("+this.tilesets.length+") tilew,tileh("+this.tile_width+","+this.tile_height+")"},parseFromXML:function(t){var e=t.firstElement();this.version=e.get("version"),this.background_color=e.get("backgroundcolor"),this.width=v.parseInt(e.get("width")),this.height=v.parseInt(e.get("height")),this.orientation=Si.orientation_from_string(e.get("orientation")),this.tile_width=v.parseInt(e.get("tilewidth")),this.tile_height=v.parseInt(e.get("tileheight"));for(var i=function(){var t;if(e.nodeType!=z.Document&&e.nodeType!=z.Element)throw new ne("Bad node type, expected Element or Document but found "+e.nodeType);return t=a.iter(e.children)}(this);i.hasNext();){var s=i.next();if(Si.valid_element(s)){var n;if(s.nodeType!=z.Element)throw new ne("Bad node type, expected Element but found "+s.nodeType);switch(n=s.nodeName){case"tileset":var r=new Ti;null!=s.get("source")?S.trace("tilesets from other sources are not available right now? "+s.get("source"),{fileName:"TiledMapData.hx",lineNumber:81,className:"luxe.importers.tiled.TiledMapData",methodName:"parseFromXML"}):r.from_xml(s),r.first_id=v.parseInt(s.get("firstgid")),this.tilesets.push(r);break;case"properties":for(var o=function(){var t;if(s.nodeType!=z.Document&&s.nodeType!=z.Element)throw new ne("Bad node type, expected Element or Document but found "+s.nodeType);return t=a.iter(s.children)}(this);o.hasNext();){var h=o.next();if(Si.valid_element(h)){var l=h.get("name"),_=h.get("value");this.properties.set(l,_)}}break;case"layer":var u=new vi(this);u.from_xml(s),this.layers.push(u);break;case"objectgroup":var c=new Ai(this);c.from_xml(s),this.object_groups.push(c);break;case"imagelayer":var d=new mi(this);d.from_xml(s),this.image_layers.push(d)}}}},parseFromJSON:function(t){this.version=p.field(t,"version"),this.background_color=p.field(t,"backgroundcolor"),this.width=v.parseInt(p.field(t,"width")),this.height=v.parseInt(p.field(t,"height")),this.orientation=Si.orientation_from_string(p.field(t,"orientation")),this.tile_width=v.parseInt(p.field(t,"tilewidth")),this.tile_height=v.parseInt(p.field(t,"tileheight"));for(var e=p.fields(t),i=0;i<e.length;){var s=e[i];++i;var n=p.field(t,s);switch(s){case"tilesets":for(var r=n,o=0;o<r.length;){var a=r[o];++o;var h=new Ti;h.from_json(a),h.first_id=v.parseInt(p.field(a,"firstgid")),this.tilesets.push(h)}break;case"properties":for(var l=p.fields(n),_=0;_<l.length;){var u=l[_];++_;var c=p.field(n,u);this.properties.set(u,c)}break;case"layers":for(var d=n,f=0;f<d.length;){var m=d[f];++f;var g=p.field(m,"type");switch(g){case"tilelayer":var y=new vi(this);y.from_json(m),this.layers.push(y);break;case"objectgroup":var w=new Ai(this);w.from_json(m),this.object_groups.push(w);break;case"imagelayer":var x=new mi(this);x.from_json(m),this.image_layers.push(x)}}}}},__class__:xi};var bi=function(t,e){this.id=t,this.properties=e};n["luxe.importers.tiled.TiledPropertyTile"]=bi,bi.__name__=["luxe","importers","tiled","TiledPropertyTile"],bi.prototype={__class__:bi};var ki=n["luxe.importers.tiled.TiledObjectType"]={__ename__:["luxe","importers","tiled","TiledObjectType"],__constructs__:["polyline","polygon","rectangle","ellipse"]};ki.polyline=["polyline",0],ki.polyline.toString=r,ki.polyline.__enum__=ki,ki.polygon=["polygon",1],ki.polygon.toString=r,ki.polygon.__enum__=ki,ki.rectangle=["rectangle",2],ki.rectangle.toString=r,ki.rectangle.__enum__=ki,ki.ellipse=["ellipse",3],ki.ellipse.toString=r,ki.ellipse.__enum__=ki;var zi=function(t,e){this.origin=t,this.points=e};n["luxe.importers.tiled.TiledPolyObject"]=zi,zi.__name__=["luxe","importers","tiled","TiledPolyObject"],zi.prototype={__class__:zi};var Ei=function(t){this.visible=!0,this.group=t,this.properties=new V,this.pos=new un};n["luxe.importers.tiled.TiledObject"]=Ei,Ei.__name__=["luxe","importers","tiled","TiledObject"],Ei.prototype={polyobject_from_xml:function(t){for(var e=[],i=t.get("points"),s=i.split(" "),n=0;n<s.length;){var r=s[n];++n;var o=r.split(",");e.push(new un(v.parseInt(o[0]),v.parseInt(o[1])))}return new zi(this.pos.clone(),e)},polyobject_from_json:function(t){for(var e=[],i=t,s=0;s<i.length;){var n=i[s];++s;var r=p.field(n,"x"),o=p.field(n,"y");e.push(new un(r,o))}return new zi(this.pos.clone(),e)},from_xml:function(t){this.gid=null!=t.get("gid")?v.parseInt(t.get("gid")):0,this.id=v.parseInt(t.get("id")),this.name=t.get("name"),this.type=t.get("type"),this.visible="0"!=t.get("visible"),this.pos.set_x(v.parseInt(t.get("x"))),this.pos.set_y(v.parseInt(t.get("y"))),this.width=v.parseInt(t.get("width")),this.height=v.parseInt(t.get("height")),this.rotation=null!=t.get("rotation")?v.parseFloat(t.get("rotation")):0,this.object_type=ki.rectangle;for(var e=function(){var e;if(t.nodeType!=z.Document&&t.nodeType!=z.Element)throw new ne("Bad node type, expected Element or Document but found "+t.nodeType);return e=a.iter(t.children)}(this);e.hasNext();){var i=e.next();if(Si.valid_element(i)){var s;if(i.nodeType!=z.Element)throw new ne("Bad node type, expected Element but found "+i.nodeType);switch(s=i.nodeName){case"polygon":this.object_type=ki.polygon,this.polyobject=this.polyobject_from_xml(i);break;case"polyline":this.object_type=ki.polyline,this.polyobject=this.polyobject_from_xml(i);break;case"ellipse":this.object_type=ki.ellipse;var n=this.width/2|0,r=this.height/2|0,o=this.pos;o.set_x(o.x+n);var h=this.pos;h.set_y(h.y+r);break;case"properties":for(var l=function(){var t;if(i.nodeType!=z.Document&&i.nodeType!=z.Element)throw new ne("Bad node type, expected Element or Document but found "+i.nodeType);return t=a.iter(i.children)}(this);l.hasNext();){var _=l.next();if(Si.valid_element(_)){var u=_.get("name"),c=_.get("value");this.properties.set(u,c)}}}}}},from_json:function(t){var e=p.field(t,"gid");this.gid=null!=e?e:0,this.id=p.field(t,"id"),this.name=p.field(t,"name"),this.type=p.field(t,"type"),this.visible=p.field(t,"visible"),this.pos.set_x(p.field(t,"x")),this.pos.set_y(p.field(t,"y")),this.width=p.field(t,"width"),this.height=p.field(t,"height");var i=p.field(t,"rotation");this.rotation=null!=i?i:0,this.object_type=ki.rectangle;for(var s=p.fields(t),n=0;n<s.length;){var r=s[n];++n;var o=p.field(t,r);switch(r){case"polygon":this.object_type=ki.polygon,this.polyobject=this.polyobject_from_json(o);break;case"polyline":this.object_type=ki.polyline,this.polyobject=this.polyobject_from_json(o);break;case"ellipse":this.object_type=ki.ellipse;var a=this.width/2|0,h=this.height/2|0,l=this.pos;l.set_x(l.x+a);var _=this.pos;_.set_y(_.y+h);break;case"properties":for(var u=p.fields(o),c=0;c<u.length;){var d=u[c];++c;var f=p.field(o,d);this.properties.set(d,f)}}}},__class__:Ei};var Ai=function(t){this.color="",this.opacity=1,this.visible=!0,this.height=0,this.width=0,this.name="",this.map=t,this.properties=new V,this.objects=[]};n["luxe.importers.tiled.TiledObjectGroup"]=Ai,Ai.__name__=["luxe","importers","tiled","TiledObjectGroup"],Ai.prototype={from_xml:function(t){this.name=t.get("name"),this.color=t.get("color"),this.visible="0"!=t.get("visible"),this.opacity=null==t.get("opacity")?1:v.parseFloat(t.get("opacity")),this.width=v.parseInt(t.get("width")),this.height=v.parseInt(t.get("height"));for(var e=function(){var e;if(t.nodeType!=z.Document&&t.nodeType!=z.Element)throw new ne("Bad node type, expected Element or Document but found "+t.nodeType);return e=a.iter(t.children)}(this);e.hasNext();){var i=e.next();if(Si.valid_element(i)){if("properties"==function(){var t;if(i.nodeType!=z.Element)throw new ne("Bad node type, expected Element but found "+i.nodeType);return t=i.nodeName}(this))for(var s=function(){var t;if(i.nodeType!=z.Document&&i.nodeType!=z.Element)throw new ne("Bad node type, expected Element or Document but found "+i.nodeType);return t=a.iter(i.children)}(this);s.hasNext();){var n=s.next();if(Si.valid_element(n)){var r=n.get("name"),o=n.get("value");this.properties.set(r,o)}}if("object"==function(){var t;if(i.nodeType!=z.Element)throw new ne("Bad node type, expected Element but found "+i.nodeType);return t=i.nodeName}(this)){var h=new Ei(this);h.from_xml(i),this.objects.push(h)}}}},from_json:function(t){this.name=p.field(t,"name"),this.color=p.field(t,"color"),this.visible=p.field(t,"visible"),this.opacity=p.field(t,"opacity"),this.width=p.field(t,"width"),this.height=p.field(t,"height");for(var e=p.fields(t),i=0;i<e.length;){var s=e[i];++i;var n=p.field(t,s);switch(s){case"objects":for(var r=n,o=0;o<r.length;){var a=r[o];++o;var h=new Ei(this);h.from_json(a),this.objects.push(h)}break;case"properties":for(var l=p.fields(n),_=0;_<l.length;){var u=l[_];++_;var c=p.field(n,u);this.properties.set(u,c)}}}},__class__:Ai};var Ci=function(t,e){this.layer=t,this.flip_horizontal=0!=(-2147483648&e),this.flip_vertical=0!=(1073741824&e),this.flip_diagonal=0!=(536870912&e),this.id=536870911&e};n["luxe.importers.tiled.TiledTile"]=Ci,Ci.__name__=["luxe","importers","tiled","TiledTile"],Ci.prototype={get_width:function(){return this.layer.map.tile_width},get_height:function(){return this.layer.map.tile_height},__class__:Ci,__properties__:{get_height:"get_height",get_width:"get_width"}};var Ti=function(){this.spacing=0,this.margin=0,this.tile_height=0,this.tile_width=0,this.first_id=1,this.texture_name="",this.name="",this.properties=new V,this.property_tiles=new U};n["luxe.importers.tiled.TiledTileset"]=Ti,Ti.__name__=["luxe","importers","tiled","TiledTileset"],Ti.prototype={from_xml:function(t){var e=t;this.name=e.get("name"),this.tile_width=v.parseInt(e.get("tilewidth")),this.tile_height=v.parseInt(e.get("tileheight")),this.spacing=v.parseInt(e.get("spacing")),this.margin=v.parseInt(e.get("margin"));for(var i=e.elements();i.hasNext();){var s=i.next();if(Si.valid_element(s)){var n;if(s.nodeType!=z.Element)throw new ne("Bad node type, expected Element but found "+s.nodeType);switch(n=s.nodeName){case"properties":for(var r=function(){var t;if(s.nodeType!=z.Document&&s.nodeType!=z.Element)throw new ne("Bad node type, expected Element or Document but found "+s.nodeType);return t=a.iter(s.children)}(this);r.hasNext();){var o=r.next();if(Si.valid_element(o)){var h=o.get("name"),l=o.get("value");this.properties.set(h,l)}}break;case"image":this.texture_name=s.get("source");break;case"tile":for(var _=v.parseInt(s.get("id")),u=new V,c=function(){var t;if(s.nodeType!=z.Document&&s.nodeType!=z.Element)throw new ne("Bad node type, expected Element or Document but found "+s.nodeType);return t=a.iter(s.children)}(this);c.hasNext();){var d=c.next();if(Si.valid_element(d)&&"properties"==function(){var t;if(d.nodeType!=z.Element)throw new ne("Bad node type, expected Element but found "+d.nodeType);return t=d.nodeName}(this))for(var f=function(){var t;if(d.nodeType!=z.Document&&d.nodeType!=z.Element)throw new ne("Bad node type, expected Element or Document but found "+d.nodeType);return t=a.iter(d.children)}(this);f.hasNext();){var p=f.next();if(Si.valid_element(p)){var m=p.get("name"),g=p.get("value");null!=Ar[m]?u.setReserved(m,g):u.h[m]=g}}}var y=new bi(_,u);this.property_tiles.h[_]=y}}}},from_json:function(t){this.name=p.field(t,"name"),this.tile_width=p.field(t,"tilewidth"),this.tile_height=p.field(t,"tileheight"),this.spacing=p.field(t,"spacing"),this.margin=p.field(t,"margin");for(var e=p.fields(t),i=0;i<e.length;){var s=e[i];++i;var n=p.field(t,s);switch(s){case"properties":for(var r=p.fields(n),o=0;o<r.length;){var a=r[o];++o;var h=p.field(n,a);this.properties.set(a,h)}break;case"image":this.texture_name=n;break;case"tile":for(var l=p.field(n,"id"),_=new V,u=p.fields(n),c=0;c<u.length;){var d=u[c];if(++c,"properties"==d)for(var f=p.field(n,d),m=p.fields(f),g=0;g<m.length;){var v=m[g];++g;var y=p.field(f,v);this.properties.set(v,y)}}var w=new bi(l,_);this.property_tiles.h[l]=w}}},__class__:Ti};var Si=function(){};n["luxe.importers.tiled.TiledUtil"]=Si,Si.__name__=["luxe","importers","tiled","TiledUtil"],Si.valid_element=function(t){return 0==t.nodeType},Si.orientation_from_string=function(t){switch(t){case"orthogonal":return ts.ortho;case"isometric":return ts.isometric;default:return ts.none}};var Ii=function(){};n["luxe.macros.BuildVersion"]=Ii,Ii.__name__=["luxe","macros","BuildVersion"],Ii.try_git=function(){return""};var Ni=function(){};n["luxe.options._DrawOptions.DrawOptions"]=Ni,Ni.__name__=["luxe","options","_DrawOptions","DrawOptions"];var Mi=function(t){if(this.ref=0,null==t)throw new ne(Re.null_assertion("_options was null"));if(null==t.id)throw new ne(Re.null_assertion("_options.id was null"));null==t.system&&(t.system=_.resources),t.system,null==t.resource_type&&(t.resource_type=0),t.resource_type,this.id=t.id,this.system=t.system,this.resource_type=t.resource_type,this.set_state(0),this.set_ref(1)};n["luxe.resource.Resource"]=Mi,Mi.__name__=["luxe","resource","Resource"],Mi.prototype={destroy:function(t){if(null==t&&(t=!1),6==this.state)throw new ne(Re.assertion("state != ResourceState.destroyed"));if(!t){if(!(this.ref>0))throw new ne(Re.assertion("ref > 0"));var e=this,i=e.ref;if(e.set_ref(i-1),!(this.ref>=0))throw new ne(Re.assertion("ref >= 0"))}(0==this.ref||t)&&(this.clear(),this.set_state(6),this.system.remove(this),this.system.emit(8,this))},invalidate:function(){if(6==this.state)throw new ne(Re.assertion("state != ResourceState.destroyed"));this.clear(),this.set_state(5),this.system.emit(6,this)},reload:function(){return null},memory_use:function(){return 0},set_ref:function(t){var e=this.ref;return this.ref=t,this.ref>e?this.system.emit(9,this):this.ref<e&&this.system.emit(10,this),this.ref},set_state:function(t){this.state=t;var e=this.state;switch(e){case 2:this.system.emit(3,this);break;case 3:this.system.emit(4,this);break;case 4:this.system.emit(5,this)}return this.state},clear:function(){},state_string:function(){var t=this.state;switch(t){case 1:return"listed";case 2:return"loading";case 3:return"loaded";case 4:return"failed";case 5:return"invalidated";case 6:return"destroyed";default:return"unknown"}},type_string:function(){var t=this.resource_type;switch(t){case 3:return"bytes";case 1:return"text";case 2:return"json";case 4:return"texture";case 7:return"shader";case 6:return"font";default:return""+this.resource_type}},toString:function(){return"Resource(`"+this.id+"`, "+this.type_string()+", "+this.state_string()+")"},__class__:Mi,__properties__:{set_ref:"set_ref",set_state:"set_state"}};var Ri=function(t){if(null==t)throw new ne(Re.null_assertion("_options was null"));t.resource_type=3,Mi.call(this,t),this.asset=t.asset};n["luxe.resource.BytesResource"]=Ri,Ri.__name__=["luxe","resource","BytesResource"],Ri.__super__=Mi,Ri.prototype=e(Mi.prototype,{reload:function(){var t=this;if(6==this.state)throw new ne(Re.assertion("state != ResourceState.destroyed"));return this.clear(),new Fn(function(e,i){t.set_state(2);var s=hr.load(_.core.app.assets,t.id);s.then(function(i){t.asset=i,t.set_state(3),e(t)}),s.error(function(e){t.set_state(4),i(e)})})},clear:function(){null!=this.asset&&(this.asset.destroy(),this.asset=null)},memory_use:function(){return null==this.asset?0:this.asset.bytes.byteLength},__class__:Ri});var Bi=function(t){if(null==t)throw new ne(Re.null_assertion("_options was null"));t.resource_type=1,Mi.call(this,t),this.asset=t.asset};n["luxe.resource.TextResource"]=Bi,Bi.__name__=["luxe","resource","TextResource"],Bi.__super__=Mi,Bi.prototype=e(Mi.prototype,{reload:function(){var t=this;if(6==this.state)throw new ne(Re.assertion("state != ResourceState.destroyed"));return this.clear(),new Fn(function(e,i){t.set_state(2);var s=lr.load(_.core.app.assets,t.id);s.then(function(i){t.asset=i,t.set_state(3),e(t)}),s.error(function(e){t.set_state(4),i(e)})})},clear:function(){null!=this.asset&&(this.asset.destroy(),this.asset=null)},memory_use:function(){return null==this.asset?0:this.asset.text.length},__class__:Bi});var Pi=function(t){if(null==t)throw new ne(Re.null_assertion("_options was null"));t.resource_type=2,Mi.call(this,t),this.asset=t.asset};n["luxe.resource.JSONResource"]=Pi,Pi.__name__=["luxe","resource","JSONResource"],Pi.__super__=Mi,Pi.prototype=e(Mi.prototype,{reload:function(){var t=this;if(6==this.state)throw new ne(Re.assertion("state != ResourceState.destroyed"));return this.clear(),new Fn(function(e,i){t.set_state(2);var s=_r.load(_.core.app.assets,t.id);s.then(function(i){t.asset=i,t.set_state(3),e(t)}),s.error(function(e){t.set_state(4),i(e)})})},clear:function(){null!=this.asset&&(this.asset.destroy(),this.asset=null)},__class__:Pi});var Fi=function(t){this.compare=t};n["luxe.structural.BalancedBST"]=Fi,Fi.__name__=["luxe","structural","BalancedBST"],Fi.prototype={size:function(){return this.node_count(this.root)},depth:function(){return this.node_depth(this.root)},insert:function(t,e){this.root=this.node_insert(this.root,t,e),this.root.color=!1},contains:function(t){return null!=this.find(t)},find:function(t){return this.node_find(this.root,t)},rank:function(t){return this.node_rank(t,this.root)},select:function(t){var e=this.node_select(this.root,t);return null!=e?e.key:null},smallest:function(){var t=this.node_smallest(this.root);return null!=t?t.key:null},largest:function(){var t=this.node_largest(this.root);return null!=t?t.key:null},remove:function(t){return this.is_red(this.root.left)||this.is_red(this.root.right)||(this.root.color=!0),this.contains(t)?(this.root=this.node_remove(this.root,t),null!=this.root&&(this.root.color=!1),!0):!1},remove_smallest:function(){return this.is_red(this.root.left)||this.is_red(this.root.right)||(this.root.color=!0),this.root=this.node_remove_smallest(this.root),null!=this.root&&(this.root.color=!1),!0},remove_largest:function(){return this.is_red(this.root.left)||this.is_red(this.root.right)||(this.root.color=!0),this.root=this.node_remove_largest(this.root),null!=this.root&&(this.root.color=!1),!0},floor:function(t){var e=this.node_floor(this.root,t);return null==e?null:e.key},ceil:function(t){var e=this.node_ceil(this.root,t);return null==e?null:e.key},toArray:function(){var t=[];return this.traverse_node(this.root,Ui.order_retain,function(e){t.push(e.value)}),t},keys:function(){var t=[];return this.traverse_node(this.root,Ui.order_retain,function(e){t.push(e.key)}),t},iterator:function(){return new Li(this)},traverse_node:function(t,e,i){if(null!=t)switch(e[1]){case 0:i(t),this.traverse_node(t.left,e,i),this.traverse_node(t.right,e,i);break;case 1:this.traverse_node(t.left,e,i),i(t),this.traverse_node(t.right,e,i);break;case 2:this.traverse_node(t.left,e,i),this.traverse_node(t.right,e,i),i(t)}},get_empty:function(){return null==this.root},node_depth:function(t){if(null==t)return 0;var e=Math.max(this.node_depth(t.left),this.node_depth(t.right));return 1+(0|e)},node_count:function(t){return null==t?0:t.nodecount},node_insert:function(t,e,i){if(null==t)return new Di(e,i,1,!0);var s=this.compare(e,t.key);return 0>s?t.left=this.node_insert(t.left,e,i):s>0?t.right=this.node_insert(t.right,e,i):t.value=i,this.is_red(t.right)&&!this.is_red(t.left)&&(t=this.rotate_left(t)),this.is_red(t.left)&&this.is_red(t.left.left)&&(t=this.rotate_right(t)),this.is_red(t.left)&&this.is_red(t.right)&&this.swap_color(t),t.nodecount=this.node_count(t.left)+this.node_count(t.right)+1,t},node_update_count:function(t){return t.nodecount=this.node_count(t.left)+this.node_count(t.right)+1,t},node_find:function(t,e){if(null==t)return null;var i=this.compare(e,t.key);return 0>i?this.node_find(t.left,e):i>0?this.node_find(t.right,e):t.value},node_rank:function(t,e){if(null==e)return 0;var i=this.compare(t,e.key);return 0>i?this.node_rank(t,e.left):i>0?1+this.node_count(e.left)+this.node_rank(t,e.right):this.node_count(e.left)},node_select:function(t,e){if(null==t)return null;var i=this.node_count(t.left);return i>e?this.node_select(t.left,e):e>i?this.node_select(t.right,e-i-1):t},node_smallest:function(t){return null==t.left?t:this.node_smallest(t.left)},node_largest:function(t){return null==t.right?t:this.node_largest(t.right)},node_floor:function(t,e){if(null==t)return null;var i=this.compare(e,t.key);if(0==i)return t;if(0>i)return this.node_floor(t.left,e);var s=this.node_floor(t.right,e);return null!=s?s:t},node_ceil:function(t,e){if(null==t)return null;var i=this.compare(e,t.key);if(0==i)return t;if(0>i){var s=this.node_ceil(t.left,e);return null!=s?s:t}return this.node_ceil(t.right,e)},node_remove_smallest:function(t){return null==t.left?null:(this.is_red(t.left)||this.is_red(t.left.left)||(t=this.move_red_left(t)),t.left=this.node_remove_smallest(t.left),t.nodecount=this.node_count(t.left)+this.node_count(t.right)+1,this.balance(t))},node_remove_largest:function(t){return this.is_red(t.left)&&(t=this.rotate_right(t)),null==t.right?null:(this.is_red(t.right)||this.is_red(t.right.left)||(t=this.move_red_right(t)),t.right=this.node_remove_largest(t.right),t.nodecount=this.node_count(t.left)+this.node_count(t.right)+1,this.balance(t))},node_remove:function(t,e){var i=this.compare(e,t.key);if(0>i)this.is_red(t.left)||this.is_red(t.left.left)||(t=this.move_red_left(t)),t.left=this.node_remove(t.left,e);else{this.is_red(t.left)&&(t=this.rotate_right(t));var s=this.compare(e,t.key);if(0==s&&null==t.right)return null;this.is_red(t.right)||this.is_red(t.right.left)||(t=this.move_red_right(t));var n=this.compare(e,t.key);if(0==n){var r=this.node_smallest(t.right);t.key=r.key,t.value=r.value,t.right=this.node_remove_smallest(t.right)}else t.right=this.node_remove(t.right,e)}return this.balance(t)},is_red:function(t){return null==t?!1:1==t.color},rotate_left:function(t){var e=t.right;return e.color=t.color,t.color=!0,t.right=e.left,e.left=t,e.nodecount=t.nodecount,t.nodecount=this.node_count(t.left)+this.node_count(t.right)+1,e},rotate_right:function(t){var e=t.left;return e.color=t.color,t.color=!0,t.left=e.right,e.right=t,e.nodecount=t.nodecount,t.nodecount=this.node_count(t.left)+this.node_count(t.right)+1,e},swap_color:function(t){t.color=!t.color,t.left.color=!t.left.color,t.right.color=!t.right.color},move_red_left:function(t){return this.swap_color(t),this.is_red(t.right.left)&&(t.right=this.rotate_right(t.right),t=this.rotate_left(t)),t},move_red_right:function(t){return this.swap_color(t),this.is_red(t.left.left)&&(t=this.rotate_right(t)),t},balance:function(t){return this.is_red(t.right)&&(t=this.rotate_left(t)),this.is_red(t.left)&&this.is_red(t.left.left)&&(t=this.rotate_right(t)),this.is_red(t.left)&&this.is_red(t.right)&&this.swap_color(t),t.nodecount=this.node_count(t.left)+this.node_count(t.right)+1,t},__class__:Fi,__properties__:{get_empty:"get_empty"}};var Li=function(t){null!=t&&null!=t.root&&(this.tree=t,this.current=this._min(this.tree.root),this.rightest=this._max(this.tree.root))};n["luxe.structural.BalancedBSTIterator"]=Li,Li.__name__=["luxe","structural","BalancedBSTIterator"],Li.prototype={hasNext:function(){return null==this.current||null==this.rightest?!1:this.tree.compare(this.current.key,this.rightest.key)<=0},next:function(){var t=this.current;return this.current=this.update_next(),t.value},update_next:function(){if(!(null==this.current||null==this.rightest?!1:this.tree.compare(this.current.key,this.rightest.key)<=0))return null;if(null!=this.current.right)return this._min(this.current.right);for(var t=null,e=this.tree.root;null!=e;){var i=this.tree.compare(this.current.key,e.key);if(0>i)t=e,e=e.left;else{if(!(i>0)){this.current=t;break}e=e.right}}return t},_min:function(t){for(;null!=t.left;)t=t.left;return t},_max:function(t){for(;null!=t.right;)t=t.right;return t},__class__:Li};var Oi=function(){};n["luxe.structural._BalancedBST.NodeColor"]=Oi,Oi.__name__=["luxe","structural","_BalancedBST","NodeColor"];var Di=function(t,e,i,s){this.left=null,this.right=null,this.key=t,this.value=e,this.nodecount=i,this.color=s};n["luxe.structural.BalancedBSTNode"]=Di,Di.__name__=["luxe","structural","BalancedBSTNode"],Di.prototype={__class__:Di};var Ui=n["luxe.structural.BalancedBSTTraverseMethod"]={__ename__:["luxe","structural","BalancedBSTTraverseMethod"],__constructs__:["order_pre","order_retain","order_post"]};Ui.order_pre=["order_pre",0],Ui.order_pre.toString=r,Ui.order_pre.__enum__=Ui,Ui.order_retain=["order_retain",1],Ui.order_retain.toString=r,Ui.order_retain.__enum__=Ui,Ui.order_post=["order_post",2],Ui.order_post.toString=r,Ui.order_post.__enum__=Ui;var Gi=function(t){null!=t&&null!=t.root&&(this.tree=t,this.current=this._min(this.tree.root),this.rightest=this._max(this.tree.root))};n["luxe.structural.BalancedBSTIterator_phoenix_geometry_GeometryKey_phoenix_geometry_Geometry"]=Gi,Gi.__name__=["luxe","structural","BalancedBSTIterator_phoenix_geometry_GeometryKey_phoenix_geometry_Geometry"],Gi.prototype={hasNext:function(){return null==this.current||null==this.rightest?!1:this.tree.compare(this.current.key,this.rightest.key)<=0},next:function(){var t=this.current;return this.current=this.update_next(),t.value},update_next:function(){if(!(null==this.current||null==this.rightest?!1:this.tree.compare(this.current.key,this.rightest.key)<=0))return null;if(null!=this.current.right)return this._min(this.current.right);for(var t=null,e=this.tree.root;null!=e;){var i=this.tree.compare(this.current.key,e.key);if(0>i)t=e,e=e.left;else{if(!(i>0)){this.current=t;break}e=e.right}}return t},_min:function(t){for(;null!=t.left;)t=t.left;return t},_max:function(t){for(;null!=t.right;)t=t.right;return t},__class__:Gi};var ji=function(t,e,i,s){this.left=null,this.right=null,this.key=t,this.value=e,this.nodecount=i,this.color=s};n["luxe.structural.BalancedBSTNode_phoenix_geometry_GeometryKey_phoenix_geometry_Geometry"]=ji,ji.__name__=["luxe","structural","BalancedBSTNode_phoenix_geometry_GeometryKey_phoenix_geometry_Geometry"],ji.prototype={__class__:ji};
var Vi=function(t){this.compare=t};n["luxe.structural.BalancedBST_phoenix_geometry_GeometryKey_phoenix_geometry_Geometry"]=Vi,Vi.__name__=["luxe","structural","BalancedBST_phoenix_geometry_GeometryKey_phoenix_geometry_Geometry"],Vi.prototype={size:function(){return this.node_count(this.root)},depth:function(){return this.node_depth(this.root)},insert:function(t,e){this.root=this.node_insert(this.root,t,e),this.root.color=!1},contains:function(t){return null!=this.find(t)},find:function(t){return this.node_find(this.root,t)},rank:function(t){return this.node_rank(t,this.root)},select:function(t){var e=this.node_select(this.root,t);return null!=e?e.key:null},smallest:function(){var t=this.node_smallest(this.root);return null!=t?t.key:null},largest:function(){var t=this.node_largest(this.root);return null!=t?t.key:null},remove:function(t){return this.is_red(this.root.left)||this.is_red(this.root.right)||(this.root.color=!0),this.contains(t)?(this.root=this.node_remove(this.root,t),null!=this.root&&(this.root.color=!1),!0):!1},remove_smallest:function(){return this.is_red(this.root.left)||this.is_red(this.root.right)||(this.root.color=!0),this.root=this.node_remove_smallest(this.root),null!=this.root&&(this.root.color=!1),!0},remove_largest:function(){return this.is_red(this.root.left)||this.is_red(this.root.right)||(this.root.color=!0),this.root=this.node_remove_largest(this.root),null!=this.root&&(this.root.color=!1),!0},floor:function(t){var e=this.node_floor(this.root,t);return null==e?null:e.key},ceil:function(t){var e=this.node_ceil(this.root,t);return null==e?null:e.key},toArray:function(){var t=[];return this.traverse_node(this.root,Ui.order_retain,function(e){t.push(e.value)}),t},keys:function(){var t=[];return this.traverse_node(this.root,Ui.order_retain,function(e){t.push(e.key)}),t},iterator:function(){return new Gi(this)},traverse_node:function(t,e,i){if(null!=t)switch(e[1]){case 0:i(t),this.traverse_node(t.left,e,i),this.traverse_node(t.right,e,i);break;case 1:this.traverse_node(t.left,e,i),i(t),this.traverse_node(t.right,e,i);break;case 2:this.traverse_node(t.left,e,i),this.traverse_node(t.right,e,i),i(t)}},get_empty:function(){return null==this.root},node_depth:function(t){if(null==t)return 0;var e=Math.max(this.node_depth(t.left),this.node_depth(t.right));return 1+(0|e)},node_count:function(t){return null==t?0:t.nodecount},node_insert:function(t,e,i){if(null==t)return new ji(e,i,1,!0);var s=this.compare(e,t.key);return 0>s?t.left=this.node_insert(t.left,e,i):s>0?t.right=this.node_insert(t.right,e,i):t.value=i,this.is_red(t.right)&&!this.is_red(t.left)&&(t=this.rotate_left(t)),this.is_red(t.left)&&this.is_red(t.left.left)&&(t=this.rotate_right(t)),this.is_red(t.left)&&this.is_red(t.right)&&this.swap_color(t),t.nodecount=this.node_count(t.left)+this.node_count(t.right)+1,t},node_update_count:function(t){return t.nodecount=this.node_count(t.left)+this.node_count(t.right)+1,t},node_find:function(t,e){if(null==t)return null;var i=this.compare(e,t.key);return 0>i?this.node_find(t.left,e):i>0?this.node_find(t.right,e):t.value},node_rank:function(t,e){if(null==e)return 0;var i=this.compare(t,e.key);return 0>i?this.node_rank(t,e.left):i>0?1+this.node_count(e.left)+this.node_rank(t,e.right):this.node_count(e.left)},node_select:function(t,e){if(null==t)return null;var i=this.node_count(t.left);return i>e?this.node_select(t.left,e):e>i?this.node_select(t.right,e-i-1):t},node_smallest:function(t){return null==t.left?t:this.node_smallest(t.left)},node_largest:function(t){return null==t.right?t:this.node_largest(t.right)},node_floor:function(t,e){if(null==t)return null;var i=this.compare(e,t.key);if(0==i)return t;if(0>i)return this.node_floor(t.left,e);var s=this.node_floor(t.right,e);return null!=s?s:t},node_ceil:function(t,e){if(null==t)return null;var i=this.compare(e,t.key);if(0==i)return t;if(0>i){var s=this.node_ceil(t.left,e);return null!=s?s:t}return this.node_ceil(t.right,e)},node_remove_smallest:function(t){return null==t.left?null:(this.is_red(t.left)||this.is_red(t.left.left)||(t=this.move_red_left(t)),t.left=this.node_remove_smallest(t.left),t.nodecount=this.node_count(t.left)+this.node_count(t.right)+1,this.balance(t))},node_remove_largest:function(t){return this.is_red(t.left)&&(t=this.rotate_right(t)),null==t.right?null:(this.is_red(t.right)||this.is_red(t.right.left)||(t=this.move_red_right(t)),t.right=this.node_remove_largest(t.right),t.nodecount=this.node_count(t.left)+this.node_count(t.right)+1,this.balance(t))},node_remove:function(t,e){var i=this.compare(e,t.key);if(0>i)this.is_red(t.left)||this.is_red(t.left.left)||(t=this.move_red_left(t)),t.left=this.node_remove(t.left,e);else{this.is_red(t.left)&&(t=this.rotate_right(t));var s=this.compare(e,t.key);if(0==s&&null==t.right)return null;this.is_red(t.right)||this.is_red(t.right.left)||(t=this.move_red_right(t));var n=this.compare(e,t.key);if(0==n){var r=this.node_smallest(t.right);t.key=r.key,t.value=r.value,t.right=this.node_remove_smallest(t.right)}else t.right=this.node_remove(t.right,e)}return this.balance(t)},is_red:function(t){return null==t?!1:1==t.color},rotate_left:function(t){var e=t.right;return e.color=t.color,t.color=!0,t.right=e.left,e.left=t,e.nodecount=t.nodecount,t.nodecount=this.node_count(t.left)+this.node_count(t.right)+1,e},rotate_right:function(t){var e=t.left;return e.color=t.color,t.color=!0,t.left=e.right,e.right=t,e.nodecount=t.nodecount,t.nodecount=this.node_count(t.left)+this.node_count(t.right)+1,e},swap_color:function(t){t.color=!t.color,t.left.color=!t.left.color,t.right.color=!t.right.color},move_red_left:function(t){return this.swap_color(t),this.is_red(t.right.left)&&(t.right=this.rotate_right(t.right),t=this.rotate_left(t)),t},move_red_right:function(t){return this.swap_color(t),this.is_red(t.left.left)&&(t=this.rotate_right(t)),t},balance:function(t){return this.is_red(t.right)&&(t=this.rotate_left(t)),this.is_red(t.left)&&this.is_red(t.left.left)&&(t=this.rotate_right(t)),this.is_red(t.left)&&this.is_red(t.right)&&this.swap_color(t),t.nodecount=this.node_count(t.left)+this.node_count(t.right)+1,t},__class__:Vi,__properties__:{get_empty:"get_empty"}};var qi=function(t){this.index=0,this.map=t};n["luxe.structural.OrderedMapIterator"]=qi,qi.__name__=["luxe","structural","OrderedMapIterator"],qi.prototype={hasNext:function(){return this.index<this.map._keys.length},next:function(){return this.map.get(this.map._keys[this.index++])},__class__:qi};var Xi=function(t){this.idx=0,this._keys=[],this.map=t};n["luxe.structural.OrderedMap"]=Xi,Xi.__name__=["luxe","structural","OrderedMap"],Xi.__interfaces__=[C],Xi.prototype={set:function(t,e){this.map.exists(t)||this._keys.push(t),this.map.set(t,e)},toString:function(){for(var t="",e=0,i=this._keys.length,s=0,n=this._keys;s<n.length;){var r=n[s];++s,t+=""+v.string(r)+" => "+v.string(this.map.get(r))+(e++<i-1?", ":"")}return"{"+t+"}"},iterator:function(){return new qi(this)},remove:function(t){return this.map.remove(t)&&a.remove(this._keys,t)},exists:function(t){return this.map.exists(t)},get:function(t){return this.map.get(t)},keys:function(){return a.iter(this._keys)},__class__:Xi};var Zi=function(){};n["luxe.tilemaps.Isometric"]=Zi,Zi.__name__=["luxe","tilemaps","Isometric"],Zi.worldpos_to_tile_coord=function(t,e,i,s,n){null==n&&(n=1);var r=new un,o=i/2,a=s/2;return r.set_x((t/o+e/a)/2),r.set_y((e/a-t/o)/2),r},Zi.tile_coord_to_worldpos=function(t,e,i,s,n,r,o){null==n&&(n=1);var a=new un,h=i*n,l=s*n,_=h/2,u=l/2;null==r&&(r=es.left),null==o&&(o=es.top);var c=0,d=0;if(null!=r)switch(r[1]){case 0:c+=h/2,c/=i;break;case 4:c+=h,c/=i}if(null!=o)switch(o[1]){case 0:d+=l/2,d/=s;break;case 2:d+=l,d/=s}return c+=t,d+=e,a.set_x((c-d)*_),a.set_y((c+d)*u),a};var Hi=function(t,e){this.geometry=new V,this.map=t,this.options=e,this.default_options(),this.create()};n["luxe.tilemaps.TilemapVisual"]=Hi,Hi.__name__=["luxe","tilemaps","TilemapVisual"],Hi.prototype={create:function(){null!=this.options.no_destroy&&1!=this.options.no_destroy&&(this.destroy(),this.geometry=new V)},geometry_for_tile:function(t,e,i){if(!this.geometry.exists(t))return S.trace("  i / tilemap / "+("visual / geometry_for_layer / "+t+" does not exist in tilemap visual"),{fileName:"Tilemap.hx",lineNumber:47,className:"luxe.tilemaps.TilemapVisual",methodName:"geometry_for_tile"}),null;var s=this.geometry_for_layer(t);return s[i][e]},geometry_for_layer:function(t){return this.geometry.exists(t)||S.trace("  i / tilemap / "+("visual / geometry_for_layer / "+t+" does not exist in tilemap visual"),{fileName:"Tilemap.hx",lineNumber:60,className:"luxe.tilemaps.TilemapVisual",methodName:"geometry_for_layer"}),this.geometry.get(t)},default_options:function(){null==this.options.batcher&&(this.options.batcher=_.renderer.batcher),this.options.batcher,null==this.options.depth&&(this.options.depth=0),this.options.depth,null==this.options.group&&(this.options.group=0),this.options.group,null==this.options.scale&&(this.options.scale=1),this.options.scale,null==this.options.grid&&(this.options.grid=!1),this.options.grid,null==this.options.filter&&(this.options.filter=9728),this.options.filter},create_tile_for_layer:function(){return null},update_tile_id:function(){},refresh_tile_id:function(t,e,i,s,n,r,o){null==o&&(o=0),null==r&&(r=!1),null==n&&(n=!1);var a=(this.map.layer(t),this.geometry_for_layer(t));if(null!=a)if(this.map.inside(e,i)){var h=a[i][e];null==h?0!=s&&(h=this.create_tile_for_layer(this.map.layer(t),e,i),a[i][e]=h):0==s?(h.drop(),h=null,a[i][e]=null):this.update_tile_id(h,t,e,i,s,n,r,o)}else S.trace("cannot refresh tile "+e+","+i+" because the coords were out of the map width/height : "+t+" and "+this.map.width+","+this.map.height,{fileName:"Tilemap.hx",lineNumber:139,className:"luxe.tilemaps.TilemapVisual",methodName:"refresh_tile_id"});else S.trace("cannot refresh tile "+e+","+i+" because layer was not found : "+t,{fileName:"Tilemap.hx",lineNumber:143,className:"luxe.tilemaps.TilemapVisual",methodName:"refresh_tile_id"})},destroy:function(){if(null!=this.geometry)for(var t=this.geometry.keys();t.hasNext();){for(var e=t.next(),i=this.geometry.get(e),s=0;s<i.length;){var n=i[s];++s;for(var r=0;r<n.length;){var o=n[r];++r,null!=o&&o.drop(),o=null}n=null}this.geometry.remove(e)}this.geometry=null},__class__:Hi};var Ki=function(t,e){Hi.call(this,t,e)};n["luxe.tilemaps.IsometricVisual"]=Ki,Ki.__name__=["luxe","tilemaps","IsometricVisual"],Ki.__super__=Hi,Ki.prototype=e(Hi.prototype,{create:function(){for(var t=this.map.iterator();t.hasNext();){for(var e=t.next(),i=[],s=0,n=this.map.height;n>s;){for(var r=s++,o=[],a=0,h=this.map.width;h>a;){var l=a++,u=this.create_tile_for_layer(e,l,r);o.push(u)}i.push(o)}this.geometry.set(e.name,i)}if(this.options.grid){for(var c=new ai(1,1,1,.8).rgb(13369344),d=0,f=this.map.width+1;f>d;){var p=d++,m=Zi.tile_coord_to_worldpos(p,0,this.map.tile_width,this.map.tile_height,this.options.scale),g=Zi.tile_coord_to_worldpos(p,this.map.height,this.map.tile_width,this.map.tile_height,this.options.scale);_.draw.line({p0:new un(this.map.pos.x+m.x,this.map.pos.y+m.y),p1:new un(this.map.pos.x+g.x,this.map.pos.y+g.y),color:c,depth:this.options.depth+.001,group:this.options.group,batcher:this.options.batcher})}for(var v=0,y=this.map.height+1;y>v;){var w=v++,x=Zi.tile_coord_to_worldpos(0,w,this.map.tile_width,this.map.tile_height,this.options.scale),b=Zi.tile_coord_to_worldpos(this.map.width,w,this.map.tile_width,this.map.tile_height,this.options.scale);_.draw.line({p0:new un(this.map.pos.x+x.x,this.map.pos.y+x.y),p1:new un(this.map.pos.x+b.x,this.map.pos.y+b.y),color:c,depth:this.options.depth+.001,group:this.options.group,batcher:this.options.batcher})}}},update_tile_id:function(t,e,i,s,n){var r=this.map.tileset_from_id(n),o=r.pos_in_texture(n),a=t;a.uv(new $s(r.margin+(o.x*r.tile_width+o.x*r.spacing),r.margin+(o.y*r.tile_height+o.y*r.spacing),r.tile_width,r.tile_height))},create_tile_for_layer:function(t,e,i){var s=this.map.tile_width*this.options.scale,n=this.map.tile_height*this.options.scale,r=t.tiles[i][e];if(0==r.id)return null;var o=this.map.tileset_from_id(r.id);if(null==o)throw new ne(Re.null_assertion("tileset was null"+(" ( Tilemap Iso cannot find tileset for tile id "+r.id+" )")));var a=o.tile_width*this.options.scale,h=o.tile_height*this.options.scale,l=s/2,u=n/2,c=_.draw.box({x:this.map.pos.x+(e-i)*l-l,y:this.map.pos.y+(e+i)*u-u,w:a,h:h,texture:null!=o?o.texture:null,visible:t.visible,color:new ai(1,1,1,t.opacity),depth:this.options.depth,group:this.options.group,batcher:this.options.batcher});if(null!=o.texture){var d=o.pos_in_texture(r.id);c.uv(new $s(o.margin+(d.x*o.tile_width+d.x*o.spacing),o.margin+(d.y*o.tile_height+d.y*o.spacing),o.tile_width,o.tile_height)),o.texture.set_filter_min(o.texture.set_filter_mag(this.options.filter))}return c},__class__:Ki});var Wi=function(){};n["luxe.tilemaps.Ortho"]=Wi,Wi.__name__=["luxe","tilemaps","Ortho"],Wi.worldpos_to_tile_coord=function(t,e,i,s,n){null==n&&(n=1);var r=new un;return r.set_x(Math.floor(t/(i*n))),r.set_y(Math.floor(e/(s*n))),r},Wi.tile_coord_to_worldpos=function(t,e,i,s,n,r,o){null==n&&(n=1);var a=new un,h=i*n,l=s*n;if(a.set_x(t*h),a.set_y(e*l),null==r&&(r=es.left),null==o&&(o=es.top),null!=r)switch(r[1]){case 0:var _=a;_.set_x(_.x+h/2);break;case 4:var u=a;u.set_x(u.x+h)}if(null!=o)switch(o[1]){case 0:var c=a;c.set_y(c.y+l/2);break;case 2:var d=a;d.set_y(d.y+l)}return a};var Qi=function(t,e){Hi.call(this,t,e)};n["luxe.tilemaps.OrthoVisual"]=Qi,Qi.__name__=["luxe","tilemaps","OrthoVisual"],Qi.__super__=Hi,Qi.prototype=e(Hi.prototype,{create:function(){Hi.prototype.create.call(this);for(var t=this.map.tile_width*this.options.scale,e=this.map.tile_height*this.options.scale,i=this.map.iterator();i.hasNext();){for(var s=i.next(),n=[],r=0,o=this.map.height;o>r;){for(var a=r++,h=[],l=0,u=this.map.width;u>l;){var c=l++,d=this.create_tile_for_layer(s,c,a);h.push(d)}n.push(h)}this.geometry.set(s.name,n)}if(this.options.grid){for(var f=new ai(1,1,1,.8).rgb(13369344),p=0,m=this.map.width+1;m>p;){var g=p++;_.draw.line({p0:new un(this.map.pos.x+g*t,this.map.pos.y),p1:new un(this.map.pos.x+g*t,this.map.pos.y+this.map.height*e),color:f,depth:this.options.depth+1e-4,group:this.options.group,batcher:this.options.batcher})}for(var v=0,y=this.map.height+1;y>v;){var w=v++;_.draw.line({p0:new un(this.map.pos.x,this.map.pos.y+w*e),p1:new un(this.map.pos.x+this.map.width*t,this.map.pos.y+w*e),color:f,depth:this.options.depth+1e-4,group:this.options.group,batcher:this.options.batcher})}}},update_tile_id:function(t,e,i,s,n,r,o,a){var h=this.map.tileset_from_id(n),l=h.pos_in_texture(n),_=t;_.uv(new $s(h.margin+(l.x*h.tile_width+l.x*h.spacing),h.margin+(l.y*h.tile_height+l.y*h.spacing),h.tile_width,h.tile_height)),_.set_flipx(r),_.set_flipy(o),_.set_uv_angle(a)},create_tile_for_layer:function(t,e,i){var s=this.map.tile_width*this.options.scale,n=this.map.tile_height*this.options.scale,r=t.tiles[i][e];if(0==r.id)return null;var o=this.map.tileset_from_id(r.id);if(null==o)throw new ne(Re.null_assertion("tileset was null"+(" ( Tilemap Ortho cannot find tileset for tile id "+r.id+" )")));var a=o.tile_width*this.options.scale,h=o.tile_height*this.options.scale,l=0,u=h-n,c=_.draw.box({x:this.map.pos.x+r.x*s-l,y:this.map.pos.y+r.y*n-u,w:a,h:h,visible:t.visible,texture:null!=o?o.texture:null,color:new ai(1,1,1,t.opacity),depth:this.options.depth,group:this.options.group,batcher:this.options.batcher});if(null!=o.texture){var d=o.pos_in_texture(r.id);c.uv(new $s(o.margin+(d.x*o.tile_width+d.x*o.spacing),o.margin+(d.y*o.tile_height+d.y*o.spacing),o.tile_width,o.tile_height)),c.set_uv_angle(r.angle),c.set_flipx(r.flipx),c.set_flipy(r.flipy),o.texture.set_filter_min(o.texture.set_filter_mag(this.options.filter))}return c},__class__:Qi});var Yi=function(t){this.id=0,this.uuid=_.utils.uniqueid(),this.set_id(t.id),this.layer=t.layer,this.map=t.layer.map,this.x=t.x,this.y=t.y,this.set_flipx(function(){var e;return null==t.flipx&&(t.flipx=!1),e=t.flipx}(this)),this.set_flipy(function(){var e;return null==t.flipy&&(t.flipy=!1),e=t.flipy}(this)),this.set_angle(function(){var e;return null==t.angle&&(t.angle=0),e=t.angle}(this));var e=this.map.tileset_from_id(this.id);this.size=null!=e?new un(e.tile_width,e.tile_height):new un(this.map.tile_width,this.map.tile_height),this.pos=new un(this.map.pos.x+this.size.x*this.x,this.map.pos.y+this.size.y*this.y)};n["luxe.tilemaps.Tile"]=Yi,Yi.__name__=["luxe","tilemaps","Tile"],Yi.prototype={toString:function(){return"Tile: id:"+this.id+" x,y:"+this.x+","+this.y+" layer("+this.layer.name+") coord("+this.x+","+this.y+") pos("+this.pos.x+","+this.pos.y+") size("+this.size.x+","+this.size.y+") flipx,flipy:"+v.string(this.flipx)+","+v.string(this.flipy)+" angle:"+this.angle},set_id:function(t){return this.id=t,null!=this.map&&null!=this.map.visual&&this.map.visual.refresh_tile_id(this.layer.name,this.x,this.y,t,this.flipx,this.flipy,this.angle),this.id},set_flipx:function(t){return this.flipx=t,null!=this.map&&null!=this.map.visual&&this.map.visual.refresh_tile_id(this.layer.name,this.x,this.y,this.id,this.flipx,this.flipy,this.angle),this.flipx},set_flipy:function(t){return this.flipy=t,null!=this.map&&null!=this.map.visual&&this.map.visual.refresh_tile_id(this.layer.name,this.x,this.y,this.id,this.flipx,this.flipy,this.angle),this.flipy},set_angle:function(t){if(t%90!=0)throw new ne(Re.assertion("_val % 90 == 0 ( Tile angle has to be a multiple of 90 )"));return this.angle=t,null!=this.map&&null!=this.map.visual&&this.map.visual.refresh_tile_id(this.layer.name,this.x,this.y,this.id,this.flipx,this.flipy,this.angle),this.angle},__class__:Yi,__properties__:{set_id:"set_id",set_angle:"set_angle",set_flipy:"set_flipy",set_flipx:"set_flipx"}};var Ji=function(t){if(this.fixed=!0,this.visible=!0,this.opacity=1,null==t.map)throw new ne(Re.null_assertion("options.map was null ( TileLayer requires a Tilemap passed into the options, as map:Tilemap )"));this.id=_.utils.uniqueid(),this.name=t.name,this.map=t.map,null==t.layer&&(t.layer=0),this.layer=t.layer,null==t.opacity&&(t.opacity=1),this.opacity=t.opacity,null==t.visible&&(t.visible=!0),this.visible=t.visible,null==t.fixed&&(t.fixed=!0),this.fixed=t.fixed,null==t.properties&&(t.properties=new V),this.properties=t.properties,this.tiles=[]};n["luxe.tilemaps.TileLayer"]=Ji,Ji.__name__=["luxe","tilemaps","TileLayer"],Ji.prototype={bounds_fitted:function(){for(var t=[],e=[],i=-1,s=-1,n=-1,r=this.map.width,o=this.map.height,a=0;o>a;){for(var h=a++,l=0;r>l;){var _=l++;s=h*r+_,n=this.tiles[h][_].id,n>0&&(0==t[s]||null==t[s])?(-1==i&&(i=_),t[s]=!0):(0==n||1==t[s])&&-1!=i&&(e.push(this.find_bounds_rect(h,i,_,t)),i=-1)}-1!=i&&(e.push(this.find_bounds_rect(h,i,r,t)),i=-1)}return e},find_bounds_rect:function(t,e,i,s){for(var n=-1,r=-1,o=this.map.width,a=this.map.height,h=t+1;a>h;)for(var l=h++,_=e;i>_;){var u=_++;if(n=l*o+u,r=this.tiles[l][u].id,0==r||1==s[n]){for(var c=e;u>c;){var d=c++;n=l*o+d,s[n]=!1}return new $s(e,t,i-e,l-t)}s[n]=!0}return new $s(e,t,i-e,a-t)},__class__:Ji};var $i=function(t){if(this.spacing=0,this.margin=0,this.tile_height=0,this.tile_width=0,this.first_id=1,null==t)throw new ne(Re.null_assertion("options was null ( Tileset requires a non-null options on new() )"));if(null==t.texture)throw new ne(Re.null_assertion("options.texture was null ( Tileset requires a texture that is not null )"));this.name=t.name,this.texture=t.texture,this.tile_width=t.tile_width,this.tile_height=t.tile_height,null==t.first_id&&(t.first_id=1),this.first_id=t.first_id,null==t.margin&&(t.margin=0),this.margin=t.margin,null==t.spacing&&(t.spacing=0),this.spacing=t.spacing};n["luxe.tilemaps.Tileset"]=$i,$i.__name__=["luxe","tilemaps","Tileset"],$i.prototype={toString:function(){return"Tileset; "+this.name+" tw("+this.tile_width+") th("+this.tile_height+") first_id("+this.first_id+") margin("+this.margin+") spacing("+this.spacing+")"},pos_in_texture:function(t){var e=t-this.first_id;return new un(this.texture_x(e),this.texture_y(e))},texture_x:function(t){var e=this.texture.width/this.tile_width|0;return 0==e?0:t%e},texture_y:function(t){var e=this.texture.width/this.tile_width|0;return 0==e?0:t/e|0},__class__:$i};var ts=n["luxe.tilemaps.TilemapOrientation"]={__ename__:["luxe","tilemaps","TilemapOrientation"],__constructs__:["ortho","isometric","none"]};ts.ortho=["ortho",0],ts.ortho.toString=r,ts.ortho.__enum__=ts,ts.isometric=["isometric",1],ts.isometric.toString=r,ts.isometric.__enum__=ts,ts.none=["none",2],ts.none.toString=r,ts.none.__enum__=ts;var es=n["luxe.tilemaps.TileOffset"]={__ename__:["luxe","tilemaps","TileOffset"],__constructs__:["center","top","bottom","left","right"]};es.center=["center",0],es.center.toString=r,es.center.__enum__=es,es.top=["top",1],es.top.toString=r,es.top.__enum__=es,es.bottom=["bottom",2],es.bottom.toString=r,es.bottom.__enum__=es,es.left=["left",3],es.left.toString=r,es.left.__enum__=es,es.right=["right",4],es.right.toString=r,es.right.__enum__=es;var is=function(){};n["luxe.tween.actuators.IGenericActuator"]=is,is.__name__=["luxe","tween","actuators","IGenericActuator"],is.prototype={__class__:is};var ss=function(t,e,i){this.timescaled=!1,this._autoVisible=!0,this._delay=0,this._reflect=!1,this._repeat=0,this._reverse=!1,this._smartRotation=!1,this._snapping=!1,this.special=!1,this.target=t,this.properties=i,this.duration=e,this._ease=hs.defaultEase};n["luxe.tween.actuators.GenericActuator"]=ss,ss.__name__=["luxe","tween","actuators","GenericActuator"],ss.__interfaces__=[is],ss.prototype={apply:function(){for(var t=0,e=p.fields(this.properties);t<e.length;){var i=e[t];++t,Object.prototype.hasOwnProperty.call(this.target,i)?p.setField(this.target,i,p.field(this.properties,i)):p.setProperty(this.target,i,p.field(this.properties,i))}},autoVisible:function(t){return null==t&&(t=!0),this._autoVisible=t,this},callMethod:function(t,e){return null==e&&(e=[]),p.callMethod(t,t,e)},change:function(){null!=this._onUpdate&&this.callMethod(this._onUpdate,this._onUpdateParams)},complete:function(t){null==t&&(t=!0),t&&(this.change(),null!=this._onComplete&&this.callMethod(this._onComplete,this._onCompleteParams)),hs.unload(this)},delay:function(t){return this._delay=t,this},ease:function(t){return this._ease=t,this},move:function(){},timescale:function(t){return null==t&&(t=!0),this.timescaled=t,this},onComplete:function(t,e){return this._onComplete=t,this._onCompleteParams=null==e?[]:e,0==this.duration&&this.complete(),this},onRepeat:function(t,e){return this._onRepeat=t,this._onRepeatParams=null==e?[]:e,this},onUpdate:function(t,e){return this._onUpdate=t,this._onUpdateParams=null==e?[]:e,this},pause:function(){},reflect:function(t){return null==t&&(t=!0),this._reflect=t,this.special=!0,this},repeat:function(t){return null==t&&(t=-1),this._repeat=t,this},resume:function(){},reverse:function(t){return null==t&&(t=!0),this._reverse=t,this.special=!0,this},smartRotation:function(t){return null==t&&(t=!0),this._smartRotation=t,this.special=!0,this},snapping:function(t){return null==t&&(t=!0),this._snapping=t,this.special=!0,this},stop:function(){},__class__:ss};var ns=function(t,e,i){this.has_timescaled_starttime=!1,this.active=!0,this.propertyDetails=[],this.sendChange=!1,this.paused=!1,this.cacheVisible=!1,this.initialized=!1,this.setVisible=!1,this.toggleVisible=!1,this.startTime=Nn.core.timestamp(),ss.call(this,t,e,i),ns.addedEvent||(ns.addedEvent=!0,_.on(4,ns.on_internal_update))};n["luxe.tween.actuators.SimpleActuator"]=ns,ns.__name__=["luxe","tween","actuators","SimpleActuator"],ns.on_internal_update=function(t){ns.update_timer+=t,ns.current_time=Nn.core.timestamp();for(var e,i=ns.current_time,s=0,n=0,r=ns.actuatorsLength;r>n;){{n++}e=ns.actuators[s],null!=e&&e.active?(i=e.timescaled?ns.update_timer:ns.current_time,e.timescaled&&!e.has_timescaled_starttime&&(e.has_timescaled_starttime=!0,e.startTime=ns.update_timer,e.timeOffset=e.startTime),i>e.timeOffset&&e.update(i),s++):(ns.actuators.splice(s,1),--ns.actuatorsLength)}},ns.__super__=ss,ns.prototype=e(ss.prototype,{autoVisible:function(t){return null==t&&(t=!0),this._autoVisible=t,t||(this.toggleVisible=!1,this.setVisible&&this.setField(this.target,"visible",this.cacheVisible)),this},delay:function(t){return this._delay=t,this.timeOffset=this.startTime+t,this},getField:function(t,e){var i=null;return i=Object.prototype.hasOwnProperty.call(t,e)?p.field(t,e):p.getProperty(t,e)},initialize:function(){for(var t,e,i=0,s=p.fields(this.properties);i<s.length;){var n=s[i];++i;var r=!0;!Object.prototype.hasOwnProperty.call(this.target,n)||this.target.__properties__&&this.target.__properties__["set_"+n]?(r=!1,e=p.getProperty(this.target,n)):e=p.field(this.target,n),"number"==typeof e&&(t=new vs(this.target,n,e,this.getField(this.properties,n)-e,r),this.propertyDetails.push(t))}this.detailsLength=this.propertyDetails.length,this.initialized=!0},move:function(){this.toggleVisible=Object.prototype.hasOwnProperty.call(this.properties,"alpha")&&Object.prototype.hasOwnProperty.call(this.properties,"visible"),this.toggleVisible&&0!=this.properties.alpha&&!this.getField(this.target,"visible")&&(this.setVisible=!0,this.cacheVisible=this.getField(this.target,"visible"),this.setField(this.target,"visible",!0)),this.timeOffset=this.startTime,ns.actuators.push(this),++ns.actuatorsLength},onUpdate:function(t,e){return this._onUpdate=t,this._onUpdateParams=null==e?[]:e,this.sendChange=!0,this},pause:function(){this.paused=!0,this.pauseTime=this.timescaled?ns.update_timer:ns.current_time},resume:function(){this.paused&&(this.paused=!1,this.timeOffset+=((this.timescaled?ns.update_timer:ns.current_time)-this.pauseTime)/1e3)},setField:function(t,e,i){Object.prototype.hasOwnProperty.call(t,e)?t[e]=i:p.setProperty(t,e,i)},setProperty:function(t,e){t.isField?p.setProperty(t.target,t.propertyName,e):p.setProperty(t.target,t.propertyName,e)},stop:function(t,e,i){if(this.active){if(null==t)return this.active=!1,e&&this.apply(),void this.complete(i);for(var s=0,n=p.fields(t);s<n.length;){var r=n[s];if(++s,Object.prototype.hasOwnProperty.call(this.properties,r))return this.active=!1,e&&this.apply(),void this.complete(i)}}},update:function(t){if(!this.paused){var e,i,s=(t-this.timeOffset)/this.duration;if(s>1&&(s=1),this.initialized||this.initialize(),this.special){i=this._ease.calculate(this._reverse?1-s:s);for(var n,r=0,o=this.detailsLength;o>r;){var a=r++;if(e=this.propertyDetails[a],!this._smartRotation||"rotation"!=e.propertyName&&"rotationX"!=e.propertyName&&"rotationY"!=e.propertyName&&"rotationZ"!=e.propertyName)n=e.start+e.change*i;else{var h=e.change%360;h>180?h-=360:-180>h&&(h+=360),n=e.start+h*i}this._snapping?this.setProperty(e,Math.round(n)):e.isField?p.setProperty(e.target,e.propertyName,n):p.setProperty(e.target,e.propertyName,n)}}else{i=this._ease.calculate(s);for(var l=0,_=this.detailsLength;_>l;){var u=l++;e=this.propertyDetails[u],this.setProperty(e,e.start+e.change*i)}}if(1==s){if(0==this._repeat)return this.active=!1,this.toggleVisible&&0==this.getField(this.target,"alpha")&&this.setField(this.target,"visible",!1),void this.complete(!0);null!=this._onRepeat&&this.callMethod(this._onRepeat,this._onRepeatParams),this._reflect&&(this._reverse=!this._reverse),this.startTime=t,this.timeOffset=this.startTime+this._delay,this._repeat>0&&this._repeat--}this.sendChange&&this.change()}},__class__:ns});var rs=function(){};n["luxe.tween.easing.Quad"]=rs,rs.__name__=["luxe","tween","easing","Quad"],rs.__properties__={get_easeOut:"get_easeOut",get_easeInOut:"get_easeInOut",get_easeIn:"get_easeIn"},rs.get_easeIn=function(){return new bs},rs.get_easeInOut=function(){return new ks},rs.get_easeOut=function(){return new as};var os=function(){};n["luxe.tween.easing.IEasing"]=os,os.__name__=["luxe","tween","easing","IEasing"],os.prototype={__class__:os};var as=function(){};n["luxe.tween.easing.QuadEaseOut"]=as,as.__name__=["luxe","tween","easing","QuadEaseOut"],as.__interfaces__=[os],as.prototype={calculate:function(t){return-t*(t-2)},ease:function(t,e,i,s){return-i*(t/=s)*(t-2)+e},__class__:as};var hs=function(){};n["luxe.tween.Actuate"]=hs,hs.__name__=["luxe","tween","Actuate"],hs.apply=function(t,e,i){hs.stop(t,e),null==i&&(i=hs.defaultActuator);var s=b.createInstance(i,[t,0,e]);return s.apply(),s},hs.getLibrary=function(t,e){return null==e&&(e=!0),!hs.targetLibraries.exists(t)&&e&&hs.targetLibraries.set(t,[]),hs.targetLibraries.get(t)},hs.motionPath=function(t,e,i,s){return null==s&&(s=!0),hs.tween(t,e,i,s,gs)},hs.pause=function(t){if(re.__instanceof(t,ss))re.__cast(t,ss).pause();else{var e=hs.getLibrary(t,!1);if(null!=e)for(var i=0;i<e.length;){var s=e[i];++i,s.pause()}}},hs.pauseAll=function(){for(var t=hs.targetLibraries.iterator();t.hasNext();)for(var e=t.next(),i=0;i<e.length;){var s=e[i];++i,s.pause()}},hs.reset=function(){for(var t=hs.targetLibraries.iterator();t.hasNext();)for(var e=t.next(),i=e.length-1;i>=0;)e[i].stop(null,!1,!1),i--;hs.targetLibraries=new G},hs.resume=function(t){if(re.__instanceof(t,ss))re.__cast(t,ss).resume();else{var e=hs.getLibrary(t,!1);if(null!=e)for(var i=0;i<e.length;){var s=e[i];++i,s.resume()}}},hs.resumeAll=function(){for(var t=hs.targetLibraries.iterator();t.hasNext();)for(var e=t.next(),i=0;i<e.length;){var s=e[i];++i,s.resume()}},hs.stop=function(t,e,i,s){if(null==s&&(s=!0),null==i&&(i=!1),null!=t)if(re.__instanceof(t,ss))re.__cast(t,ss).stop(null,i,s);else{var n=hs.getLibrary(t,!1);if(null!=n){if("string"==typeof e){var r={};p.setField(r,e,null),e=r}else if(e instanceof Array&&null==e.__enum__){var o,a={},h=0;for(o=re.__cast(e,Array);h<o.length;){var l=o[h];++h,p.setField(a,l,null)}e=a}for(var _=n.length-1;_>=0;)n[_].stop(e,i,s),_--}}},hs.timer=function(t,e){return hs.tween(new ls(0),t,new ls(1),!1,e)},hs.tween=function(t,e,i,s,n){if(null==s&&(s=!0),null!=t){if(e>0){null==n&&(n=hs.defaultActuator);var r=b.createInstance(n,[t,e,i]),o=hs.getLibrary(r.target);if(s){for(var a=o.length-1;a>=0;)o[a].stop(r.properties,!1,!1),a--;o=hs.getLibrary(r.target)}return o.push(r),r.move(),r}return hs.apply(t,i,n)}return null},hs.unload=function(t){var e=t.target;null!=hs.targetLibraries.h.__keys__[e.__id__]&&(a.remove(hs.targetLibraries.h[e.__id__],t),0==hs.targetLibraries.h[e.__id__].length&&hs.targetLibraries.remove(e))},hs.update=function(t,e,i,s,n){null==n&&(n=!0);var r={start:i,end:s};return hs.tween(t,e,r,n,ms)};var ls=function(t){this.progress=t};n["luxe.tween._Actuate.TweenTimer"]=ls,ls.__name__=["luxe","tween","_Actuate","TweenTimer"],ls.prototype={__class__:ls};var _s=function(){this._x=new cs,this._y=new cs,this._rotation=null};n["luxe.tween.MotionPath"]=_s,_s.__name__=["luxe","tween","MotionPath"],_s.prototype={bezier:function(t,e,i,s,n){return null==n&&(n=1),this._x.addPath(new ds(t,i,n)),this._y.addPath(new ds(e,s,n)),this},line:function(t,e,i){return null==i&&(i=1),this._x.addPath(new fs(t,i)),this._y.addPath(new fs(e,i)),this},get_rotation:function(){return null==this._rotation&&(this._rotation=new ps(this._x,this._y)),this._rotation},get_x:function(){return this._x},get_y:function(){return this._y},__class__:_s,__properties__:{get_y:"get_y",get_x:"get_x",get_rotation:"get_rotation"}};var us=function(){};n["luxe.tween.IComponentPath"]=us,us.__name__=["luxe","tween","IComponentPath"],us.prototype={__class__:us,__properties__:{get_end:"get_end"}};var cs=function(){this.paths=[],this.start=0,this.totalStrength=0};n["luxe.tween.ComponentPath"]=cs,cs.__name__=["luxe","tween","ComponentPath"],cs.__interfaces__=[us],cs.prototype={addPath:function(t){this.paths.push(t),this.totalStrength+=t.strength},calculate:function(t){if(1==this.paths.length)return this.paths[0].calculate(this.start,t);for(var e=t*this.totalStrength,i=this.start,s=0,n=this.paths;s<n.length;){var r=n[s];if(++s,!(e>r.strength))return r.calculate(i,e/r.strength);e-=r.strength,i=r.end}return 0},get_end:function(){if(this.paths.length>0){var t=this.paths[this.paths.length-1];return t.end}return this.start},__class__:cs,__properties__:{get_end:"get_end"}};
var ds=function(t,e,i){this.end=t,this.control=e,this.strength=i};n["luxe.tween.BezierPath"]=ds,ds.__name__=["luxe","tween","BezierPath"],ds.prototype={calculate:function(t,e){return(1-e)*(1-e)*t+2*(1-e)*e*this.control+e*e*this.end},__class__:ds};var fs=function(t,e){ds.call(this,t,0,e)};n["luxe.tween.LinearPath"]=fs,fs.__name__=["luxe","tween","LinearPath"],fs.__super__=ds,fs.prototype=e(ds.prototype,{calculate:function(t,e){return t+e*(this.end-t)},__class__:fs});var ps=function(t,e){this.step=.01,this._x=t,this._y=e,this.offset=0,this.start=this.calculate(0)};n["luxe.tween.RotationPath"]=ps,ps.__name__=["luxe","tween","RotationPath"],ps.__interfaces__=[us],ps.prototype={calculate:function(t){var e=this._x.calculate(t)-this._x.calculate(t+this.step),i=this._y.calculate(t)-this._y.calculate(t+this.step),s=Math.atan2(i,e)*(180/Math.PI);return s=(s+this.offset)%360},get_end:function(){return this.calculate(1)},__class__:ps,__properties__:{get_end:"get_end"}};var ms=function(t,e,i){this.currentParameters=[],this.tweenProperties={},ns.call(this,t,e,i),Object.prototype.hasOwnProperty.call(i,"start")||(this.properties.start=[]),Object.prototype.hasOwnProperty.call(i,"end")||(this.properties.end=this.properties.start);for(var s=0,n=this.properties.start.length;n>s;){{s++}this.currentParameters.push(null)}};n["luxe.tween.actuators.MethodActuator"]=ms,ms.__name__=["luxe","tween","actuators","MethodActuator"],ms.__super__=ns,ms.prototype=e(ns.prototype,{apply:function(){this.callMethod(this.target,this.properties.end)},complete:function(t){null==t&&(t=!0);for(var e=0,i=this.properties.start.length;i>e;){var s=e++;this.currentParameters[s]=p.field(this.tweenProperties,"param"+s)}this.callMethod(this.target,this.currentParameters),ns.prototype.complete.call(this,t)},initialize:function(){for(var t,e,i,s=0,n=this.properties.start.length;n>s;){var r=s++;e="param"+r,i=this.properties.start[r],this.tweenProperties[e]=i,("number"==typeof i||(0|i)===i)&&(t=new vs(this.tweenProperties,e,i,this.properties.end[r]-i),this.propertyDetails.push(t))}this.detailsLength=this.propertyDetails.length,this.initialized=!0},update:function(t){if(ns.prototype.update.call(this,t),this.active){for(var e=0,i=this.properties.start.length;i>e;){var s=e++;this.currentParameters[s]=p.field(this.tweenProperties,"param"+s)}this.callMethod(this.target,this.currentParameters)}},__class__:ms});var gs=function(t,e,i){ns.call(this,t,e,i)};n["luxe.tween.actuators.MotionPathActuator"]=gs,gs.__name__=["luxe","tween","actuators","MotionPathActuator"],gs.__super__=ns,gs.prototype=e(ns.prototype,{apply:function(){for(var t=0,e=p.fields(this.properties);t<e.length;){var i=e[t];++t,Object.prototype.hasOwnProperty.call(this.target,i)?p.setField(this.target,i,re.__cast(p.field(this.properties,i),us).get_end()):p.setProperty(this.target,i,re.__cast(p.field(this.properties,i),us).get_end())}},initialize:function(){for(var t,e,i=0,s=p.fields(this.properties);i<s.length;){var n=s[i];if(++i,e=re.__cast(p.field(this.properties,n),us),null!=e){var r=!0;Object.prototype.hasOwnProperty.call(this.target,n)?e.start=p.field(this.target,n):(r=!1,e.start=p.getProperty(this.target,n)),t=new ys(this.target,n,e,r),this.propertyDetails.push(t)}}this.detailsLength=this.propertyDetails.length,this.initialized=!0},update:function(t){if(!this.paused){var e,i=(t-this.timeOffset)/this.duration;if(i>1&&(i=1),this.initialized||this.initialize(),this.special){e=this._ease.calculate(this._reverse?1-i:i);for(var s=0,n=this.propertyDetails;s<n.length;){var r=n[s];++s,this._snapping?r.isField?p.setField(r.target,r.propertyName,Math.round(re.__cast(r,ys).path.calculate(e))):p.setProperty(r.target,r.propertyName,Math.round(re.__cast(r,ys).path.calculate(e))):r.isField?p.setField(r.target,r.propertyName,re.__cast(r,ys).path.calculate(e)):p.setProperty(r.target,r.propertyName,re.__cast(r,ys).path.calculate(e))}}else{e=this._ease.calculate(i);for(var o=0,a=this.propertyDetails;o<a.length;){var h=a[o];++o,h.isField?p.setField(h.target,h.propertyName,re.__cast(h,ys).path.calculate(e)):p.setProperty(h.target,h.propertyName,re.__cast(h,ys).path.calculate(e))}}if(1==i){if(0==this._repeat)return this.active=!1,this.toggleVisible&&0==this.getField(this.target,"alpha")&&this.setField(this.target,"visible",!1),void this.complete(!0);this._reflect&&(this._reverse=!this._reverse),this.startTime=t,this.timeOffset=this.startTime+this._delay,this._repeat>0&&this._repeat--}this.sendChange&&this.change()}},__class__:gs});var vs=function(t,e,i,s,n){null==n&&(n=!0),this.target=t,this.propertyName=e,this.start=i,this.change=s,this.isField=n};n["luxe.tween.actuators.PropertyDetails"]=vs,vs.__name__=["luxe","tween","actuators","PropertyDetails"],vs.prototype={__class__:vs};var ys=function(t,e,i,s){null==s&&(s=!0),vs.call(this,t,e,0,0,s),this.path=i};n["luxe.tween.actuators.PropertyPathDetails"]=ys,ys.__name__=["luxe","tween","actuators","PropertyPathDetails"],ys.__super__=vs,ys.prototype=e(vs.prototype,{__class__:ys});var ws=function(){};n["luxe.tween.easing.Linear"]=ws,ws.__name__=["luxe","tween","easing","Linear"],ws.__properties__={get_easeNone:"get_easeNone"},ws.get_easeNone=function(){return new xs};var xs=function(){};n["luxe.tween.easing.LinearEaseNone"]=xs,xs.__name__=["luxe","tween","easing","LinearEaseNone"],xs.__interfaces__=[os],xs.prototype={calculate:function(t){return t},ease:function(t,e,i,s){return i*t/s+e},__class__:xs};var bs=function(){};n["luxe.tween.easing.QuadEaseIn"]=bs,bs.__name__=["luxe","tween","easing","QuadEaseIn"],bs.__interfaces__=[os],bs.prototype={calculate:function(t){return t*t},ease:function(t,e,i,s){return i*(t/=s)*t+e},__class__:bs};var ks=function(){};n["luxe.tween.easing.QuadEaseInOut"]=ks,ks.__name__=["luxe","tween","easing","QuadEaseInOut"],ks.__interfaces__=[os],ks.prototype={calculate:function(t){return(t*=2)<1?.5*t*t:-.5*((t-1)*(t-3)-1)},ease:function(t,e,i,s){return(t/=s/2)<1?i/2*t*t+e:-i/2*((t-1)*(t-3)-1)+e},__class__:ks};var zs=function(){};n["luxe.utils.GeometryUtils"]=zs,zs.__name__=["luxe","utils","GeometryUtils"],zs.prototype={segments_for_smooth_circle:function(t,e){return null==e&&(e=5),v["int"](e*Math.sqrt(t))},random_point_in_unit_circle:function(){var t=Math.sqrt(Math.random()),e=6.283185307179586*(-1+2*Math.random());return new un(t*Math.cos(e),t*Math.sin(e))},point_in_polygon:function(t,e,i){null==e&&(e=new un);for(var s=!1,n=i.length,r=n-1,o=0;n>o;){var a=o++;i[a].y+e.y>t.y!=i[r].y+e.y>t.y&&t.x<(i[r].x+e.x-(i[a].x+e.x))*(t.y-(i[a].y+e.y))/(i[r].y+e.y-(i[a].y+e.y))+(i[a].x+e.x)&&(s=!s),r=a}return s},point_in_geometry:function(t,e){for(var i=!1,s=e.vertices.length,n=s-1,r=0;s>r;){var o=r++,a=e.vertices[o].pos.clone().transform(e.transform.get_world().get_matrix()),h=e.vertices[n].pos.clone().transform(e.transform.get_world().get_matrix());a.y>t.y!=h.y>t.y&&t.x<(h.x-a.x)*(t.y-a.y)/(h.y-a.y)+a.x&&(i=!i),n=o}return i},intersect_ray_plane:function(t,e,i,s){var n=i.dot(new un(s.x-t.x,s.y-t.y,s.z-t.z)),r=i.x*e.x+i.y*e.y+i.z*e.z,o=n/r;return un.Add(t,un.Multiply(e,o))},__class__:zs};var Es=function(){};n["luxe.utils.Maths"]=Es,Es.__name__=["luxe","utils","Maths"],Es.fixed=function(t,e){var i=Math.pow(10,e);return(t*i|0)/i},Es.lerp=function(t,e,i){return i=0>i?0:i>1?1:i,t+i*(e-t)},Es.weighted_avg=function(t,e,i){return 0==i&&(i=1e-8),(t*(i-1)+e)/i},Es.clamp=function(t,e,i){return e>t?e:t>i?i:t},Es.clampi=function(t,e,i){return e>t?e:t>i?i:t},Es.clamp_bottom=function(t,e){return e>t?e:t},Es.within_range=function(t,e,i){return t>=e&&i>=t},Es.wrap_angle=function(t,e,i){var s=i-e,n=Math.floor((t-e)/s);return t-n*s},Es.nearest_power_of_two=function(t){return t--,t|=t>>1,t|=t>>2,t|=t>>4,t|=t>>8,t|=t>>16,t++,t},Es.map_linear=function(t,e,i,s,n){return s+(t-e)*(n-s)/(i-e)},Es.smoothstep=function(t,e,i){return e>=t?0:t>=i?1:(t=(t-e)/(i-e),t*t*(3-2*t))},Es.smootherstep=function(t,e,i){return e>=t?0:t>=i?1:(t=(t-e)/(i-e),t*t*t*(t*(6*t-15)+10))},Es.sign=function(t){return t>=0?1:-1},Es.sign0=function(t){return 0>t?-1:t>0?1:0},Es.radians=function(t){return.017453292519943278*t},Es.degrees=function(t){return 57.29577951308238*t},Es.prototype={__class__:Es};var As=function(t){if(!(t>0))throw new ne(Re.assertion("_initial_seed > 0 ( initial negative seed will return negative random results, if this was intentional, define luxe_random_allow_negative_seed )"));this.initial=this.seed=t,this.seed=this.initial};n["luxe.utils.Random"]=As,As.__name__=["luxe","utils","Random"],As.prototype={get:function(){return(this.seed=16807*this.seed%2147483647)/2147483647+2.33e-10},"float":function(t,e){return null==e&&(e=t,t=0),((this.seed=16807*this.seed%2147483647)/2147483647+2.33e-10)*(e-t)+t},"int":function(t,e){return null==e&&(e=t,t=0),Math.floor(this["float"](t,e))},bool:function(t){return null==t&&(t=.5),(this.seed=16807*this.seed%2147483647)/2147483647+2.33e-10<t},sign:function(t){return null==t&&(t=.5),(this.seed=16807*this.seed%2147483647)/2147483647+2.33e-10<t?1:-1},bit:function(t){return null==t&&(t=.5),(this.seed=16807*this.seed%2147483647)/2147483647+2.33e-10<t?1:0},reset:function(){var t=this.seed;this.initial=this.seed=t,this.initial},set_initial:function(t){return this.initial=this.seed=t,this.initial},__class__:As,__properties__:{set_initial:"set_initial"}};var Cs=function(t){this.core=t,this.geometry=new zs,this.random=new As(16777215*Math.random()),this._byte_levels=["bytes","Kb","MB","GB","TB"]};n["luxe.utils.Utils"]=Cs,Cs.__name__=["luxe","utils","Utils"],Cs.prototype={pos_info:function(t){return""+t.fileName+":"+t.lineNumber+":("+t.className+":"+t.methodName+")"},uniqueid:function(t){null==t&&(t=v.random(2147483647));var e=function(t){if(t>9){var e=65+(t-10);return e>90&&(e+=6),String.fromCharCode(e)}return(null==t?"null":""+t).charAt(0)},i=t%62|0,s=t/62|0;return s>0?this.uniqueid(s)+e(i):v.string(e(i))},uniquehash:function(){return this.hash(this.uniqueid())},hash:function(t){return this.hashdjb2(t)},hashdjb2:function(t){for(var e=5381,i=0,s=t.length;s>i;){var n=i++;e=(e<<5)+e+a.cca(t,n)}return e},uniqueid2:function(){return D.encode(v.string(Nn.core.timestamp()*Math.random()))},stacktrace:function(t){null==t&&(t=100);var e="\n",i=A.callStack();i.shift(),i.reverse();for(var s=v["int"](Math.min(i.length,t)),n=0;s>n;){var r=n++,o=(i[r],i[r]);switch(o[1]){case 2:var a=o[4],h=o[3],l=o[2];if(null!=l)switch(l[1]){case 3:var _=l[3],u=l[2];e+="   at "+h+":"+a+": "+u+"."+_}}r!=s-1&&(e+="\n")}return e},path_is_relative:function(t){return"#"!=t.charAt(0)&&"/"!=t.charAt(0)&&-1==t.indexOf(":\\")&&-1==t.indexOf(":/")&&(-1==t.indexOf("//")||t.indexOf("//")>t.indexOf("#")||t.indexOf("//")>t.indexOf("?"))},find_assets_sequence:function(t,e,i){null==i&&(i="1"),null==e&&(e=".png");var s=[],n="",r=null,a=t+i+e,h=new o("("+t+")(\\d\\b)","gi"),l=t+"_"+i+e,u=new o("("+t+")(_\\d\\b)","gi"),c=t+"-"+i+e,d=new o("("+t+")(-\\d\\b)","gi");if(_.resources.cache.exists(a)?(n=a,r=h):_.resources.cache.exists(l)?(n=l,r=u):_.resources.cache.exists(c)?(n=c,r=d):S.trace("Sequence requested from "+t+" but no assets found like `"+a+"` or `"+l+"` or `"+c+"`",{fileName:"Utils.hx",lineNumber:170,className:"luxe.utils.Utils",methodName:"find_assets_sequence"}),""!=n){for(var f=this.core.resources.cache.iterator();f.hasNext();){var p=f.next();r.match(p.id)&&s.push(p.id)}s.sort(function(t,e){return t==e?0:e>t?-1:1})}return s},text_wrap_column_knuth_plass:function(t,e){null==e&&(e=80);var i,s=[],n=[],r=[],a=new U;a.h[0]=0,i=a;for(var h=new U,l=t,_=new o("(\\b[^\\s]+\\b)","gm");_.match(l);)n.push(_.matched(1)),l=_.matchedRight();0==n.length&&n.push(t),n.map(function(t){r.push(t.length)});for(var u=n.length,c=1,d=u+1;d>c;){for(var f=c++,p=new U,m=f;function(){for(var t,e=0,i=m-1;f>i;){var s=i++;e+=r[s]}return t=e+(f-m+1)}(this)<=e&&m>0;){var g;g=e-function(){for(var t,e=0,i=m-1;f>i;){var s=i++;e+=r[s]}return t=e+(f-m+1)}(this);var y=v["int"](Math.pow(g,3)+i.h[m-1]);p.h[y]=m,m-=1}for(var w,x=1073741823,b=p.keys();b.hasNext();){var k=b.next();x>k&&(x=k)}w=x,i.h[f]=w;var z=p.h[w];h.h[f]=z}for(var E=1;u>1;)s.unshift(n.slice(h.h[u]-1,u).join(" ")),u=h.h[u]-1,E+=1;return 0==s.length&&s.push(t),s},text_wrap_column:function(t,e,i){null==i&&(i=80),null==e&&(e="\n");var s=new o("(.{1,"+i+"})(?: +|$)\n?|(.{"+i+"})","gimu").replace(t,"$1$2"+e);return w.rtrim(s)},bytes_to_string:function(t,e){null==e&&(e=3);var i=Math.floor(Math.log(t)/Math.log(1024)),s=t/Math.pow(1024,i);return s=Es.fixed(s,e),s+" "+this._byte_levels[i]},array_to_bytes:function(t){if(null==t)return null;for(var e=F.alloc(t.length),i=0,s=e.length;s>i;){var n=i++;e.b[n]=255&t[n]}return e},premultiply_alpha:function(t){for(var e=t.length,i=(t[0],0);e>i;){var s=t[i],n=t[i+1],r=t[i+2],o=k.toFloat(t[i+3])/255,a=v["int"](k.toFloat(s)*o);t[i]=a;var h=v["int"](k.toFloat(n)*o);t[i+1]=h;var l=v["int"](k.toFloat(r)*o);t[i+2]=l,i+=4}return t},premultiply_alpha_normalized:function(t){for(var e=t.length,i=(t[0],0);e>i;){var s=t[i],n=t[i+1],r=t[i+2],o=t[i+3];t[i]=s*o,t[i+1]=n*o,t[i+2]=r*o,i+=4}return t},__class__:Cs};var Ts={};n["luxe.utils.unifill._CodePoint.CodePoint_Impl_"]=Ts,Ts.__name__=["luxe","utils","unifill","_CodePoint","CodePoint_Impl_"],Ts.cons=function(t,e){return Ns.fromCodePoint(t)+e},Ts.snoc=function(t,e){return t+Ns.fromCodePoint(e)},Ts.addInt=function(t,e){return t+e},Ts.sub=function(t,e){return t-e},Ts.subInt=function(t,e){return t-e},Ts._new=function(t){var e;if(!(t>=0&&1114111>=t)||t>=55296&&56319>=t||t>=56320&&57343>=t)throw new ne(Is.InvalidCodePoint(t));return e=t},Ts.toString=function(t){return Ns.fromCodePoint(t)},Ts.toInt=function(t){return t};var Ss=function(t){this.i=0,this.string=t,this.index=0,this.endIndex=t.length};n["luxe.utils.unifill.CodePointIter"]=Ss,Ss.__name__=["luxe","utils","unifill","CodePointIter"],Ss.prototype={hasNext:function(){return this.index<this.endIndex},next:function(){return this.i=this.index,this.index+=Ns.codePointWidthAt(this.string,this.index),Ps.codePointAt(this.string,this.i)},__class__:Ss};var Is=n["luxe.utils.unifill.Exception"]={__ename__:["luxe","utils","unifill","Exception"],__constructs__:["InvalidCodePoint","InvalidCodeUnitSequence"]};Is.InvalidCodePoint=function(t){var e=["InvalidCodePoint",0,t];return e.__enum__=Is,e.toString=r,e},Is.InvalidCodeUnitSequence=function(t){var e=["InvalidCodeUnitSequence",1,t];return e.__enum__=Is,e.toString=r,e};var Ns=function(){};n["luxe.utils.unifill.InternalEncoding"]=Ns,Ns.__name__=["luxe","utils","unifill","InternalEncoding"],Ns.__properties__={get_internalEncoding:"get_internalEncoding"},Ns.get_internalEncoding=function(){return"UTF-16"},Ns.codeUnitAt=function(t,e){return t.charCodeAt(e)},Ns.codePointAt=function(t,e){return Ps.codePointAt(t,e)},Ns.charAt=function(t,e){var i,s,n,r=t,o=r.charCodeAt(e);n=o>=55296&&56319>=o?2:1;var h=a.substr(r,e,n);return s=h,i=s},Ns.codePointCount=function(t,e,i){return Ps.codePointCount(t,e,i)},Ns.codePointWidthAt=function(t,e){var i=t.charCodeAt(e);return i>=55296&&56319>=i?2:1},Ns.codePointWidthBefore=function(t,e){var i=t;return Fs.find_prev_code_point(function(t){return i.charCodeAt(t)},e)},Ns.offsetByCodePoints=function(t,e,i){var s=t;if(i>=0){for(var n=e,r=s.length,o=0;i>o&&r>n;){var a=s.charCodeAt(n);n+=a>=55296&&56319>=a?2:1,++o}return n}for(var h=e,l=0;-i>l&&h>0;){var _=[s];h-=Fs.find_prev_code_point(function(t){return function(e){return t[0].charCodeAt(e)}}(_),h),++l}return h},Ns.backwardOffsetByCodePoints=function(t,e,i){var s=t,n=-i;if(n>=0){for(var r=e,o=s.length,a=0;n>a&&o>r;){var h=s.charCodeAt(r);r+=h>=55296&&56319>=h?2:1,++a}return r}for(var l=e,_=0;-n>_&&l>0;){var u=[s];l-=Fs.find_prev_code_point(function(t){return function(e){return t[0].charCodeAt(e)}}(u),l),++_}return l},Ns.fromCodePoint=function(t){var e;if(65535>=t){var i,s=String.fromCharCode(t);i=s,e=i}else{var n,r=String.fromCharCode((t>>10)+55232)+String.fromCharCode(1023&t|56320);n=r,e=n}return e},Ns.fromCodePoints=function(t){for(var e,s=new y,n=i(t)();n.hasNext();){var r=n.next();Fs.encode_code_point(function(t){s.b+=String.fromCharCode(t)},r)}return e=s.b},Ns.validate=function(t){Ps.validate(t)},Ns.isValidString=function(t){try{return Ps.validate(t),!0}catch(e){if(e instanceof ne&&(e=e.val),!re.__instanceof(e,Is))throw e;switch(e[1]){case 1:{e[2]}return!1;default:throw new ne(e)}}};var Ms=function(t,e,i){this.i=0,this.string=t,this.index=e,this.endIndex=i};n["luxe.utils.unifill.InternalEncodingIter"]=Ms,Ms.__name__=["luxe","utils","unifill","InternalEncodingIter"],Ms.prototype={hasNext:function(){return this.index<this.endIndex},next:function(){return this.i=this.index,this.index+=Ns.codePointWidthAt(this.string,this.index),this.i},__class__:Ms};var Rs=function(){};n["luxe.utils.unifill.Unicode"]=Rs,Rs.__name__=["luxe","utils","unifill","Unicode"],Rs.decodeSurrogate=function(t,e){return t-55232<<10|1023&e},Rs.encodeHighSurrogate=function(t){return(t>>10)+55232},Rs.encodeLowSurrogate=function(t){return 1023&t|56320},Rs.isScalar=function(t){return t>=0&&1114111>=t&&!(t>=55296&&56319>=t)&&!(t>=56320&&57343>=t)},Rs.isHighSurrogate=function(t){return t>=55296&&56319>=t},Rs.isLowSurrogate=function(t){return t>=56320&&57343>=t};var Bs=function(){};n["luxe.utils.unifill.Unifill"]=Bs,Bs.__name__=["luxe","utils","unifill","Unifill"],Bs.uLength=function(t){return Ps.codePointCount(t,0,t.length)},Bs.uCharAt=function(t,e){var i=Ns.offsetByCodePoints(t,0,e);return Ns.charAt(t,i)},Bs.uCharCodeAt=function(t,e){var i=Ns.offsetByCodePoints(t,0,e);return Ps.codePointAt(t,i)},Bs.uCodePointAt=function(t,e){return Bs.uCharCodeAt(t,e)},Bs.uIndexOf=function(t,e,i){null==i&&(i=0);var s=t.indexOf(e,Ns.offsetByCodePoints(t,0,i));return s>=0?Ps.codePointCount(t,0,s):-1},Bs.uLastIndexOf=function(t,e,i){null==i&&(i=t.length-1);var s=t.lastIndexOf(e,Ns.offsetByCodePoints(t,0,i));return s>=0?Ps.codePointCount(t,0,s):-1},Bs.uSplit=function(t,e){if(0==e.length){for(var i=[],s=0,n=t,r=0,o=t.length;o>r;){var a;s=r,r+=Ns.codePointWidthAt(n,r),a=s,i.push(Ns.charAt(t,a))}return i}return t.split(e)},Bs.uSubstr=function(t,e,i){var s,n=Ns.offsetByCodePoints(t,e>=0?0:t.length,e);return s=null==i?t.length:0>i?n:Ns.offsetByCodePoints(t,n,i),t.substring(n,s)},Bs.uSubstring=function(t,e,i){var s;s=0>e?0:Ns.offsetByCodePoints(t,0,e);var n;return n=null==i?t.length:0>i?0:Ns.offsetByCodePoints(t,0,i),t.substring(s,n)},Bs.uIterator=function(t){return new Ss(t)},Bs.uCompare=function(t,e){for(var i=0,s=t,n=0,r=t.length,o=0,a=e,h=0,l=e.length;r>n&&l>h;){var _=Ns.codePointAt(t,function(){var t;return i=n,n+=Ns.codePointWidthAt(s,n),t=i}(this)),u=Ns.codePointAt(e,function(){var t;return o=h,h+=Ns.codePointWidthAt(a,h),t=o}(this));if(u>_)return-1;if(_>u)return 1}return l>h?-1:r>n?1:0},Bs.uToString=function(t){return Ns.fromCodePoints(t)};var Ps={};n["luxe.utils.unifill._Utf16.Utf16_Impl_"]=Ps,Ps.__name__=["luxe","utils","unifill","_Utf16","Utf16_Impl_"],Ps.__properties__={get_length:"get_length"},Ps.fromCodePoint=function(t){if(65535>=t){var e,i=String.fromCharCode(t);return e=i}var s,n=String.fromCharCode((t>>10)+55232)+String.fromCharCode(1023&t|56320);return s=n},Ps.fromCodePoints=function(t){for(var e=new y,s=i(t)();s.hasNext();){var n=s.next();Fs.encode_code_point(function(t){e.b+=String.fromCharCode(t)},n)}return e.b},Ps.fromString=function(t){return t},Ps.fromArray=function(t){for(var e,i="",s=0;s<t.length;){var n=t[s];++s,i+=String.fromCharCode(n)}return e=i},Ps.codeUnitAt=function(t,e){return t.charCodeAt(e)},Ps.codePointAt=function(t,e){return Fs.decode_code_point(t.length,function(e){return t.charCodeAt(e)},e)},Ps.charAt=function(t,e){var i,s,n=t.charCodeAt(e);s=n>=55296&&56319>=n?2:1;var r=a.substr(t,e,s);return i=r},Ps.codePointCount=function(t,e,i){for(var s=e,n=0;i>s;){var r=t.charCodeAt(s);s+=r>=55296&&56319>=r?2:1,++n}return n},Ps.codePointWidthAt=function(t,e){var i=t.charCodeAt(e);return i>=55296&&56319>=i?2:1},Ps.codePointWidthBefore=function(t,e){return Fs.find_prev_code_point(function(e){return t.charCodeAt(e)},e)},Ps.offsetByCodePoints=function(t,e,i){if(i>=0){for(var s=e,n=t.length,r=0;i>r&&n>s;){var o=t.charCodeAt(s);s+=o>=55296&&56319>=o?2:1,++r}return s}for(var a=e,h=0;-i>h&&a>0;){var l=[t];a-=Fs.find_prev_code_point(function(t){return function(e){return t[0].charCodeAt(e)}}(l),a),++h}return a},Ps.substr=function(t,e,i){var s,n=a.substr(t,e,i);return s=n},Ps.validate=function(t){for(var e=t.length,i=function(e){return t.charCodeAt(e)},s=0;e>s;){Fs.decode_code_point(e,i,s);var n=t.charCodeAt(s);s+=n>=55296&&56319>=n?2:1}},Ps.toString=function(t){return t},Ps.toArray=function(t){for(var e=0,i=t.length,s=[];i>e;)s.push(w.fastCodeAt(t,e++));return s},Ps._new=function(t){return t},Ps.get_length=function(t){return t.length},Ps.forward_offset_by_code_points=function(t,e,i){for(var s=t.length,n=0;i>n&&s>e;){var r=t.charCodeAt(e);e+=r>=55296&&56319>=r?2:1,++n}return e},Ps.backward_offset_by_code_points=function(t,e,i){for(var s=0;i>s&&e>0;){var n=[t];e-=Fs.find_prev_code_point(function(t){return function(e){return t[0].charCodeAt(e)}}(n),e),++s}return e};var Fs=function(){};n["luxe.utils.unifill._Utf16.Utf16Impl"]=Fs,Fs.__name__=["luxe","utils","unifill","_Utf16","Utf16Impl"],Fs.code_point_width=function(t){return t>=55296&&56319>=t?2:1},Fs.find_prev_code_point=function(t,e){var i=t(e-1);return i>=56320&&57343>=i?2:1},Fs.encode_code_point=function(t,e){65535>=e?t(e):(t((e>>10)+55232),t(1023&e|56320))},Fs.decode_code_point=function(t,e,i){if(0>i||i>=t)throw new ne(Is.InvalidCodeUnitSequence(i));var s=e(i);if(s>=55296&&56319>=s){if(0>i+1||i+1>=t)throw new ne(Is.InvalidCodeUnitSequence(i));var n=e(i+1);if(n>=56320&&57343>=n)return s-55232<<10|1023&n;throw new ne(Is.InvalidCodeUnitSequence(i))}if(s>=56320&&57343>=s)throw new ne(Is.InvalidCodeUnitSequence(i));return s};var Ls={};n["luxe.utils.unifill._Utf16.StringU16Buffer_Impl_"]=Ls,Ls.__name__=["luxe","utils","unifill","_Utf16","StringU16Buffer_Impl_"],Ls._new=function(){return new y},Ls.addUnit=function(t,e){t.b+=String.fromCharCode(e)},Ls.getStringU16=function(t){return t.b};var Os={};n["luxe.utils.unifill._Utf16.StringU16_Impl_"]=Os,Os.__name__=["luxe","utils","unifill","_Utf16","StringU16_Impl_"],Os.__properties__={get_length:"get_length"},Os.fromString=function(t){return t},Os.fromCodeUnit=function(t){var e=String.fromCharCode(t);return e},Os.fromTwoCodeUnits=function(t,e){var i=String.fromCharCode(t)+String.fromCharCode(e);return i},Os.ofArray=function(t){for(var e="",i=0;i<t.length;){var s=t[i];++i,e+=String.fromCharCode(s)}return e},Os.fromArray=function(t){for(var e="",i=0;i<t.length;){var s=t[i];++i,e+=String.fromCharCode(s)}return e},Os.codeUnitAt=function(t,e){return t.charCodeAt(e)},Os.substr=function(t,e,i){var s=a.substr(t,e,i);return s},Os.toString=function(t){return t},Os.toArray=function(t){for(var e=0,i=t.length,s=[];i>e;)s.push(w.fastCodeAt(t,e++));return s},Os._new=function(t){return t},Os.get_length=function(t){return t.length};var Ds=function(t){this.log=!1,this.last_group=-1,this.batcher=t,this.geom_state=new yn,this.last_geom_state=new yn};n["phoenix.BatchState"]=Ds,Ds.__name__=["phoenix","BatchState"],Ds.prototype={active_shader:function(){return null!=this.geom_state.shader?this.geom_state.shader:null!=this.geom_state.texture?this.batcher.renderer.shaders.textured.shader:this.batcher.renderer.shaders.plain.shader},activate:function(t){if(this.geom_state.dirty&&(null!=this.geom_state.texture?this.last_texture_id!=this.geom_state.texture.id&&(this.last_texture_id=this.geom_state.texture.id,null!=this.geom_state.texture.texture&&this.geom_state.texture.bind()):(_.renderer.state.bindTexture2D(null),this.last_texture_id=null),null!=this.geom_state.shader?this.last_shader_id!=this.geom_state.shader.program&&(t.shader_activate(this.geom_state.shader),this.last_shader_id=this.geom_state.shader.program):null!=this.geom_state.texture?(t.shader_activate(t.renderer.shaders.textured.shader),this.last_shader_id=t.renderer.shaders.textured.shader.program):(t.shader_activate(t.renderer.shaders.plain.shader),this.last_shader_id=t.renderer.shaders.plain.shader.program),this.geom_state.group!=this.last_group)){var e=t.groups.h[this.last_group];if(null!=e)for(var i=0;i<e.length;){var s=e[i];++i,null!=s.post_render&&s.post_render(t)}var n=t.groups.h[this.geom_state.group];if(null!=n)for(var r=0;r<n.length;){var o=n[r];++r,null!=o.pre_render&&o.pre_render(t)}this.last_group=this.geom_state.group}if(this.geom_state.clip){if(this.is_clipping||(rr.current_context.enable(3089),this.is_clipping=!0),null!=this.clip_rect&&!this.clip_rect.equal(this.last_clip_rect)){var a=t.view.get_viewport().h-(this.clip_rect.y+this.clip_rect.h);rr.current_context.scissor(0|this.clip_rect.x,0|a,0|this.clip_rect.w,0|this.clip_rect.h)}}else this.is_clipping&&(rr.current_context.disable(3089),this.is_clipping=!1);this.geom_state.dirty=!1},deactivate:function(t){null!=this.last_texture_id&&_.renderer.state.bindTexture2D(null),_.renderer.state.useProgram(null);var e=t.groups.h[this.last_group];if(null!=e)for(var i=0;i<e.length;){var s=e[i];++i,null!=s.post_render&&s.post_render(t)}this.is_clipping&&rr.current_context.disable(3089)},update:function(t){return this.geom_state.clone_onto(this.last_geom_state),this.geom_state.update(t.state),this.geom_state.clip&&(this.last_clip_rect=this.clip_rect,this.clip_rect=t.clip_rect),this.geom_state.dirty||this.last_clip_rect!=this.clip_rect},str:function(){this.log&&(S.trace("	+ BATCHSTATE LAST ",{fileName:"BatchState.hx",lineNumber:196,className:"phoenix.BatchState",methodName:"str"}),S.trace("		depth - "+this.last_geom_state.depth,{fileName:"BatchState.hx",lineNumber:197,className:"phoenix.BatchState",methodName:"str"}),S.trace("		group - "+this.last_geom_state.group,{fileName:"BatchState.hx",lineNumber:198,className:"phoenix.BatchState",methodName:"str"}),S.trace("		texture - "+(null==this.last_geom_state.texture?"null":this.last_geom_state.texture.id),{fileName:"BatchState.hx",lineNumber:199,className:"phoenix.BatchState",methodName:"str"}),null!=this.last_geom_state.texture&&S.trace("			 "+v.string(this.last_geom_state.texture.texture),{fileName:"BatchState.hx",lineNumber:201,className:"phoenix.BatchState",methodName:"str"}),S.trace("		shader - "+(null==this.last_geom_state.shader?"null":this.last_geom_state.shader.id),{fileName:"BatchState.hx",lineNumber:203,className:"phoenix.BatchState",methodName:"str"}),S.trace("		primitive_type - "+this.last_geom_state.primitive_type,{fileName:"BatchState.hx",lineNumber:204,className:"phoenix.BatchState",methodName:"str"}),S.trace("		clip - "+v.string(this.last_geom_state.clip),{fileName:"BatchState.hx",lineNumber:205,className:"phoenix.BatchState",methodName:"str"}),S.trace("	- BATCHSTATE LAST",{fileName:"BatchState.hx",lineNumber:206,className:"phoenix.BatchState",methodName:"str"}),S.trace("	+ BATCHSTATE STATE",{fileName:"BatchState.hx",lineNumber:208,className:"phoenix.BatchState",methodName:"str"}),S.trace("		depth - "+this.geom_state.depth,{fileName:"BatchState.hx",lineNumber:209,className:"phoenix.BatchState",methodName:"str"}),S.trace("		group - "+this.geom_state.group,{fileName:"BatchState.hx",lineNumber:210,className:"phoenix.BatchState",methodName:"str"}),S.trace("		texture - "+(null==this.geom_state.texture?"null":this.geom_state.texture.id),{fileName:"BatchState.hx",lineNumber:211,className:"phoenix.BatchState",methodName:"str"}),null!=this.geom_state.texture&&S.trace("			 "+v.string(this.geom_state.texture.texture),{fileName:"BatchState.hx",lineNumber:213,className:"phoenix.BatchState",methodName:"str"}),S.trace("		shader - "+(null==this.geom_state.shader?"null":this.geom_state.shader.id),{fileName:"BatchState.hx",lineNumber:215,className:"phoenix.BatchState",methodName:"str"}),S.trace("		primitive_type - "+this.geom_state.primitive_type,{fileName:"BatchState.hx",lineNumber:216,className:"phoenix.BatchState",methodName:"str"}),S.trace("		clip - "+v.string(this.geom_state.clip),{fileName:"BatchState.hx",lineNumber:217,className:"phoenix.BatchState",methodName:"str"}),S.trace("	- BATCHSTATE STATE",{fileName:"BatchState.hx",lineNumber:218,className:"phoenix.BatchState",methodName:"str"}))},__class__:Ds};var Us=function(t,e){null==e&&(e=""),this.normal_floats=0,this.color_floats=0,this.tcoord_floats=0,this.pos_floats=0,this.sequence=-1,this.name="",this.log=!1,this.visible_count=0,this.static_batched_count=0,this.dynamic_batched_count=0,this.draw_calls=0,this.vert_count=0,this.max_floats=0,this.max_verts=0,this.tree_changed=!1,this.enabled=!0,this.layer=0,this.id=_.utils.uniqueid(),this.renderer=t,this.sequence=++Us._sequence_key,this.geometry=new Vi(s(this,this.geometry_compare)),this.groups=new U,this.max_verts=v["int"](Math.pow(2,16)),this.max_floats=4*this.max_verts;var i,n=this.max_floats;i=null!=n?new Float32Array(n):null,this.pos_list=i;var r,o=this.max_floats;r=null!=o?new Float32Array(o):null,this.tcoord_list=r;var a,h=this.max_floats;a=null!=h?new Float32Array(h):null,this.color_list=a,this.view=this.renderer.camera,rr.current_context.enableVertexAttribArray(0),rr.current_context.enableVertexAttribArray(1),rr.current_context.enableVertexAttribArray(2),this.name=0==e.length?_.utils.uniqueid():e,this._dropped=[]};n["phoenix.Batcher"]=Us,Us.__name__=["phoenix","Batcher"],Us.prototype={add_group:function(t,e,i){if(!this.groups.h.hasOwnProperty(t)){var s=[];this.groups.h[t]=s}this.groups.h[t].push(new Gs(e,i))},add:function(t,e){null==e&&(e=!1),(null==this.geometry.find(t.key)||e)&&(h.has(t.batchers,this)||t.batchers.push(this),this.geometry.insert(t.key,t),t.added=!0,this.tree_changed=!0)},empty:function(t){if(null==t&&(t=!0),t)for(var e=new Gi(this.geometry);null==e.current||null==e.rightest?!1:e.tree.compare(e.current.key,e.rightest.key)<=0;){var i=e.next();i.drop(!0),i=null}else for(var s=new Gi(this.geometry);null==s.current||null==s.rightest?!1:s.tree.compare(s.current.key,s.rightest.key)<=0;){var n=s.next();this.geometry.remove(n.key)}},destroy:function(t){null==t&&(t=!0),this.empty(t),this.renderer.remove_batch(this),this.geometry=null,this.groups=null,this.pos_list=null,this.tcoord_list=null,this.color_list=null,this.normal_list=null,this.max_verts=0,this.max_floats=0,this.vert_count=0,this.proj_attribute=null,this.view_attribute=null,this.tex0_attribute=null,this.tex1_attribute=null,this.tex2_attribute=null,this.tex3_attribute=null,this.tex4_attribute=null,this.tex5_attribute=null,this.tex6_attribute=null,this.tex7_attribute=null,this.renderer=null,this.view=null},remove:function(t,e){null==e&&(e=!0),e&&(a.remove(t.batchers,this),0==t.batchers.length&&(t.added=!1));this.geometry.size();this.geometry.remove(t.key);this.geometry.size();this.tree_changed=!0},shader_activate:function(t){null!=t.program&&_.renderer.state.useProgram(t.program),this.proj_attribute=t.proj_attribute,this.view_attribute=t.view_attribute,this.tex0_attribute=t.tex0_attribute,this.tex1_attribute=t.tex1_attribute,this.tex2_attribute=t.tex2_attribute,this.tex3_attribute=t.tex3_attribute,this.tex4_attribute=t.tex4_attribute,this.tex5_attribute=t.tex5_attribute,this.tex6_attribute=t.tex6_attribute,this.tex7_attribute=t.tex7_attribute,null!=t.tex0_attribute&&rr.current_context.uniform1i(t.tex0_attribute,0),null!=t.tex1_attribute&&rr.current_context.uniform1i(t.tex1_attribute,1),null!=t.tex2_attribute&&rr.current_context.uniform1i(t.tex2_attribute,2),null!=t.tex3_attribute&&rr.current_context.uniform1i(t.tex3_attribute,3),null!=t.tex4_attribute&&rr.current_context.uniform1i(t.tex4_attribute,4),null!=t.tex5_attribute&&rr.current_context.uniform1i(t.tex5_attribute,5),null!=t.tex6_attribute&&rr.current_context.uniform1i(t.tex6_attribute,6),null!=t.tex7_attribute&&rr.current_context.uniform1i(t.tex7_attribute,7);for(var e=t.uniform_int.iterator();e.hasNext();){var i=e.next();rr.current_context.uniform1i(i.location,i.value)}for(var s=t.uniform_float.iterator();s.hasNext();){var n=s.next();rr.current_context.uniform1f(n.location,n.value)}for(var r=t.uniform_vector2.iterator();r.hasNext();){var o=r.next();rr.current_context.uniform2f(o.location,o.value.x,o.value.y)}for(var a=t.uniform_vector3.iterator();a.hasNext();){var h=a.next();
rr.current_context.uniform3f(h.location,h.value.x,h.value.y,h.value.z)}for(var l=t.uniform_vector4.iterator();l.hasNext();){var u=l.next();rr.current_context.uniform4f(u.location,u.value.x,u.value.y,u.value.z,u.value.w)}for(var c=t.uniform_matrix4.iterator();c.hasNext();){var d=c.next();rr.uniformMatrix4fv(d.location,!1,d.value.float32array())}for(var f=t.uniform_color.iterator();f.hasNext();){var p=f.next();rr.current_context.uniform4f(p.location,p.value.r,p.value.g,p.value.b,p.value.a)}for(var m=t.uniform_texture.iterator();m.hasNext();){var g=m.next();rr.current_context.uniform1i(g.location,g.value.slot),g.value.bind()}_.renderer.state.activeTexture(33984)},batch:function(t){null==t&&(t=!1),this.dynamic_batched_count=0,this.static_batched_count=0,this.visible_count=0,this.pos_floats=0,this.tcoord_floats=0,this.color_floats=0,this.normal_floats=0,this.state=new Ds(this);for(var e=null,i=new Gi(this.geometry);null==i.current||null==i.rightest?!1:i.tree.compare(i.current.key,i.rightest.key)<=0;){var s=i.next();if(e=s,null!=e&&!e.dropped&&(this.state.update(e)&&this.pos_floats>0&&this.submit_current_vertex_list(this.state.last_geom_state.primitive_type),this.state.activate(this),e.visible)){if(this.visible_count++,e.buffer_based){this.visible_count--;continue}e.locked?(this.submit_static_geometry(e),this.vert_count+=e.vertices.length):3==e.state.primitive_type||2==e.state.primitive_type||5==e.state.primitive_type||6==e.state.primitive_type?(this.geometry_batch(e),this.submit_current_vertex_list(e.state.primitive_type),this.vert_count+=e.vertices.length):(this.geometry_batch(e),this.dynamic_batched_count++,this.vert_count+=e.vertices.length),!t&&e.immediate&&(e.dropped=!0,this._dropped.push(e))}}if(this.pos_floats>0&&null!=e&&(this.state.update(e),this.state.activate(this),this.submit_current_vertex_list(this.state.last_geom_state.primitive_type)),this._dropped.length>0){for(var n=0,r=this._dropped;n<r.length;){var o=r[n];++n,o.drop(),o=null}this._dropped=null,this._dropped=[]}this.state.deactivate(this),this.state=null},draw:function(t){null==t&&(t=!1),this.draw_calls=0,this.vert_count=0,this.view.process(),this.renderer.state.viewport(this.view.get_viewport().x,this.view.get_viewport().y,this.view.get_viewport().w,this.view.get_viewport().h),this.batch(t)},update_view:function(){this.view.process(),this.renderer.state.viewport(this.view.get_viewport().x,this.view.get_viewport().y,this.view.get_viewport().w,this.view.get_viewport().h)},submit_geometry:function(t,e){if(!t.buffer_based)throw new ne(Re.assertion("geom.buffer_based ( Only buffer based geometry can be submitted directly )"));if(t.visible){null==e&&(e=t.transform.get_world().get_matrix()),t.state.shader.set_matrix4("model",e),this.shader_activate(t.state.shader);var i=t.vertices.length,s=t.update_buffers();rr.current_context.uniformMatrix4fv(this.proj_attribute,!1,this.view.proj_arr),rr.current_context.uniformMatrix4fv(this.view_attribute,!1,this.view.view_inverse_arr),s?(rr.current_context.bindBuffer(34962,t.vb_pos),rr.current_context.vertexAttribPointer(0,4,5126,!1,0,0),rr.current_context.bufferData(34962,t.buffer_pos,t.buffer_type),rr.current_context.bindBuffer(34962,t.vb_tcoords),rr.current_context.vertexAttribPointer(1,4,5126,!1,0,0),rr.current_context.bufferData(34962,t.buffer_tcoords,t.buffer_type),rr.current_context.bindBuffer(34962,t.vb_colors),rr.current_context.vertexAttribPointer(2,4,5126,!1,0,0),rr.current_context.bufferData(34962,t.buffer_colors,t.buffer_type)):(rr.current_context.bindBuffer(34962,t.vb_pos),rr.current_context.vertexAttribPointer(0,4,5126,!1,0,0),rr.current_context.bindBuffer(34962,t.vb_tcoords),rr.current_context.vertexAttribPointer(1,4,5126,!1,0,0),rr.current_context.bindBuffer(34962,t.vb_colors),rr.current_context.vertexAttribPointer(2,4,5126,!1,0,0)),rr.current_context.drawArrays(t.state.primitive_type,0,t.buffer_pos.length/4|0);var n=this.renderer.stats;n.geometry_count++,n.visible_count++,n.draw_calls++,n.vert_count+=i}},submit_buffers:function(t,e,i,s){rr.current_context.uniformMatrix4fv(this.proj_attribute,!1,this.view.proj_arr),rr.current_context.uniformMatrix4fv(this.view_attribute,!1,this.view.view_inverse_arr);var n=rr.current_context.createBuffer(),r=rr.current_context.createBuffer(),o=rr.current_context.createBuffer();rr.current_context.bindBuffer(34962,n),rr.current_context.vertexAttribPointer(0,4,5126,!1,0,0),rr.current_context.bufferData(34962,e,35040),rr.current_context.bindBuffer(34962,o),rr.current_context.vertexAttribPointer(1,4,5126,!1,0,0),rr.current_context.bufferData(34962,i,35040),rr.current_context.bindBuffer(34962,r),rr.current_context.vertexAttribPointer(2,4,5126,!1,0,0),rr.current_context.bufferData(34962,s,35040),rr.current_context.drawArrays(t,0,e.length/4|0),rr.current_context.deleteBuffer(n),rr.current_context.deleteBuffer(r),rr.current_context.deleteBuffer(o),this.draw_calls++},submit_static_geometry:function(t){var e=t.vertices.length;if(0!=e){var i=t.update_buffers();rr.current_context.uniformMatrix4fv(this.proj_attribute,!1,this.view.proj_arr),rr.current_context.uniformMatrix4fv(this.view_attribute,!1,this.view.view_inverse_arr),i?(rr.current_context.bindBuffer(34962,t.vb_pos),rr.current_context.vertexAttribPointer(0,4,5126,!1,0,0),rr.current_context.bufferData(34962,t.buffer_pos,t.buffer_type),rr.current_context.bindBuffer(34962,t.vb_tcoords),rr.current_context.vertexAttribPointer(1,4,5126,!1,0,0),rr.current_context.bufferData(34962,t.buffer_tcoords,t.buffer_type),rr.current_context.bindBuffer(34962,t.vb_colors),rr.current_context.vertexAttribPointer(2,4,5126,!1,0,0),rr.current_context.bufferData(34962,t.buffer_colors,t.buffer_type)):(rr.current_context.bindBuffer(34962,t.vb_pos),rr.current_context.vertexAttribPointer(0,4,5126,!1,0,0),rr.current_context.bindBuffer(34962,t.vb_tcoords),rr.current_context.vertexAttribPointer(1,4,5126,!1,0,0),rr.current_context.bindBuffer(34962,t.vb_colors),rr.current_context.vertexAttribPointer(2,4,5126,!1,0,0)),rr.current_context.drawArrays(t.state.primitive_type,0,t.buffer_pos.length/4|0),this.static_batched_count++,this.draw_calls++,t.set_dirty(!1)}},submit_current_vertex_list:function(t){if(0!=this.pos_floats){if(this.pos_floats>this.max_floats)throw new ne("uh oh, somehow too many floats are being submitted (max:$max_floats, attempt:$pos_floats).");var e,i,s=this.pos_list.buffer,n=this.pos_floats;i=null!=s?null==n?new Float32Array(s,0):new Float32Array(s,0,n):null,e=i;var r,o,a=this.tcoord_list.buffer,h=this.tcoord_floats;o=null!=a?null==h?new Float32Array(a,0):new Float32Array(a,0,h):null,r=o;var l,_,u=this.color_list.buffer,c=this.color_floats;_=null!=u?null==c?new Float32Array(u,0):new Float32Array(u,0,c):null,l=_;var d=null;this.submit_buffers(t,e,r,l,d),e=null,r=null,l=null,d=null,this.pos_floats=0,this.tcoord_floats=0,this.color_floats=0,this.normal_floats=0}},geometry_batch:function(t){var e=t.vertices.length+this.pos_floats/4;e>this.max_verts&&this.submit_current_vertex_list(t.state.primitive_type),t.batch(this.pos_floats,this.tcoord_floats,this.color_floats,this.normal_floats,this.pos_list,this.tcoord_list,this.color_list,this.normal_list);var i=4*t.vertices.length;this.pos_floats+=i,this.tcoord_floats+=i,this.color_floats+=i,this.normal_floats+=i},_enable_attributes:function(){rr.current_context.uniformMatrix4fv(this.proj_attribute,!1,this.view.proj_arr),rr.current_context.uniformMatrix4fv(this.view_attribute,!1,this.view.view_inverse_arr)},_disable_attributes:function(){},set_layer:function(t){return this.layer=t,this.renderer.batchers.sort((vr=this.renderer,s(vr,vr.sort_batchers))),this.layer},toString:function(){return"Batcher("+this.name+")"},compare:function(t){return this.layer==t.layer?0:this.layer<t.layer?-1:1},compare_rule_to_string:function(t){switch(t){case 0:return"same";case 1:return"depth <";case 2:return"depth >";case 3:return"shader <";case 4:return"shader >";case 5:return"shader s._ >";case 6:return"shader _.s <";case 7:return"texture <";case 8:return"texture >";case 9:return"texture t._ >";case 10:return"texture _.t <";case 11:return"primitive <";case 12:return"primitive >";case 13:return"unclipped";case 14:return"clipped";case 15:return"timestamp <";case 16:return"timestamp >";case 17:return"timestamp ==";case 18:return"sequence <";case 19:return"sequence >";case 20:return"fallback";default:return"unknown"}},compare_rule:function(t,e){if(t.uuid==e.uuid)return 0;if(t.depth<e.depth)return 1;if(t.depth>e.depth)return 2;if(null!=t.shader&&null!=e.shader){if(t.shader.id<e.shader.id)return 3;if(t.shader.id>e.shader.id)return 4}else{if(null!=t.shader&&null==e.shader)return 5;if(null==t.shader&&null!=e.shader)return 6}if(null!=t.texture&&null!=e.texture){if(t.texture.id<e.texture.id)return 7;if(t.texture.id>e.texture.id)return 8}else{if(null!=t.texture&&null==e.texture)return 9;if(null==t.texture&&null!=e.texture)return 10}var i=t.primitive_type,s=e.primitive_type;if(s>i)return 11;if(i>s)return 12;if(t.clip!=e.clip){if(0==t.clip&&1==e.clip)return 13;if(1==t.clip&&0==e.clip)return 14}return t.timestamp<e.timestamp?15:t.timestamp>e.timestamp?16:t.timestamp==e.timestamp?17:t.sequence<e.sequence?18:t.sequence>e.sequence?19:20},geometry_compare:function(t,e){if(t.uuid==e.uuid)return 0;if(t.depth<e.depth)return-1;if(t.depth>e.depth)return 1;if(null!=t.shader&&null!=e.shader){if(t.shader.id<e.shader.id)return-1;if(t.shader.id>e.shader.id)return 1}else{if(null!=t.shader&&null==e.shader)return 1;if(null==t.shader&&null!=e.shader)return-1}if(null!=t.texture&&null!=e.texture){if(t.texture.id<e.texture.id)return-1;if(t.texture.id>e.texture.id)return 1}else{if(null!=t.texture&&null==e.texture)return 1;if(null==t.texture&&null!=e.texture)return-1}var i=t.primitive_type,s=e.primitive_type;if(s>i)return-1;if(i>s)return 1;if(t.clip!=e.clip){if(0==t.clip&&1==e.clip)return 1;if(1==t.clip&&0==e.clip)return-1}return t.timestamp<e.timestamp?-1:t.timestamp>=e.timestamp?1:t.sequence<e.sequence?-1:t.sequence>e.sequence?1:1},list_geometry:function(){for(var t=new Gi(this.geometry);null==t.current||null==t.rightest?!1:t.tree.compare(t.current.key,t.rightest.key)<=0;){t.next()}},__class__:Us,__properties__:{set_layer:"set_layer"}};var Gs=function(t,e){this.pre_render=t,this.post_render=e};n["phoenix.BatchGroup"]=Gs,Gs.__name__=["phoenix","BatchGroup"],Gs.prototype={__class__:Gs};var js=function(t){if(null==t)throw new ne(Re.null_assertion("_options was null"));if(t.resource_type=6,Mi.call(this,t),this.texture_path=null!=t.texture_path?t.texture_path:Q.directory(this.id),this.pages=new U,null!=t.pages&&null==t.font_data)throw new ne(Re.null_assertion("_options.font_data was null ( BitmapFont create from pages + font_data requires both of those options )"));if(null!=t.font_data){if(null==t.pages)throw new ne(Re.null_assertion("_options.pages was null ( BitmapFont create from pages + font_data requires both of those options )"));this.set_info(pi.parse(t.font_data)),this.apply_pages(t.pages)}};n["phoenix.BitmapFont"]=js,js.__name__=["phoenix","BitmapFont"],js.__super__=Mi,js.prototype=e(Mi.prototype,{kerning:function(t,e){var i=this.info.kernings.h[t];return null!=i&&i.h.hasOwnProperty(e)?i.h[e]:0},wrap_string_to_bounds:function(t,e,i,s){null==s&&(s=0),null==i&&(i=1);var n=this;if(null==e)return t;for(var r=0,o=0,a="",h=n.width_of(" ",i,s,null),l=t.split(" "),_=l.length,u=0;u<l.length;){var c=l[u];if(++u,-1==Bs.uIndexOf(c,"\n",null)){""==c&&(c=" ");var d=n.width_of(c,i,s,null);r+d>e.w&&(r=0,a+="\n"),r+=d,a+=c}else for(var f=0,p=c.split("\n"),m=0;m<p.length;){var g=p[m];if(++m,""!=g){var v=n.width_of(g,i,s,null);r+v>e.w&&(r=0,a+="\n"),r+=v,a+=g}else r=0;f<p.length-1&&(a+="\n",r=0),f++}_-1>o&&(a+=" ",r+=h+s),o++}return a},width_of_line:function(t,e,i){null==i&&(i=0),null==e&&(e=1);for(var s=0,n=0,r=e/this.info.point_size,o=0,a=Ps.codePointCount(t,0,t.length),h=0,l=t,_=0,u=t.length;u>_;){var c;h=_,_+=Ns.codePointWidthAt(l,_),c=Ps.codePointAt(l,h);var d=c,f=this.info.chars.h[d];null==f&&(f=this.space_char);var p=(f.xoffset+Math.max(f.width,f.xadvance))*r,m=s+f.xoffset*r,g=f.xadvance;if(a-1>o){var v=Bs.uCharCodeAt(t,o+1);g+=this.kerning(d,v),v>=32&&(g+=i)}s+=g*r,n=Math.max(n,m+p),++o}return n},width_of:function(t,e,i,s){null==i&&(i=0),null==e&&(e=1);for(var n=0,r=null!=s,o=Bs.uSplit(t,"\n"),a=0;a<o.length;){var h=o[a];++a;var l=this.width_of_line(h,e,i);n=Math.max(n,l),r&&s.push(l)}return n},height_of:function(t,e,i){return null==i&&(i=0),this.height_of_lines(t.split("\n"),e,i)},dimensions_of:function(t,e,i,s,n){null==n&&(n=0),null==s&&(s=0);var r=this.width_of(t,e,s,null),o=this.height_of_lines(t.split("\n"),e,n);return i.set_xy(r,o)},height_of_lines:function(t,e,i){null==i&&(i=0);var s=e/this.info.point_size;return t.length*(this.info.line_height+i)*s},clear:function(){this.set_info(null);for(var t=this.pages.keys();t.hasNext();){var e=t.next(),i=this.pages.h[e];i.destroy(),this.pages.remove(e),i=null}},reload:function(){var t=this;if(6==this.state)throw new ne(Re.assertion("state != ResourceState.destroyed"));return this.clear(),new Fn(function(e,i){t.set_state(2);var s=lr.load(_.core.app.assets,t.id);s.then(function(s){if(t.set_info(pi.parse(s.text)),null==t.info)throw new ne(Re.null_assertion("info was null"));for(var n=[],r=0,o=t.info.pages;r<o.length;){var a=o[r];++r;var h=Q.join([t.texture_path,a.file]),l=t.system.cache.get(h);n.push(null!=l?l.reload():t.system.load_texture(h))}Fn.all(n).then(function(i){t.apply_pages(i),t.set_state(3),e(t)}).error(function(e){t.set_state(4),i(e)})}).error(function(e){t.set_state(4),i(e)})})},apply_pages:function(t){for(var e=0,i=0;i<t.length;){var s=t[i];++i,s.slot=e,this.pages.h[e]=s,++e}},set_info:function(t){return this.info=t,null!=this.info&&(this.space_char=this.info.chars.h[32]),this.info},toString:function(){return"BitmapFont("+this.id+")"},__class__:js,__properties__:e(Mi.prototype.__properties__,{set_info:"set_info"})});var Vs=n["phoenix.ProjectionType"]={__ename__:["phoenix","ProjectionType"],__constructs__:["ortho","perspective","custom"]};Vs.ortho=["ortho",0],Vs.ortho.toString=r,Vs.ortho.__enum__=Vs,Vs.perspective=["perspective",1],Vs.perspective.toString=r,Vs.perspective.__enum__=Vs,Vs.custom=["custom",2],Vs.custom.toString=r,Vs.custom.__enum__=Vs;var qs=function(t){this._refresh_pos=!1,this._setup=!0,this.look_at_dirty=!0,this.projection_dirty=!0,this.transform_dirty=!0,this.minimum_zoom=.01,this.aspect=1.5,this.fov_type=Xs.horizontal,this.fov=60,this.far=-1e3,this.near=1e3,this.zoom=1,this.name="camera",this.transform=new ln,this.options=t,null==this.options&&(this.options=this.default_camera_options()),this.options,null!=this.options.camera_name&&(this.name=this.options.camera_name),this.projection=null!=this.options.projection?this.options.projection:Vs.ortho,this.set_center(new un(_.core.screen.get_w()/2,_.core.screen.get_h()/2)),this.set_pos(new un),this.set_viewport(null!=this.options.viewport?this.options.viewport:new $s(0,0,_.core.screen.get_w(),_.core.screen.get_h())),this.up=new un(0,1,0),this.projection_matrix=new Qs,this.view_matrix=new Qs,this.view_matrix_inverse=new Qs,this.look_at_matrix=new Qs,this.transform.listen(s(this,this.on_transform_cleaned));var e=this.projection;switch(e[1]){case 0:this.set_ortho(this.options);break;case 1:this.set_perspective(this.options);break;case 2:}this.process(),this._setup=!1};n["phoenix.Camera"]=qs,qs.__name__=["phoenix","Camera"],qs.prototype={set_ortho:function(t){this.projection=Vs.ortho,this._merge_options(t)},set_perspective:function(t){this.projection=Vs.perspective,this._merge_options(t),this.transform.origin.set_xyz(0,0,0)},project:function(t){this.update_view_matrix();var e=(new Qs).multiplyMatrices(this.projection_matrix,this.view_matrix_inverse);return new un(t.x,t.y,t.z,t.w).applyProjection(e)},unproject:function(t){this.update_view_matrix();var e=(new Qs).multiplyMatrices(this.projection_matrix,this.view_matrix_inverse);return new un(t.x,t.y,t.z,t.w).applyProjection(e.getInverse(e))},screen_point_to_ray:function(t){return new Js(t,this)},screen_point_to_world:function(t){return this.projection==Vs.ortho?this.ortho_screen_to_world(t):this.projection==Vs.perspective?this.screen_point_to_ray(t).end:this.ortho_screen_to_world(t)},world_point_to_screen:function(t,e){return this.projection==Vs.ortho?this.ortho_world_to_screen(t):this.projection==Vs.perspective?this.persepective_world_to_screen(t,e):this.ortho_world_to_screen(t)},process:function(){null!=this.target&&this.update_look_at(),this.update_projection_matrix(),this.update_view_matrix(),this.apply_state(2884,this.options.cull_backfaces),this.apply_state(2929,this.options.depth_test)},on_transform_cleaned:function(){this.transform_dirty=!0},update_look_at:function(){this.look_at_dirty&&null!=this.target&&(this.look_at_matrix.lookAt(this.target,this.get_pos(),this.up),this.get_rotation().setFromRotationMatrix(this.look_at_matrix))},update_view_matrix:function(){this.view_matrix=this.transform.get_world().get_matrix(),this.transform_dirty&&(this.view_matrix_inverse=this.view_matrix.inverse(),this.view_inverse_arr=this.view_matrix_inverse.float32array(),this.transform_dirty=!1)},update_projection_matrix:function(){if(this.projection_dirty){var t=this.projection;switch(t[1]){case 1:this.projection_matrix.makePerspective(this.fov_y,this.aspect,this.near,this.far);break;case 0:this.projection_matrix.makeOrthographic(0,this.get_viewport().w,0,this.get_viewport().h,this.near,this.far);break;case 2:}this.proj_arr=this.projection_matrix.float32array(),this.projection_dirty=!1}},apply_state:function(t,e){e?_.renderer.state.enable(t):_.renderer.state.disable(t)},apply_default_camera_options:function(){var t=this.projection;switch(t[1]){case 0:this.options.cull_backfaces=!1,this.options.depth_test=!1;break;case 1:this.options.cull_backfaces=!0,this.options.depth_test=!0;break;case 2:}},default_camera_options:function(){return{projection:Vs.ortho,depth_test:!1,cull_backfaces:!1,near:1e3,far:-1e3}},ortho_screen_to_world:function(t){return this.update_view_matrix(),new un(t.x,t.y,t.z,t.w).transform(this.view_matrix)},ortho_world_to_screen:function(t){return this.update_view_matrix(),new un(t.x,t.y,t.z,t.w).transform(this.view_matrix_inverse)},persepective_world_to_screen:function(t,e){null==e&&(e=this.get_viewport());var i=this.project(t),s=e.w/2,n=e.h/2;return new un(i.x*s+s,-(i.y*n)+n)},set_target:function(t){return null!=t&&(this.look_at_dirty=!0),this.target=t},set_fov:function(t){return this.projection_dirty=!0,this.options.fov=t,this.fov_y=this.fov_type==Xs.horizontal?180/Math.PI*2*Math.atan(Math.tan(t*(Math.PI/180)/2)*(1/this.aspect)):t,this.fov=t},set_fov_type:function(t){return this.options.fov_type=t,this.fov_type=t,this.set_fov(this.fov),this.fov_type},set_aspect:function(t){return this.projection_dirty=!0,this.options.aspect=t,this.aspect=t},set_near:function(t){return this.projection_dirty=!0,this.options.near=t,this.near=t},set_far:function(t){return this.projection_dirty=!0,this.options.far=t,this.far=t},set_zoom:function(t){var e=t;e<this.minimum_zoom&&(e=this.minimum_zoom);var i=this.projection;switch(i[1]){case 0:this.transform.local.scale.set_x(1/e),this.transform.local.scale.set_y(1/e),this.transform.local.scale.set_z(1/e);break;case 1:break;case 2:}return this.zoom=e},set_center:function(t){this.center=t;var e=this.projection;switch(e[1]){case 0:this._refresh_pos||this._setup||(this.get_pos().ignore_listeners=!0,this.get_pos().set_x(t.x-this.get_viewport().w/2),this.get_pos().set_y(t.y-this.get_viewport().h/2),this.get_pos().ignore_listeners=!1,this.transform.local.pos.copy_from(t));break;case 1:break;case 2:}return un.Listen(this.get_center(),s(this,this._center_changed)),this.get_center()},get_center:function(){return this.center},get_pos:function(){return this.pos},get_rotation:function(){return this.transform.local.rotation},get_scale:function(){return this.transform.local.scale},get_viewport:function(){return this.viewport},set_viewport:function(t){this.projection_dirty=!0,this.viewport=t;var e=this.projection;switch(e[1]){case 0:this.transform.set_origin(new un(t.w/2,t.h/2)),this.set_pos(this.get_pos());break;case 1:break;case 2:}return this.get_viewport()},set_rotation:function(t){return this.transform.local.set_rotation(t)},set_scale:function(t){return this.transform.local.set_scale(t)},set_pos:function(t){this.pos=t;var e=this.projection;switch(e[1]){case 0:var i=this.get_center().x,n=this.get_center().y;null!=this.get_viewport()&&(i=t.x+this.get_viewport().w/2,n=t.y+this.get_viewport().h/2),this._refresh_pos=!0,this.get_center().ignore_listeners=!0,this.get_center().set_x(i),this.get_center().set_y(n),this.get_center().ignore_listeners=!1,this._refresh_pos=!1,this.transform.local.pos.set_x(i),this.transform.local.pos.set_y(n);break;case 1:this.transform.set_pos(this.get_pos());break;case 2:}return un.Listen(this.get_pos(),s(this,this._pos_changed)),this.get_pos()},_merge_options:function(t){this.apply_default_camera_options(),null!=t.aspect&&(this.options.aspect=t.aspect,this.set_aspect(this.options.aspect)),null!=t.far&&(this.options.far=t.far,this.set_far(this.options.far)),null!=t.fov&&(this.options.fov=t.fov,this.set_fov(this.options.fov)),null!=t.fov_type?(this.options.fov_type=t.fov_type,this.set_fov_type(t.fov_type)):(this.options.fov_type=Xs.horizontal,this.set_fov_type(Xs.horizontal)),null!=t.near&&(this.options.near=t.near,this.set_near(this.options.near)),null!=t.viewport&&(this.options.viewport=t.viewport,this.set_viewport(this.options.viewport)),null!=t.cull_backfaces&&(this.options.cull_backfaces=t.cull_backfaces),null!=t.depth_test&&(this.options.depth_test=t.depth_test)},_pos_changed:function(){this.set_pos(this.get_pos())},_center_changed:function(){this.set_center(this.get_center())},__class__:qs,__properties__:{set_rotation:"set_rotation",get_rotation:"get_rotation",set_scale:"set_scale",get_scale:"get_scale",set_pos:"set_pos",get_pos:"get_pos",set_target:"set_target",set_aspect:"set_aspect",set_fov_type:"set_fov_type",set_fov:"set_fov",set_far:"set_far",set_near:"set_near",set_zoom:"set_zoom",set_center:"set_center",get_center:"get_center",set_viewport:"set_viewport",get_viewport:"get_viewport"}};var Xs=n["phoenix.FOVType"]={__ename__:["phoenix","FOVType"],__constructs__:["vertical","horizontal"]};Xs.vertical=["vertical",0],Xs.vertical.toString=r,Xs.vertical.__enum__=Xs,Xs.horizontal=["horizontal",1],Xs.horizontal.toString=r,Xs.horizontal.__enum__=Xs;var Zs=function(t,e,i){null==i&&(i=0),null==e&&(e=0),null==t&&(t=0),this.x=t,this.y=e,this.r=i};n["phoenix.Circle"]=Zs,Zs.__name__=["phoenix","Circle"],Zs.prototype={toString:function(){return"{ x:"+this.x+", y:"+this.y+", r:"+this.r+" }"},point_inside:function(t){var e=new un(t.x-this.x,t.y-this.y);return Math.sqrt(e.x*e.x+e.y*e.y+e.z*e.z)<=this.r},clone:function(){return new Zs(this.x,this.y,this.r)},set:function(t,e,i){var s=this.x,n=this.y,r=this.r;return null!=t&&(s=t),null!=e&&(n=e),null!=i&&(r=i),this.x=s,this.y=n,this.r=r,this},__class__:Zs};var Hs=function(t,e,i,s){null==s&&(s=1),null==i&&(i=1),null==e&&(e=1),null==t&&(t=0),this.l=1,this.s=1,this.h=0,ai.call(this),this.is_hsl=!0,this.set_h(t),this.set_s(e),this.set_l(i),this.a=s,this._refresh()};n["phoenix.ColorHSL"]=Hs,Hs.__name__=["phoenix","ColorHSL"],Hs.__super__=ai,Hs.prototype=e(ai.prototype,{set_h:function(t){return this.h=t,this._refresh(),t},set_s:function(t){return this.s=t,this._refresh(),t},set_l:function(t){return this.l=t,this._refresh(),t},set:function(t,e,i,s){var n=this.h,r=this.s,o=this.l,a=this.a;return null!=t&&(n=t),null!=e&&(r=e),null!=i&&(o=i),null!=s&&(a=s),this.set_h(n),this.set_s(r),this.set_l(o),this.a=a,this._refresh(),this},tween:function(t,e,i){if(null==i&&(i=!0),null==t&&(t=.5),ai.prototype.tween.call(this,t,e,i),null!=e){var s=this.h,n=this.s,r=this.l,o=this.a,a=!1,h=!1,l=!1,_=!1;re.__instanceof(e,Hs)?(s=e.h,n=e.s,r=e.l,o=e.a,a=!0,h=!0,l=!0,_=!0):(null!=e.h&&(s=e.h,a=!0),null!=e.s&&(n=e.s,h=!0),null!=e.l&&(r=e.l,l=!0),null!=e.a&&(o=e.a,_=!0));var u={};return a&&(u.h=s),h&&(u.s=n),l&&(u.l=r),_&&(u.a=o),hs.tween(this,t,u,i)}throw new ne(" Warning: Color.tween passed a null destination ")},_refresh:function(){return this.refreshing=!0,ai.prototype.fromColorHSL.call(this,this),this.refreshing=!1,this},clone:function(){return new Hs(this.h,this.s,this.l,this.a)},toColor:function(){return this._refresh()},fromColor:function(t){var e=t.maxRGB(),i=t.minRGB(),s=e+i,n=e-i,r=0;e==i?r=0:e==t.r?r=(60*(t.g-t.b)/n+360)%360:e==t.g?r=60*(t.b-t.r)/n+120:e==t.b&&(r=60*(t.r-t.g)/n+240);var o,a=s/2;return o=e==i?0:this.l<=.5?n/s:n/(2-s),this.set_h(r),this.set_s(o),this.set_l(a),this.a=t.a,this},toString:function(){return"{ h:"+this.h+" , s:"+this.s+" , l:"+this.l+" , a:"+this.a+" }"},__class__:Hs,__properties__:e(ai.prototype.__properties__,{set_l:"set_l",set_s:"set_s",set_h:"set_h"})});var Ks=function(t,e,i,s){null==s&&(s=1),null==i&&(i=1),null==e&&(e=0),null==t&&(t=0),this.v=1,this.s=0,this.h=0,ai.call(this),this.is_hsv=!0,this.set_h(t),this.set_s(e),this.set_v(i),this.a=s,this._refresh()};n["phoenix.ColorHSV"]=Ks,Ks.__name__=["phoenix","ColorHSV"],Ks.__super__=ai,Ks.prototype=e(ai.prototype,{set_h:function(t){return this.h=t,this._refresh(),t},set_s:function(t){return this.s=t,this._refresh(),this.s},set_v:function(t){return this.v=t,this._refresh(),this.v},set:function(t,e,i,s){var n=this.h,r=this.s,o=this.v,a=this.a;return null!=t&&(n=t),null!=e&&(r=e),null!=i&&(o=i),null!=s&&(a=s),this.set_h(n),this.set_s(r),this.set_v(o),this.a=a,this._refresh(),this},tween:function(t,e,i){if(null==i&&(i=!0),null==t&&(t=.5),ai.prototype.tween.call(this,t,e,i),null!=e){var s=this.h,n=this.s,r=this.v,o=this.a,a=!1,h=!1,l=!1,_=!1;re.__instanceof(e,Ks)?(s=e.h,n=e.s,r=e.v,o=e.a,a=!0,h=!0,l=!0,_=!0):(null!=e.h&&(s=e.h,a=!0),null!=e.s&&(n=e.s,h=!0),null!=e.v&&(r=e.v,l=!0),null!=e.a&&(o=e.a,_=!0));var u={};return a&&(u.h=s),h&&(u.s=n),l&&(u.v=r),_&&(u.a=o),hs.tween(this,t,u,i)}throw new ne(" Warning: Color.tween passed a null destination ")},_refresh:function(){return this.refreshing=!0,ai.prototype.fromColorHSV.call(this,this),this.refreshing=!1,this},clone:function(){return new Ks(this.h,this.s,this.v,this.a)},toColor:function(){return this._refresh()},toColorHSL:function(){return this._refresh(),ai.prototype.toColorHSL.call(this)},fromColorHSL:function(t){return t._refresh(),this.fromColor(t)},fromColor:function(t){var e=t.maxRGB(),i=t.minRGB(),s=e-i,n=0;e==i?n=0:e==t.r?n=(60*(t.g-t.b)/s+360)%360:e==t.g?n=60*(t.b-t.r)/s+120:e==t.b&&(n=60*(t.r-t.g)/s+240);var r;return r=0==e?0:1-i/e,this.set_h(n),this.set_s(r),this.set_v(e),this.a=t.a,this},toString:function(){return"{ h:"+this.h+" , s:"+this.s+" , v:"+this.v+" , a:"+this.a+" }"},__class__:Ks,__properties__:e(ai.prototype.__properties__,{set_v:"set_v",set_s:"set_s",set_h:"set_h"})});var Ws=function(t,e,i){this.pos=t,this.rotation=e,this.scale=i};n["phoenix.MatrixTransform"]=Ws,Ws.__name__=["phoenix","MatrixTransform"],Ws.prototype={destroy:function(){this.pos=null,this.rotation=null,this.scale=null},__class__:Ws};var Qs=function(t,e,i,s,n,r,o,a,h,l,_,u,c,d,f,p){null==p&&(p=1),null==f&&(f=0),null==d&&(d=0),null==c&&(c=0),null==u&&(u=0),null==_&&(_=1),null==l&&(l=0),null==h&&(h=0),null==a&&(a=0),null==o&&(o=0),null==r&&(r=1),null==n&&(n=0),null==s&&(s=0),null==i&&(i=0),null==e&&(e=0),null==t&&(t=1),this.M44=1,this.M34=0,this.M24=0,this.M14=0,this.M43=0,this.M33=1,this.M23=0,this.M13=0,this.M42=0,this.M32=0,this.M22=1,this.M12=0,this.M41=0,this.M31=0,this.M21=0,this.M11=1,this.elements=[];for(var m=0;m++<16;)this.elements.push(0);this.set(t,e,i,s,n,r,o,a,h,l,_,u,c,d,f,p);var g,v=this.elements;g=null!=v?new Float32Array(v):null,this._float32array=g};n["phoenix.Matrix"]=Qs,Qs.__name__=["phoenix","Matrix"],Qs.prototype={set:function(t,e,i,s,n,r,o,a,h,l,_,u,c,d,f,p){var m=this.elements;return m[0]=t,m[4]=e,m[8]=i,m[12]=s,m[1]=n,m[5]=r,m[9]=o,m[13]=a,m[2]=h,m[6]=l,m[10]=_,m[14]=u,m[3]=c,m[7]=d,m[11]=f,m[15]=p,this},toString:function(){var t=this.elements,e="{ 11:"+Es.fixed(t[0],3)+", 12:"+Es.fixed(t[4],3)+", 13:"+Es.fixed(t[8],3)+", 14:"+Es.fixed(t[12],3)+" }, { 21:"+Es.fixed(t[1],3)+", 22:"+Es.fixed(t[5],3)+", 23:"+Es.fixed(t[9],3)+", 24:"+Es.fixed(t[13],3)+" }, { 31:"+Es.fixed(t[2],3)+", 32:"+Es.fixed(t[6],3)+", 33:"+Es.fixed(t[10],3)+", 34:"+Es.fixed(t[14],3)+" }, { 41:"+Es.fixed(t[3],3)+", 42:"+Es.fixed(t[7],3)+", 43:"+Es.fixed(t[11],3)+", 44:"+Es.fixed(t[15],3)+" }";return e},get_M11:function(){return this.elements[0]},get_M12:function(){return this.elements[1]},get_M13:function(){return this.elements[2]},get_M14:function(){return this.elements[3]},get_M21:function(){return this.elements[4]},get_M22:function(){return this.elements[5]},get_M23:function(){return this.elements[6]},get_M24:function(){return this.elements[7]},get_M31:function(){return this.elements[8]},get_M32:function(){return this.elements[9]},get_M33:function(){return this.elements[10]},get_M34:function(){return this.elements[11]},get_M41:function(){return this.elements[12]},get_M42:function(){return this.elements[13]},get_M43:function(){return this.elements[14]},get_M44:function(){return this.elements[15]},set_M11:function(t){return this.elements[0]=t,t},set_M12:function(t){return this.elements[1]=t,t},set_M13:function(t){return this.elements[2]=t,t},set_M14:function(t){return this.elements[3]=t,t},set_M21:function(t){return this.elements[4]=t,t},set_M22:function(t){return this.elements[5]=t,t},set_M23:function(t){return this.elements[6]=t,t},set_M24:function(t){return this.elements[7]=t,t},set_M31:function(t){return this.elements[8]=t,t},set_M32:function(t){return this.elements[9]=t,t},set_M33:function(t){return this.elements[10]=t,t},set_M34:function(t){return this.elements[11]=t,t},set_M41:function(t){return this.elements[12]=t,t},set_M42:function(t){return this.elements[13]=t,t},set_M43:function(t){return this.elements[14]=t,t},set_M44:function(t){return this.elements[15]=t,t},float32array:function(){var t,e=this.elements;return t=null!=e?new Float32Array(e):null},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},copy:function(t){var e=t.elements;return this.set(e[0],e[4],e[8],e[12],e[1],e[5],e[9],e[13],e[2],e[6],e[10],e[14],e[3],e[7],e[11],e[15]),this},make2D:function(t,e,i,s){null==s&&(s=0),null==i&&(i=1);var n=.017453292519943278*s,r=Math.cos(n),o=Math.sin(n);return this.set(r*i,o*i,0,t,-o*i,r*i,0,e,0,0,1,0,0,0,0,1),this},copyPosition:function(t){return this.elements[12]=t.elements[12],this.elements[13]=t.elements[13],this.elements[14]=t.elements[14],this},getPosition:function(){return new un(this.elements[12],this.elements[13],this.elements[14],1)},extractRotation:function(t){var e=new un,i=t.elements,s=1/e.set_xyz(i[0],i[1],i[2]).get_length(),n=1/e.set_xyz(i[4],i[5],i[6]).get_length(),r=1/e.set_xyz(i[8],i[9],i[10]).get_length();return this.elements[0]=i[0]*s,this.elements[1]=i[1]*s,this.elements[2]=i[2]*s,this.elements[4]=i[4]*n,this.elements[5]=i[5]*n,this.elements[6]=i[6]*n,this.elements[8]=i[8]*r,this.elements[9]=i[9]*r,this.elements[10]=i[10]*r,this},makeRotationFromEuler:function(t,e){null==e&&(e=0);var i=this.elements,s=t.x,n=t.y,r=t.z,o=Math.cos(s),a=Math.sin(s),h=Math.cos(n),l=Math.sin(n),_=Math.cos(r),u=Math.sin(r);if(0==e){var c=o*_,d=o*u,f=a*_,p=a*u;i[0]=h*_,i[4]=-h*u,i[8]=l,i[1]=d+f*l,i[5]=c-p*l,i[9]=-a*h,i[2]=p-c*l,i[6]=f+d*l,i[10]=o*h}else if(1==e){var m=h*_,g=h*u,v=l*_,y=l*u;i[0]=m+y*a,i[4]=v*a-g,i[8]=o*l,i[1]=o*u,i[5]=o*_,i[9]=-a,i[2]=g*a-v,i[6]=y+m*a,i[10]=o*h}else if(2==e){var w=h*_,x=h*u,b=l*_,k=l*u;i[0]=w-k*a,i[4]=-o*u,i[8]=b+x*a,i[1]=x+b*a,i[5]=o*_,i[9]=k-w*a,i[2]=-o*l,i[6]=a,i[10]=o*h}else if(3==e){var z=o*_,E=o*u,A=a*_,C=a*u;i[0]=h*_,i[4]=A*l-E,i[8]=z*l+C,i[1]=h*u,i[5]=C*l+z,i[9]=E*l-A,i[2]=-l,i[6]=a*h,i[10]=o*h}else if(4==e){var T=o*h,S=o*l,I=a*h,N=a*l;i[0]=h*_,i[4]=N-T*u,i[8]=I*u+S,i[1]=u,i[5]=o*_,i[9]=-a*_,i[2]=-l*_,i[6]=S*u+I,i[10]=T-N*u}else if(5==e){var M=o*h,R=o*l,B=a*h,P=a*l;i[0]=h*_,i[4]=-u,i[8]=l*_,i[1]=M*u+P,i[5]=o*_,i[9]=R*u-B,i[2]=B*u-R,i[6]=a*_,i[10]=P*u+M
}return i[3]=0,i[7]=0,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,this},makeRotationFromQuaternion:function(t){var e=this.elements,i=t.x+t.x,s=t.y+t.y,n=t.z+t.z,r=t.x*i,o=t.x*s,a=t.x*n,h=t.y*s,l=t.y*n,_=t.z*n,u=t.w*i,c=t.w*s,d=t.w*n;return e[0]=1-(h+_),e[4]=o-d,e[8]=a+c,e[1]=o+d,e[5]=1-(r+_),e[9]=l-u,e[2]=a-c,e[6]=l+u,e[10]=1-(r+h),e[3]=0,e[7]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this},lookAt:function(t,e,i){var s=new un,n=new un,r=new un,o=this.elements;if(r=new un(e.x-t.x,e.y-t.y,e.z-t.z).get_normalized(),0==Math.sqrt(r.x*r.x+r.y*r.y+r.z*r.z)&&(r.z=1,r._construct?r.z:(null==r.listen_z||r.ignore_listeners||r.listen_z(1),r.z)),s=new un(i.y*r.z-i.z*r.y,i.z*r.x-i.x*r.z,i.x*r.y-i.y*r.x).get_normalized(),0==Math.sqrt(s.x*s.x+s.y*s.y+s.z*s.z)){var a=r;a.set_x(a.x+1e-4),s=new un(i.y*r.z-i.z*r.y,i.z*r.x-i.x*r.z,i.x*r.y-i.y*r.x).get_normalized()}return n=new un(r.y*s.z-r.z*s.y,r.z*s.x-r.x*s.z,r.x*s.y-r.y*s.x),o[0]=s.x,o[4]=n.x,o[8]=r.x,o[1]=s.y,o[5]=n.y,o[9]=r.y,o[2]=s.z,o[6]=n.z,o[10]=r.z,this},multiply:function(t){return this.multiplyMatrices(this,t)},multiplyMatrices:function(t,e){var i=t.elements,s=e.elements,n=this.elements,r=i[0],o=i[4],a=i[8],h=i[12],l=i[1],_=i[5],u=i[9],c=i[13],d=i[2],f=i[6],p=i[10],m=i[14],g=i[3],v=i[7],y=i[11],w=i[15],x=s[0],b=s[4],k=s[8],z=s[12],E=s[1],A=s[5],C=s[9],T=s[13],S=s[2],I=s[6],N=s[10],M=s[14],R=s[3],B=s[7],P=s[11],F=s[15];return n[0]=r*x+o*E+a*S+h*R,n[4]=r*b+o*A+a*I+h*B,n[8]=r*k+o*C+a*N+h*P,n[12]=r*z+o*T+a*M+h*F,n[1]=l*x+_*E+u*S+c*R,n[5]=l*b+_*A+u*I+c*B,n[9]=l*k+_*C+u*N+c*P,n[13]=l*z+_*T+u*M+c*F,n[2]=d*x+f*E+p*S+m*R,n[6]=d*b+f*A+p*I+m*B,n[10]=d*k+f*C+p*N+m*P,n[14]=d*z+f*T+p*M+m*F,n[3]=g*x+v*E+y*S+w*R,n[7]=g*b+v*A+y*I+w*B,n[11]=g*k+v*C+y*N+w*P,n[15]=g*z+v*T+y*M+w*F,this},multiplyToArray:function(t,e,i){var s=this.elements;return this.multiplyMatrices(t,e),i[0]=s[0],i[1]=s[1],i[2]=s[2],i[3]=s[3],i[4]=s[4],i[5]=s[5],i[6]=s[6],i[7]=s[7],i[8]=s[8],i[9]=s[9],i[10]=s[10],i[11]=s[11],i[12]=s[12],i[13]=s[13],i[14]=s[14],i[15]=s[15],this},multiplyScalar:function(t){var e=this.elements;return e[0]*=t,e[4]*=t,e[8]*=t,e[12]*=t,e[1]*=t,e[5]*=t,e[9]*=t,e[13]*=t,e[2]*=t,e[6]*=t,e[10]*=t,e[14]*=t,e[3]*=t,e[7]*=t,e[11]*=t,e[15]*=t,this},multiplyVector3Array:function(t){for(var e=new un,i=0,s=t.length;s>i;)e.set_x(t[i]),e.set_y(t[i+1]),e.set_z(t[i+2]),e.applyProjection(this),t[i]=e.x,t[i+1]=e.y,t[i+2]=e.z,i+=3;return t},determinant:function(){var t=this.elements,e=t[0],i=t[4],s=t[8],n=t[12],r=t[1],o=t[5],a=t[9],h=t[13],l=t[2],_=t[6],u=t[10],c=t[14],d=t[3],f=t[7],p=t[11],m=t[15];return d*(n*a*_-s*h*_-n*o*u+i*h*u+s*o*c-i*a*c)+f*(e*a*c-e*h*u+n*r*u-s*r*c+s*h*l-n*a*l)+p*(e*h*_-e*o*c-n*r*_+i*r*c+n*o*l-i*h*l)+m*(-s*o*l-e*a*_+e*o*u+s*r*_-i*r*u+i*a*l)},transpose:function(){var t,e=this.elements;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this},flattenToArray:function(t){if(null==t){t=[];for(var e=0;16>e;){{e++}t.push(0)}}var i=this.elements;return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],t[9]=i[9],t[10]=i[10],t[11]=i[11],t[12]=i[12],t[13]=i[13],t[14]=i[14],t[15]=i[15],t},flattenToArrayOffset:function(t,e){var i=this.elements;return t[e]=i[0],t[e+1]=i[1],t[e+2]=i[2],t[e+3]=i[3],t[e+4]=i[4],t[e+5]=i[5],t[e+6]=i[6],t[e+7]=i[7],t[e+8]=i[8],t[e+9]=i[9],t[e+10]=i[10],t[e+11]=i[11],t[e+12]=i[12],t[e+13]=i[13],t[e+14]=i[14],t[e+15]=i[15],t},setPosition:function(t){var e=this.elements;return e[12]=t.x,e[13]=t.y,e[14]=t.z,this},inverse:function(){return this.clone().getInverse(this)},getInverse:function(t){var e=this.elements,i=t.elements,s=i[0],n=i[4],r=i[8],o=i[12],a=i[1],h=i[5],l=i[9],_=i[13],u=i[2],c=i[6],d=i[10],f=i[14],p=i[3],m=i[7],g=i[11],v=i[15];e[0]=l*f*m-_*d*m+_*c*g-h*f*g-l*c*v+h*d*v,e[4]=o*d*m-r*f*m-o*c*g+n*f*g+r*c*v-n*d*v,e[8]=r*_*m-o*l*m+o*h*g-n*_*g-r*h*v+n*l*v,e[12]=o*l*c-r*_*c-o*h*d+n*_*d+r*h*f-n*l*f,e[1]=_*d*p-l*f*p-_*u*g+a*f*g+l*u*v-a*d*v,e[5]=r*f*p-o*d*p+o*u*g-s*f*g-r*u*v+s*d*v,e[9]=o*l*p-r*_*p-o*a*g+s*_*g+r*a*v-s*l*v,e[13]=r*_*u-o*l*u+o*a*d-s*_*d-r*a*f+s*l*f,e[2]=h*f*p-_*c*p+_*u*m-a*f*m-h*u*v+a*c*v,e[6]=o*c*p-n*f*p-o*u*m+s*f*m+n*u*v-s*c*v,e[10]=n*_*p-o*h*p+o*a*m-s*_*m-n*a*v+s*h*v,e[14]=o*h*u-n*_*u-o*a*c+s*_*c+n*a*f-s*h*f,e[3]=l*c*p-h*d*p-l*u*m+a*d*m+h*u*g-a*c*g,e[7]=n*d*p-r*c*p+r*u*m-s*d*m-n*u*g+s*c*g,e[11]=r*h*p-n*l*p-r*a*m+s*l*m+n*a*g-s*h*g,e[15]=n*l*u-r*h*u+r*a*c-s*l*c-n*a*d+s*h*d;var y=i[0]*e[0]+i[1]*e[4]+i[2]*e[8]+i[3]*e[12];return 0==y?(S.trace("Matrix.getInverse: cant invert matrix, determinant is 0",{fileName:"Matrix.hx",lineNumber:689,className:"phoenix.Matrix",methodName:"getInverse"}),this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this):(this.multiplyScalar(1/y),this)},scale:function(t){var e=this.elements,i=t.x,s=t.y,n=t.z;return e[0]*=i,e[4]*=s,e[8]*=n,e[1]*=i,e[5]*=s,e[9]*=n,e[2]*=i,e[6]*=s,e[10]*=n,e[3]*=i,e[7]*=s,e[11]*=n,this},getMaxScaleOnAxis:function(){var t=this.elements,e=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],i=t[4]*t[4]+t[5]*t[5]+t[6]*t[6],s=t[8]*t[8]+t[9]*t[9]+t[10]*t[10];return Math.sqrt(Math.max(e,Math.max(i,s)))},makeTranslation:function(t,e,i){return this.set(1,0,0,t,0,1,0,e,0,0,1,i,0,0,0,1),this},makeRotationX:function(t){var e=Math.cos(t),i=Math.sin(t);return this.set(1,0,0,0,0,e,-i,0,0,i,e,0,0,0,0,1),this},makeRotationY:function(t){var e=Math.cos(t),i=Math.sin(t);return this.set(e,0,i,0,0,1,0,0,-i,0,e,0,0,0,0,1),this},makeRotationZ:function(t){var e=Math.cos(t),i=Math.sin(t);return this.set(e,-i,0,0,i,e,0,0,0,0,1,0,0,0,0,1),this},makeRotationAxis:function(t,e){var i=Math.cos(e),s=Math.sin(e),n=1-i,r=t.x,o=t.y,a=t.z,h=n*r,l=n*o;return this.set(h*r+i,h*o-s*a,h*a+s*o,0,h*o+s*a,l*o+i,l*a-s*r,0,h*a-s*o,l*a+s*r,n*a*a+i,0,0,0,0,1),this},makeScale:function(t,e,i){return this.set(t,0,0,0,0,e,0,0,0,0,i,0,0,0,0,1),this},compose_with_origin:function(t,e,i,s){return this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1),this.scale(s),this.multiply((new Qs).makeRotationFromQuaternion(i)),this.multiply((new Qs).makeTranslation(-e.x,-e.y,-e.z)),this.multiply((new Qs).makeTranslation(t.x,t.y,t.z)),this},compose:function(t,e,i){return this.makeRotationFromQuaternion(e),this.scale(i),this.setPosition(t),this},decompose:function(t,e,i){var s=this.elements,n=new Qs,r=s[0],o=s[1],a=s[2],h=s[4],l=s[5],_=s[6],u=s[8],c=s[9],d=s[10],f=Math.sqrt(r*r+o*o+a*a),p=Math.sqrt(h*h+l*l+_*_),m=Math.sqrt(u*u+c*c+d*d);null==e&&(e=new Ys),null==t?t=new un(s[12],s[13],s[14]):(t.set_x(s[12]),t.set_y(s[13]),t.set_z(s[14])),null==i?i=new un(f,p,m):(i.x=f,i._construct?i.x:(null==i.listen_x||i.ignore_listeners||i.listen_x(f),i.x),i.y=p,i._construct?i.y:(null==i.listen_y||i.ignore_listeners||i.listen_y(p),i.y),i.z=m,i._construct?i.z:(null==i.listen_z||i.ignore_listeners||i.listen_z(m),i.z)),n.elements=this.elements.concat([]);var g=n.elements;return g[0]/=f,g[1]/=f,g[2]/=f,g[4]/=p,g[5]/=p,g[6]/=p,g[8]/=m,g[9]/=m,g[10]/=m,e.setFromRotationMatrix(n),null==this._transform?this._transform=new Ws(t,e,i):(this._transform.pos=t,this._transform.rotation=e,this._transform.scale=i),this._transform},makeFrustum:function(t,e,i,s,n,r){var o=this.elements,a=2*n/(e-t),h=2*n/(s-i),l=(e+t)/(e-t),_=(s+i)/(s-i),u=-(r+n)/(r-n),c=-2*r*n/(r-n);return o[0]=a,o[4]=0,o[8]=l,o[12]=0,o[1]=0,o[5]=h,o[9]=_,o[13]=0,o[2]=0,o[6]=0,o[10]=u,o[14]=c,o[3]=0,o[7]=0,o[11]=-1,o[15]=0,this},makePerspective:function(t,e,i,s){var n=i*Math.tan(.5*t*.017453292519943278),r=-n,o=r*e,a=n*e;return this.makeFrustum(o,a,r,n,i,s)},makeOrthographic:function(t,e,i,s,n,r){var o=this.elements,a=e-t,h=i-s,l=r-n,_=(e+t)/a,u=(i+s)/h,c=(r+n)/l;return o[0]=2/a,o[4]=0,o[8]=0,o[12]=-_,o[1]=0,o[5]=2/h,o[9]=0,o[13]=-u,o[2]=0,o[6]=0,o[10]=-2/l,o[14]=-c,o[3]=0,o[7]=0,o[11]=0,o[15]=1,this},fromArray:function(t){this.elements=t.concat([])},toArray:function(){var t=this.elements;return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13],t[14],t[15]]},clone:function(){var t=this.elements;return new Qs(t[0],t[4],t[8],t[12],t[1],t[5],t[9],t[13],t[2],t[6],t[10],t[14],t[3],t[7],t[11],t[15])},up:function(){return new un(this.elements[4],this.elements[5],this.elements[10])},down:function(){return new un(this.elements[4],this.elements[5],this.elements[10]).get_inverted()},left:function(){return new un(this.elements[0],this.elements[1],this.elements[2]).get_inverted()},right:function(){return new un(this.elements[0],this.elements[1],this.elements[2])},backward:function(){return new un(this.elements[8],this.elements[9],this.elements[10])},forward:function(){return new un(this.elements[8],this.elements[9],this.elements[10]).get_inverted()},__class__:Qs,__properties__:{set_M44:"set_M44",get_M44:"get_M44",set_M34:"set_M34",get_M34:"get_M34",set_M24:"set_M24",get_M24:"get_M24",set_M14:"set_M14",get_M14:"get_M14",set_M43:"set_M43",get_M43:"get_M43",set_M33:"set_M33",get_M33:"get_M33",set_M23:"set_M23",get_M23:"get_M23",set_M13:"set_M13",get_M13:"get_M13",set_M42:"set_M42",get_M42:"get_M42",set_M32:"set_M32",get_M32:"get_M32",set_M22:"set_M22",get_M22:"get_M22",set_M12:"set_M12",get_M12:"get_M12",set_M41:"set_M41",get_M41:"get_M41",set_M31:"set_M31",get_M31:"get_M31",set_M21:"set_M21",get_M21:"get_M21",set_M11:"set_M11",get_M11:"get_M11"}};var Ys=function(t,e,i,s){null==s&&(s=1),null==i&&(i=0),null==e&&(e=0),null==t&&(t=0),this.ignore_euler=!1,this._construct=!1,this.ignore_listeners=!1,this.w=0,this.z=0,this.y=0,this.x=0,this._construct=!0,this.x=t,this._construct?this.x:(null==this.euler||this.ignore_euler||this._construct||this.euler.setEulerFromQuaternion(this,null),null==this.listen_x||this.ignore_listeners||this.listen_x(this.x),this.x),this.y=e,this._construct?this.y:(null==this.euler||this.ignore_euler||this._construct||this.euler.setEulerFromQuaternion(this,null),null==this.listen_y||this.ignore_listeners||this.listen_y(this.y),this.y),this.z=i,this._construct?this.z:(null==this.euler||this.ignore_euler||this._construct||this.euler.setEulerFromQuaternion(this,null),null==this.listen_z||this.ignore_listeners||this.listen_z(this.z),this.z),this.w=s,this._construct?this.w:(null==this.euler||this.ignore_euler||this._construct||this.euler.setEulerFromQuaternion(this,null),null==this.listen_w||this.ignore_listeners||this.listen_w(this.w),this.w),this.euler=new un,this._construct=!1};n["phoenix.Quaternion"]=Ys,Ys.__name__=["phoenix","Quaternion"],Ys.Add=function(t,e){return t.clone().add(e)},Ys.Multiply=function(t,e){return t.clone().multiply(e)},Ys.MultiplyScalar=function(t,e){return t.clone().multiplyScalar(e)},Ys.Slerp=function(t,e,i,s){return i.copy(t).slerp(e,s)},Ys.Dot=function(t,e){return new Ys(t.x,t.y,t.z,t.w).dot(e)},Ys.Listen=function(t,e){t.listen_x=e,t.listen_y=e,t.listen_z=e,t.listen_w=e},Ys.prototype={toString:function(){return"{ x:"+this.x+", y:"+this.y+", z:"+this.z+", w:"+this.w+" }"},set:function(t,e,i,s){return this.ignore_euler=!0,this.x=t,this._construct?this.x:(null==this.euler||this.ignore_euler||this._construct||this.euler.setEulerFromQuaternion(this,null),null==this.listen_x||this.ignore_listeners||this.listen_x(this.x),this.x),this.y=e,this._construct?this.y:(null==this.euler||this.ignore_euler||this._construct||this.euler.setEulerFromQuaternion(this,null),null==this.listen_y||this.ignore_listeners||this.listen_y(this.y),this.y),this.z=i,this._construct?this.z:(null==this.euler||this.ignore_euler||this._construct||this.euler.setEulerFromQuaternion(this,null),null==this.listen_z||this.ignore_listeners||this.listen_z(this.z),this.z),this.w=s,this._construct?this.w:(null==this.euler||this.ignore_euler||this._construct||this.euler.setEulerFromQuaternion(this,null),null==this.listen_w||this.ignore_listeners||this.listen_w(this.w),this.w),this.ignore_euler=!1,null==this.euler||this.ignore_euler||this._construct||this.euler.setEulerFromQuaternion(this,null),null==this.listen_x||this.ignore_listeners||this.listen_x(this.x),null==this.listen_y||this.ignore_listeners||this.listen_y(this.y),null==this.listen_z||this.ignore_listeners||this.listen_z(this.z),null==this.listen_w||this.ignore_listeners||this.listen_w(this.w),this},copy:function(t){return this.ignore_euler=!0,this.x=t.x,this._construct?this.x:(null==this.euler||this.ignore_euler||this._construct||this.euler.setEulerFromQuaternion(this,null),null==this.listen_x||this.ignore_listeners||this.listen_x(this.x),this.x),this.y=t.y,this._construct?this.y:(null==this.euler||this.ignore_euler||this._construct||this.euler.setEulerFromQuaternion(this,null),null==this.listen_y||this.ignore_listeners||this.listen_y(this.y),this.y),this.z=t.z,this._construct?this.z:(null==this.euler||this.ignore_euler||this._construct||this.euler.setEulerFromQuaternion(this,null),null==this.listen_z||this.ignore_listeners||this.listen_z(this.z),this.z),this.w=t.w,this._construct?this.w:(null==this.euler||this.ignore_euler||this._construct||this.euler.setEulerFromQuaternion(this,null),null==this.listen_w||this.ignore_listeners||this.listen_w(this.w),this.w),this.ignore_euler=!1,null==this.euler||this.ignore_euler||this._construct||this.euler.setEulerFromQuaternion(this,null),null==this.listen_x||this.ignore_listeners||this.listen_x(this.x),null==this.listen_y||this.ignore_listeners||this.listen_y(this.y),null==this.listen_z||this.ignore_listeners||this.listen_z(this.z),null==this.listen_w||this.ignore_listeners||this.listen_w(this.w),this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w},setFromEuler:function(t,e){null==e&&(e=0);var i=this.x,s=this.y,n=this.z,r=this.w,o=Math.cos(t.x/2),a=Math.cos(t.y/2),h=Math.cos(t.z/2),l=Math.sin(t.x/2),_=Math.sin(t.y/2),u=Math.sin(t.z/2);return 0==e?(i=l*a*h+o*_*u,s=o*_*h-l*a*u,n=o*a*u+l*_*h,r=o*a*h-l*_*u):1==e?(i=l*a*h+o*_*u,s=o*_*h-l*a*u,n=o*a*u-l*_*h,r=o*a*h+l*_*u):2==e?(i=l*a*h-o*_*u,s=o*_*h+l*a*u,n=o*a*u+l*_*h,r=o*a*h-l*_*u):3==e?(i=l*a*h-o*_*u,s=o*_*h+l*a*u,n=o*a*u-l*_*h,r=o*a*h+l*_*u):4==e?(i=l*a*h+o*_*u,s=o*_*h+l*a*u,n=o*a*u-l*_*h,r=o*a*h-l*_*u):5==e&&(i=l*a*h-o*_*u,s=o*_*h-l*a*u,n=o*a*u+l*_*h,r=o*a*h+l*_*u),this.ignore_euler=!0,this.x=i,this._construct?this.x:(null==this.euler||this.ignore_euler||this._construct||this.euler.setEulerFromQuaternion(this,null),null==this.listen_x||this.ignore_listeners||this.listen_x(this.x),this.x),this.y=s,this._construct?this.y:(null==this.euler||this.ignore_euler||this._construct||this.euler.setEulerFromQuaternion(this,null),null==this.listen_y||this.ignore_listeners||this.listen_y(this.y),this.y),this.z=n,this._construct?this.z:(null==this.euler||this.ignore_euler||this._construct||this.euler.setEulerFromQuaternion(this,null),null==this.listen_z||this.ignore_listeners||this.listen_z(this.z),this.z),this.w=r,this._construct?this.w:(null==this.euler||this.ignore_euler||this._construct||this.euler.setEulerFromQuaternion(this,null),null==this.listen_w||this.ignore_listeners||this.listen_w(this.w),this.w),this.ignore_euler=!1,null==this.euler||this.ignore_euler||this._construct||this.euler.setEulerFromQuaternion(this,null),null==this.listen_x||this.ignore_listeners||this.listen_x(this.x),null==this.listen_y||this.ignore_listeners||this.listen_y(this.y),null==this.listen_z||this.ignore_listeners||this.listen_z(this.z),null==this.listen_w||this.ignore_listeners||this.listen_w(this.w),this},setFromAxisAngle:function(t,e){var i=e/2,s=Math.sin(i);return this.set_xyzw(t.x*s,t.y*s,t.z*s,Math.cos(i)),this},setFromRotationMatrix:function(t){var e,i=t.elements,s=i[0],n=i[4],r=i[8],o=i[1],a=i[5],h=i[9],l=i[2],_=i[6],u=i[10],c=this.x,d=this.y,f=this.z,p=this.w,m=s+a+u;return m>0?(e=.5/Math.sqrt(m+1),p=.25/e,c=(_-h)*e,d=(r-l)*e,f=(o-n)*e):s>a&&s>u?(e=2*Math.sqrt(1+s-a-u),p=(_-h)/e,c=.25*e,d=(n+o)/e,f=(r+l)/e):a>u?(e=2*Math.sqrt(1+a-s-u),p=(r-l)/e,c=(n+o)/e,d=.25*e,f=(h+_)/e):(e=2*Math.sqrt(1+u-s-a),p=(o-n)/e,c=(r+l)/e,d=(h+_)/e,f=.25*e),this.ignore_euler=!0,this.x=c,this._construct?this.x:(null==this.euler||this.ignore_euler||this._construct||this.euler.setEulerFromQuaternion(this,null),null==this.listen_x||this.ignore_listeners||this.listen_x(this.x),this.x),this.y=d,this._construct?this.y:(null==this.euler||this.ignore_euler||this._construct||this.euler.setEulerFromQuaternion(this,null),null==this.listen_y||this.ignore_listeners||this.listen_y(this.y),this.y),this.z=f,this._construct?this.z:(null==this.euler||this.ignore_euler||this._construct||this.euler.setEulerFromQuaternion(this,null),null==this.listen_z||this.ignore_listeners||this.listen_z(this.z),this.z),this.w=p,this._construct?this.w:(null==this.euler||this.ignore_euler||this._construct||this.euler.setEulerFromQuaternion(this,null),null==this.listen_w||this.ignore_listeners||this.listen_w(this.w),this.w),this.ignore_euler=!1,null==this.euler||this.ignore_euler||this._construct||this.euler.setEulerFromQuaternion(this,null),null==this.listen_x||this.ignore_listeners||this.listen_x(this.x),null==this.listen_y||this.ignore_listeners||this.listen_y(this.y),null==this.listen_z||this.ignore_listeners||this.listen_z(this.z),null==this.listen_w||this.ignore_listeners||this.listen_w(this.w),this},inverse:function(){return this.conjugate().normalize()},conjugate:function(){return this.ignore_euler=!0,this.x=-1*this.x,this._construct?this.x:(null==this.euler||this.ignore_euler||this._construct||this.euler.setEulerFromQuaternion(this,null),null==this.listen_x||this.ignore_listeners||this.listen_x(this.x),this.x),this.y=-1*this.y,this._construct?this.y:(null==this.euler||this.ignore_euler||this._construct||this.euler.setEulerFromQuaternion(this,null),null==this.listen_y||this.ignore_listeners||this.listen_y(this.y),this.y),this.z=-1*this.z,this._construct?this.z:(null==this.euler||this.ignore_euler||this._construct||this.euler.setEulerFromQuaternion(this,null),null==this.listen_z||this.ignore_listeners||this.listen_z(this.z),this.z),this.ignore_euler=!1,null==this.euler||this.ignore_euler||this._construct||this.euler.setEulerFromQuaternion(this,null),null==this.listen_x||this.ignore_listeners||this.listen_x(this.x),null==this.listen_y||this.ignore_listeners||this.listen_y(this.y),null==this.listen_z||this.ignore_listeners||this.listen_z(this.z),this},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},normalize:function(){var t=this.length();return 0==t?(this.ignore_euler=!0,this.x=0,this._construct?this.x:(null==this.euler||this.ignore_euler||this._construct||this.euler.setEulerFromQuaternion(this,null),null==this.listen_x||this.ignore_listeners||this.listen_x(this.x),this.x),this.y=0,this._construct?this.y:(null==this.euler||this.ignore_euler||this._construct||this.euler.setEulerFromQuaternion(this,null),null==this.listen_y||this.ignore_listeners||this.listen_y(this.y),this.y),this.z=0,this._construct?this.z:(null==this.euler||this.ignore_euler||this._construct||this.euler.setEulerFromQuaternion(this,null),null==this.listen_z||this.ignore_listeners||this.listen_z(this.z),this.z),this.w=1,this._construct?this.w:(null==this.euler||this.ignore_euler||this._construct||this.euler.setEulerFromQuaternion(this,null),null==this.listen_w||this.ignore_listeners||this.listen_w(this.w),this.w),this.ignore_euler=!1,null==this.euler||this.ignore_euler||this._construct||this.euler.setEulerFromQuaternion(this,null),null==this.listen_x||this.ignore_listeners||this.listen_x(this.x),null==this.listen_y||this.ignore_listeners||this.listen_y(this.y),null==this.listen_z||this.ignore_listeners||this.listen_z(this.z),null==this.listen_w||this.ignore_listeners||this.listen_w(this.w)):(t=1/t,this.ignore_euler=!0,this.x=this.x*t,this._construct?this.x:(null==this.euler||this.ignore_euler||this._construct||this.euler.setEulerFromQuaternion(this,null),null==this.listen_x||this.ignore_listeners||this.listen_x(this.x),this.x),this.y=this.y*t,this._construct?this.y:(null==this.euler||this.ignore_euler||this._construct||this.euler.setEulerFromQuaternion(this,null),null==this.listen_y||this.ignore_listeners||this.listen_y(this.y),this.y),this.z=this.z*t,this._construct?this.z:(null==this.euler||this.ignore_euler||this._construct||this.euler.setEulerFromQuaternion(this,null),null==this.listen_z||this.ignore_listeners||this.listen_z(this.z),this.z),this.w=this.w*t,this._construct?this.w:(null==this.euler||this.ignore_euler||this._construct||this.euler.setEulerFromQuaternion(this,null),null==this.listen_w||this.ignore_listeners||this.listen_w(this.w),this.w),this.ignore_euler=!1,null==this.euler||this.ignore_euler||this._construct||this.euler.setEulerFromQuaternion(this,null),null==this.listen_x||this.ignore_listeners||this.listen_x(this.x),null==this.listen_y||this.ignore_listeners||this.listen_y(this.y),null==this.listen_z||this.ignore_listeners||this.listen_z(this.z),null==this.listen_w||this.ignore_listeners||this.listen_w(this.w)),this},multiply:function(t){return this.multiplyQuaternions(this,t)},add:function(t){return this.addQuaternions(this,t)},addQuaternions:function(t,e){return this.x=t.x+e.x,this._construct?this.x:(null==this.euler||this.ignore_euler||this._construct||this.euler.setEulerFromQuaternion(this,null),null==this.listen_x||this.ignore_listeners||this.listen_x(this.x),this.x),this.y=t.y+e.y,this._construct?this.y:(null==this.euler||this.ignore_euler||this._construct||this.euler.setEulerFromQuaternion(this,null),null==this.listen_y||this.ignore_listeners||this.listen_y(this.y),this.y),this.z=t.z+e.z,this._construct?this.z:(null==this.euler||this.ignore_euler||this._construct||this.euler.setEulerFromQuaternion(this,null),null==this.listen_z||this.ignore_listeners||this.listen_z(this.z),this.z),this.w=t.w+e.w,this._construct?this.w:(null==this.euler||this.ignore_euler||this._construct||this.euler.setEulerFromQuaternion(this,null),null==this.listen_w||this.ignore_listeners||this.listen_w(this.w),this.w),this},multiplyScalar:function(t){var e=this;e.x=e.x*t,e._construct?e.x:(null==e.euler||e.ignore_euler||e._construct||e.euler.setEulerFromQuaternion(e,null),null==e.listen_x||e.ignore_listeners||e.listen_x(e.x),e.x);var i=this;i.y=i.y*t,i._construct?i.y:(null==i.euler||i.ignore_euler||i._construct||i.euler.setEulerFromQuaternion(i,null),null==i.listen_y||i.ignore_listeners||i.listen_y(i.y),i.y);var s=this;s.z=s.z*t,s._construct?s.z:(null==s.euler||s.ignore_euler||s._construct||s.euler.setEulerFromQuaternion(s,null),null==s.listen_z||s.ignore_listeners||s.listen_z(s.z),s.z);var n=this;return n.w=n.w*t,n._construct?n.w:(null==n.euler||n.ignore_euler||n._construct||n.euler.setEulerFromQuaternion(n,null),null==n.listen_w||n.ignore_listeners||n.listen_w(n.w),n.w),this},multiplyQuaternions:function(t,e){var i=t.x,s=t.y,n=t.z,r=t.w,o=e.x,a=e.y,h=e.z,l=e.w;return this.ignore_euler=!0,this.x=i*l+r*o+s*h-n*a,this._construct?this.x:(null==this.euler||this.ignore_euler||this._construct||this.euler.setEulerFromQuaternion(this,null),null==this.listen_x||this.ignore_listeners||this.listen_x(this.x),this.x),this.y=s*l+r*a+n*o-i*h,this._construct?this.y:(null==this.euler||this.ignore_euler||this._construct||this.euler.setEulerFromQuaternion(this,null),null==this.listen_y||this.ignore_listeners||this.listen_y(this.y),this.y),this.z=n*l+r*h+i*a-s*o,this._construct?this.z:(null==this.euler||this.ignore_euler||this._construct||this.euler.setEulerFromQuaternion(this,null),null==this.listen_z||this.ignore_listeners||this.listen_z(this.z),this.z),this.w=r*l-i*o-s*a-n*h,this._construct?this.w:(null==this.euler||this.ignore_euler||this._construct||this.euler.setEulerFromQuaternion(this,null),null==this.listen_w||this.ignore_listeners||this.listen_w(this.w),this.w),this.ignore_euler=!1,null==this.euler||this.ignore_euler||this._construct||this.euler.setEulerFromQuaternion(this,null),null==this.listen_x||this.ignore_listeners||this.listen_x(this.x),null==this.listen_y||this.ignore_listeners||this.listen_y(this.y),null==this.listen_z||this.ignore_listeners||this.listen_z(this.z),null==this.listen_w||this.ignore_listeners||this.listen_w(this.w),this},slerp:function(t,e){var i=this.x,s=this.y,n=this.z,r=this.w,o=r*t.w+i*t.x+s*t.y+n*t.z;if(0>o?(this.w=-t.w,this._construct?this.w:(null==this.euler||this.ignore_euler||this._construct||this.euler.setEulerFromQuaternion(this,null),null==this.listen_w||this.ignore_listeners||this.listen_w(this.w),this.w),this.x=-t.x,this._construct?this.x:(null==this.euler||this.ignore_euler||this._construct||this.euler.setEulerFromQuaternion(this,null),null==this.listen_x||this.ignore_listeners||this.listen_x(this.x),this.x),this.y=-t.y,this._construct?this.y:(null==this.euler||this.ignore_euler||this._construct||this.euler.setEulerFromQuaternion(this,null),null==this.listen_y||this.ignore_listeners||this.listen_y(this.y),this.y),this.z=-t.z,this._construct?this.z:(null==this.euler||this.ignore_euler||this._construct||this.euler.setEulerFromQuaternion(this,null),null==this.listen_z||this.ignore_listeners||this.listen_z(this.z),this.z),o=-o):this.copy(t),o>=1)return this.ignore_euler=!0,this.x=i,this._construct?this.x:(null==this.euler||this.ignore_euler||this._construct||this.euler.setEulerFromQuaternion(this,null),null==this.listen_x||this.ignore_listeners||this.listen_x(this.x),this.x),this.y=s,this._construct?this.y:(null==this.euler||this.ignore_euler||this._construct||this.euler.setEulerFromQuaternion(this,null),null==this.listen_y||this.ignore_listeners||this.listen_y(this.y),this.y),this.z=n,this._construct?this.z:(null==this.euler||this.ignore_euler||this._construct||this.euler.setEulerFromQuaternion(this,null),null==this.listen_z||this.ignore_listeners||this.listen_z(this.z),this.z),this.w=r,this._construct?this.w:(null==this.euler||this.ignore_euler||this._construct||this.euler.setEulerFromQuaternion(this,null),null==this.listen_w||this.ignore_listeners||this.listen_w(this.w),this.w),this.ignore_euler=!1,null==this.euler||this.ignore_euler||this._construct||this.euler.setEulerFromQuaternion(this,null),null==this.listen_x||this.ignore_listeners||this.listen_x(this.x),null==this.listen_y||this.ignore_listeners||this.listen_y(this.y),null==this.listen_z||this.ignore_listeners||this.listen_z(this.z),null==this.listen_w||this.ignore_listeners||this.listen_w(this.w),this;var a=Math.acos(o),h=Math.sqrt(1-o*o);if(Math.abs(h)<.001)return this.ignore_euler=!0,this.x=.5*(r+this.w),this._construct?this.x:(null==this.euler||this.ignore_euler||this._construct||this.euler.setEulerFromQuaternion(this,null),null==this.listen_x||this.ignore_listeners||this.listen_x(this.x),this.x),this.y=.5*(i+this.x),this._construct?this.y:(null==this.euler||this.ignore_euler||this._construct||this.euler.setEulerFromQuaternion(this,null),null==this.listen_y||this.ignore_listeners||this.listen_y(this.y),this.y),this.z=.5*(s+this.y),this._construct?this.z:(null==this.euler||this.ignore_euler||this._construct||this.euler.setEulerFromQuaternion(this,null),null==this.listen_z||this.ignore_listeners||this.listen_z(this.z),this.z),this.w=.5*(n+this.z),this._construct?this.w:(null==this.euler||this.ignore_euler||this._construct||this.euler.setEulerFromQuaternion(this,null),null==this.listen_w||this.ignore_listeners||this.listen_w(this.w),this.w),this.ignore_euler=!1,null==this.euler||this.ignore_euler||this._construct||this.euler.setEulerFromQuaternion(this,null),null==this.listen_x||this.ignore_listeners||this.listen_x(this.x),null==this.listen_y||this.ignore_listeners||this.listen_y(this.y),null==this.listen_z||this.ignore_listeners||this.listen_z(this.z),null==this.listen_w||this.ignore_listeners||this.listen_w(this.w),this;var l=Math.sin((1-e)*a)/h,_=Math.sin(e*a)/h;return this.ignore_euler=!0,this.x=r*l+this.w*_,this._construct?this.x:(null==this.euler||this.ignore_euler||this._construct||this.euler.setEulerFromQuaternion(this,null),null==this.listen_x||this.ignore_listeners||this.listen_x(this.x),this.x),this.y=i*l+this.x*_,this._construct?this.y:(null==this.euler||this.ignore_euler||this._construct||this.euler.setEulerFromQuaternion(this,null),null==this.listen_y||this.ignore_listeners||this.listen_y(this.y),this.y),this.z=s*l+this.y*_,this._construct?this.z:(null==this.euler||this.ignore_euler||this._construct||this.euler.setEulerFromQuaternion(this,null),null==this.listen_z||this.ignore_listeners||this.listen_z(this.z),this.z),this.w=n*l+this.z*_,this._construct?this.w:(null==this.euler||this.ignore_euler||this._construct||this.euler.setEulerFromQuaternion(this,null),null==this.listen_w||this.ignore_listeners||this.listen_w(this.w),this.w),this.ignore_euler=!1,null==this.euler||this.ignore_euler||this._construct||this.euler.setEulerFromQuaternion(this,null),null==this.listen_x||this.ignore_listeners||this.listen_x(this.x),null==this.listen_y||this.ignore_listeners||this.listen_y(this.y),null==this.listen_z||this.ignore_listeners||this.listen_z(this.z),null==this.listen_w||this.ignore_listeners||this.listen_w(this.w),this},equals:function(t){return t.x==this.x&&t.y==this.y&&t.z==this.z&&t.w==this.w},fromArray:function(t){return this.ignore_euler=!0,this.x=t[0],this._construct?this.x:(null==this.euler||this.ignore_euler||this._construct||this.euler.setEulerFromQuaternion(this,null),null==this.listen_x||this.ignore_listeners||this.listen_x(this.x),this.x),this.y=t[1],this._construct?this.y:(null==this.euler||this.ignore_euler||this._construct||this.euler.setEulerFromQuaternion(this,null),null==this.listen_y||this.ignore_listeners||this.listen_y(this.y),this.y),this.z=t[2],this._construct?this.z:(null==this.euler||this.ignore_euler||this._construct||this.euler.setEulerFromQuaternion(this,null),null==this.listen_z||this.ignore_listeners||this.listen_z(this.z),this.z),this.w=t[3],this._construct?this.w:(null==this.euler||this.ignore_euler||this._construct||this.euler.setEulerFromQuaternion(this,null),null==this.listen_w||this.ignore_listeners||this.listen_w(this.w),this.w),this.ignore_euler=!1,null==this.euler||this.ignore_euler||this._construct||this.euler.setEulerFromQuaternion(this,null),null==this.listen_x||this.ignore_listeners||this.listen_x(this.x),null==this.listen_y||this.ignore_listeners||this.listen_y(this.y),null==this.listen_z||this.ignore_listeners||this.listen_z(this.z),null==this.listen_w||this.ignore_listeners||this.listen_w(this.w),this},toArray:function(){return[this.x,this.y,this.z,this.w]},clone:function(){return new Ys(this.x,this.y,this.z,this.w)},toeuler:function(){return(new un).setEulerFromQuaternion(this,null).degrees()},update_euler:function(){null==this.euler||this.ignore_euler||this._construct||this.euler.setEulerFromQuaternion(this,null)},set_xyzw:function(t,e,i,s){this.ignore_euler=!0,this.x=t,this._construct?this.x:(null==this.euler||this.ignore_euler||this._construct||this.euler.setEulerFromQuaternion(this,null),null==this.listen_x||this.ignore_listeners||this.listen_x(this.x),this.x),this.y=e,this._construct?this.y:(null==this.euler||this.ignore_euler||this._construct||this.euler.setEulerFromQuaternion(this,null),null==this.listen_y||this.ignore_listeners||this.listen_y(this.y),this.y),this.z=i,this._construct?this.z:(null==this.euler||this.ignore_euler||this._construct||this.euler.setEulerFromQuaternion(this,null),null==this.listen_z||this.ignore_listeners||this.listen_z(this.z),this.z),this.w=s,this._construct?this.w:(null==this.euler||this.ignore_euler||this._construct||this.euler.setEulerFromQuaternion(this,null),null==this.listen_w||this.ignore_listeners||this.listen_w(this.w),this.w),this.ignore_euler=!1,null==this.euler||this.ignore_euler||this._construct||this.euler.setEulerFromQuaternion(this,null),null==this.listen_x||this.ignore_listeners||this.listen_x(this.x),null==this.listen_y||this.ignore_listeners||this.listen_y(this.y),null==this.listen_z||this.ignore_listeners||this.listen_z(this.z),null==this.listen_w||this.ignore_listeners||this.listen_w(this.w)},set_xyz:function(t,e,i){this.ignore_euler=!0,this.x=t,this._construct?this.x:(null==this.euler||this.ignore_euler||this._construct||this.euler.setEulerFromQuaternion(this,null),null==this.listen_x||this.ignore_listeners||this.listen_x(this.x),this.x),this.y=e,this._construct?this.y:(null==this.euler||this.ignore_euler||this._construct||this.euler.setEulerFromQuaternion(this,null),null==this.listen_y||this.ignore_listeners||this.listen_y(this.y),this.y),this.z=i,this._construct?this.z:(null==this.euler||this.ignore_euler||this._construct||this.euler.setEulerFromQuaternion(this,null),null==this.listen_z||this.ignore_listeners||this.listen_z(this.z),this.z),this.ignore_euler=!1,null==this.euler||this.ignore_euler||this._construct||this.euler.setEulerFromQuaternion(this,null),null==this.listen_x||this.ignore_listeners||this.listen_x(this.x),null==this.listen_y||this.ignore_listeners||this.listen_y(this.y),null==this.listen_z||this.ignore_listeners||this.listen_z(this.z)
},set_x:function(t){return this.x=t,this._construct?this.x:(null==this.euler||this.ignore_euler||this._construct||this.euler.setEulerFromQuaternion(this,null),null==this.listen_x||this.ignore_listeners||this.listen_x(this.x),this.x)},set_y:function(t){return this.y=t,this._construct?this.y:(null==this.euler||this.ignore_euler||this._construct||this.euler.setEulerFromQuaternion(this,null),null==this.listen_y||this.ignore_listeners||this.listen_y(this.y),this.y)},set_z:function(t){return this.z=t,this._construct?this.z:(null==this.euler||this.ignore_euler||this._construct||this.euler.setEulerFromQuaternion(this,null),null==this.listen_z||this.ignore_listeners||this.listen_z(this.z),this.z)},set_w:function(t){return this.w=t,this._construct?this.w:(null==this.euler||this.ignore_euler||this._construct||this.euler.setEulerFromQuaternion(this,null),null==this.listen_w||this.ignore_listeners||this.listen_w(this.w),this.w)},__class__:Ys,__properties__:{set_w:"set_w",set_z:"set_z",set_y:"set_y",set_x:"set_x"}};var Js=function(t,e,i){if(null==i&&(i=new $s(0,0,_.core.screen.get_w(),_.core.screen.get_h())),null==e)throw new ne("Camera required for a ray!");this.camera=e,this.viewport=i,this.refresh(t)};n["phoenix.Ray"]=Js,Js.__name__=["phoenix","Ray"],Js.prototype={refresh:function(t){var e=2*(t.x/this.viewport.w-.5),i=2*((this.viewport.h-t.y)/this.viewport.h-.5),s=new un(e,i,0,1),n=new un(e,i,1,1);this.origin=this.camera.unproject(s),this.end=this.camera.unproject(n),this.dir=un.Subtract(this.end,this.origin)},__class__:Js};var $s=function(t,e,i,s){null==s&&(s=0),null==i&&(i=0),null==e&&(e=0),null==t&&(t=0),this.ignore_listeners=!1,this.h=0,this.w=0,this.y=0,this.x=0,this.set_x(t),this.set_y(e),this.set_w(i),this.set_h(s)};n["phoenix.Rectangle"]=$s,$s.__name__=["phoenix","Rectangle"],$s.listen=function(t,e){t.listen_x=e,t.listen_y=e,t.listen_w=e,t.listen_h=e},$s.prototype={toString:function(){return"{ x:"+this.x+", y:"+this.y+", w:"+this.w+", h:"+this.h+" }"},point_inside:function(t){return t.x<this.x?!1:t.y<this.y?!1:t.x>this.x+this.w?!1:t.y>this.y+this.h?!1:!0},overlaps:function(t){return null==t?!1:this.x<t.x+t.w&&this.y<t.y+t.h&&this.x+this.w>t.x&&this.y+this.h>t.y?!0:!1},clone:function(){return new $s(this.x,this.y,this.w,this.h)},equal:function(t){return null==t?!1:this.x==t.x&&this.y==t.y&&this.w==t.w&&this.h==t.h},copy_from:function(t){this.set_x(t.x),this.set_y(t.y),this.set_w(t.w),this.set_h(t.h)},set:function(t,e,i,s){var n=this.x,r=this.y,o=this.w,a=this.h;return null!=t&&(n=t),null!=e&&(r=e),null!=i&&(o=i),null!=s&&(a=s),this.set_x(n),this.set_y(r),this.set_w(o),this.set_h(a),this},set_x:function(t){return this.x=t,null==this.listen_x||this.ignore_listeners||this.listen_x(t),this.x},set_y:function(t){return this.y=t,null==this.listen_y||this.ignore_listeners||this.listen_y(t),this.y},set_w:function(t){return this.w=t,null==this.listen_w||this.ignore_listeners||this.listen_w(t),this.w},set_h:function(t){return this.h=t,null==this.listen_h||this.ignore_listeners||this.listen_h(t),this.h},__class__:$s,__properties__:{set_h:"set_h",set_w:"set_w",set_y:"set_y",set_x:"set_x"}};var tn=function(t){this.renderer=t};n["phoenix.RenderPath"]=tn,tn.__name__=["phoenix","RenderPath"],tn.prototype={render:function(t,e){for(var i=0;i<t.length;){var s=t[i];++i,s.enabled&&(_.debug.start("batch."+s.name),s.draw_calls=0,s.vert_count=0,s.view.process(),s.renderer.state.viewport(s.view.get_viewport().x,s.view.get_viewport().y,s.view.get_viewport().w,s.view.get_viewport().h),s.batch(!1),e.geometry_count+=s.geometry.size(),e.dynamic_batched_count+=s.dynamic_batched_count,e.static_batched_count+=s.static_batched_count,e.visible_count+=s.visible_count,e.draw_calls+=s.draw_calls,e.vert_count+=s.vert_count,_.debug.end("batch."+s.name))}},__class__:tn};var en=function(t){this._last_depth_mask=!0,this._last_line_width=1,this._active_texture=-1,this._used_program=null,this._current_rbo=null,this._current_fbo=null,this.depth_func=-1,this.depth_mask=!0,this.depth_test=!1,this.cull_face=!1,this.renderer=t,this._viewport=new $s(0,0,0,0)};n["phoenix.RenderState"]=en,en.__name__=["phoenix","RenderState"],en.prototype={enable:function(t){switch(t){case 2884:this.cull_face||(this.cull_face=!0,rr.current_context.enable(2884));break;case 2929:_.core.app.config.render.depth&&(this.depth_test||(this.depth_test=!0,rr.current_context.enable(2929)))}},disable:function(t){switch(t){case 2884:this.cull_face&&(this.cull_face=!1,rr.current_context.disable(2884));break;case 2929:_.core.app.config.render.depth&&this.depth_test&&(this.depth_test=!1,rr.current_context.disable(2929))}},depth_function:function(t){this.depth_func!=t&&(rr.current_context.depthFunc(t),this.depth_func=t)},viewport:function(t,e,i,s){if(this._viewport.x!=t||this._viewport.y!=e||this._viewport.w!=i||this._viewport.h!=s){this._viewport.set_x(t),this._viewport.set_y(e),this._viewport.set_w(i),this._viewport.set_h(s);var n=this.renderer.target_size.y-(e+s);rr.current_context.viewport(0|t,0|n,0|i,0|s)}},bindFramebuffer:function(t){this._current_fbo!=t&&(null==t&&(t=this.renderer.default_fbo),rr.current_context.bindFramebuffer(36160,t),this._current_fbo=t)},bindRenderbuffer:function(t){this._current_rbo!=t&&(null==t&&(t=this.renderer.default_rbo),rr.current_context.bindRenderbuffer(36161,t),this._current_rbo=t)},useProgram:function(t){this._used_program!=t&&(this._used_program=t,rr.current_context.useProgram(t))},activeTexture:function(t){this._active_texture!=t&&(rr.current_context.activeTexture(t),this._active_texture=t)},bindTexture:function(t,e){switch(t){case 3553:this.bindTexture2D(e);break;case 34067:this.bindTextureCube(e)}},bindTexture2D:function(t){en.bound_texture_2D!=t&&(en.bound_texture_2D=t,rr.current_context.bindTexture(3553,t))},bindTextureCube:function(t){en.bound_texture_cube!=t&&(en.bound_texture_cube=t,rr.current_context.bindTexture(34067,t))},lineWidth:function(t){this._last_line_width!=t&&(this._last_line_width=t,rr.current_context.lineWidth(t))},depthMask:function(t){this._last_depth_mask!=t&&(this._last_depth_mask=t,rr.current_context.depthMask(t))},__class__:en};var sn=function(t){if(this.load_premultiply_alpha=!1,this.height=-1,this.width=-1,this.height_actual=-1,this.width_actual=-1,this.compressed=!1,this.border=0,this.slot=0,null==t)throw new ne(Re.null_assertion("_options was null ( Texture create requires non-null options )"));if(null==t.resource_type&&(t.resource_type=4),t.resource_type,Mi.call(this,t),null==t.texture&&(t.texture=this.create_texture_id()),t.texture,this.texture=t.texture,this.bind(),this.apply_default_options(t),null!=t.pixels){if(null==t.width)throw new ne(Re.null_assertion("_options.width was null ( Texture create with pixels requires both width and height )"));if(null==t.height)throw new ne(Re.null_assertion("_options.height was null ( Texture create with pixels requires both width and height )"))}if(null!=t.width||null!=t.height){if(null==t.height)throw new ne(Re.null_assertion("_options.height was null ( Texture requires both width and height, only width was given in construct options )"));if(null==t.width)throw new ne(Re.null_assertion("_options.width was null ( Texture requires both width and height, only height was given in construct options )"));this.width=this.width_actual=t.width,this.height=this.height_actual=t.height,null!=t.pixels&&this.submit(t.pixels)}};n["phoenix.Texture"]=sn,sn.__name__=["phoenix","Texture"],sn.max_size=function(){return rr.current_context.getParameter(3379)},sn.dump_asset_info=function(){},sn.type_name=function(t){switch(t){case 3553:return"tex_2D";case 34067:return"tex_cube"}},sn.filter_name=function(t){switch(t){case 9729:return"linear";case 9728:return"nearest";case 9987:return"mip_linear_linear";case 9985:return"mip_linear_nearest";case 9986:return"mip_nearest_linear";case 9984:return"mip_nearest_nearest"}},sn.clamp_name=function(t){switch(t){case 33071:return"edge";case 10497:return"repeat";case 33648:return"mirror"}},sn.__super__=Mi,sn.prototype=e(Mi.prototype,{memory_use:function(){return this.width_actual*this.height_actual*4},fetch:function(t,e,i,s,n){if(null==i&&(i=0),null==e&&(e=0),null==t)throw new ne(Re.null_assertion("_into was null ( Texture fetch requires a valid buffer to store the pixels. )"));null==e&&(e=0),null==i&&(i=0),null==s&&(s=this.width),null==n&&(n=this.height);var r=s*n*4;if(!(t.length>=r))throw new ne(Re.assertion("_into.length >= _required"+(" ( "+("Texture fetch requires at least "+r+" (w * h * 4) bytes for the pixels, you have "+t.length+"!")+" )")));var o=rr.current_context.createFramebuffer();if(rr.current_context.bindFramebuffer(36160,o),rr.current_context.framebufferTexture2D(36160,36064,3553,this.texture,0),36053!=rr.current_context.checkFramebufferStatus(36160))throw new ne(Re.assertion("GL.checkFramebufferStatus(GL.FRAMEBUFFER) == GL.FRAMEBUFFER_COMPLETE"));return rr.current_context.readPixels(e,i,s,n,6408,5121,t),rr.current_context.bindFramebuffer(36160,null),rr.current_context.deleteFramebuffer(o),o=null,t},submit:function(t,e,i){if(null==i&&(i=0),!(i>=0))throw new ne(Re.assertion("_level >= 0 ( Texture submit level cannot be negative )"));var s=sn.max_size();if(!(this.width_actual<=s))throw new ne(Re.assertion("width_actual <= _max"+(" ( "+("Texture actual width bigger than maximum hardware size (width:"+this.width_actual+", max:"+s+")")+" )")));if(!(this.height_actual<=s))throw new ne(Re.assertion("height_actual <= _max"+(" ( "+("Texture actual height bigger than maximum hardware size (height:"+this.height_actual+", max:"+s+")")+" )")));if(this.bind(),3553==this.type)null==e&&(e=3553);else if(null==e)throw new ne(Re.null_assertion("_target was null ( Texture submit to a non 2D texture requires the _target to be specified )"));this.compressed?rr.current_context.compressedTexImage2D(e,i,this.format,this.width_actual,this.height_actual,this.border,t):rr.current_context.texImage2D(e,i,this.format,this.width_actual,this.height_actual,this.border,this.format,this.data_type,t)},generate_mipmaps:function(){this.bind(),rr.current_context.generateMipmap(this.type)},bind:function(){_.renderer.state.activeTexture(33984+this.slot),_.renderer.state.bindTexture(this.type,this.texture)},reload:function(){var t=this;if(6==this.state)throw new ne(Re.assertion("state != ResourceState.destroyed ( Resource cannot reload when already destroyed )"));return this.clear(),new Fn(function(e,i){t.set_state(2);var s=ar.load(_.core.app.assets,t.id);s.then(function(i){t.texture=t.create_texture_id(),t.from_asset(i),t.set_state(3),e(t)}),s.error(function(e){t.set_state(4),i(e)})})},from_asset:function(t,e){null==e&&(e=!0),this.width=t.image.width,this.height=t.image.height,this.width_actual=t.image.width_actual,this.height_actual=t.image.height_actual,this.load_premultiply_alpha&&_.utils.premultiply_alpha(t.image.pixels),this.submit(t.image.pixels),e&&(t.image.pixels=null,t=null),rr.current_context.texParameteri(this.type,10241,this.filter_min),rr.current_context.texParameteri(this.type,10240,this.filter_mag),rr.current_context.texParameteri(this.type,10242,this.clamp_s),rr.current_context.texParameteri(this.type,10243,this.clamp_t)},clear:function(){null!=this.texture&&rr.current_context.deleteTexture(this.texture)},create_texture_id:function(){return rr.current_context.createTexture()},apply_props:function(){rr.current_context.texParameteri(this.type,10241,this.filter_min),rr.current_context.texParameteri(this.type,10240,this.filter_mag),rr.current_context.texParameteri(this.type,10242,this.clamp_s),rr.current_context.texParameteri(this.type,10243,this.clamp_t)},apply_default_options:function(t){null==t.load_premultiply_alpha&&(t.load_premultiply_alpha=!1),this.load_premultiply_alpha=t.load_premultiply_alpha,null==t.compressed&&(t.compressed=!1),this.compressed=t.compressed,null==t.format&&(t.format=6408),this.format=t.format,null==t.type&&(t.type=3553),this.type=t.type,null==t.data_type&&(t.data_type=5121),this.data_type=t.data_type,this.set_filter_min(function(){var e;return null==t.filter_min&&(t.filter_min=sn.default_filter),e=t.filter_min}(this)),this.set_filter_mag(function(){var e;return null==t.filter_mag&&(t.filter_mag=sn.default_filter),e=t.filter_mag}(this)),this.set_clamp_s(function(){var e;return null==t.clamp_s&&(t.clamp_s=sn.default_clamp),e=t.clamp_s}(this)),this.set_clamp_t(function(){var e;return null==t.clamp_t&&(t.clamp_t=sn.default_clamp),e=t.clamp_t}(this))},set_clamp_s:function(t){return this.bind(),rr.current_context.texParameteri(this.type,10242,t),this.clamp_s=t},set_clamp_t:function(t){return this.bind(),rr.current_context.texParameteri(this.type,10243,t),this.clamp_t=t},set_filter_min:function(t){return this.bind(),rr.current_context.texParameteri(this.type,10241,t),this.filter_min=t},set_filter_mag:function(t){return this.bind(),rr.current_context.texParameteri(this.type,10240,t),this.filter_mag=t},apply_clamp:function(t,e){rr.current_context.texParameteri(this.type,e,t)},apply_filter:function(t,e){rr.current_context.texParameteri(this.type,e,t)},toString:function(){var t=sn.type_name(this.type),e=sn.filter_name(this.filter_min),i=sn.filter_name(this.filter_mag),s=(sn.clamp_name(this.clamp_s),sn.clamp_name(this.clamp_t)),n="filter(min: "+e+", mag:"+i+")",r="clamp(s: "+s+", t: "+s+")",o="size(size: "+this.width+"x"+this.height+", actual: "+this.width_actual+"x"+this.height_actual+")";return"Texture(id: "+this.id+", tex: "+v.string(this.texture)+", type:"+t+", "+o+" "+n+" "+r+" )"},__class__:sn,__properties__:e(Mi.prototype.__properties__,{set_clamp_t:"set_clamp_t",set_clamp_s:"set_clamp_s",set_filter_mag:"set_filter_mag",set_filter_min:"set_filter_min"})});var nn=function(t){t.resource_type=5,sn.call(this,t),null==t.width&&(t.width=v["int"](_.core.screen.get_w())),t.width,null==t.height&&(t.height=v["int"](_.core.screen.get_h())),t.height,this.width=this.width_actual=t.width,this.height=this.height_actual=t.height,null!=t.texture&&this.submit(null),rr.current_context.texParameteri(this.type,10241,this.filter_min),rr.current_context.texParameteri(this.type,10240,this.filter_mag),rr.current_context.texParameteri(this.type,10242,this.clamp_s),rr.current_context.texParameteri(this.type,10243,this.clamp_t),this.fbo=rr.current_context.createFramebuffer(),this.bindBuffer(),this.renderbuffer=rr.current_context.createRenderbuffer(),this.bindRenderBuffer(),rr.current_context.renderbufferStorage(36161,33189,this.width,this.height),rr.current_context.framebufferTexture2D(36160,36064,3553,this.texture,0),rr.current_context.framebufferRenderbuffer(36160,36096,36161,this.renderbuffer);var e=rr.current_context.checkFramebufferStatus(36160);switch(e){case 36053:break;case 36054:throw new ne("Incomplete framebuffer: FRAMEBUFFER_INCOMPLETE_ATTACHMENT");case 36055:throw new ne("Incomplete framebuffer: FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT");case 36057:throw new ne("Incomplete framebuffer: FRAMEBUFFER_INCOMPLETE_DIMENSIONS");case 36061:throw new ne("Incomplete framebuffer: FRAMEBUFFER_UNSUPPORTED");default:throw new ne("Incomplete framebuffer: "+e)}this.unbindBuffer(),this.unbindRenderBuffer(),this.system.add(this)};n["phoenix.RenderTexture"]=nn,nn.__name__=["phoenix","RenderTexture"],nn.__super__=sn,nn.prototype=e(sn.prototype,{clear:function(){sn.prototype.clear.call(this),null!=this.fbo&&rr.current_context.deleteFramebuffer(this.fbo),null!=this.renderbuffer&&rr.current_context.deleteRenderbuffer(this.renderbuffer)},bindBuffer:function(){_.renderer.state.bindFramebuffer(this.fbo)},unbindBuffer:function(t){_.renderer.state.bindFramebuffer(t)},bindRenderBuffer:function(){_.renderer.state.bindRenderbuffer(this.renderbuffer)},unbindRenderBuffer:function(t){_.renderer.state.bindRenderbuffer(t)},__class__:nn});var rn=function(t,e){this.stop_count=0,this.stop=!1,this.should_clear=!0,this.core=t,this.font_asset=e,this.default_fbo=rr.current_context.getParameter(36006),this.default_rbo=rr.current_context.getParameter(36007)};n["phoenix.Renderer"]=rn,rn.__name__=["phoenix","Renderer"],rn.prototype={init:function(){this.state=new en(this),this.clear_color=(new ai).rgb(1710618),this.stats=new on,this.batchers=[],this.target_size=new un(_.core.screen.get_w(),_.core.screen.get_h()),this.camera=new qs,this.default_render_path=new tn(this),this.render_path=this.default_render_path,this.create_default_shaders(),this.batcher=new Us(this,"default batcher"),this.batcher.set_layer(1),this.add_batch(this.batcher),_.core.app.config.render.depth&&(this.state.enable(2929),this.state.depth_function(515),rr.current_context.clearDepth(1)),rr.current_context.enable(3042),rr.current_context.blendFunc(770,771),rr.current_context.pixelStorei(37441,0)},destroy:function(){this.clear((new ai).rgb(16729099))},sort_batchers:function(t,e){return t.layer<e.layer?-1:t.layer>e.layer?1:t.sequence<e.sequence?-1:t.sequence>e.sequence?1:1},add_batch:function(t){this.batchers.push(t),this.batchers.sort(s(this,this.sort_batchers))},remove_batch:function(t){a.remove(this.batchers,t)},create_batcher:function(t){var e=2;null!=t?(null==t.name&&(t.name="batcher"),t.name,null==t.layer&&(t.layer=e),t.layer,null==t.camera&&(t.camera=new qs),t.camera):t={name:"batcher",camera:new qs,layer:e};var i=new Us(this,t.name);return i.view=t.camera,i.layer=t.layer,i.renderer.batchers.sort((vr=i.renderer,s(vr,vr.sort_batchers))),i.layer,(null==t.no_add||0==t.no_add)&&this.add_batch(i),i},clear:function(t){null==t&&(t=this.clear_color),rr.current_context.clearColor(t.r,t.g,t.b,t.a),_.core.app.config.render.depth?(rr.current_context.clear(16640),rr.current_context.clearDepth(1)):rr.current_context.clear(16384)},blend_mode:function(t,e){null==e&&(e=771),null==t&&(t=770),rr.current_context.blendFunc(t,e)},blend_equation:function(t){null==t&&(t=32774),rr.current_context.blendEquation(t)},internal_resized:function(t,e){null==this.get_target()&&this.target_size.set_xy(t,e)},process:function(){this.stop||(this.should_clear&&this.clear(this.clear_color),this.stats.batchers=this.batchers.length,this.stats.reset(),this.render_path.render(this.batchers,this.stats))},onresize:function(){},set_vsync:function(t){return _.core.app.windowing.enable_vsync(t),this.vsync=t},get_vsync:function(){return this.vsync},get_target:function(){return this.target},set_target:function(t){return null!=t?(this.target_size.set_x(t.width),this.target_size.set_y(t.height),this.state.bindFramebuffer(t.fbo)):(this.target_size.set_x(_.core.screen.get_w()),this.target_size.set_y(_.core.screen.get_h()),this.state.bindFramebuffer()),this.target=t},create_default_shaders:function(){{var t=I.getString("default.vert.glsl"),e=I.getString("default.frag.glsl"),i=I.getString("default.frag.textured.glsl"),s=I.getString("default.frag.bitmapfont.glsl");rr.current_context.getExtension("OES_standard_derivatives")}e="precision mediump float;\n"+e,i="precision mediump float;\n"+i,s="#extension GL_OES_standard_derivatives : enable\n#extension OES_standard_derivatives : enable\nprecision mediump float;\n"+s;var n=new an({id:"luxe.shader",frag_id:"default",vert_id:"default"}),r=new an({id:"luxe.shader_textured",frag_id:"textured",vert_id:"default"}),o=new an({id:"luxe.shader_bitmapfont",frag_id:"bitmapfont",vert_id:"default"}),a=!0;if(a=a&&n.from_string(t,e),a=a&&r.from_string(t,i),a=a&&o.from_string(t,s),!a)throw new ne(Re.assertion("_ok ( Default shaders failed to compile or link. See log for errors )"));this.shaders={plain:{shader:n,source:{vert:t,frag:e}},textured:{shader:r,source:{vert:t,frag:i}},bitmapfont:{shader:o,source:{vert:t,frag:s}}}},create_default_font:function(){if(null==this.font_asset)throw new ne(Re.null_assertion("font_asset was null ( Renderer / failed to create the default font )"));var t=new sn({id:"luxe.font.png",width:this.font_asset.image.width_actual,height:this.font_asset.image.height_actual,pixels:this.font_asset.image.pixels});if(null==t)throw new ne(Re.null_assertion("_font_texture was null ( Renderer / failed to create the default font... font_texture was null. )"));var e=I.getString("default.fnt");this.font=new js({id:"luxe.font",font_data:e,pages:[t]})},__class__:rn,__properties__:{set_target:"set_target",get_target:"get_target",set_vsync:"set_vsync",get_vsync:"get_vsync"}};var on=function(){this.vert_count=0,this.group_count=0,this.draw_calls=0,this.visible_count=0,this.static_batched_count=0,this.dynamic_batched_count=0,this.geometry_count=0,this.batchers=0};n["phoenix.RendererStats"]=on,on.__name__=["phoenix","RendererStats"],on.prototype={reset:function(){this.geometry_count=0,this.dynamic_batched_count=0,this.static_batched_count=0,this.visible_count=0,this.group_count=0,this.draw_calls=0,this.vert_count=0},toString:function(){return"Renderer Statistics\n	batcher count : "+this.batchers+"\n	total geometry : "+this.geometry_count+"\n	visible geometry : "+this.visible_count+"\n	dynamic batched geometry : "+this.dynamic_batched_count+"\n	static batched geometry : "+this.static_batched_count+"\n	total draw calls : "+this.draw_calls+"\n	total vertices : "+this.vert_count},__class__:on};var an=function(t){if(this.frag_id="",this.vert_id="",this.log="",null==t)throw new ne(Re.null_assertion("_options was null"));t.resource_type=7,Mi.call(this,t),this.frag_id=t.frag_id,this.vert_id=t.vert_id,this.uniform_int=new V,this.uniform_float=new V,this.uniform_vector2=new V,this.uniform_vector3=new V,this.uniform_vector4=new V,this.uniform_matrix4=new V,this.uniform_color=new V,this.uniform_texture=new V};n["phoenix.Shader"]=an,an.__name__=["phoenix","Shader"],an.__super__=Mi,an.prototype=e(Mi.prototype,{activate:function(){null!=this.program&&_.renderer.state.useProgram(this.program)},deactivate:function(){_.renderer.state.useProgram(null)},clone:function(t){var e=new an({id:t,frag_id:this.frag_id,vert_id:this.vert_id});return e.from_string(this.vert_source,this.frag_source),e},set_int:function(t,e){if(this.uniform_int.exists(t))this.uniform_int.get(t).value=e;else{var i=new hn(t,e,rr.current_context.getUniformLocation(this.program,t));this.uniform_int.set(t,i)}},set_float:function(t,e){if(this.uniform_float.exists(t))this.uniform_float.get(t).value=e;else{var i=new hn(t,e,rr.current_context.getUniformLocation(this.program,t));this.uniform_float.set(t,i)}},set_vector2:function(t,e){if(this.uniform_vector2.exists(t))this.uniform_vector2.get(t).value=e;else{var i=new hn(t,e,rr.current_context.getUniformLocation(this.program,t));this.uniform_vector2.set(t,i)}},set_vector3:function(t,e){if(this.uniform_vector3.exists(t))this.uniform_vector3.get(t).value=e;else{var i=new hn(t,e,rr.current_context.getUniformLocation(this.program,t));this.uniform_vector3.set(t,i)}},set_vector4:function(t,e){if(this.uniform_vector4.exists(t))this.uniform_vector4.get(t).value=e;else{var i=new hn(t,e,rr.current_context.getUniformLocation(this.program,t));this.uniform_vector4.set(t,i)}},set_matrix4:function(t,e){if(this.uniform_matrix4.exists(t))this.uniform_matrix4.get(t).value=e;else{var i=new hn(t,e,rr.current_context.getUniformLocation(this.program,t));this.uniform_matrix4.set(t,i)}},set_color:function(t,e){if(this.uniform_color.exists(t))this.uniform_color.get(t).value=e;else{var i=new hn(t,e,rr.current_context.getUniformLocation(this.program,t));this.uniform_color.set(t,i)}},set_texture:function(t,e){if(this.uniform_texture.exists(t))this.uniform_texture.get(t).value=e;else{var i=new hn(t,e,rr.current_context.getUniformLocation(this.program,t));this.uniform_texture.set(t,i)}},format_log:function(t){var e=t.split("\n");return e=e.filter(function(t){return""!=w.trim(t)}),e=e.map(function(t){return"		"+w.trim(t)}),e.join("\n")},compile:function(t,e){var i=rr.current_context.createShader(t);rr.current_context.shaderSource(i,e),rr.current_context.compileShader(i);var s=rr.current_context.getShaderInfoLog(i),n="";if(s.length>0){var r,o=35632==t;r=o?"frag":"vert";var a;a=o?this.frag_id:this.vert_id,n+="\n	// start -- ("+r+" / "+a+") compile log --\n",n+=this.format_log(s),n+="\n	// end --\n"}return 0==rr.current_context.getShaderParameter(i,35713)?(this.log+="	Failed to compile shader `"+this.id+"`:\n",this.add_log(0==n.length?this.format_log(rr.current_context.getShaderInfoLog(i)):n),rr.current_context.deleteShader(i),i=null,null):i},link:function(){return this.program=rr.current_context.createProgram(),rr.current_context.attachShader(this.program,this.vert_shader),rr.current_context.attachShader(this.program,this.frag_shader),rr.current_context.bindAttribLocation(this.program,0,"vertexPosition"),rr.current_context.bindAttribLocation(this.program,1,"vertexTCoord"),rr.current_context.bindAttribLocation(this.program,2,"vertexColor"),rr.current_context.bindAttribLocation(this.program,3,"vertexNormal"),rr.current_context.linkProgram(this.program),0==rr.current_context.getProgramParameter(this.program,35714)?(this.log+="	Failed to link shader program:",this.add_log(this.format_log(rr.current_context.getProgramInfoLog(this.program))),rr.current_context.deleteProgram(this.program),this.program=null,!1):(null!=this.program&&_.renderer.state.useProgram(this.program),this.proj_attribute=rr.current_context.getUniformLocation(this.program,"projectionMatrix"),this.view_attribute=rr.current_context.getUniformLocation(this.program,"modelViewMatrix"),this.tex0_attribute=rr.current_context.getUniformLocation(this.program,"tex0"),this.tex1_attribute=rr.current_context.getUniformLocation(this.program,"tex1"),this.tex2_attribute=rr.current_context.getUniformLocation(this.program,"tex2"),this.tex3_attribute=rr.current_context.getUniformLocation(this.program,"tex3"),this.tex4_attribute=rr.current_context.getUniformLocation(this.program,"tex4"),this.tex5_attribute=rr.current_context.getUniformLocation(this.program,"tex5"),this.tex6_attribute=rr.current_context.getUniformLocation(this.program,"tex6"),this.tex7_attribute=rr.current_context.getUniformLocation(this.program,"tex7"),!0)},clear:function(){null!=this.vert_shader&&rr.current_context.deleteShader(this.vert_shader),null!=this.frag_shader&&rr.current_context.deleteShader(this.frag_shader),null!=this.program&&rr.current_context.deleteProgram(this.program),this.vert_source=null,this.frag_source=null},reload:function(){var t=this;if(6==this.state)throw new ne(Re.assertion("state != ResourceState.destroyed"));return this.clear(),new Fn(function(e,i){t.set_state(2);var s=t.frag_id;switch(s){case"default":t.frag_source=_.renderer.shaders.plain.source.frag;break;case"textured":t.frag_source=_.renderer.shaders.textured.source.frag}var n=t.vert_id;switch(n){case"default":t.vert_source=_.renderer.shaders.plain.source.vert}var r=function(e){t.set_state(4),i(e)},o=[Fn.resolve()];if(null==t.frag_source){var a=lr.load(_.core.app.assets,t.frag_id);a.then(function(e){t.frag_source=e.text}),o.push(a)}if(null==t.vert_source){var h=lr.load(_.core.app.assets,t.vert_id);h.then(function(e){t.vert_source=e.text}),o.push(h)}Fn.all(o).then(function(){t.from_string(t.vert_source,t.frag_source)?(t.set_state(3),e(t)):r(gr.error("`"+t.id+"` failed to create :\n\n"+t.log))}).error(function(e){r(gr.error("`"+t.id+"` failed to create :\n		"+e+"\n"))})})},from_string:function(t,e){var i=this;return this.clear(),this.frag_source=e,this.vert_source=t,this.vert_shader=this.compile(35633,this.vert_source),this.frag_shader=this.compile(35632,this.frag_source),null==this.vert_shader||null==this.frag_shader?(i.log.length>0&&S.trace("   i / shader / "+i.log,{fileName:"Shader.hx",lineNumber:368,className:"phoenix.Shader",methodName:"from_string"}),!1):this.link()?!0:(i.log.length>0&&S.trace("   i / shader / "+i.log,{fileName:"Shader.hx",lineNumber:368,className:"phoenix.Shader",methodName:"from_string"}),!1)},apply_uniforms:function(){null!=this.tex0_attribute&&rr.current_context.uniform1i(this.tex0_attribute,0),null!=this.tex1_attribute&&rr.current_context.uniform1i(this.tex1_attribute,1),null!=this.tex2_attribute&&rr.current_context.uniform1i(this.tex2_attribute,2),null!=this.tex3_attribute&&rr.current_context.uniform1i(this.tex3_attribute,3),null!=this.tex4_attribute&&rr.current_context.uniform1i(this.tex4_attribute,4),null!=this.tex5_attribute&&rr.current_context.uniform1i(this.tex5_attribute,5),null!=this.tex6_attribute&&rr.current_context.uniform1i(this.tex6_attribute,6),null!=this.tex7_attribute&&rr.current_context.uniform1i(this.tex7_attribute,7);for(var t=this.uniform_int.iterator();t.hasNext();){var e=t.next();rr.current_context.uniform1i(e.location,e.value)}for(var i=this.uniform_float.iterator();i.hasNext();){var s=i.next();rr.current_context.uniform1f(s.location,s.value)}for(var n=this.uniform_vector2.iterator();n.hasNext();){var r=n.next();rr.current_context.uniform2f(r.location,r.value.x,r.value.y)}for(var o=this.uniform_vector3.iterator();o.hasNext();){var a=o.next();rr.current_context.uniform3f(a.location,a.value.x,a.value.y,a.value.z)}for(var h=this.uniform_vector4.iterator();h.hasNext();){var l=h.next();rr.current_context.uniform4f(l.location,l.value.x,l.value.y,l.value.z,l.value.w)}for(var _=this.uniform_matrix4.iterator();_.hasNext();){var u=_.next();rr.uniformMatrix4fv(u.location,!1,u.value.float32array())}for(var c=this.uniform_color.iterator();c.hasNext();){var d=c.next();rr.current_context.uniform4f(d.location,d.value.r,d.value.g,d.value.b,d.value.a)}for(var f=this.uniform_texture.iterator();f.hasNext();){var p=f.next();rr.current_context.uniform1i(p.location,p.value.slot),p.value.bind()}},location:function(t){return rr.current_context.getUniformLocation(this.program,t)},add_log:function(t){this.log+=t},toString:function(){return"Shader("+this.id+") vert:"+this.vert_id+" / frag: "+this.frag_id},__class__:an});var hn=function(t,e,i){this.name=t,this.value=e,this.location=i};n["phoenix.Uniform"]=hn,hn.__name__=["phoenix","Uniform"],hn.prototype={__class__:hn};var ln=function(){this._destroying=!1,this._cleaning=!1,this._setup=!0,this.dirty=!0,pe.call(this,"transform"),this.set_local(new _n),this.set_world(new _n),this._origin_undo_matrix=new Qs,this._pos_matrix=new Qs,this._rotation_matrix=new Qs,this.set_origin(new un),this.local.pos_changed=s(this,this.on_local_pos_change),this.local.rotation_changed=s(this,this.on_local_rotation_change),this.local.scale_changed=s(this,this.on_local_scale_change),this._setup=!1};n["phoenix.Transform"]=ln,ln.__name__=["phoenix","Transform"],ln.__super__=pe,ln.prototype=e(pe.prototype,{destroy:function(){this._destroying=!0,null!=this.parent&&this.parent.unlisten(s(this,this.on_parent_cleaned)),this._clean_handlers=null,this._dirty_handlers=null,this._pos_handlers=null,this._rotation_handlers=null,this._scale_handlers=null,this._origin_handlers=null,this._parent_handlers=null,this.local.destroy(),function(t){var e;return t._destroying||(null!=t.parent&&t.parent.dirty&&t.parent.clean(),t.dirty&&!t._cleaning&&t.clean()),e=t.world}(this).destroy(),this.local=null,this.world=null,this.dirty=!0,this.dirty&&!this._setup&&null!=this._dirty_handlers&&this._dirty_handlers.length>0&&this.propagate_dirty(),this.dirty,this.origin=null,null!=this._origin_handlers&&this._origin_handlers.length>0&&this.propagate_origin(this.origin),this.origin,this._origin_undo_matrix=null,this._pos_matrix=null,this._rotation_matrix=null},set_dirty:function(t){return this.dirty=t,this.dirty&&!this._setup&&null!=this._dirty_handlers&&this._dirty_handlers.length>0&&this.propagate_dirty(),this.dirty},on_local_pos_change:function(t){this.dirty=!0,this.dirty&&!this._setup&&null!=this._dirty_handlers&&this._dirty_handlers.length>0&&this.propagate_dirty(),this.dirty,null!=this._pos_handlers&&this._pos_handlers.length>0&&this.propagate_pos(t)},on_local_rotation_change:function(t){this.dirty=!0,this.dirty&&!this._setup&&null!=this._dirty_handlers&&this._dirty_handlers.length>0&&this.propagate_dirty(),this.dirty,null!=this._rotation_handlers&&this._rotation_handlers.length>0&&this.propagate_rotation(t)},on_local_scale_change:function(t){this.dirty=!0,this.dirty&&!this._setup&&null!=this._dirty_handlers&&this._dirty_handlers.length>0&&this.propagate_dirty(),this.dirty,null!=this._scale_handlers&&this._scale_handlers.length>0&&this.propagate_scale(t)
},on_parent_cleaned:function(){this.dirty=!0,this.dirty&&!this._setup&&null!=this._dirty_handlers&&this._dirty_handlers.length>0&&this.propagate_dirty(),this.dirty},get_local:function(){return this.local},set_local:function(t){return null!=t&&(this.dirty=!0,this.dirty&&!this._setup&&null!=this._dirty_handlers&&this._dirty_handlers.length>0&&this.propagate_dirty(),this.dirty,t.pos_changed=s(this,this.on_local_pos_change),t.rotation_changed=s(this,this.on_local_rotation_change),t.scale_changed=s(this,this.on_local_scale_change)),this.local=t},get_world:function(){return this._destroying||(null!=this.parent&&this.parent.dirty&&this.parent.clean(),this.dirty&&!this._cleaning&&this.clean()),this.world},clean_check:function(){null!=this.parent&&this.parent.dirty&&this.parent.clean(),this.dirty&&!this._cleaning&&this.clean()},clean:function(){this.dirty&&(this._cleaning=!0,this._pos_matrix.makeTranslation(this.local.pos.x,this.local.pos.y,this.local.pos.z),this._rotation_matrix.makeRotationFromQuaternion(this.local.rotation),this._origin_undo_matrix.makeTranslation(-this.origin.x,-this.origin.y,-this.origin.z),this.local.matrix.makeTranslation(this.origin.x,this.origin.y,this.origin.z),this.local.matrix.multiply(this._rotation_matrix),this.local.matrix.scale(this.local.scale),this.local.matrix.setPosition(this.local.pos),this.local.matrix.multiply(this._origin_undo_matrix),this.get_world().set_matrix(null!=this.parent?this.get_world().get_matrix().multiplyMatrices(this.parent.get_world().get_matrix(),this.local.matrix):this.local.matrix.clone()),this.get_world().decompose(!1),this.dirty=!1,this.dirty&&!this._setup&&null!=this._dirty_handlers&&this._dirty_handlers.length>0&&this.propagate_dirty(),this.dirty,this._cleaning=!1,null!=this._clean_handlers&&this._clean_handlers.length>0&&this.propagate_clean())},toString:function(){return"Transform ("+this.id+")"},get_origin:function(){return this.origin},set_origin:function(t){return this.dirty=!0,this.dirty&&!this._setup&&null!=this._dirty_handlers&&this._dirty_handlers.length>0&&this.propagate_dirty(),this.dirty,this.origin=t,null!=this._origin_handlers&&this._origin_handlers.length>0&&this.propagate_origin(this.origin),this.origin},set_world:function(t){return null==t?this.world=t:(this.dirty=!0,this.dirty&&!this._setup&&null!=this._dirty_handlers&&this._dirty_handlers.length>0&&this.propagate_dirty(),this.dirty,this.world=t)},get_parent:function(){return this.parent},set_parent:function(t){return this.dirty=!0,this.dirty&&!this._setup&&null!=this._dirty_handlers&&this._dirty_handlers.length>0&&this.propagate_dirty(),this.dirty,null!=this.parent&&this.parent.unlisten(s(this,this.on_parent_cleaned)),this.parent=t,null!=this._parent_handlers&&this._parent_handlers.length>0&&this.propagate_parent(this.parent),null!=this.parent&&this.parent.listen(s(this,this.on_parent_cleaned)),this.parent},get_pos:function(){return this.local.pos},get_rotation:function(){return this.local.rotation},get_scale:function(){return this.local.scale},set_pos:function(t){return this.local.set_pos(t)},set_rotation:function(t){return this.local.set_rotation(t)},set_scale:function(t){return this.local.set_scale(t)},propagate_clean:function(){for(var t=0,e=this._clean_handlers;t<e.length;){var i=e[t];++t,null!=i&&i(this)}},propagate_dirty:function(){for(var t=0,e=this._dirty_handlers;t<e.length;){var i=e[t];++t,null!=i&&i(this)}},propagate_pos:function(t){for(var e=0,i=this._pos_handlers;e<i.length;){var s=i[e];++e,null!=s&&s(t)}},propagate_rotation:function(t){for(var e=0,i=this._rotation_handlers;e<i.length;){var s=i[e];++e,null!=s&&s(t)}},propagate_scale:function(t){for(var e=0,i=this._scale_handlers;e<i.length;){var s=i[e];++e,null!=s&&s(t)}},propagate_origin:function(t){for(var e=0,i=this._origin_handlers;e<i.length;){var s=i[e];++e,null!=s&&s(t)}},propagate_parent:function(t){for(var e=0,i=this._parent_handlers;e<i.length;){var s=i[e];++e,null!=s&&s(t)}},listen:function(t){null==this._clean_handlers&&(this._clean_handlers=[]),this._clean_handlers.push(t)},unlisten:function(t){return null==this._clean_handlers?!1:a.remove(this._clean_handlers,t)},listen_dirty:function(t){null==this._dirty_handlers&&(this._dirty_handlers=[]),this._dirty_handlers.push(t)},unlisten_dirty:function(t){return null==this._dirty_handlers?!1:a.remove(this._dirty_handlers,t)},listen_pos:function(t){null==this._pos_handlers&&(this._pos_handlers=[]),this._pos_handlers.push(t)},unlisten_pos:function(t){return null==this._pos_handlers?!1:a.remove(this._pos_handlers,t)},listen_scale:function(t){null==this._scale_handlers&&(this._scale_handlers=[]),this._scale_handlers.push(t)},unlisten_scale:function(t){return null==this._scale_handlers?!1:a.remove(this._scale_handlers,t)},listen_rotation:function(t){null==this._rotation_handlers&&(this._rotation_handlers=[]),this._rotation_handlers.push(t)},unlisten_rotation:function(t){return null==this._rotation_handlers?!1:a.remove(this._rotation_handlers,t)},listen_origin:function(t){null==this._origin_handlers&&(this._origin_handlers=[]),this._origin_handlers.push(t)},unlisten_origin:function(t){return null==this._origin_handlers?!1:a.remove(this._origin_handlers,t)},listen_parent:function(t){null==this._parent_handlers&&(this._parent_handlers=[]),this._parent_handlers.push(t)},unlisten_parent:function(t){return null==this._parent_handlers?!1:a.remove(this._parent_handlers,t)},__class__:ln,__properties__:{set_scale:"set_scale",get_scale:"get_scale",set_rotation:"set_rotation",get_rotation:"get_rotation",set_pos:"set_pos",get_pos:"get_pos",set_dirty:"set_dirty",set_origin:"set_origin",get_origin:"get_origin",set_world:"set_world",get_world:"get_world",set_local:"set_local",get_local:"get_local",set_parent:"set_parent",get_parent:"get_parent"}});var _n=function(){this._setup=!0,this.auto_decompose=!1,this.ignore_listeners=!1,this.set_matrix(new Qs),this.floats=this.matrix.float32array(),this.set_pos(new un),this.set_rotation(new Ys),this.set_scale(new un(1,1,1)),this._setup=!1};n["phoenix.Spatial"]=_n,_n.__name__=["phoenix","Spatial"],_n.prototype={destroy:function(){this.matrix=null,this.matrix,this.floats=null,this.pos=null,this.pos,this.rotation=null,this.rotation,this.scale=null,this.scale},decompose:function(t){if(null==t&&(t=!0),this.auto_decompose||t){var e=this.matrix.decompose(null,null,null);this.set_pos(e.pos),this.set_rotation(e.rotation),this.set_scale(e.scale)}return this},get_matrix:function(){return this.matrix},set_matrix:function(t){return this.matrix=t,null!=t&&(this.floats=this.matrix.float32array()),this.matrix},propagate_pos:function(t){null==this.pos_changed||this.ignore_listeners||this.pos_changed(t)},propagate_rotation:function(t){null==this.rotation_changed||this.ignore_listeners||this.rotation_changed(t)},propagate_scale:function(t){null==this.scale_changed||this.ignore_listeners||this.scale_changed(t)},set_pos:function(t){return this.pos=t,null!=t&&(un.Listen(this.pos,s(this,this._pos_change)),null==this.pos_changed||this.ignore_listeners||this.pos_changed(this.pos)),this.pos},set_rotation:function(t){return this.rotation=t,null!=t&&(Ys.Listen(this.rotation,s(this,this._rotation_change)),null==this.rotation_changed||this.ignore_listeners||this.rotation_changed(this.rotation)),this.rotation},set_scale:function(t){return this.scale=t,null!=t&&(un.Listen(this.scale,s(this,this._scale_change)),null==this.scale_changed||this.ignore_listeners||this.scale_changed(this.scale)),this.scale},_pos_change:function(){this.set_pos(this.pos)},_scale_change:function(){this.set_scale(this.scale)},_rotation_change:function(){this.set_rotation(this.rotation)},__class__:_n,__properties__:{set_matrix:"set_matrix",get_matrix:"get_matrix",set_scale:"set_scale",set_rotation:"set_rotation",set_pos:"set_pos"}};var un=function(t,e,i,s){null==s&&(s=0),null==i&&(i=0),null==e&&(e=0),null==t&&(t=0),this._construct=!1,this.ignore_listeners=!1,this.w=0,this.z=0,this.y=0,this.x=0,this._construct=!0,this.x=t,this._construct?this.x:(null==this.listen_x||this.ignore_listeners||this.listen_x(t),this.x),this.y=e,this._construct?this.y:(null==this.listen_y||this.ignore_listeners||this.listen_y(e),this.y),this.z=i,this._construct?this.z:(null==this.listen_z||this.ignore_listeners||this.listen_z(i),this.z),this.w=s,this._construct=!1};n["phoenix.Vector"]=un,un.__name__=["phoenix","Vector"],un.Add=function(t,e){return new un(t.x+e.x,t.y+e.y,t.z+e.z)},un.Subtract=function(t,e){return new un(t.x-e.x,t.y-e.y,t.z-e.z)},un.MultiplyVector=function(t,e){return new un(t.x*e.x,t.y*e.y,t.z*e.z)},un.DivideVector=function(t,e){return new un(t.x/e.x,t.y/e.y,t.z/e.z)},un.Multiply=function(t,e){return new un(t.x*e,t.y*e,t.z*e)},un.Divide=function(t,e){return new un(t.x/e,t.y/e,t.z/e)},un.AddScalar=function(t,e){return new un(t.x+e,t.y+e,t.z+e)},un.SubtractScalar=function(t,e){return new un(t.x-e,t.y-e,t.z-e)},un.Cross=function(t,e){return new un(t.y*e.z-t.z*e.y,t.z*e.x-t.x*e.z,t.x*e.y-t.y*e.x)},un.RotationTo=function(t,e){return t.rotationTo(e)},un.Listen=function(t,e){t.listen_x=e,t.listen_y=e,t.listen_z=e},un.Degrees=function(t){return new un(t.x,t.y,t.z,t.w).degrees()},un.Radians=function(t){return new un(t.x,t.y,t.z,t.w).radians()},un.prototype={copy_from:function(t){return this.set(t.x,t.y,t.z,t.w),this},set:function(t,e,i,s){var n=this.ignore_listeners;return this.ignore_listeners=!0,this.x=t,this._construct?this.x:(null==this.listen_x||this.ignore_listeners||this.listen_x(t),this.x),this.y=e,this._construct?this.y:(null==this.listen_y||this.ignore_listeners||this.listen_y(e),this.y),this.z=i,this._construct?this.z:(null==this.listen_z||this.ignore_listeners||this.listen_z(i),this.z),this.w=s,this.ignore_listeners=n,null==this.listen_x||this.ignore_listeners||this.listen_x(this.x),null==this.listen_y||this.ignore_listeners||this.listen_y(this.y),null==this.listen_z||this.ignore_listeners||this.listen_z(this.z),this},set_xy:function(t,e){var i=this.ignore_listeners;return this.ignore_listeners=!0,this.x=t,this._construct?this.x:(null==this.listen_x||this.ignore_listeners||this.listen_x(t),this.x),this.y=e,this._construct?this.y:(null==this.listen_y||this.ignore_listeners||this.listen_y(e),this.y),this.ignore_listeners=i,null==this.listen_x||this.ignore_listeners||this.listen_x(this.x),null==this.listen_y||this.ignore_listeners||this.listen_y(this.y),this},set_xyz:function(t,e,i){var s=this.ignore_listeners;return this.ignore_listeners=!0,this.x=t,this._construct?this.x:(null==this.listen_x||this.ignore_listeners||this.listen_x(t),this.x),this.y=e,this._construct?this.y:(null==this.listen_y||this.ignore_listeners||this.listen_y(e),this.y),this.z=i,this._construct?this.z:(null==this.listen_z||this.ignore_listeners||this.listen_z(i),this.z),this.ignore_listeners=s,null==this.listen_x||this.ignore_listeners||this.listen_x(this.x),null==this.listen_y||this.ignore_listeners||this.listen_y(this.y),null==this.listen_z||this.ignore_listeners||this.listen_z(this.z),this},lerp_xy:function(t,e,i){return this.set_xy(Es.lerp(this.x,t,i),Es.lerp(this.y,e,i)),this},lerp_xyz:function(t,e,i,s){return this.set_xyz(Es.lerp(this.x,t,s),Es.lerp(this.y,e,s),Es.lerp(this.z,i,s)),this},lerp:function(t,e){return this.set_xyz(Es.lerp(this.x,t.x,e),Es.lerp(this.y,t.y,e),Es.lerp(this.z,t.z,e)),this},weighted_average_xy:function(t,e,i){return this.set_xy(Es.weighted_avg(this.x,t,i),Es.weighted_avg(this.y,e,i)),this},weighted_average_xyz:function(t,e,i,s){return this.set_xyz(Es.weighted_avg(this.x,t,s),Es.weighted_avg(this.y,e,s),Es.weighted_avg(this.z,i,s)),this},"int":function(){return this.set_xyz(Math.round(this.x),Math.round(this.y),Math.round(this.z)),this},int_x:function(){return this.set_x(Math.round(this.x)),this},int_y:function(){return this.set_y(Math.round(this.y)),this},int_z:function(){return this.set_z(Math.round(this.z)),this},toString:function(){return"{ x:"+this.x+", y:"+this.y+", z:"+this.z+" }"},equals:function(t){return this.x==t.x&&this.y==t.y&&this.z==t.z&&this.w==t.w},clone:function(){return new un(this.x,this.y,this.z,this.w)},normalize:function(){return this.divideScalar(Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z))},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z},cross:function(t,e){return this.set_xyz(t.y*e.z-t.z*e.y,t.z*e.x-t.x*e.z,t.x*e.y-t.y*e.x),this},invert:function(){return this.set_xyz(-this.x,-this.y,-this.z),this},add:function(t){if(null==t)throw new ne(Re.null_assertion("other was null"));return this.set_xyz(this.x+t.x,this.y+t.y,this.z+t.z),this},add_xyz:function(t,e,i){return null==i&&(i=0),null==e&&(e=0),null==t&&(t=0),this.set_xyz(this.x+t,this.y+e,this.z+i),this},subtract:function(t){if(null==t)throw new ne(Re.null_assertion("other was null"));return this.set_xyz(this.x-t.x,this.y-t.y,this.z-t.z),this},subtract_xyz:function(t,e,i){return null==i&&(i=0),null==e&&(e=0),null==t&&(t=0),this.set_xyz(this.x-t,this.y-e,this.z-i),this},multiply:function(t){if(null==t)throw new ne(Re.null_assertion("other was null"));return this.set_xyz(this.x*t.x,this.y*t.y,this.z*t.z),this},multiply_xyz:function(t,e,i){return null==i&&(i=1),null==e&&(e=1),null==t&&(t=1),this.set_xyz(this.x*t,this.y*e,this.z*i),this},divide:function(t){if(null==t)throw new ne(Re.null_assertion("other was null"));if(0==t.x)throw new ne(Re.assertion("other.x != 0 ( Vector: division by zero (other.x) )"));if(0==t.y)throw new ne(Re.assertion("other.y != 0 ( Vector: division by zero (other.y) )"));return this.set_xyz(this.x/t.x,this.y/t.y,this.z/t.z),this},divide_xyz:function(t,e,i){if(null==i&&(i=1),null==e&&(e=1),null==t&&(t=1),0==t)throw new ne(Re.assertion("_x != 0 ( Vector.divide_xyz: division by zero (x) )"));if(0==e)throw new ne(Re.assertion("_y != 0 ( Vector.divide_xyz: division by zero (y) )"));if(0==i)throw new ne(Re.assertion("_z != 0 ( Vector.divide_xyz: division by zero (z) )"));return this.set_xyz(this.x/t,this.y/e,this.z/i),this},addScalar:function(t){return this.set_xyz(this.x+t,this.y+t,this.z+t),this},subtractScalar:function(t){return this.set_xyz(this.x-t,this.y-t,this.z-t),this},multiplyScalar:function(t){return this.set_xyz(this.x*t,this.y*t,this.z*t),this},divideScalar:function(t){return 0!=t?this.set_xyz(this.x/t,this.y/t,this.z/t):this.set_xyz(0,0,0),this},set_length:function(t){return this.divideScalar(Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)).multiplyScalar(t),t},get_length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},get_lengthsq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},get_normalized:function(){return un.Divide(this,Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z))},set_x:function(t){return this.x=t,this._construct?this.x:(null==this.listen_x||this.ignore_listeners||this.listen_x(t),this.x)},set_y:function(t){return this.y=t,this._construct?this.y:(null==this.listen_y||this.ignore_listeners||this.listen_y(t),this.y)},set_z:function(t){return this.z=t,this._construct?this.z:(null==this.listen_z||this.ignore_listeners||this.listen_z(t),this.z)},get_inverted:function(){return new un(-this.x,-this.y,-this.z)},set_angle2D:function(t){var e=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z);return this.set_xy(Math.cos(t)*e,Math.sin(t)*e),t},get_angle2D:function(){return Math.atan2(this.y,this.x)},truncate:function(t){return this.set_length(Math.min(t,Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z))),this},rotationTo:function(t){var e=Math.atan2(t.x-this.x,t.y-this.y),i=-(180+180*e/Math.PI);return i},applyQuaternion:function(t){var e=t.x,i=t.y,s=t.z,n=t.w,r=n*this.x+i*this.z-s*this.y,o=n*this.y+s*this.x-e*this.z,a=n*this.z+e*this.y-i*this.x,h=-e*this.x-i*this.y-s*this.z;return this.set_xyz(r*n+h*-e+o*-s-a*-i,o*n+h*-i+a*-e-r*-s,a*n+h*-s+r*-i-o*-e),this},applyProjection:function(t){var e=t.elements,i=this.x,s=this.y,n=this.z,r=1/(e[3]*i+e[7]*s+e[11]*n+e[15]);return this.set_xyz((e[0]*i+e[4]*s+e[8]*n+e[12])*r,(e[1]*i+e[5]*s+e[9]*n+e[13])*r,(e[2]*i+e[6]*s+e[10]*n+e[14])*r),this},transform:function(t){var e=this.x,i=this.y,s=this.z,n=t.elements;return this.set_xyz(n[0]*e+n[4]*i+n[8]*s+n[12],n[1]*e+n[5]*i+n[9]*s+n[13],n[2]*e+n[6]*i+n[10]*s+n[14]),this},transformDirection:function(t){var e=t.elements,i=this.x,s=this.y,n=this.z;return this.set_xyz(e[0]*i+e[4]*s+e[8]*n,e[1]*i+e[5]*s+e[9]*n,e[2]*i+e[6]*s+e[10]*n),this.divideScalar(Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)),this},setEulerFromRotationMatrix:function(t,e){null==e&&(e=0);var i=t.elements,s=i[0],n=i[4],r=i[8],o=i[1],a=i[5],h=i[9],l=i[2],_=i[6],u=i[10],c=this.x,d=this.y,f=this.z;return 0==e?(d=Math.asin(-1>r?-1:r>1?1:r),Math.abs(r)<.99999?(c=Math.atan2(-h,u),f=Math.atan2(-n,s)):(c=Math.atan2(_,a),f=0)):1==e?(c=Math.asin(-(-1>h?-1:h>1?1:h)),Math.abs(h)<.99999?(d=Math.atan2(r,u),f=Math.atan2(o,a)):(d=Math.atan2(-l,s),f=0)):2==e?(c=Math.asin(-1>_?-1:_>1?1:_),Math.abs(_)<.99999?(d=Math.atan2(-l,u),f=Math.atan2(-n,a)):(d=0,f=Math.atan2(o,s))):3==e?(d=Math.asin(-(-1>l?-1:l>1?1:l)),Math.abs(l)<.99999?(c=Math.atan2(_,u),f=Math.atan2(o,s)):(c=0,f=Math.atan2(-n,a))):4==e?(f=Math.asin(-1>o?-1:o>1?1:o),Math.abs(o)<.99999?(c=Math.atan2(-h,a),d=Math.atan2(-l,s)):(c=0,d=Math.atan2(r,u))):5==e&&(f=Math.asin(-(-1>n?-1:n>1?1:n)),Math.abs(n)<.99999?(c=Math.atan2(_,a),d=Math.atan2(r,s)):(c=Math.atan2(-h,u),d=0)),this.set_xyz(c,d,f),this},setEulerFromQuaternion:function(t,e){null==e&&(e=0);var i=t.x*t.x,s=t.y*t.y,n=t.z*t.z,r=t.w*t.w,o=this.x,a=this.y,h=this.z;return 0==e?(o=Math.atan2(2*(t.x*t.w-t.y*t.z),r-i-s+n),a=Math.asin(Es.clamp(2*(t.x*t.z+t.y*t.w),-1,1)),h=Math.atan2(2*(t.z*t.w-t.x*t.y),r+i-s-n)):1==e?(o=Math.asin(Es.clamp(2*(t.x*t.w-t.y*t.z),-1,1)),a=Math.atan2(2*(t.x*t.z+t.y*t.w),r-i-s+n),h=Math.atan2(2*(t.x*t.y+t.z*t.w),r-i+s-n)):2==e?(o=Math.asin(Es.clamp(2*(t.x*t.w+t.y*t.z),-1,1)),a=Math.atan2(2*(t.y*t.w-t.z*t.x),r-i-s+n),h=Math.atan2(2*(t.z*t.w-t.x*t.y),r-i+s-n)):3==e?(o=Math.atan2(2*(t.x*t.w+t.z*t.y),r-i-s+n),a=Math.asin(Es.clamp(2*(t.y*t.w-t.x*t.z),-1,1)),h=Math.atan2(2*(t.x*t.y+t.z*t.w),r+i-s-n)):4==e?(o=Math.atan2(2*(t.x*t.w-t.z*t.y),r-i+s-n),a=Math.atan2(2*(t.y*t.w-t.x*t.z),r+i-s-n),h=Math.asin(Es.clamp(2*(t.x*t.y+t.z*t.w),-1,1))):5==e&&(o=Math.atan2(2*(t.x*t.w+t.y*t.z),r-i+s-n),a=Math.atan2(2*(t.x*t.z+t.y*t.w),r+i-s-n),h=Math.asin(Es.clamp(2*(t.z*t.w-t.x*t.y),-1,1))),this.set_xyz(o,a,h),this},degrees:function(){return this.set_xyz(57.29577951308238*this.x,57.29577951308238*this.y,57.29577951308238*this.z),this},radians:function(){return this.set_xyz(.017453292519943278*this.x,.017453292519943278*this.y,.017453292519943278*this.z),this},__class__:un,__properties__:{get_inverted:"get_inverted",get_normalized:"get_normalized",set_angle2D:"set_angle2D",get_angle2D:"get_angle2D",get_lengthsq:"get_lengthsq",set_length:"set_length",get_length:"get_length",set_z:"set_z",set_y:"set_y",set_x:"set_x"}};var cn={};n["phoenix._Vector.Vec_Impl_"]=cn,cn.__name__=["phoenix","_Vector","Vec_Impl_"],cn._new=function(t,e,i,s){return new un(t,e,i,s)},cn._multiply=function(t,e){return new un(t.x*e.x,t.y*e.y,t.z*e.z)},cn._multiply_scalar=function(t,e){return un.Multiply(t,e)},cn._multiply_scalar_int=function(t,e){return un.Multiply(t,e)},cn._divide=function(t,e){return new un(t.x/e.x,t.y/e.y,t.z/e.z)},cn._divide_scalar=function(t,e){return new un(t.x/e,t.y/e,t.z/e)},cn._divide_scalar_int=function(t,e){return new un(t.x/e,t.y/e,t.z/e)},cn._add=function(t,e){return new un(t.x+e.x,t.y+e.y,t.z+e.z)},cn._add_scalar=function(t,e){return new un(t.x+e,t.y+e,t.z+e)},cn._add_scalar_int=function(t,e){return new un(t.x+e,t.y+e,t.z+e)},cn._subtract=function(t,e){return new un(t.x-e.x,t.y-e.y,t.z-e.z)},cn._subtract_scalar=function(t,e){return new un(t.x-e,t.y-e,t.z-e)},cn._subtract_scalar_int=function(t,e){return new un(t.x-e,t.y-e,t.z-e)};var dn=function(t){this._prev_count=0,this.dirty=!1,this.locked=!1,this.immediate=!1,this.visible=!0,this.dirty_clip=!1,this.dirty_depth=!1,this.dirty_group=!1,this.dirty_shader=!1,this.dirty_texture=!1,this.dirty_primitive_type=!1,this.shadow_clip=!1,this.shadow_depth=0,this.shadow_group=0,this.id="",this.uuid="",this.dropped=!1,this.added=!1,this.buffer_type=35048,this.buffer_based=!1,this.object_space=!1,this.uuid=_.utils.uniqueid(),this.id=this.uuid,this.state=new yn,this.vertices=[],this.batchers=[],this.transform=new ln,this._final_vert_position=new un,this.set_clip_rect(null),this.set_clip(!1);var e=!0;if(null!=t){if(null==t.id&&(t.id=this.uuid),this.id=t.id,this.set_color(function(){var e;return null==t.color&&(t.color=new ai),e=t.color}(this)),this.set_visible(function(){var e;return null==t.visible&&(t.visible=!0),e=t.visible}(this)),null==t.immediate&&(t.immediate=!1),this.immediate=t.immediate,null==t.buffer_based&&(t.buffer_based=!1),this.buffer_based=t.buffer_based,null==t.object_space&&(t.object_space=!1),this.object_space=t.object_space,this.state.set_depth(function(e){var i;return null==t.depth&&(t.depth=e.state.depth),i=t.depth}(this)),this.state.set_group(function(e){var i;return null==t.group&&(t.group=e.state.group),i=t.group}(this)),this.state.set_texture(function(e){var i;return null==t.texture&&(t.texture=e.state.texture),i=t.texture}(this)),this.state.set_primitive_type(function(e){var i;return null==t.primitive_type&&(t.primitive_type=e.state.primitive_type),i=t.primitive_type}(this)),this.state.set_shader(function(e){var i;return null==t.shader&&(t.shader=e.state.shader),i=t.shader}(this)),null!=t.clip_rect){var i=t.clip_rect;this.state.set_clip_x(i.x),this.state.set_clip_y(i.y),this.state.set_clip_w(i.w),this.state.set_clip_h(i.h)}this.transform.set_pos(function(e){var i;return null==t.pos&&(t.pos=e.transform.local.pos),i=t.pos}(this)),this.transform.set_rotation(function(e){var i;return null==t.rotation&&(t.rotation=e.transform.local.rotation),i=t.rotation}(this)),this.transform.set_scale(function(e){var i;return null==t.scale&&(t.scale=e.transform.local.scale),i=t.scale}(this)),this.transform.set_origin(function(e){var i;return null==t.origin&&(t.origin=e.transform.origin),i=t.origin}(this)),null!=t.no_batcher_add&&1==t.no_batcher_add&&(e=!1)}else this.set_color(new ai);dn._sequence_key++,this.key=new vn,this.key.uuid=this.uuid,this.key.timestamp=Nn.core.timestamp(),this.key.sequence=dn._sequence_key,this.key.primitive_type=this.state.primitive_type,this.key.texture=this.state.texture,this.key.shader=this.state.shader,this.key.group=this.state.group,this.key.depth=this.state.depth,this.key.clip=this.state.clip,this.transform.id=this.uuid,this.transform.name=this.id,null!=t&&null!=t.batcher&&e&&t.batcher.add(this),this.buffer_based&&(null!=this.vb_pos||(this.vb_pos=rr.current_context.createBuffer(),this.vb_tcoords=rr.current_context.createBuffer(),this.vb_colors=rr.current_context.createBuffer(),this.set_dirty(!0)))};n["phoenix.geometry.Geometry"]=dn,dn.__name__=["phoenix","geometry","Geometry"],dn.prototype={key_string:function(){return"ts: "+this.key.timestamp+"\nsequence: "+this.key.sequence+"\nprimitive_type: "+this.key.primitive_type+"\ntexture: "+(null==this.key.texture?"null":this.key.texture.id)+"\nshader: "+(null==this.key.shader?"null":this.key.shader.id)+"\ngroup: "+this.key.group+"\ndepth: "+this.key.depth+"\nclip: "+v.string(this.key.clip)},refresh_key:function(){this.key.uuid=this.uuid,this.key.timestamp=Nn.core.timestamp(),this.key.sequence=dn._sequence_key,this.key.primitive_type=this.state.primitive_type,this.key.texture=this.state.texture,this.key.shader=this.state.shader,this.key.group=this.state.group,this.key.depth=this.state.depth,this.key.clip=this.state.clip},str:function(){this.state.log&&(S.trace("		geometry ; "+this.id,{fileName:"Geometry.hx",lineNumber:223,className:"phoenix.geometry.Geometry",methodName:"str"}),this.state.log=!0,this.state.str(),this.state.log=!1)},drop:function(t){if(null==t&&(t=!0),t&&this.added)for(var e=0,i=this.batchers;e<i.length;){var s=i[e];++e,s.remove(this,!0)}this.key=null,this.set_color(null),this.state=null,this._final_vert_position=null,this.batchers=null,this.uuid=null,this.id=null,this.shadow_texture=null,this.shadow_shader=null,this.vertices=null,null!=this.transform&&(this.transform.destroy(),this.transform=null),this.destroy_vbos(),null!=this.buffer_pos&&(this.buffer_pos=null,this.buffer_tcoords=null,this.buffer_colors=null,this.buffer_normals=null),this.dropped=!0},add:function(t){if(this.vertices.push(t),this.vertices.length>_.renderer.batcher.max_verts)throw new ne(""+this.id+" / Currently a single geometry cannot exceed the maximum vert count of "+_.renderer.batcher.max_verts)},remove:function(t){a.remove(this.vertices,t)},batch:function(t,e,i,s,n,r,o){for(var a=0,h=this.vertices;a<h.length;){var l=h[a];++a,this._final_vert_position.set(l.pos.x,l.pos.y,l.pos.z,l.pos.w),this._final_vert_position.transform(this.transform.get_world().get_matrix()),n[t]=this._final_vert_position.x,n[t+1]=this._final_vert_position.y,n[t+2]=this._final_vert_position.z,n[t+3]=this._final_vert_position.w,t+=4;var _=l.uv.uv0;r[e]=_.u,r[e+1]=_.v,r[e+2]=_.w,r[e+3]=_.t,e+=4,o[i]=l.color.r,o[i+1]=l.color.g,o[i+2]=l.color.b,o[i+3]=l.color.a,i+=4,s+=4}},batch_object_space:function(t,e,i,s,n,r,o){for(var a=0,h=this.vertices;a<h.length;){var l=h[a];++a;var _=l.pos,u=l.uv.uv0,c=l.color;n[t]=_.x,n[t+1]=_.y,n[t+2]=_.z,n[t+3]=_.w,t+=4,r[e]=u.u,r[e+1]=u.v,r[e+2]=u.w,r[e+3]=u.t,e+=4,o[i]=c.r,o[i+1]=c.g,o[i+2]=c.b,o[i+3]=c.a,i+=4,s+=4}},batch_into_arrays:function(t,e,i){for(var s=0,n=this.vertices;s<n.length;){var r=n[s];++s,this._final_vert_position.set(r.pos.x,r.pos.y,r.pos.z,r.pos.w),this._final_vert_position.transform(this.transform.get_world().get_matrix()),t.push(this._final_vert_position.x),t.push(this._final_vert_position.y),t.push(this._final_vert_position.z),t.push(this._final_vert_position.w),e.push(r.uv.uv0.u),e.push(r.uv.uv0.v),e.push(r.uv.uv0.w),e.push(r.uv.uv0.t),i.push(r.color.r),i.push(r.color.g),i.push(r.color.b),i.push(r.color.a)}},destroy_vbos:function(){null!=this.vb_pos&&(rr.current_context.deleteBuffer(this.vb_pos),rr.current_context.deleteBuffer(this.vb_tcoords),rr.current_context.deleteBuffer(this.vb_colors))},create_vbos:function(){null==this.vb_pos&&(this.vb_pos=rr.current_context.createBuffer(),this.vb_tcoords=rr.current_context.createBuffer(),this.vb_colors=rr.current_context.createBuffer(),this.set_dirty(!0))},bind:function(){rr.current_context.bindBuffer(34962,this.vb_pos),rr.current_context.vertexAttribPointer(0,4,5126,!1,0,0),rr.current_context.bindBuffer(34962,this.vb_tcoords),rr.current_context.vertexAttribPointer(1,4,5126,!1,0,0),rr.current_context.bindBuffer(34962,this.vb_colors),rr.current_context.vertexAttribPointer(2,4,5126,!1,0,0)},bind_pos:function(){rr.current_context.bindBuffer(34962,this.vb_pos),rr.current_context.vertexAttribPointer(0,4,5126,!1,0,0)},bind_tcoords:function(){rr.current_context.bindBuffer(34962,this.vb_tcoords),rr.current_context.vertexAttribPointer(1,4,5126,!1,0,0)},bind_colors:function(){rr.current_context.bindBuffer(34962,this.vb_colors),rr.current_context.vertexAttribPointer(2,4,5126,!1,0,0)},unbind:function(){rr.current_context.bindBuffer(34962,null)},bind_and_upload:function(){rr.current_context.bindBuffer(34962,this.vb_pos),rr.current_context.vertexAttribPointer(0,4,5126,!1,0,0),rr.current_context.bufferData(34962,this.buffer_pos,this.buffer_type),rr.current_context.bindBuffer(34962,this.vb_tcoords),rr.current_context.vertexAttribPointer(1,4,5126,!1,0,0),rr.current_context.bufferData(34962,this.buffer_tcoords,this.buffer_type),rr.current_context.bindBuffer(34962,this.vb_colors),rr.current_context.vertexAttribPointer(2,4,5126,!1,0,0),rr.current_context.bufferData(34962,this.buffer_colors,this.buffer_type)},update_buffers:function(){if(!this.dirty)return!1;var t=this.vertices.length;if(t!=this._prev_count||null==this.buffer_pos){var e=4*this.vertices.length;this.buffer_pos=null,this.buffer_normals=null,this.buffer_colors=null,this.buffer_tcoords=null;var i;i=null!=e?new Float32Array(e):null,this.buffer_pos=i;var s;s=null!=e?new Float32Array(e):null,this.buffer_tcoords=s;var n;n=null!=e?new Float32Array(e):null,this.buffer_colors=n}return this.object_space?this.batch_object_space(0,0,0,0,this.buffer_pos,this.buffer_tcoords,this.buffer_colors,this.buffer_normals):this.batch(0,0,0,0,this.buffer_pos,this.buffer_tcoords,this.buffer_colors,this.buffer_normals),this.set_dirty(!1),!0},draw:function(){rr.current_context.drawArrays(this.state.primitive_type,0,this.buffer_pos.length/4|0)},translate:function(t){this.transform.local.pos.set_xyz(this.transform.local.pos.x+t.x,this.transform.local.pos.y+t.y,this.transform.local.pos.x+t.z)},set_locked:function(t){return this.buffer_type=t?35044:35048,t&&null==this.vb_pos&&(null!=this.vb_pos||(this.vb_pos=rr.current_context.createBuffer(),this.vb_tcoords=rr.current_context.createBuffer(),this.vb_colors=rr.current_context.createBuffer(),this.set_dirty(!0))),t||null==this.vb_pos||this.destroy_vbos(),this.locked=t},get_locked:function(){return this.locked},set_dirty:function(t){return this.dirty=t},get_dirty:function(){return this.dirty},refresh:function(){for(var t=0,e=this.batchers;t<e.length;){var i=e[t];++t,i.remove(this,!1)}this.dirty_primitive_type&&(this.dirty_primitive_type=!1,this.state.set_primitive_type(this.shadow_primitive_type)),this.dirty_texture&&(this.dirty_texture=!1,this.state.set_texture(this.shadow_texture)),this.dirty_shader&&(this.dirty_shader=!1,this.state.set_shader(this.shadow_shader)),this.dirty_group&&(this.dirty_group=!1,this.state.set_group(this.shadow_group)),this.dirty_depth&&(this.dirty_depth=!1,this.state.depth=this.shadow_depth),this.dirty_clip&&(this.dirty_clip=!1,this.state.set_clip(this.shadow_clip)),this.refresh_key();for(var s=0,n=this.batchers;s<n.length;){var r=n[s];++s,r.add(this,!1)}},get_primitive_type:function(){return this.state.primitive_type},set_primitive_type:function(t){return this.state.primitive_type!=t&&(this.shadow_primitive_type=t,this.dirty_primitive_type=!0,this.refresh()),this.primitive_type=t},get_texture:function(){return this.state.texture},set_texture:function(t){return this.state.texture!=t&&(this.shadow_texture=t,this.dirty_texture=!0,this.refresh()),this.texture=t},set_visible:function(t){return this.visible=t},set_color:function(t){if(null!=this.vertices&&this.vertices.length>0)for(var e=0,i=this.vertices;e<i.length;){var s=i[e];++e,s.color=t}return this.color=t},get_shader:function(){return this.state.shader},set_shader:function(t){return this.state.shader!=t&&(this.shadow_shader=t,this.dirty_shader=!0,this.refresh()),this.shader=t},get_depth:function(){return this.state.depth},set_depth:function(t){return this.state.depth!=t&&(this.shadow_depth=t,this.dirty_depth=!0,this.refresh()),this.depth=t},get_group:function(){return this.state.group},set_group:function(t){return this.state.group!=t&&(this.shadow_group=t,this.dirty_group=!0,this.refresh()),this.group=t},get_clip:function(){return this.state.clip},set_clip:function(t){return this.state.clip!=t&&(this.shadow_clip=t,this.dirty_clip=!0,this.refresh()),this.clip=t},get_clip_rect:function(){return this.clip_rect},set_clip_rect:function(t){return null==t?this.set_clip(!1):(this.set_clip(!0),this.state.set_clip_x(t.x),this.state.set_clip_y(t.y),this.state.set_clip_w(t.w),this.state.set_clip_h(t.h)),this.clip_rect=t},__class__:dn,__properties__:{set_clip:"set_clip",get_clip:"get_clip",set_color:"set_color",set_dirty:"set_dirty",get_dirty:"get_dirty",set_locked:"set_locked",get_locked:"get_locked",set_visible:"set_visible",set_clip_rect:"set_clip_rect",get_clip_rect:"get_clip_rect",set_group:"set_group",get_group:"get_group",set_depth:"set_depth",get_depth:"get_depth",set_shader:"set_shader",get_shader:"get_shader",set_texture:"set_texture",get_texture:"get_texture",set_primitive_type:"set_primitive_type",get_primitive_type:"get_primitive_type"}};var fn=function(t){if(dn.call(this,t),null!=t){var e=32,i=32;if(null==t.end_angle&&(t.end_angle=360),t.end_angle,null==t.start_angle&&(t.start_angle=0),t.start_angle,null!=t.r&&(e=t.r,i=t.r),null!=t.rx&&(e=t.rx),null!=t.ry&&(i=t.ry),null==t.steps)if(null==t.smooth){var s=Math.max(e,i);
t.steps=_.utils.geometry.segments_for_smooth_circle(s)}else{var n=t.smooth,r=Math.max(e,i);t.steps=_.utils.geometry.segments_for_smooth_circle(r,n)}this.set(t.x,t.y,e,i,t.steps,t.start_angle,t.end_angle),null!=t.visible&&this.set_visible(t.visible)}};n["phoenix.geometry.CircleGeometry"]=fn,fn.__name__=["phoenix","geometry","CircleGeometry"],fn.__super__=dn,fn.prototype=e(dn.prototype,{set:function(t,e,i,s,n,r,o){null==o&&(o=360),null==r&&(r=0),this.set_primitive_type(4);var a=Math.PI/2,h=.017453292519943278*r-a,l=.017453292519943278*o-a,_=l-h;n=Math.ceil(Math.abs(_)/(2*Math.PI)*n);var u=_/n,c=Math.tan(u),d=Math.cos(u),f=i*Math.cos(h),p=i*Math.sin(h),m=i/s;0==m&&(m=1e-9);for(var g=0,v=[],y=0,w=n+1;w>y;){var x=(y++,f),b=p/m,k=new un(x,b);v.push(k),g>0&&this.add(new Tn(k,this.color)),this.add(new Tn(new un(0,0),this.color)),this.add(new Tn(k,this.color));var z=-p,E=f;f+=z*c,p+=E*c,f*=d,p*=d,g++}this.add(new Tn(v[n],this.color)),this.transform.set_pos(new un(t,e))},__class__:fn});var pn=function(t){fn.call(this,t),this.set_primitive_type(1)};n["phoenix.geometry.RingGeometry"]=pn,pn.__name__=["phoenix","geometry","RingGeometry"],pn.__super__=fn,pn.prototype=e(fn.prototype,{set:function(t,e,i,s,n,r,o){null==o&&(o=360),null==r&&(r=0),this.set_primitive_type(4);var a=.017453292519943278*r,h=.017453292519943278*o,l=h-a,_=l/n,u=Math.tan(_),c=Math.cos(_),d=i*Math.cos(a),f=i*Math.sin(a),p=i/s;0==p&&(p=1e-9);for(var m=0,g=[],v=0;n>v;){var y=(v++,d),w=f/p,x=new un(y,w);if(g.push(x),this.add(new Tn(x,this.color)),m>0){var b=g[m];this.add(new Tn(new un(b.x,b.y,b.z,b.w),this.color))}var k=-f,z=d;d+=k*u,f+=z*u,d*=c,f*=c,m++}g.length>0&&this.add(new Tn(g[0].clone(),this.color)),this.transform.set_pos(new un(t,e))},__class__:pn});var mn=function(t){pn.call(this,t),this.vertices.pop(),this.vertices.pop(),this.set_primitive_type(1)};n["phoenix.geometry.ArcGeometry"]=mn,mn.__name__=["phoenix","geometry","ArcGeometry"],mn.__super__=pn,mn.prototype=e(pn.prototype,{__class__:mn});var gn=function(t){dn.call(this,t),this.geometry=[]};n["phoenix.geometry.CompositeGeometry"]=gn,gn.__name__=["phoenix","geometry","CompositeGeometry"],gn.__super__=dn,gn.prototype=e(dn.prototype,{toString:function(){return"CompositeGeometry "+v.string(this.geometry)+" : "+v.string(this.geometry)},clear:function(){for(var t=0,e=this.geometry;t<e.length;){var i=e[t];++t,i.transform.set_parent(null)}this.geometry.splice(0,this.geometry.length)},replace:function(t){this.clear(),this.geometry=t;for(var e=0,i=this.geometry;e<i.length;){var s=i[e];++e,s.transform.set_parent(this.transform)}},has_geometry:function(t){return h.has(this.geometry,t)},add_geometry:function(t){null!=t&&(t.transform.set_parent(this.transform),this.geometry.push(t))},remove_geometry:function(t){a.remove(this.geometry,t)&&t.transform.set_parent(null)},add_to_batcher:function(t){for(var e=0,i=this.geometry;e<i.length;){var s=i[e];++e,t.add(s)}},drop:function(t){null==t&&(t=!0),dn.prototype.drop.call(this,t);for(var e=0,i=this.geometry;e<i.length;){var s=i[e];++e,s.drop(t),s=null}this.geometry=null,this.geometry=[]},translate:function(t){if(null!=this.geometry)for(var e=0,i=this.geometry;e<i.length;){var s=i[e];++e,s.translate(t)}},set_color:function(t){if(null!=this.geometry)for(var e=0,i=this.geometry;e<i.length;){var s=i[e];++e,s.set_color(t)}return this.color=t},set_primitive_type:function(t){if(null!=this.geometry)for(var e=0,i=this.geometry;e<i.length;){var s=i[e];++e,s.set_primitive_type(t)}return this.primitive_type=t},set_shader:function(t){if(null!=this.geometry)for(var e=0,i=this.geometry;e<i.length;){var s=i[e];++e,s.set_shader(t)}return this.shader=t},set_texture:function(t){if(null!=this.geometry)for(var e=0,i=this.geometry;e<i.length;){var s=i[e];++e,s.set_texture(t)}return this.texture=t},set_depth:function(t){if(null!=this.geometry)for(var e=0,i=this.geometry;e<i.length;){var s=i[e];++e,s.set_depth(t)}return this.depth=t},set_group:function(t){if(null!=this.geometry)for(var e=0,i=this.geometry;e<i.length;){var s=i[e];++e,s.set_group(t)}return this.group=t},set_locked:function(t){if(null!=this.geometry)for(var e=0,i=this.geometry;e<i.length;){var s=i[e];++e,s.set_locked(t)}return this.locked=t},set_dirty:function(t){if(null!=this.geometry)for(var e=0,i=this.geometry;e<i.length;){var s=i[e];++e,s.set_dirty(t)}return this.dirty=t},set_clip_rect:function(t){if(null!=this.geometry)for(var e=0,i=this.geometry;e<i.length;){var s=i[e];++e,s.set_clip_rect(t)}return this.clip_rect=t},set_visible:function(t){if(null!=this.geometry)for(var e=0,i=this.geometry;e<i.length;){var s=i[e];++e,s.set_visible(t)}return this.visible=t},__class__:gn});var vn=function(){this.clip=!1,this.depth=0,this.group=0,this.uuid="",this.sequence=0,this.timestamp=0};n["phoenix.geometry.GeometryKey"]=vn,vn.__name__=["phoenix","geometry","GeometryKey"],vn.prototype={__class__:vn};var yn=function(){this.log=!1,this.dirty=!0,this.clip=!1,this.dirty=!0,this.clip_x=0,this.dirty=!0,this.clip_y=0,this.dirty=!0,this.clip_w=0,this.dirty=!0,this.clip_h=0,this.dirty=!0,this.texture=null,this.dirty=!0,this.shader=null,this.dirty=!0,this.group=0,this.depth=0,this.dirty=!0,this.primitive_type=0,this.dirty=!1};n["phoenix.geometry.GeometryState"]=yn,yn.__name__=["phoenix","geometry","GeometryState"],yn.prototype={clone_onto:function(t){t.dirty=this.dirty,t.dirty=!0,t.texture=this.texture,t.dirty=!0,t.shader=this.shader,t.dirty=!0,t.group=this.group,t.depth=this.depth,t.dirty=!0,t.primitive_type=this.primitive_type,t.dirty=!0,t.clip=this.clip,t.dirty=!0,t.clip_x=this.clip_x,t.dirty=!0,t.clip_y=this.clip_y,t.dirty=!0,t.clip_w=this.clip_w,t.dirty=!0,t.clip_h=this.clip_h},str:function(){this.log&&(S.trace("	+ GEOMETRYSTATE "+v.string(this.dirty),{fileName:"GeometryState.hx",lineNumber:67,className:"phoenix.geometry.GeometryState",methodName:"str"}),S.trace("		depth - "+this.depth,{fileName:"GeometryState.hx",lineNumber:68,className:"phoenix.geometry.GeometryState",methodName:"str"}),S.trace("		group - "+this.group,{fileName:"GeometryState.hx",lineNumber:69,className:"phoenix.geometry.GeometryState",methodName:"str"}),S.trace("		texture - "+(null==this.texture?"null":this.texture.id),{fileName:"GeometryState.hx",lineNumber:70,className:"phoenix.geometry.GeometryState",methodName:"str"}),null!=this.texture&&S.trace("			 "+v.string(this.texture.texture),{fileName:"GeometryState.hx",lineNumber:72,className:"phoenix.geometry.GeometryState",methodName:"str"}),S.trace("		shader - "+(null==this.shader?"null":this.shader.id),{fileName:"GeometryState.hx",lineNumber:74,className:"phoenix.geometry.GeometryState",methodName:"str"}),S.trace("		primitive_type - "+this.primitive_type,{fileName:"GeometryState.hx",lineNumber:75,className:"phoenix.geometry.GeometryState",methodName:"str"}),S.trace("		clip - "+v.string(this.clip),{fileName:"GeometryState.hx",lineNumber:76,className:"phoenix.geometry.GeometryState",methodName:"str"}),S.trace("		clip rect - "+this.clip_x+","+this.clip_y+","+this.clip_w+","+this.clip_h,{fileName:"GeometryState.hx",lineNumber:77,className:"phoenix.geometry.GeometryState",methodName:"str"}),S.trace("	- GEOMETRYSTATE",{fileName:"GeometryState.hx",lineNumber:78,className:"phoenix.geometry.GeometryState",methodName:"str"}))},clean:function(){this.dirty=!1},update:function(t){this.depth!=t.depth&&(this.depth=t.depth),this.group!=t.group&&(this.dirty=!0,this.group=t.group),this.texture!=t.texture&&(this.dirty=!0,this.texture=t.texture),this.shader!=t.shader&&(this.dirty=!0,this.shader=t.shader),this.primitive_type!=t.primitive_type&&(this.dirty=!0,this.primitive_type=t.primitive_type),this.clip!=t.clip&&(this.dirty=!0,this.clip=t.clip),this.clip_x!=t.clip_x&&(this.dirty=!0,this.clip_x=t.clip_x),this.clip_y!=t.clip_y&&(this.dirty=!0,this.clip_y=t.clip_y),this.clip_w!=t.clip_w&&(this.dirty=!0,this.clip_w=t.clip_w),this.clip_h!=t.clip_h&&(this.dirty=!0,this.clip_h=t.clip_h)},set_primitive_type:function(t){return this.dirty=!0,this.primitive_type=t},set_texture:function(t){return this.dirty=!0,this.texture=t},set_shader:function(t){return this.dirty=!0,this.shader=t},set_depth:function(t){return this.depth=t},set_group:function(t){return this.dirty=!0,this.group=t},set_clip:function(t){return this.dirty=!0,this.clip=t},set_clip_x:function(t){return this.dirty=!0,this.clip_x=t},set_clip_y:function(t){return this.dirty=!0,this.clip_y=t},set_clip_w:function(t){return this.dirty=!0,this.clip_w=t},set_clip_h:function(t){return this.dirty=!0,this.clip_h=t},__class__:yn,__properties__:{set_clip_h:"set_clip_h",set_clip_w:"set_clip_w",set_clip_y:"set_clip_y",set_clip_x:"set_clip_x",set_clip:"set_clip",set_group:"set_group",set_depth:"set_depth",set_texture:"set_texture",set_shader:"set_shader",set_primitive_type:"set_primitive_type"}};var wn=function(t){if(dn.call(this,t),this.set_primitive_type(1),null!=t){null==t.color&&(t.color=new ai),t.color,null==t.color0&&(t.color0=t.color),t.color0,null==t.color1&&(t.color1=t.color),t.color1,this.set_p0(function(){var e;return null==t.p0&&(t.p0=new un),e=t.p0}(this)),this.set_p1(function(){var e;return null==t.p1&&(t.p1=new un(64,64)),e=t.p1}(this));var e=new Tn(this.p0,t.color0),i=new Tn(this.p1,t.color1);e.uv.uv0.set_uv(0,0),i.uv.uv0.set_uv(1,0),this.add(e),this.add(i)}};n["phoenix.geometry.LineGeometry"]=wn,wn.__name__=["phoenix","geometry","LineGeometry"],wn.__super__=dn,wn.prototype=e(dn.prototype,{set_p0:function(t){return this.p0=t,0==this.vertices.length?this.p0:(this.vertices[0].pos=this.p0,this.p0=t)},set_p1:function(t){return this.p1=t,0==this.vertices.length?this.p1:(this.vertices[1].pos=this.p1,this.p1=t)},set_color0:function(t){return this.color0=t,0==this.vertices.length?this.color0:(this.vertices[0].color=this.color0,this.color0)},set_color1:function(t){return this.color1=t,0==this.vertices.length?this.color1:(this.vertices[1].color=this.color1,this.color1)},__class__:wn,__properties__:e(dn.prototype.__properties__,{set_color1:"set_color1",set_color0:"set_color0",set_p1:"set_p1",set_p0:"set_p0"})});var xn=function(t){this.is_set=!1,this.flipy=!1,this.flipx=!1,dn.call(this,t),null!=t&&(null!=t.flipx&&this.set_flipx(t.flipx),null!=t.flipy&&this.set_flipy(t.flipy),this._uv_cache=new $s(0,0,1,1),this.set(new $s(t.x,t.z,t.w,t.h),t.y),null!=t.visible&&this.set_visible(t.visible),null!=t.immediate&&(this.immediate=t.immediate))};n["phoenix.geometry.PlaneGeometry"]=xn,xn.__name__=["phoenix","geometry","PlaneGeometry"],xn.__super__=dn,xn.prototype=e(dn.prototype,{uv:function(t){if(null==this.state.texture)return void S.trace("Warning : calling UV on a geometry with null texture.",{fileName:"PlaneGeometry.hx",lineNumber:45,className:"phoenix.geometry.PlaneGeometry",methodName:"uv"});var e=t.x/this.state.texture.width_actual,i=t.y/this.state.texture.height_actual,s=t.w/this.state.texture.width_actual,n=t.h/this.state.texture.height_actual;this.uv_space(new $s(e,i,s,n))},uv_space:function(t){var e=t.w,i=t.h,s=t.x,n=t.y;this._uv_cache.set(s,n,e,i);var r=s+e,o=n,a=s+e,h=n+i,l=s,_=n+i,u=0,c=0;this.flipy&&(c=_,_=n,n=c,c=h,h=o,o=c),this.flipx&&(u=r,r=s,s=u,u=a,a=l,l=u),this.vertices[0].uv.uv0.set_uv(s,n),this.vertices[1].uv.uv0.set_uv(r,o),this.vertices[2].uv.uv0.set_uv(a,h),this.vertices[3].uv.uv0.set_uv(l,_),this.vertices[4].uv.uv0.set_uv(s,n),this.vertices[5].uv.uv0.set_uv(a,h),this.set_dirty(!0)},set:function(t,e){this.vertices.splice(0,this.vertices.length);var i=new Tn(new un(0,0,0),this.color),s=new Tn(new un(t.w,0,0),this.color),n=new Tn(new un(t.w,0,t.h),this.color),r=new Tn(new un(0,0,t.h),this.color),o=new Tn(new un(0,0,0),this.color),a=new Tn(new un(t.w,0,t.h),this.color);this.add(a),this.add(o),this.add(r),this.add(n),this.add(s),this.add(i),this.set_primitive_type(4),this.immediate=!1,this.transform.set_pos(new un(t.x,e,t.y)),this.is_set=!0,this.uv_space(new $s(0,0,1,1))},set_flipx:function(t){return this.flipx=t,this.is_set&&this.uv_space(this._uv_cache),this.flipx},set_flipy:function(t){return this.flipy=t,this.is_set&&this.uv_space(this._uv_cache),this.flipy},__class__:xn,__properties__:e(dn.prototype.__properties__,{set_flipy:"set_flipy",set_flipx:"set_flipx"})});var bn=function(t){if(this._uv_h=1,this._uv_w=1,this._uv_y=0,this._uv_x=0,this.uv_angle=0,this.flipy=!1,this.flipx=!1,t.primitive_type=4,dn.call(this,t),null!=t){null!=t.flipx&&this.set_flipx(t.flipx),null!=t.flipy&&this.set_flipy(t.flipy);var e=t.x,i=t.y,s=t.w,n=t.h;null!=t.rect&&(e=t.rect.x,i=t.rect.y,s=t.rect.w,n=t.rect.h),this.add(new Tn(new un(0,0),this.color)),this.add(new Tn(new un(s,0),this.color)),this.add(new Tn(new un(s,n),this.color)),this.add(new Tn(new un(0,n),this.color)),this.add(new Tn(new un(0,0),this.color)),this.add(new Tn(new un(s,n),this.color)),this.transform.set_pos(this.transform.local.pos.set_xy(e,i)),this.uv_space(0,0,1,1),null!=t.visible&&this.set_visible(t.visible),null!=t.immediate&&(this.immediate=t.immediate)}};n["phoenix.geometry.QuadGeometry"]=bn,bn.__name__=["phoenix","geometry","QuadGeometry"],bn.__super__=dn,bn.prototype=e(dn.prototype,{uv:function(t){if(null==this.state.texture)throw new ne(Re.null_assertion("texture was null ( QuadGeometry; Calling UV on a geometry with null texture. )"));var e=t.x/this.state.texture.width_actual,i=t.y/this.state.texture.height_actual,s=t.w/this.state.texture.width_actual,n=t.h/this.state.texture.height_actual;this.uv_space(e,i,s,n)},uv_space:function(t,e,i,s){if(0!=this.vertices.length){var n=i,r=s,o=t,a=e;this._uv_x=o,this._uv_y=a,this._uv_w=n,this._uv_h=r;var h=o+n,l=a,_=o+n,u=a+r,c=o,d=a+r,f=0,p=0,m=this.uv_angle/90|0;m-=4*Math.floor(m/4);for(var g=0;m>g;){{g++}f=o,o=c,c=_,_=h,h=f,p=a,a=d,d=u,u=l,l=p}this.flipy&&(p=d,d=a,a=p,f=c,c=o,o=f,p=u,u=l,l=p,f=_,_=h,h=f),this.flipx&&(f=h,h=o,o=f,p=l,l=a,a=p,f=_,_=c,c=f,p=u,u=d,d=p),this.vertices[0].uv.uv0.set_uv(o,a),this.vertices[1].uv.uv0.set_uv(h,l),this.vertices[2].uv.uv0.set_uv(_,u),this.vertices[3].uv.uv0.set_uv(c,d),this.vertices[4].uv.uv0.set_uv(o,a),this.vertices[5].uv.uv0.set_uv(_,u),this.set_dirty(!0)}},resize_xy:function(t,e){0!=this.vertices.length&&(this.vertices[0].pos.set_xy(0,0),this.vertices[1].pos.set_xy(t,0),this.vertices[2].pos.set_xy(t,e),this.vertices[3].pos.set_xy(0,e),this.vertices[4].pos.set_xy(0,0),this.vertices[5].pos.set_xy(t,e))},resize:function(t){this.resize_xy(t.x,t.y)},set:function(t){this.set_xywh(t.x,t.y,t.w,t.h)},set_xywh:function(t,e,i,s){0!=this.vertices.length&&(this.vertices[0].pos.set_xy(0,0),this.vertices[1].pos.set_xy(i,0),this.vertices[2].pos.set_xy(i,s),this.vertices[3].pos.set_xy(0,s),this.vertices[4].pos.set_xy(0,0),this.vertices[5].pos.set_xy(i,s),this.transform.set_pos(this.transform.local.pos.set_xy(t,e)))},set_flipx:function(t){return this.flipx=t,this.uv_space(this._uv_x,this._uv_y,this._uv_w,this._uv_h),this.flipx},set_flipy:function(t){return this.flipy=t,this.uv_space(this._uv_x,this._uv_y,this._uv_w,this._uv_h),this.flipy},set_uv_angle:function(t){if(t%90!=0)throw new ne(Re.assertion("_val % 90 == 0 ( uv_angle has to be a multiple of 90 )"));return this.uv_angle=t,this.uv_space(this._uv_x,this._uv_y,this._uv_w,this._uv_h),this.uv_angle},__class__:bn,__properties__:e(dn.prototype.__properties__,{set_uv_angle:"set_uv_angle",set_flipy:"set_flipy",set_flipx:"set_flipx"})});var kn=function(t){dn.call(this,t),this.set_primitive_type(4),this.quads=new U};n["phoenix.geometry.QuadPackGeometry"]=kn,kn.__name__=["phoenix","geometry","QuadPackGeometry"],kn.__super__=dn,kn.prototype=e(dn.prototype,{clear:function(){for(var t=this.quads.keys();t.hasNext();){var e=t.next();this.quad_remove(e)}},quad_add:function(t){null==t.visible&&(t.visible=!0),t.visible,null==t.flipx&&(t.flipx=!1),t.flipx,null==t.flipy&&(t.flipy=!1),t.flipy;var e=_.utils.uniquehash(),i=new Tn(new un(t.x,t.y),t.color),s=new Tn(new un(t.x+t.w,t.y),t.color),n=new Tn(new un(t.x+t.w,t.y+t.h),t.color),r=new Tn(new un(t.x,t.y+t.h),t.color),o=new Tn(new un(t.x,t.y),t.color),a=new Tn(new un(t.x+t.w,t.y+t.h),t.color);this.add(i),this.add(s),this.add(n),this.add(r),this.add(o),this.add(a);var h={uid:e,verts:[],flipx:t.flipx,flipy:t.flipx,visible:t.visible,_uv_cache:new $s(0,0,1,1)};return h.verts.push(i),h.verts.push(s),h.verts.push(n),h.verts.push(r),h.verts.push(o),h.verts.push(a),this.quads.h[e]=h,null!=t.uv&&this.quad_uv(e,t.uv),this.set_dirty(!0),e},quad_remove:function(t){var e=this.quads.h[t];null!=e&&(this.remove(e.verts[0]),this.remove(e.verts[1]),this.remove(e.verts[2]),this.remove(e.verts[3]),this.remove(e.verts[4]),this.remove(e.verts[5]),this.quads.remove(t),this.set_dirty(!0))},quad_visible:function(t,e){var i=this.quads.h[t];null!=i&&(e&&!i.visible?(i.visible=!1,this.add(i.verts[0]),this.add(i.verts[1]),this.add(i.verts[2]),this.add(i.verts[3]),this.add(i.verts[4]),this.add(i.verts[5])):!e&&i.visible&&(i.visible=!1,this.remove(i.verts[0]),this.remove(i.verts[1]),this.remove(i.verts[2]),this.remove(i.verts[3]),this.remove(i.verts[4]),this.remove(i.verts[5])),this.set_dirty(!0))},quad_resize:function(t,e){var i=this.quads.h[t];null!=i&&(i.verts[0].pos=new un(e.x,e.y),i.verts[1].pos=new un(e.x+e.w,e.y),i.verts[2].pos=new un(e.x+e.w,e.y+e.h),i.verts[3].pos=new un(e.x,e.y+e.h),i.verts[4].pos=new un(e.x,e.y),i.verts[5].pos=new un(e.x+e.w,e.y+e.h),this.set_dirty(!0))},quad_pos:function(t,e){var i=this.quads.h[t];if(null!=i){var s=e.x-i.verts[0].pos.x,n=e.y-i.verts[0].pos.y,r=i.verts[0].pos;r.set_x(r.x+s);var o=i.verts[0].pos;o.set_y(o.y+n);var a=i.verts[1].pos;a.set_x(a.x+s);var h=i.verts[1].pos;h.set_y(h.y+n);var l=i.verts[2].pos;l.set_x(l.x+s);var _=i.verts[2].pos;_.set_y(_.y+n);var u=i.verts[3].pos;u.set_x(u.x+s);var c=i.verts[3].pos;c.set_y(c.y+n);var d=i.verts[4].pos;d.set_x(d.x+s);var f=i.verts[4].pos;f.set_y(f.y+n);var p=i.verts[5].pos;p.set_x(p.x+s);var m=i.verts[5].pos;m.set_y(m.y+n),this.set_dirty(!0)}},quad_color:function(t,e){var i=this.quads.h[t];null!=i&&(i.verts[0].color=e,i.verts[1].color=e,i.verts[2].color=e,i.verts[3].color=e,i.verts[4].color=e,i.verts[5].color=e)},quad_alpha:function(t,e){var i=this.quads.h[t];null!=i&&(i.verts[0].color.a=e,i.verts[1].color.a=e,i.verts[2].color.a=e,i.verts[3].color.a=e,i.verts[4].color.a=e,i.verts[5].color.a=e)},quad_uv_space:function(t,e){var i=this.quads.h[t];if(null!=i){var s=i.flipx,n=i.flipy,r=e.w,o=e.h,a=e.x,h=e.y;i._uv_cache.set(a,h,r,o);var l=a+r,_=h,u=a+r,c=h+o,d=a,f=h+o,p=0,m=0;n&&(m=f,f=h,h=m,m=c,c=_,_=m),s&&(p=l,l=a,a=p,p=u,u=d,d=p),i.verts[0].uv.uv0.set_uv(a,h),i.verts[1].uv.uv0.set_uv(l,_),i.verts[2].uv.uv0.set_uv(u,c),i.verts[3].uv.uv0.set_uv(d,f),i.verts[4].uv.uv0.set_uv(a,h),i.verts[5].uv.uv0.set_uv(u,c),this.set_dirty(!0)}},quad_uv:function(t,e){if(null==this.state.texture)return void S.trace("Warning : calling UV on a PackedQuad Geometry with null texture.",{fileName:"QuadPackGeometry.hx",lineNumber:351,className:"phoenix.geometry.QuadPackGeometry",methodName:"quad_uv"});var i=e.x/this.state.texture.width_actual,s=e.y/this.state.texture.height_actual,n=e.w/this.state.texture.width_actual,r=e.h/this.state.texture.height_actual;this.quad_uv_space(t,new $s(i,s,n,r))},quad_flipx:function(t,e){var i=this.quads.h[t];null!=i&&(i.flipx=e,this.quad_uv_space(t,i._uv_cache))},quad_flipy:function(t,e){var i=this.quads.h[t];null!=i&&(i.flipy=e,this.quad_uv_space(t,i._uv_cache))},__class__:kn});var zn=function(t){dn.call(this,t),null!=t&&this.set(t)};n["phoenix.geometry.RectangleGeometry"]=zn,zn.__name__=["phoenix","geometry","RectangleGeometry"],zn.__super__=dn,zn.prototype=e(dn.prototype,{set:function(t){this.vertices.splice(0,this.vertices.length);var e=t.x,i=t.y,s=t.w,n=t.h;null!=t.rect&&(e=t.rect.x,i=t.rect.y,s=t.rect.w,n=t.rect.h);var r=new Tn(new un(0,0));r.uv.uv0.set_uv(0,0);var o=new Tn(new un(s,0));o.uv.uv0.set_uv(1,0);var a=new Tn(new un(s,0));a.uv.uv0.set_uv(1,0);var h=new Tn(new un(s,n));h.uv.uv0.set_uv(1,1);var l=new Tn(new un(s,n));l.uv.uv0.set_uv(1,1);var _=new Tn(new un(0,n));_.uv.uv0.set_uv(0,1);var u=new Tn(new un(0,n));u.uv.uv0.set_uv(0,1);var c=new Tn(new un(0,0));c.uv.uv0.set_uv(0,0),this.add(r),this.add(o),this.add(a),this.add(h),this.add(l),this.add(_),this.add(u),this.add(c),this.set_primitive_type(1),null==t.immediate&&(t.immediate=!1),this.immediate=t.immediate,this.set_visible(function(){var e;return null==t.visible&&(t.visible=!0),e=t.visible}(this)),this.set_color(function(){var e;return null==t.color&&(t.color=new ai),e=t.color}(this)),this.transform.set_pos(new un(e,i))},__class__:zn});var En=function(t){if(this.dirty_align=!0,this.dirty_sizing=!0,this.point_ratio=1,this.text_h_h=0,this.text_h_w=0,this.text_height=0,this.text_width=0,this.glow_amount=0,this.glow_threshold=0,this.outline=0,this.thickness=.5,this.smoothness=.75,this.unique=!1,this.sdf=!1,this.bounds_wrap=!1,this.letter_spacing=0,this.line_spacing=0,this.point_size=32,this.text="",this.options=t,this.emitter=new c,null==this.options)throw new ne(Re.null_assertion("options was null ( TextGeometry requires non-null options )"));null!=this.options.sdf&&(this.sdf=this.options.sdf),null==this.options.font&&(this.options.font=_.renderer.font),this.font=this.options.font,this.font==_.renderer.font&&(this.sdf=!0),null==this.options.shader?this.options.shader=this.sdf?_.renderer.shaders.bitmapfont.shader:_.renderer.shaders.textured.shader:this.options.shader!=_.renderer.shaders.bitmapfont.shader&&(this.unique=!0),dn.call(this,this.options),this.set_primitive_type(4),this.cache=[],this.line_widths=[],this.line_offsets=[[],[]],this.lines=[],this.set_outline_color(new ai),this.set_glow_color(new ai),this.default_options()};n["phoenix.geometry.TextGeometry"]=En,En.__name__=["phoenix","geometry","TextGeometry"],En.__super__=dn,En.prototype=e(dn.prototype,{tidy:function(){var t=Math.floor(this.vertices.length/6),e=this.cache.length-t;if(e>0)for(var i=this.cache.splice(t,e),s=i.length;s>0;){s--;var n=i.pop();n=null}},default_options:function(){this.set_texture(this.font.pages.h[0]),null!=this.options.letter_spacing&&this.set_letter_spacing(this.options.letter_spacing),null!=this.options.line_spacing&&this.set_line_spacing(this.options.line_spacing),null!=this.options.point_size&&this.set_point_size(this.options.point_size),null!=this.options.bounds&&this.set_bounds(this.options.bounds),null!=this.options.bounds_wrap&&this.set_bounds_wrap(this.options.bounds_wrap),null==this.options.align&&(this.options.align=0),this.options.align,null==this.options.align_vertical&&(this.options.align_vertical=3),this.options.align_vertical,this.set_align(this.options.align),this.set_align_vertical(this.options.align_vertical),null!=this.options.thickness&&this.set_thickness(this.options.thickness),null!=this.options.smoothness&&this.set_smoothness(this.options.smoothness),null!=this.options.outline&&this.set_outline(this.options.outline),null!=this.options.outline_color&&this.set_outline_color(this.options.outline_color),null!=this.options.glow_threshold&&this.set_glow_threshold(this.options.glow_threshold),null!=this.options.glow_amount&&this.set_glow_amount(this.options.glow_amount),null!=this.options.glow_color&&this.set_glow_color(this.options.glow_color),this.sdf&&this.flush_uniforms(),null!=this.options.text&&this.set_text(this.options.text)},set_text:function(t){return null==t&&(S.trace("i / textgeometry / null text passed into TextGeometry!",{fileName:"TextGeometry.hx",lineNumber:239,className:"phoenix.geometry.TextGeometry",methodName:"set_text"}),t=""),this.text!=t&&(this.text=t,""!=this.text?(this.set_dirty_sizing(!0),this.update_text()):this.vertices.splice(0,this.vertices.length)),this.text},stats:function(){return"letters:"+this.vertices.length/6+" / cache:"+this.cache.length},update_sizes:function(){if(!this.dirty_sizing)return!1;var t=En.tab_regex.replace(this.text,"    ");return this.bounds_wrap&&null!=this.bounds&&(t=this.font.wrap_string_to_bounds(t,this.bounds,this.point_size,this.letter_spacing)),this.lines.splice(0,this.lines.length),this.lines=t.split("\n"),this.line_widths.splice(0,this.line_widths.length),this.text_width=this.font.width_of(t,this.point_size,this.letter_spacing,this.line_widths),this.text_height=this.font.height_of_lines(this.lines,this.point_size,this.line_spacing),this.text_h_w=this.text_width/2,this.text_h_h=this.text_height/2,this.point_ratio=this.point_size/this.font.info.point_size,this.set_dirty_sizing(!1),!0},update_text:function(){var t=this,e=0,i=0,s=null!=this.bounds;s&&(this.transform.local.pos.set_x(e=this.bounds.x),this.transform.local.pos.set_y(i=this.bounds.y));for(var n=0,r=0,o=0,a=0,h=!0,l=(this.update_sizes(),0),_=this.lines;l<_.length;){var u=_[l];++l;var c=0,d=0;if(this.dirty_align){if(s){var f=this.align;switch(f){case 2:c=-(this.line_widths[o]/2)+this.bounds.w/2;break;case 1:c=-this.line_widths[o]+this.bounds.w;break;default:c=0}var p=this.align_vertical;switch(p){case 2:d=this.bounds.h/2-this.text_h_h;break;case 4:d=this.bounds.h-this.text_height;break;default:d=0}}else{var m=this.align;switch(m){case 2:c=-(this.line_widths[o]/2);break;case 1:c=-this.line_widths[o];break;default:c=0}var g=this.align_vertical;switch(g){case 2:d=-this.text_h_h;break;case 4:d=-this.text_height;break;default:d=0}}this.line_offsets[0][o]=c,this.line_offsets[1][o]=d}else c=this.line_offsets[0][o],d=this.line_offsets[1][o];0!=o&&(r+=(t.font.info.line_height+t.line_spacing)*t.point_ratio,n=0);for(var v=0,y=0,w=u,x=0,b=u.length;b>x;){var k;y=x,x+=Ns.codePointWidthAt(w,x),k=Ps.codePointAt(w,y);var z=k,E=this.font.info.chars.h[z];if(h=null!=E&&z>32,h||(E=this.font.space_char),h){var A=c+n+E.xoffset*this.point_ratio,C=d+r+E.yoffset*this.point_ratio,T=this.font.pages.h[E.page],S=E.x/T.width_actual,I=E.y/T.height_actual,N=(E.x+E.width)/T.width_actual,M=(E.y+E.height)/T.height_actual;this.update_char(a,A,C,E.width*this.point_ratio,E.height*this.point_ratio,S,I,N,M,this.color),a++}var R=E.xadvance;v<u.length-1&&(R+=this.font.kerning(z,Bs.uCharCodeAt(u,v+1)),z>=32&&(R+=this.letter_spacing)),R*=this.point_ratio,n+=R,v++}o++}var B=this.vertices.length/6|0,P=B-a;P>0&&this.vertices.splice(6*a,6*P),this.dirty_align=!1,this.emitter.emit(1)},update_char:function(t,e,i,s,n,r,o,a,h,l){var _,u,c,d,f,p,m=this.cache[t];null==m?(_=new Tn(new un(e,i),l),u=new Tn(new un(e+s,i),l),c=new Tn(new un(e+s,i+n),l),d=new Tn(new un(e,i+n),l),f=new Tn(new un(e,i),l),p=new Tn(new un(e+s,i+n),l),m=[_,u,c,d,f,p],this.cache[t]=m):(_=m[0],u=m[1],c=m[2],d=m[3],f=m[4],p=m[5],_.pos.set_xy(e,i),u.pos.set_xy(e+s,i),c.pos.set_xy(e+s,i+n),d.pos.set_xy(e,i+n),f.pos.set_xy(e,i),p.pos.set_xy(e+s,i+n)),_.uv.uv0.set_uv(r,o),u.uv.uv0.set_uv(a,o),c.uv.uv0.set_uv(a,h),d.uv.uv0.set_uv(r,h),f.uv.uv0.set_uv(r,o),p.uv.uv0.set_uv(a,h);var g=Math.floor(this.vertices.length/6);t>=g&&(this.add(_),this.add(u),this.add(c),this.add(d),this.add(f),this.add(p))},set_dirty_sizing:function(t){return this.dirty_align=!0,this.dirty_sizing=t},set_bounds:function(t){return this.bounds=t,this.set_dirty_sizing(!0),this.update_text(),this.bounds},set_bounds_wrap:function(t){return this.bounds_wrap=t,this.set_dirty_sizing(!0),this.update_text(),this.bounds_wrap},set_line_spacing:function(t){return this.line_spacing=t,this.set_dirty_sizing(!0),this.update_text(),this.line_spacing},set_letter_spacing:function(t){return this.letter_spacing=t,this.set_dirty_sizing(!0),this.update_text(),this.letter_spacing},set_align:function(t){return this.align=t,this.dirty_align=!0,this.update_text(),this.align},set_align_vertical:function(t){return this.align_vertical=t,this.dirty_align=!0,this.update_text(),this.align_vertical},set_point_size:function(t){return 0>t&&(t=0),this.point_size=t,this.set_dirty_sizing(!0),this.update_text(),this.point_size},set_smoothness:function(t){return 0>t&&(t=0),null!=this.state.shader&&this.sdf&&this.unique&&this.state.shader.set_float("smoothness",t),this.smoothness=t},set_thickness:function(t){return 0>t&&(t=0),null!=this.state.shader&&this.sdf&&this.unique&&this.state.shader.set_float("thickness",t),this.thickness=t},set_outline:function(t){return t=0>t?0:t>1?1:t,null!=this.state.shader&&this.sdf&&this.unique&&this.state.shader.set_float("outline",t),this.outline=t},set_glow_threshold:function(t){return 0>t&&(t=0),null!=this.state.shader&&this.sdf&&this.unique&&this.state.shader.set_float("glow_threshold",t),this.glow_threshold=t},set_glow_amount:function(t){return 0>t&&(t=0),null!=this.state.shader&&this.sdf&&this.unique&&this.state.shader.set_float("glow_amount",t),this.glow_amount=t},set_outline_color:function(t){return null!=this.state.shader&&this.sdf&&this.unique&&this.state.shader.set_color("outline_color",t),this.outline_color=t},set_glow_color:function(t){return null!=this.state.shader&&this.sdf&&this.unique&&this.state.shader.set_color("glow_color",t),this.glow_color=t},flush_uniforms:function(){null!=this.state.shader&&this.sdf&&(this.state.shader.set_float("smoothness",this.smoothness),this.state.shader.set_float("thickness",this.thickness),this.state.shader.set_float("outline",this.outline),this.state.shader.set_float("glow_threshold",this.glow_threshold),this.state.shader.set_float("glow_amount",this.glow_amount),this.state.shader.set_color("outline_color",this.outline_color),this.state.shader.set_color("glow_color",this.glow_color))},__class__:En,__properties__:e(dn.prototype.__properties__,{set_dirty_sizing:"set_dirty_sizing",set_glow_color:"set_glow_color",set_glow_amount:"set_glow_amount",set_glow_threshold:"set_glow_threshold",set_outline_color:"set_outline_color",set_outline:"set_outline",set_thickness:"set_thickness",set_smoothness:"set_smoothness",set_align_vertical:"set_align_vertical",set_align:"set_align",set_bounds_wrap:"set_bounds_wrap",set_bounds:"set_bounds",set_letter_spacing:"set_letter_spacing",set_line_spacing:"set_line_spacing",set_point_size:"set_point_size",set_text:"set_text"})});var An=function(){this.uv0=new Cn,this.uv1=new Cn,this.uv2=new Cn,this.uv3=new Cn,this.uv4=new Cn,this.uv5=new Cn,this.uv6=new Cn,this.uv7=new Cn};n["phoenix.geometry.TextureCoordSet"]=An,An.__name__=["phoenix","geometry","TextureCoordSet"],An.prototype={clone:function(){var t=new An;return t.uv0.set(this.uv0.u,this.uv0.v,this.uv0.w,this.uv0.t),t.uv1.set(this.uv1.u,this.uv1.v,this.uv1.w,this.uv1.t),t.uv2.set(this.uv2.u,this.uv2.v,this.uv2.w,this.uv2.t),t.uv3.set(this.uv3.u,this.uv3.v,this.uv3.w,this.uv3.t),t.uv4.set(this.uv4.u,this.uv4.v,this.uv4.w,this.uv4.t),t.uv5.set(this.uv5.u,this.uv5.v,this.uv5.w,this.uv5.t),t.uv6.set(this.uv6.u,this.uv6.v,this.uv6.w,this.uv6.t),t.uv7.set(this.uv7.u,this.uv7.v,this.uv7.w,this.uv7.t),t},__class__:An};var Cn=function(t,e,i,s){null==s&&(s=0),null==i&&(i=0),null==e&&(e=0),null==t&&(t=0),this.t=0,this.w=0,this.v=0,this.u=0,this.u=t,this.v=e,this.w=i,this.t=s};n["phoenix.geometry.TextureCoord"]=Cn,Cn.__name__=["phoenix","geometry","TextureCoord"],Cn.prototype={clone:function(){return new Cn(this.u,this.v,this.w,this.t)},set:function(t,e,i,s){return this.u=t,this.v=e,this.w=i,this.t=s,this},set_uv:function(t,e){return this.u=t,this.v=e,this},toString:function(){return"{ u:"+this.v+", v:"+this.v+" }"},__class__:Cn};var Tn=function(t,e,i){this.uv=new An,this.pos=t,this.color=null==e?new ai:e,this.normal=null==i?new un:i};n["phoenix.geometry.Vertex"]=Tn,Tn.__name__=["phoenix","geometry","Vertex"],Tn.prototype={clone:function(){var t=new Tn(this.pos.clone(),this.color.clone(),this.normal.clone());return t.uv=this.uv.clone(),t},__class__:Tn};var Sn=function(){};n["phoenix.utils.Rendering"]=Sn,Sn.__name__=["phoenix","utils","Rendering"],Sn.gl_blend_mode_from_BlendMode=function(t){switch(t){case 0:return 0;case 1:return 1;case 768:return 768;case 769:return 769;case 770:return 770;case 771:return 771;case 772:return 772;case 773:return 773;case 774:return 774;case 775:return 775;case 776:return 776}},Sn.fovx_to_y=function(t,e){return 180/Math.PI*2*Math.atan(Math.tan(t*(Math.PI/180)/2)*(1/e))};var In=function(){this.overflow=0,this.frame_time=.0167,ge.call(this)};n["snow.AppFixedTimestep"]=In,In.__name__=["snow","AppFixedTimestep"],In.__super__=ge,In.prototype=e(ge.prototype,{on_internal_init:function(){ge.prototype.on_internal_init.call(this),this.frame_time=.016666666666666666,this.last_frame_start=Nn.core.timestamp()
},on_internal_update:function(){for(this.cur_frame_start=Nn.core.timestamp(),this.delta_time=this.cur_frame_start-this.last_frame_start,this.delta_sim=this.delta_time*this.timescale,this.delta_sim>this.max_frame_time&&(this.delta_sim=this.max_frame_time),this.last_frame_start=this.cur_frame_start,this.overflow+=this.delta_sim;this.overflow>=this.frame_time;)this.app.do_internal_update(this.frame_time*this.timescale),this.current_time+=this.frame_time*this.timescale,this.overflow-=this.frame_time*this.timescale;this.alpha=this.overflow/this.frame_time},__class__:In});var Nn=function(){this.is_ready=!1,this.was_ready=!1,this.has_shutdown=!1,this.shutting_down=!1,this.debug=!1,this.os="unknown",this.platform="unknown",this.freeze=!1,this.platform="web",Nn.core=new Vn(this),Nn.next_queue=[]};n["snow.Snow"]=Nn,Nn.__name__=["snow","Snow"],Nn.__properties__={get_timestamp:"get_timestamp"},Nn.next=function(t){null!=t&&Nn.next_queue.push(t)},Nn.get_timestamp=function(){return Nn.core.timestamp()},Nn.prototype={shutdown:function(){this.shutting_down=!0,this.host.ondestroy(),this.io.module.destroy(),this.audio.destroy(),this.input.destroy(),this.windowing.destroy(),Nn.core.shutdown(),this.has_shutdown=!0},render:function(){this.windowing.update()},dispatch_system_event:function(t){this.on_event(t)},init:function(t,e){this.snow_config=t,null==this.snow_config.app_package&&(this.snow_config.app_package="org.snowkit.snow"),this.config=this.default_config(),this.host=e,this.host.app=this,Nn.core.init(s(this,this.on_event))},on_snow_init:function(){this.host.on_internal_init()},on_snow_ready:function(){var t=this;if(this.was_ready)throw new ne(gr.error("firing ready event more than once is invalid usage"));for(this.io=new fr(this),this.input=new dr(this),this.audio=new cr(this),this.assets=new ur(this),this.windowing=new mr(this),this.was_ready=!0,this.setup_app_path(),this.setup_default_assets().then(function(){t.setup_configs().then(function(){t.setup_default_window(),Nn.next(s(t,t.on_ready))})}).error(function(t){throw new ne(gr.init("snow / cannot recover from error: "+t))}),Ln.step();Nn.next_queue.length>0;)this.cycle_next_queue()},do_internal_update:function(t){this.io.module.update(),this.input.update(),this.audio.update(),this.host.update(t)},on_ready:function(){this.is_ready=!0,this.host.ready()},on_snow_update:function(){this.freeze||(Dn.update(),Ln.step(),this.cycle_next_queue(),this.is_ready&&(this.host.on_internal_update(),this.host.on_internal_render()))},on_event:function(t){3!=t.type&&0!=t.type&&5!=t.type&&6!=t.type,3!=t.type,this.is_ready&&(this.io.module.on_event(t),this.audio.on_event(t),this.windowing.on_event(t),this.input.on_event(t)),this.host.onevent(t);var e=t.type;if(null!=e)switch(e){case 1:this.on_snow_init();break;case 2:this.on_snow_ready();break;case 3:this.on_snow_update();break;case 7:case 8:this.shutdown();break;case 4:S.trace("     i / snow / Goodbye.",{fileName:"Snow.hx",lineNumber:325,className:"snow.Snow",methodName:"on_event"})}},cycle_next_queue:function(){var t=Nn.next_queue.length;if(t>0)for(var e=0;t>e;){{e++}Nn.next_queue.shift()()}},setup_app_path:function(){},setup_default_assets:function(){var t=this;return this.snow_config.config_custom_assets?Fn.resolve():new Fn(function(e){t.assets.manifest_path=t.snow_config.config_assets_path,t.default_asset_list().then(function(e){t.assets.list=e}).error(function(){}).then(e)})},setup_configs:function(){var t=this;return this.snow_config.config_custom_runtime?(this.setup_host_config(),Fn.resolve()):new Fn(function(e){t.default_runtime_config().then(function(e){t.config.runtime=e}).error(function(t){throw new ne(gr.init("config / failed / default runtime config failed to parse as JSON. cannot recover. "+t))}).then(function(){t.setup_host_config(),e()})})},setup_host_config:function(){this.config=this.host.config(this.config)},setup_default_window:function(){if(1==this.config.has_window&&(this.window=this.windowing.create(this.config.window),null==this.window.handle))throw new ne(gr.windowing("requested default window cannot be created. cannot continue"))},default_config:function(){return{has_window:!0,runtime:{},window:this.default_window_config(),render:this.default_render_config(),web:{no_context_menu:!0,prevent_default_keys:[Wn.left,Wn.right,Wn.up,Wn.down,Wn.backspace,Wn.tab,Wn["delete"]],prevent_default_mouse_wheel:!0,true_fullscreen:!1},"native":{audio_buffer_length:176400,audio_buffer_count:4}}},default_runtime_config:function(){var t=this;return new Fn(function(e,i){var s=t.io.data_flow(t.snow_config.config_runtime_path,_r.processor);s.then(e).error(function(t){switch(t[1]){case 3:{t[2]}i(t);break;default:e()}})})},default_asset_list:function(){var t=this;return new Fn(function(e,i){var s=t.assets.root+t.assets.manifest_path,n=t.io.data_flow(s,_r.processor);n.then(function(t){var i=t;e(i)}).error(i)})},default_render_config:function(){return{depth:!1,stencil:!1,antialiasing:0,red_bits:8,green_bits:8,blue_bits:8,alpha_bits:8,depth_bits:0,stencil_bits:0,opengl:{minor:0,major:0,profile:0}}},default_window_config:function(){var t={fullscreen_desktop:!0,fullscreen:!1,borderless:!1,resizable:!0,x:536805376,y:536805376,width:960,height:640,title:"snow app"};return t},set_freeze:function(t){return this.freeze=t,t?this.audio.suspend():this.audio.resume(),this.freeze},get_time:function(){return Nn.core.timestamp()},get_uniqueid:function(){return this.make_uniqueid()},make_uniqueid:function(t){null==t&&(t=v.random(2147483647));var e=t%62|0,i=t/62|0;return i>0?this.make_uniqueid(i)+(e>9?function(){var t,i=65+(e-10);return i>90&&(i+=6),t=String.fromCharCode(i)}(this):(null==e?"null":""+e).charAt(0)):v.string(e>9?function(){var t,i=65+(e-10);return i>90&&(i+=6),t=String.fromCharCode(i)}(this):(null==e?"null":""+e).charAt(0))},typename:function(t){return b.getClassName(b.getClass(t))},__class__:Nn,__properties__:{set_freeze:"set_freeze",get_uniqueid:"get_uniqueid",get_time:"get_time"}};var Mn=n["snow.api._Debug.LogError"]={__ename__:["snow","api","_Debug","LogError"],__constructs__:["RequireString"]};Mn.RequireString=function(t){var e=["RequireString",0,t];return e.__enum__=Mn,e.toString=r,e};var Rn=function(){};n["snow.api.Debug"]=Rn,Rn.__name__=["snow","api","Debug"],Rn._get_spacing=function(t){var e="",i=t.length+4,s=Rn._log_width-i;if(s>0)for(var n=0;s>n;){{n++}e+=" "}return e};var Bn=n["snow.api.DebugError"]={__ename__:["snow","api","DebugError"],__constructs__:["assertion","null_assertion"]};Bn.assertion=function(t){var e=["assertion",0,t];return e.__enum__=Bn,e.toString=r,e},Bn.null_assertion=function(t){var e=["null_assertion",1,t];return e.__enum__=Bn,e.toString=r,e};var Pn=function(){};n["snow.api.Libs"]=Pn,Pn.__name__=["snow","api","Libs"],Pn.tryLoad=function(){return null},Pn.findHaxeLib=function(){try{}catch(t){t instanceof ne&&(t=t.val)}return""},Pn.get_system_name=function(){return window.navigator.userAgent},Pn.web_add_lib=function(t,e){null==Pn._web_libs&&(Pn._web_libs=new V);var i=e;return Pn._web_libs.set(t,i),!0},Pn.web_lib_load=function(t,e){null==Pn._web_libs&&(Pn._web_libs=new V);var i=Pn._web_libs.get(t);return null!=i?p.field(i,e):null},Pn.load=function(t,e,i){null==i&&(i=0);var s=Pn.web_lib_load(t,e);if(s)return s;null==Pn.__moduleNames&&(Pn.__moduleNames=new V),Pn.__moduleNames.exists(t),Pn.__moduleNames.set(t,t);var n=Pn.tryLoad("./"+t,t,e,i);if(null==n&&(n=Pn.tryLoad(".\\"+t,t,e,i)),null==n&&(n=Pn.tryLoad(t,t,e,i)),null==n){var r;r="windows"==function(){var t,e=Pn.get_system_name();return t=a.substr(e,7,null)}(this).toLowerCase()?"\\":"/";var o=Pn.findHaxeLib("snow");""!=o&&(n=Pn.tryLoad(o+r+"ndll"+r+Pn.get_system_name()+r+t,t,e,i),null==n&&(n=Pn.tryLoad(o+r+"ndll"+r+Pn.get_system_name()+"64"+r+t,t,e,i)))}return Pn.loaderTrace("Result : "+v.string(n)),n},Pn.loaderTrace=function(){};var Fn=function(t){this.was_caught=!1;var e=this;this.state=0,this.reject_reactions=[],this.fulfill_reactions=[],this.settle_reactions=[],Ln.queue(function(){t(s(e,e.onfulfill),s(e,e.onreject)),Ln.defer(Ln.next)})};n["snow.api.Promise"]=Fn,Fn.__name__=["snow","api","Promise"],Fn.all=function(t){return new Fn(function(e,i){for(var s=0,n=t.length,r=[],o=null,a=0,h=function(t,i){0==a&&(s++,r[t]=i,n==s&&(a=1,e(r)))},l=function(t){0==a&&(a=2,o=t,i(o))},_=0,u=0;u<t.length;){var c=t[u];++u,c.then(function(t,e){return function(i){t(e,i)}}(h,_)).error(l),_++}})},Fn.race=function(t){return new Fn(function(e,i){for(var s=!1,n=function(t){s||(s=!0,e(t))},r=function(t){s||(s=!0,i(t))},o=0;o<t.length;){var a=t[o];++o,a.then(n).error(r)}})},Fn.reject=function(t){return new Fn(function(e,i){i(t)})},Fn.resolve=function(t){return new Fn(function(e){e(t)})},Fn.prototype={then:function(t,e){var i=this.state;switch(i){case 0:return this.add_fulfill(t),this.add_reject(e),this.new_linked_promise();case 1:return Ln.defer(t,this.result),Fn.resolve(this.result);case 2:return Ln.defer(e,this.result),Fn.reject(this.result)}},error:function(t){var e=this.state;switch(e){case 0:return this.add_reject(t),this.new_linked_resolve_empty();case 1:return Fn.resolve(this.result);case 2:return Ln.defer(t,this.result),Fn.reject(this.result)}},toString:function(){return"Promise { state:"+this.state_string()+", result:"+v.string(this.result)+" }"},add_settle:function(t){0==this.state?this.settle_reactions.push(t):Ln.defer(t,this.result)},new_linked_promise:function(){var t=this;return new Fn(function(e,i){t.add_settle(function(){1==t.state?e(t.result):i(t.result)})})},new_linked_resolve:function(){var t=this;return new Fn(function(e){t.add_settle(function(t){e(t)})})},new_linked_reject:function(){var t=this;return new Fn(function(e,i){t.add_settle(function(t){i(t)})})},new_linked_resolve_empty:function(){var t=this;return new Fn(function(e){t.add_settle(function(){e()})})},new_linked_reject_empty:function(){var t=this;return new Fn(function(e,i){t.add_settle(function(){i()})})},add_fulfill:function(t){null!=t&&this.fulfill_reactions.push(t)},add_reject:function(t){null!=t&&(this.was_caught=!0,this.reject_reactions.push(t))},onfulfill:function(t){for(this.state=1,this.result=t;this.fulfill_reactions.length>0;){var e=this.fulfill_reactions.shift();e(this.result)}this.onsettle()},onreject:function(t){for(this.state=2,this.result=t;this.reject_reactions.length>0;){var e=this.reject_reactions.shift();e(this.result)}this.onsettle()},onsettle:function(){for(;this.settle_reactions.length>0;){var t=this.settle_reactions.shift();t(this.result)}},onexception:function(t){var e=this;this.add_settle(function(){if(!e.was_caught&&2==e.state)throw new ne(On.UnhandledPromiseRejection(e.toString()))}),0==this.state&&this.onreject(t)},state_string:function(){var t=this.state;switch(t){case 0:return"pending";case 1:return"fulfilled";case 2:return"rejected"}},__class__:Fn};var Ln=function(){};n["snow.api.Promises"]=Ln,Ln.__name__=["snow","api","Promises"],Ln.step=function(){for(Ln.next();Ln.defers.length>0;){var t=Ln.defers.shift();t.f(t.a)}},Ln.next=function(){Ln.calls.length>0&&Ln.calls.shift()()},Ln.defer=function(t,e){null!=t&&Ln.defers.push({f:t,a:e})},Ln.queue=function(t){null!=t&&Ln.calls.push(t)};var On=n["snow.api.PromiseError"]={__ename__:["snow","api","PromiseError"],__constructs__:["UnhandledPromiseRejection"]};On.UnhandledPromiseRejection=function(t){var e=["UnhandledPromiseRejection",0,t];return e.__enum__=On,e.toString=r,e};var Dn=function(t){this.time=t,Dn.running_timers.push(this),this.fire_at=Nn.core.timestamp()+this.time,this.running=!0};n["snow.api.Timer"]=Dn,Dn.__name__=["snow","api","Timer"],Dn.measure=function(t,e){var i=Nn.core.timestamp(),s=t();return S.trace(Nn.core.timestamp()-i+"s",e),s},Dn.update=function(){for(var t=Nn.core.timestamp(),e=0,i=Dn.running_timers;e<i.length;){var s=i[e];++e,s.running&&s.fire_at<t&&(s.fire_at+=s.time,s.run())}},Dn.delay=function(t,e){var i=new Dn(t);return i.run=function(){i.stop(),e()},i},Dn.prototype={run:function(){},stop:function(){this.running&&(this.running=!1,a.remove(Dn.running_timers,this))},__class__:Dn};var Un={};n["snow.api.buffers._Float32Array.Float32Array_Impl_"]=Un,Un.__name__=["snow","api","buffers","_Float32Array","Float32Array_Impl_"],Un.__set=function(t,e,i){return t[e]=i},Un.__get=function(t,e){return t[e]},Un.fromBytes=function(t,e,i){return null==e&&(e=0),null==e?new Float32Array(t.b.bufferValue):null==i?new Float32Array(t.b.bufferValue,e):new Float32Array(t.b.bufferValue,e,i)},Un.toBytes=function(t){return new F(new Tr(t.buffer))},Un.toString=function(t){return"Float32Array [byteLength:"+t.byteLength+", length:"+t.length+"]"};var Gn={};n["snow.api.buffers._Int32Array.Int32Array_Impl_"]=Gn,Gn.__name__=["snow","api","buffers","_Int32Array","Int32Array_Impl_"],Gn.__set=function(t,e,i){return t[e]=i},Gn.__get=function(t,e){return t[e]},Gn.fromBytes=function(t,e,i){return null==e&&(e=0),null==e?new Int32Array(t.b.bufferValue):null==i?new Int32Array(t.b.bufferValue,e):new Int32Array(t.b.bufferValue,e,i)},Gn.toBytes=function(t){return new F(new Tr(t.buffer))},Gn.toString=function(t){return"Int32Array [byteLength:"+t.byteLength+", length:"+t.length+"]"};var jn={};n["snow.api.buffers._Uint8Array.Uint8Array_Impl_"]=jn,jn.__name__=["snow","api","buffers","_Uint8Array","Uint8Array_Impl_"],jn.__set=function(t,e,i){return t[e]=i},jn.__get=function(t,e){return t[e]},jn.fromBytes=function(t,e,i){return null==e?new Tr(t.b.bufferValue):null==i?new Tr(t.b.bufferValue,e):new Tr(t.b.bufferValue,e,i)},jn.toBytes=function(t){return new F(new Tr(t.buffer))},jn.toString=function(t){return"Uint8Array [byteLength:"+t.byteLength+", length:"+t.length+"]"};var Vn=function(t){this._time_now=0,this._lf_timestamp=.016,this.start_timestamp=0,this.app=t,this.start_timestamp=this.timestamp(),this.guess_os()};n["snow.core.web.Core"]=Vn,Vn.__name__=["snow","core","web","Core"],Vn.prototype={init:function(){this.app.on_event({type:1}),this.app.on_event({type:2}),this.app.snow_config.has_loop&&this.request_update()},shutdown:function(){},timestamp:function(){var t;return t=null!=window.performance?window.performance.now()/1e3:M.stamp(),t-this.start_timestamp},request_update:function(){var t=this;null!=(vr=window,s(vr,vr.requestAnimationFrame))?window.requestAnimationFrame(s(this,this.snow_core_loop)):(S.trace("     i / core / warning : requestAnimationFrame not found, falling back to render_rate! render_rate:"+this.app.host.render_rate,{fileName:"Core.hx",lineNumber:80,className:"snow.core.web.Core",methodName:"request_update"}),window.setTimeout(function(){var e=t.timestamp();t._time_now+=e-t._lf_timestamp,t.snow_core_loop(1e3*t._time_now),t._lf_timestamp=e},1e3*this.app.host.render_rate|0))},snow_core_loop:function(t){return null==t&&(t=.016),this.update(),this.app.on_event({type:3}),this.request_update(),!0},update:function(){},guess_os:function(){var t=window.navigator.appVersion,e=window.navigator.userAgent;(function(){var e,i=new o("mac","gi");return e=i.match(t)})(this)&&(this.app.os="mac"),function(){var e,i=new o("win","gi");return e=i.match(t)}(this)&&(this.app.os="windows"),function(){var e,i=new o("x11","gi");return e=i.match(t)}(this)&&(this.app.os="linux"),function(){var e,i=new o("linux","gi");return e=i.match(t)}(this)&&(this.app.os="linux"),function(){var e,i=new o("android","gi");return e=i.match(t)}(this)&&(this.app.os="android"),function(){var t,i=new o("ipad","gi");return t=i.match(e)}(this)&&(this.app.os="ios"),function(){var t,i=new o("iphone","gi");return t=i.match(e)}(this)&&(this.app.os="ios"),function(){var t,i=new o("ipod","gi");return t=i.match(e)}(this)&&(this.app.os="ios")},__class__:Vn};var qn=function(){};n["snow.modules.interfaces.Assets"]=qn,qn.__name__=["snow","modules","interfaces","Assets"],qn.prototype={__class__:qn};var Xn=function(t){this.system=t};n["snow.core.web.assets.Assets"]=Xn,Xn.__name__=["snow","core","web","assets","Assets"],Xn.__interfaces__=[qn],Xn.prototype={init:function(){},update:function(){},destroy:function(){},on_event:function(){},image_load_info:function(t,e){return null==e&&(e=4),this.system.app.io.data_flow(t,ar.processor)},image_info_from_element:function(t,e){var i=this.nearest_power_of_two(e.width),s=this.nearest_power_of_two(e.height),n=this.POT_bytes_from_element(e.width,e.height,i,s,e),r={id:t,bpp:4,width:e.width,height:e.height,width_actual:i,height_actual:s,bpp_source:4,pixels:n};return n=null,r},image_info_from_pixels:function(t,e,i,s){var n=this.nearest_power_of_two(e),r=this.nearest_power_of_two(i),o=this.POT_bytes_from_pixels(e,i,n,r,s),a={id:t,bpp:4,width:e,height:i,width_actual:n,height_actual:r,bpp_source:4,pixels:o};return o=null,a},image_info_from_bytes:function(t,e,i){null==i&&(i=4);var s=this;if(null==t)throw new ne(Bn.null_assertion("_id was null"));if(null==e)throw new ne(Bn.null_assertion("_bytes was null"));if(0==e.length)throw new ne(Bn.assertion("_bytes.length != 0"));var n=Q.extension(t);return new Fn(function(i,r){for(var o="",a=0,h=e.length;h>a;)o+=String.fromCharCode(function(){var t,i,s=a++;return i=e[s],t=255&i}(this));var l=window.btoa(o),_="data:image/"+n+";base64,"+l,u=new Image;u.onload=function(){var e=s.image_info_from_element(t,u);i(e)},u.onerror=function(t){r(gr.error("failed to load image from bytes, on error: "+t))},u.src=_})},POT_bytes_from_pixels:function(t,e,i,s,n){var r,o=window.document;r=o.createElement("canvas"),r.width=i,r.height=s;var a=r.getContext("2d",null);a.clearRect(0,0,r.width,r.height);var h=null,l=new Uint8ClampedArray(n.buffer),_=a.createImageData(t,e);_.data.set(l);try{a.putImageData(_,0,0),h=a.getImageData(0,0,r.width,r.height)}catch(u){u instanceof ne&&(u=u.val);var c="- textures served from file:/// throw security errors\n";throw c+="- textures served over http:// work for cross origin byte requests",S.trace("   i / assets / "+c,{fileName:"Assets.hx",lineNumber:199,className:"snow.core.web.assets.Assets",methodName:"POT_bytes_from_pixels"}),new ne(u)}r=null,a=null,_=null;var d,f=h.data;return d=null!=f?new Tr(f):null},POT_bytes_from_element:function(t,e,i,s,n){var r,o=window.document;r=o.createElement("canvas"),r.width=i,r.height=s;var a=r.getContext("2d",null);a.clearRect(0,0,r.width,r.height),a.drawImage(n,0,0,t,e);var h=null;try{h=a.getImageData(0,0,r.width,r.height)}catch(l){l instanceof ne&&(l=l.val);var _="- textures served from file:/// throw security errors\n";throw _+="- textures served over http:// work for cross origin byte requests",S.trace("   i / assets / "+_,{fileName:"Assets.hx",lineNumber:235,className:"snow.core.web.assets.Assets",methodName:"POT_bytes_from_element"}),new ne(l)}r=null,a=null;var u,c=h.data;return u=null!=c?new Tr(c):null},nearest_power_of_two:function(t){return Xn.POT?(t--,t|=t>>1,t|=t>>2,t|=t>>4,t|=t>>8,t|=t>>16,t++,t):t},__class__:Xn};var Zn=function(){};n["snow.core.web.input.DOMKeys"]=Zn,Zn.__name__=["snow","core","web","input","DOMKeys"],Zn.dom_key_to_keycode=function(t){switch(t){case 16:return Wn.lshift;case 17:return Wn.lctrl;case 18:return Wn.lalt;case 20:return Wn.capslock;case 33:return Wn.pageup;case 34:return Wn.pagedown;case 35:return Wn.end;case 36:return Wn.home;case 37:return Wn.left;case 38:return Wn.up;case 39:return Wn.right;case 40:return Wn.down;case 44:return Wn.printscreen;case 45:return Wn.insert;case 46:return Wn["delete"];case 91:return Wn.lmeta;case 93:return Wn.rmeta;case 224:return Wn.lmeta;case 96:return Wn.kp_0;case 97:return Wn.kp_1;case 98:return Wn.kp_2;case 99:return Wn.kp_3;case 100:return Wn.kp_4;case 101:return Wn.kp_5;case 102:return Wn.kp_6;case 103:return Wn.kp_7;case 104:return Wn.kp_8;case 105:return Wn.kp_9;case 106:return Wn.kp_multiply;case 107:return Wn.kp_plus;case 109:return Wn.kp_minus;case 110:return Wn.kp_decimal;case 111:return Wn.kp_divide;case 144:return Wn.numlockclear;case 112:return Wn.f1;case 113:return Wn.f2;case 114:return Wn.f3;case 115:return Wn.f4;case 116:return Wn.f5;case 117:return Wn.f6;case 118:return Wn.f7;case 119:return Wn.f8;case 120:return Wn.f9;case 121:return Wn.f10;case 122:return Wn.f11;case 123:return Wn.f12;case 124:return Wn.f13;case 125:return Wn.f14;case 126:return Wn.f15;case 127:return Wn.f16;case 128:return Wn.f17;case 129:return Wn.f18;case 130:return Wn.f19;case 131:return Wn.f20;case 132:return Wn.f21;case 133:return Wn.f22;case 134:return Wn.f23;case 135:return Wn.f24;case 160:return Wn.caret;case 161:return Wn.exclaim;case 162:return Wn.quotedbl;case 163:return Wn.hash;case 164:return Wn.dollar;case 165:return Wn.percent;case 166:return Wn.ampersand;case 167:return Wn.underscore;case 168:return Wn.leftparen;case 169:return Wn.rightparen;case 170:return Wn.asterisk;case 171:return Wn.plus;case 172:return Wn.backslash;case 173:return Wn.minus;case 174:return Wn.leftbracket;case 175:return Wn.rightbracket;case 176:return Wn.backquote;case 181:return Wn.audiomute;case 182:return Wn.volumedown;case 183:return Wn.volumeup;case 188:return Wn.comma;case 190:return Wn.period;case 191:return Wn.slash;case 192:return Wn.backquote;case 219:return Wn.leftbracket;case 221:return Wn.rightbracket;case 220:return Wn.backslash;case 222:return Wn.quote}return t};var Hn=function(){};n["snow.modules.interfaces.Input"]=Hn,Hn.__name__=["snow","modules","interfaces","Input"],Hn.prototype={__class__:Hn};var Kn=function(){};n["snow.system.input.Scancodes"]=Kn,Kn.__name__=["snow","system","input","Scancodes"],Kn.$name=function(t){var e=null;return t>=0&&t<Kn.scancode_names.length&&(e=Kn.scancode_names[t]),null!=e?e:""};var Wn=function(){};n["snow.system.input.Keycodes"]=Wn,Wn.__name__=["snow","system","input","Keycodes"],Wn.from_scan=function(t){return t|Kn.MASK},Wn.to_scan=function(t){if(0!=(t&Kn.MASK))return t&~Kn.MASK;switch(t){case 13:return Kn.enter;case 27:return Kn.escape;case 8:return Kn.backspace;case 9:return Kn.tab;case 32:return Kn.space;case 47:return Kn.slash;case 48:return Kn.key_0;case 49:return Kn.key_1;case 50:return Kn.key_2;case 51:return Kn.key_3;case 52:return Kn.key_4;case 53:return Kn.key_5;case 54:return Kn.key_6;case 55:return Kn.key_7;case 56:return Kn.key_8;case 57:return Kn.key_9;case 59:return Kn.semicolon;case 61:return Kn.equals;case 91:return Kn.leftbracket;case 92:return Kn.backslash;case 93:return Kn.rightbracket;case 96:return Kn.grave;case 97:return Kn.key_a;case 98:return Kn.key_b;case 99:return Kn.key_c;case 100:return Kn.key_d;case 101:return Kn.key_e;case 102:return Kn.key_f;case 103:return Kn.key_g;case 104:return Kn.key_h;case 105:return Kn.key_i;case 106:return Kn.key_j;case 107:return Kn.key_k;case 108:return Kn.key_l;case 109:return Kn.key_m;case 110:return Kn.key_n;case 111:return Kn.key_o;case 112:return Kn.key_p;case 113:return Kn.key_q;case 114:return Kn.key_r;case 115:return Kn.key_s;case 116:return Kn.key_t;case 117:return Kn.key_u;case 118:return Kn.key_v;case 119:return Kn.key_w;case 120:return Kn.key_x;case 121:return Kn.key_y;case 122:return Kn.key_z}return Kn.unknown},Wn.$name=function(t){if(0!=(t&Kn.MASK))return Kn.$name(t&~Kn.MASK);switch(t){case 13:return Kn.$name(Kn.enter);case 27:return Kn.$name(Kn.escape);case 8:return Kn.$name(Kn.backspace);case 9:return Kn.$name(Kn.tab);case 32:return Kn.$name(Kn.space);case 127:return Kn.$name(Kn["delete"]);default:var e=new B;return e.__b+=String.fromCharCode(t),e.__b}};var Qn=function(t){this.gamepads_supported=!1,this.system=t};n["snow.core.web.input.Input"]=Qn,Qn.__name__=["snow","core","web","input","Input"],Qn.__interfaces__=[Hn],Qn.prototype={init:function(){window.document.addEventListener("keypress",s(this,this.on_keypress)),window.document.addEventListener("keydown",s(this,this.on_keydown)),window.document.addEventListener("keyup",s(this,this.on_keyup)),this.active_gamepads=new U,this.gamepads_supported=null!=this.get_gamepad_list(),window.DeviceOrientationEvent&&(window.addEventListener("deviceorientation",s(this,this.on_orientation)),window.addEventListener("devicemotion",s(this,this.on_motion))),S.trace("    i / input / Gamepads supported: "+v.string(this.gamepads_supported),{fileName:"Input.hx",lineNumber:51,className:"snow.core.web.input.Input",methodName:"init"})},update:function(){this.gamepads_supported&&this.poll_gamepads()},destroy:function(){},listen:function(t){t.handle.addEventListener("contextmenu",s(this,this.on_contextmenu)),t.handle.addEventListener("mousedown",s(this,this.on_mousedown)),t.handle.addEventListener("mouseup",s(this,this.on_mouseup)),t.handle.addEventListener("mousemove",s(this,this.on_mousemove)),t.handle.addEventListener("mousewheel",s(this,this.on_mousewheel)),t.handle.addEventListener("wheel",s(this,this.on_mousewheel)),t.handle.addEventListener("touchstart",s(this,this.on_touchdown)),t.handle.addEventListener("touchend",s(this,this.on_touchup)),t.handle.addEventListener("touchmove",s(this,this.on_touchmove))},unlisten:function(){},on_event:function(){},text_input_start:function(){},text_input_stop:function(){},text_input_rect:function(){},on_orientation:function(t){this.system.app.dispatch_system_event({type:6,input:{type:4,timestamp:Nn.core.timestamp(),event:{type:"orientation",alpha:t.alpha,beta:t.beta,gamma:t.gamma}}})},on_motion:function(t){this.system.app.dispatch_system_event({type:6,input:{type:4,timestamp:Nn.core.timestamp(),event:{type:"motion",acceleration:t.acceleration,accelerationIncludingGravity:t.accelerationIncludingGravity,rotationRate:t.rotationRate}}})},gamepad_add:function(){},gamepad_remove:function(){},poll_gamepads:function(){if(this.gamepads_supported){var t=this.get_gamepad_list();if(null!=t)for(var e=0,i=t.length;i>e;){var s=e++;if(null!=t[s])this.handle_gamepad(t[s]);else{var n=this.active_gamepads.h[s];null!=n&&this.system.dispatch_gamepad_device_event(n.index,2,Nn.core.timestamp()),this.active_gamepads.remove(s)}}}},handle_gamepad:function(t){if(null!=t)if(function(e){var i,s=t.index;return i=e.active_gamepads.h.hasOwnProperty(s)}(this)){var e,i=t.index;e=this.active_gamepads.h[i],e.id!=t.id&&(e.id=t.id);for(var s=[],n=[],r=e.axes,o=e.buttons,a=t.axes,h=t.buttons,l=0,_=0;_<a.length;){var u=a[_];++_,u!=r[l]&&(s.push(l),e.axes[l]=u),l++}for(var c=0,d=0;d<h.length;){var f=h[d];++d,f.value!=o[c].value&&(n.push(c),e.buttons[c].pressed=f.pressed,e.buttons[c].value=f.value),c++}for(var p=0;p<s.length;){var m=s[p];++p,this.system.dispatch_gamepad_axis_event(e.index,m,a[m],e.timestamp)}for(var g=0;g<n.length;){var v=n[g];++g,1==h[v].pressed?this.system.dispatch_gamepad_button_down_event(e.index,v,h[v].value,e.timestamp):this.system.dispatch_gamepad_button_up_event(e.index,v,h[v].value,e.timestamp)}}else{for(var y={id:t.id,index:t.index,axes:[],buttons:[],timestamp:Nn.core.timestamp()},w=t.axes,x=0;x<w.length;){var b=w[x];++x,y.axes.push(b)}for(var k=t.buttons,z=0;z<k.length;){{k[z]}++z,y.buttons.push({pressed:!1,value:0})}this.active_gamepads.h[y.index]=y,this.system.dispatch_gamepad_device_event(y.index,1,y.timestamp)}},fail_gamepads:function(){this.gamepads_supported=!1,S.trace("    i / input / Gamepads are not supported in this browser :(",{fileName:"Input.hx",lineNumber:309,className:"snow.core.web.input.Input",methodName:"fail_gamepads"})},get_gamepad_list:function(){return null!=(vr=window.navigator,s(vr,vr.getGamepads))?window.navigator.getGamepads():null!=window.navigator.webkitGetGamepads?window.navigator.webkitGetGamepads():(this.fail_gamepads(),null)},on_mousedown:function(t){var e=this.system.app.windowing.window_from_handle(t.target);this.system.dispatch_mouse_down_event(t.pageX-window.pageXOffset-e.x,t.pageY-window.pageYOffset-e.y,t.button+1,t.timeStamp,e.id)},on_mouseup:function(t){var e=this.system.app.windowing.window_from_handle(t.target);this.system.dispatch_mouse_up_event(t.pageX-window.pageXOffset-e.x,t.pageY-window.pageYOffset-e.y,t.button+1,t.timeStamp,e.id)},on_mousemove:function(t){var e=this.system.app.windowing.window_from_handle(t.target),i=t.movementX,s=t.movementY;null!=t.webkitMovementX?(i=t.webkitMovementX,s=t.webkitMovementY):null!=t.mozMovementX&&(i=t.mozMovementX,s=t.mozMovementY),this.system.dispatch_mouse_move_event(t.pageX-window.pageXOffset-e.x,t.pageY-window.pageYOffset-e.y,i,s,t.timeStamp,e.id)},on_mousewheel:function(t){this.system.app.config.web.prevent_default_mouse_wheel&&t.preventDefault();var e=this.system.app.windowing.window_from_handle(t.target),i=0,s=0;null!=t.deltaY?s=t.deltaY:null!=t.wheelDeltaY&&(s=-t.wheelDeltaY/3|0),null!=t.deltaX?i=t.deltaX:null!=t.wheelDeltaX&&(i=-t.wheelDeltaX/3|0),this.system.dispatch_mouse_wheel_event(Math.round(i/16),Math.round(s/16),t.timeStamp,e.id)},on_contextmenu:function(t){this.system.app.config.web.no_context_menu&&t.preventDefault()},on_keypress:function(t){if(0!=t.which&&-1==a.indexOf(Qn._keypress_blacklist,t.keyCode,0)){var e=String.fromCharCode(t.charCode);this.system.dispatch_text_event(e,0,e.length,2,t.timeStamp,1)}},on_keydown:function(t){var e=this.convert_keycode(t.keyCode),i=Wn.to_scan(e),s=this.mod_state_from_event(t);-1!=a.indexOf(this.system.app.config.web.prevent_default_keys,e,0)&&t.preventDefault(),this.system.dispatch_key_down_event(e,i,t.repeat,s,t.timeStamp,1)},on_keyup:function(t){var e=this.convert_keycode(t.keyCode),i=Wn.to_scan(e),s=this.mod_state_from_event(t);-1!=a.indexOf(this.system.app.config.web.prevent_default_keys,e,0)&&t.preventDefault(),this.system.dispatch_key_up_event(e,i,t.repeat,s,t.timeStamp,1)},mod_state_from_event:function(t){var e=!(t.altKey||t.ctrlKey||t.metaKey||t.shiftKey);return{none:e,lshift:t.shiftKey,rshift:t.shiftKey,lctrl:t.ctrlKey,rctrl:t.ctrlKey,lalt:t.altKey,ralt:t.altKey,lmeta:t.metaKey,rmeta:t.metaKey,num:!1,caps:!1,mode:!1,ctrl:t.ctrlKey,shift:t.shiftKey,alt:t.altKey,meta:t.metaKey}},convert_keycode:function(t){return t>=65&&90>=t?t+32:Zn.dom_key_to_keycode(t)},on_touchdown:function(t){for(var e=this.system.app.windowing.window_from_handle(t.target),i=0,s=t.changedTouches;i<s.length;){var n=s[i];++i;var r=n.pageX-window.pageXOffset-e.x,o=n.pageY-window.pageYOffset-e.y;r/=e.width,o/=e.height,this.system.dispatch_touch_down_event(r,o,n.identifier,Nn.core.timestamp())}},on_touchup:function(t){for(var e=this.system.app.windowing.window_from_handle(t.target),i=0,s=t.changedTouches;i<s.length;){var n=s[i];++i;var r=n.pageX-window.pageXOffset-e.x,o=n.pageY-window.pageYOffset-e.y;r/=e.width,o/=e.height,this.system.dispatch_touch_up_event(r,o,n.identifier,Nn.core.timestamp())}},on_touchmove:function(t){for(var e=this.system.app.windowing.window_from_handle(t.target),i=0,s=t.changedTouches;i<s.length;){var n=s[i];++i;var r=n.pageX-window.pageXOffset-e.x,o=n.pageY-window.pageYOffset-e.y;r/=e.width,o/=e.height,this.system.dispatch_touch_move_event(r,o,0,0,n.identifier,Nn.core.timestamp())}},__class__:Qn};var Yn=function(){};n["snow.modules.interfaces.IO"]=Yn,Yn.__name__=["snow","modules","interfaces","IO"],Yn.prototype={__class__:Yn};var Jn=function(t){this.system=t};n["snow.core.web.io.IO"]=Jn,Jn.__name__=["snow","core","web","io","IO"],Jn.__interfaces__=[Yn],Jn.prototype={url_open:function(t){null!=t&&t.length>0&&window.open(t,"_blank")},data_load:function(t,e){return new Fn(function(i,s){var n=!0,r=!0;null!=e&&null!=e.binary&&(r=e.binary);var o=new XMLHttpRequest;o.open("GET",t,n),o.overrideMimeType(r?"text/plain; charset=x-user-defined":"text/plain; charset=UTF-8"),n&&(o.responseType="arraybuffer"),o.onload=function(){200==o.status?i(function(){var t,e,i=o.response;return e=null!=i?new Tr(i):null,t=e}(this)):s(gr.error("request status was "+o.status+" / "+o.statusText))},o.send()})},data_save:function(){return!1},string_save_path:function(t){null==t&&(t=0);var e="<localstorage>",i=this.string_slot_id(t),s=Q.join([e,i]);return Q.normalize(s)},init:function(){},update:function(){},destroy:function(){},on_event:function(){},string_slot_id:function(t){null==t&&(t=0);var e=this.system.app.snow_config.app_package.split("."),i=e.pop(),s=e.join(".");return""+s+"/"+i+"/"+this.system.string_save_prefix+"."+t},string_slot_destroy:function(t){null==t&&(t=0);var e=window.localStorage;if(null==e)return S.trace("       i / io / localStorage isnt supported in this browser?!",{fileName:"IO.hx",lineNumber:115,className:"snow.core.web.io.IO",methodName:"string_slot_destroy"}),!1;
var i=this.string_slot_id(t);return e.removeItem(i),!1},string_slot_save:function(t,e){null==t&&(t=0);var i=window.localStorage;if(null==i)return S.trace("       i / io / localStorage isnt supported in this browser?!",{fileName:"IO.hx",lineNumber:132,className:"snow.core.web.io.IO",methodName:"string_slot_save"}),!1;var s=this.string_slot_id(t);return i.setItem(s,e),!0},string_slot_load:function(t){null==t&&(t=0);var e=window.localStorage;if(null==e)return S.trace("       i / io / localStorage isnt supported in this browser?!",{fileName:"IO.hx",lineNumber:150,className:"snow.core.web.io.IO",methodName:"string_slot_load"}),null;var i=this.string_slot_id(t);return e.getItem(i)},string_slot_encode:function(t){return window.btoa(t)},string_slot_decode:function(t){return window.atob(t)},__class__:Jn};var $n=function(){};n["snow.modules.interfaces.Windowing"]=$n,$n.__name__=["snow","modules","interfaces","Windowing"],$n.prototype={__class__:$n};var tr=function(t){this._hidden_event_name="",this._hidden_name="",this._cursor_visible=!0,this._pre_fs_body_margin="0",this._pre_fs_body_overflow="0",this._pre_fs_height=0,this._pre_fs_width=0,this._pre_fs_s_height="",this._pre_fs_s_width="",this._pre_fs_margin="0",this._pre_fs_padding="0",this.seq_window=1,this.system=t,this.fs_windows=[],this.gl_contexts=new U};n["snow.core.web.window.Windowing"]=tr,tr.__name__=["snow","core","web","window","Windowing"],tr.__interfaces__=[$n],tr.prototype={init:function(){this.listen_for_visibility(),this.listen_for_resize()},update:function(){},destroy:function(){},on_event:function(){},_copy_config:function(t){return{borderless:t.borderless,fullscreen:t.fullscreen,fullscreen_desktop:t.fullscreen_desktop,height:t.height,no_input:t.no_input,resizable:t.resizable,title:t.title,width:t.width,x:t.x,y:t.y}},create:function(t,e,i){var s,n=this.seq_window,r=window.document;s=r.createElement("canvas");var o=this._copy_config(e);s.width=o.width,s.height=o.height,s.style.display="block",s.style.position="relative",s.style.background="#000",window.document.body.appendChild(s);var a=oe.getContextWebGL(s,{alpha:!1,premultipliedAlpha:!1,antialias:t.antialiasing>0});if(null==a){var h="WebGL is required to run this!<br/><br/>";throw h+="visit http://get.webgl.org/ for help <br/>",h+="and contact the developer of the application",this.internal_fallback(h),new ne(gr.windowing(h))}null==rr.current_context&&(rr.current_context=a),this.gl_contexts.h[n]=a;var l=this.get_real_window_position(s);o.x=l.x,o.y=l.y,null!=o.title&&""!=o.title&&(window.document.title=o.title),i(s,n,{config:o,render_config:t}),s.setAttribute("id","window"+n),this.seq_window++},destroy_window:function(t){window.document.body.removeChild(t.handle)},close:function(t){t.handle.style.display="none"},show:function(t){t.handle.style.display=null},internal_resize:function(t,e,i){this.system.app.dispatch_system_event({type:5,window:{type:7,timestamp:Nn.core.timestamp(),window_id:t.id,event:{x:e,y:i}}}),this.system.app.dispatch_system_event({type:5,window:{type:6,timestamp:Nn.core.timestamp(),window_id:t.id,event:{x:e,y:i}}})},update_window:function(t){var e=t.handle.getBoundingClientRect();(e.left!=t.x||e.top!=t.y)&&this.system.app.dispatch_system_event({type:5,window:{type:5,timestamp:Nn.core.timestamp(),window_id:t.id,event:{x:e.left,y:e.top}}}),(e.width!=t.width||e.height!=t.height)&&this.internal_resize(t,e.width,e.height),e=null},render:function(t){var e=this.gl_contexts.h[t.id];rr.current_context!=e&&(rr.current_context=e)},swap:function(){},simple_message:function(t,e,i){null==i&&(i=""),window.alert(e)},set_size:function(t,e,i){t.handle.width=e,t.handle.height=i,t.handle.style.width=""+e+"px",t.handle.style.height=""+i+"px",this.internal_resize(t,e,i)},set_position:function(t,e,i){t.handle.style.left=""+e+"px",t.handle.style.top=""+i+"px"},get_real_window_position:function(t){for(var e=0,i=0,s=t,n=!0,r=0;1==n;){if(r++,r>100){n=!1;break}null!=s.offsetParent?(e+=s.offsetLeft,i+=s.offsetTop,s=s.offsetParent):n=!1}return{x:e,y:i}},set_title:function(t,e){window.document.title=e},set_max_size:function(t,e,i){t.handle.style.maxWidth=""+e+"px",t.handle.style.maxHeight=""+i+"px"},set_min_size:function(t,e,i){t.handle.style.minWidth=""+e+"px",t.handle.style.minHeight=""+i+"px"},internal_fullscreen:function(t,e){var i=t.handle;e?-1==a.indexOf(this.fs_windows,t,0)&&this.fs_windows.push(t):a.remove(this.fs_windows,t);var n=this.system.app.config.web.true_fullscreen;e?n?null==s(i,i.requestFullscreen)?null==i.requestFullScreen?null==i.webkitRequestFullscreen?null==i.mozRequestFullScreen||i.mozRequestFullScreen():i.webkitRequestFullscreen():i.requestFullScreen(null):i.requestFullscreen():(this._pre_fs_padding=i.style.padding,this._pre_fs_margin=i.style.margin,this._pre_fs_s_width=i.style.width,this._pre_fs_s_height=i.style.height,this._pre_fs_width=i.width,this._pre_fs_height=i.height,this._pre_fs_body_margin=window.document.body.style.margin,this._pre_fs_body_overflow=window.document.body.style.overflow,i.style.margin="0",i.style.padding="0",i.style.width=window.innerWidth+"px",i.style.height=window.innerHeight+"px",i.width=window.innerWidth,i.height=window.innerHeight,window.document.body.style.margin="0",window.document.body.style.overflow="hidden"):n||(i.style.padding=this._pre_fs_padding,i.style.margin=this._pre_fs_margin,i.style.width=this._pre_fs_s_width,i.style.height=this._pre_fs_s_height,i.width=this._pre_fs_width,i.height=this._pre_fs_height,window.document.body.style.margin=this._pre_fs_body_margin,window.document.body.style.overflow=this._pre_fs_body_overflow)},fullscreen:function(t,e){this.internal_fullscreen(t,e)},bordered:function(){},grab:function(t,e){e&&(null==(vr=t.handle,s(vr,vr.requestPointerLock))?null==t.handle.webkitRequestPointerLock?null==t.handle.mozRequestPointerLock||t.handle.mozRequestPointerLock():t.handle.webkitRequestPointerLock():t.handle.requestPointerLock())},set_cursor_position:function(){},system_enable_cursor:function(t){if(null==this.cursor_style){var e=window.document;this.cursor_style=e.createElement("style"),this.cursor_style.innerHTML="* { cursor:none; }"}t&&!this._cursor_visible?(this._cursor_visible=!0,window.document.body.removeChild(this.cursor_style)):!t&&this._cursor_visible&&(this._cursor_visible=!1,window.document.body.appendChild(this.cursor_style))},system_lock_cursor:function(t){null!=this.system.app.window&&this.grab(this.system.app.window,t)},system_enable_vsync:function(){return-1},display_count:function(){return 1},display_mode_count:function(){return 1},display_native_mode:function(){return{format:0,refresh_rate:0,width:window.screen.width,height:window.screen.height}},display_current_mode:function(t){return this.display_native_mode(t)},display_mode:function(t){return this.display_native_mode(t)},display_bounds:function(){return{x:0,y:0,width:window.innerWidth,height:window.innerHeight}},display_name:function(){return window.navigator.vendor},listen:function(t){t.handle.addEventListener("mouseleave",s(this,this.on_internal_leave)),t.handle.addEventListener("mouseenter",s(this,this.on_internal_enter)),t.config.fullscreen&&(this.internal_fullscreen(t,t.config.fullscreen),t.config.width=t.handle.width,t.config.height=t.handle.height)},unlisten:function(t){t.handle.removeEventListener("mouseleave",s(this,this.on_internal_leave)),t.handle.removeEventListener("mouseenter",s(this,this.on_internal_enter)),a.remove(this.fs_windows,t)},on_internal_leave:function(t){var e=this.system.window_from_handle(t.target);this.system.app.dispatch_system_event({type:5,window:{type:12,timestamp:t.timeStamp,window_id:e.id,event:t}})},on_internal_enter:function(t){var e=this.system.window_from_handle(t.target);this.system.app.dispatch_system_event({type:5,window:{type:11,timestamp:t.timeStamp,window_id:e.id,event:t}})},listen_for_resize:function(){var t=this;window.onresize=function(){if(!t.system.app.config.web.true_fullscreen)for(var e=0,i=t.fs_windows;e<i.length;){var s=i[e];++e,s.set_size(window.innerWidth,window.innerHeight),t.internal_resize(s,s.width,s.height)}}},listen_for_visibility:function(){void 0!==typeof document.hidden?(this._hidden_name="hidden",this._hidden_event_name="visibilitychange"):void 0!==typeof document.mozHidden?(this._hidden_name="mozHidden",this._hidden_name="mozvisibilitychange"):"undefined"!=typeof document.msHidden?(this._hidden_name="msHidden",this._hidden_event_name="msvisibilitychange"):"undefined"!=typeof document.webkitHidden&&(this._hidden_name="webkitHidden",this._hidden_event_name="webkitvisibilitychange"),""!=this._hidden_name&&""!=this._hidden_event_name&&window.document.addEventListener(this._hidden_event_name,s(this,this.on_visibility_change))},on_visibility_change:function(t){var e={type:5,window:{type:2,timestamp:Nn.core.timestamp(),window_id:1,event:t}};document[this._hidden_name]?(e.window.type=3,this.system.app.dispatch_system_event(e),e.window.type=8,this.system.app.dispatch_system_event(e),e.window.type=14,this.system.app.dispatch_system_event(e)):(e.window.type=2,this.system.app.dispatch_system_event(e),e.window.type=10,this.system.app.dispatch_system_event(e),e.window.type=13,this.system.app.dispatch_system_event(e))},internal_fallback:function(t){var e,i,s=window.document;e=s.createElement("div");var n=window.document;i=n.createElement("div"),e.style.marginLeft="auto",e.style.marginRight="auto",e.style.color="#d3d3d3",e.style.marginTop="5em",e.style.fontSize="1.4em",e.style.fontFamily="helvetica,sans-serif",e.innerHTML=t,i.style.top="0",i.style.left="0",i.style.width="100%",i.style.height="100%",i.style.display="block",i.style.minWidth="100%",i.style.minHeight="100%",i.style.textAlign="center",i.style.position="absolute",i.style.background="rgba(1,1,1,0.90)",i.appendChild(e),window.document.body.appendChild(i)},__class__:tr};var er=function(){};n["snow.modules.interfaces.Audio"]=er,er.__name__=["snow","modules","interfaces","Audio"],er.prototype={__class__:er};var ir=function(t){this.system=t,this.suspended_sounds=[],this.handles=new G};n["snow.modules.howlerjs.Audio"]=ir,ir.__name__=["snow","modules","howlerjs","Audio"],ir.__interfaces__=[er],ir.prototype={init:function(){},update:function(){},destroy:function(){},on_event:function(){},suspend:function(){for(var t=this.handles.iterator();t.hasNext();){var e=t.next();e.get_playing()&&(e.toggle(),this.suspended_sounds.push(e))}},resume:function(){for(;this.suspended_sounds.length>0;){var t=this.suspended_sounds.pop();t.toggle()}},info_from_id:function(t,e){if(null==e){var i=Q.extension(t);switch(i){case"wav":e=2;break;case"ogg":e=1;break;case"pcm":e=3;break;default:e=0}}return{format:e,id:t,handle:null,data:null}},create_sound:function(t,e,i,s){null==i&&(i=!1);var n=this;return new Fn(function(r,o){var a=n.system.app.assets.root+t,h=n.info_from_id(a,s),l=new nr(n.system,e,i);h.handle=new window.Howl({urls:[a],onend:function(){n.system.app.audio.module._on_end(h.handle)},onloaderror:function(){o(gr.error("failed to create sound "+e+" from "+t))},onload:function(){h.handle=this,l.set_info(h);var t=h.handle;n.handles.set(t,l),r(l)}})})},create_sound_from_bytes:function(t,e,i){var s,n=this;switch(i){case 1:s="ogg";break;case 2:s="wav";break;case 3:throw new ne(gr.error("pcm audio format unsupported atm"));case 0:throw new ne(gr.error("unknown audio format for create_sound_from_bytes "+t))}for(var r="",o=0,a=e.length;a>o;)r+=String.fromCharCode(function(){var t,i,s=o++;return i=e[s],t=255&i}(this));var h=window.btoa(r),l="data:audio/"+s+";base64,"+h,_=this.info_from_id("bytes;"+t,i),u=new nr(this.system,t,!1);return _.handle=new window.Howl({urls:[l],onend:function(){n.system.app.audio.module._on_end(_.handle)},onloaderror:function(){throw new ne(gr.error("failed to create sound "+t+" from bytes"))},onload:function(){_.handle=this,u.set_info(_);var t=_.handle;n.handles.set(t,u)}}),u},_on_end:function(t){var e,i=t;e=this.handles.h[i.__id__],null!=e&&e.emit("end")},__class__:ir};var sr=function(t,e,i){null==i&&(i=!1),this.is_stream=!1,this.position_bytes=0,this.length_bytes=0,this.duration=0,this.position=0,this.looping=!1,this.pan=0,this.volume=1,this.pitch=1,this.loaded=!1,this.paused=!1,this.playing=!1,this.name="",this.name=e,this.system=t,this.is_stream=i};n["snow.system.audio.Sound"]=sr,sr.__name__=["snow","system","audio","Sound"],sr.prototype={emit:function(t){this.system.sound_event(this,t)},on:function(t,e){this.system.on(this.name,t,e)},off:function(t,e){this.system.off(this.name,t,e)},play:function(){S.trace("    i / sound / Sound:play called in root Sound module. Nothing will happen.",{fileName:"Sound.hx",lineNumber:102,className:"snow.system.audio.Sound",methodName:"play"})},loop:function(){S.trace("    i / sound / Sound:loop called in root Sound module. Nothing will happen.",{fileName:"Sound.hx",lineNumber:104,className:"snow.system.audio.Sound",methodName:"loop"})},stop:function(){S.trace("    i / sound / Sound:stop called in root Sound module. Nothing will happen.",{fileName:"Sound.hx",lineNumber:106,className:"snow.system.audio.Sound",methodName:"stop"})},pause:function(){S.trace("    i / sound / Sound:pause called in root Sound module. Nothing will happen.",{fileName:"Sound.hx",lineNumber:108,className:"snow.system.audio.Sound",methodName:"pause"})},destroy:function(){S.trace("    i / sound / Sound:destroy called in root Sound module. Nothing will happen.",{fileName:"Sound.hx",lineNumber:110,className:"snow.system.audio.Sound",methodName:"destroy"})},internal_update:function(){},internal_play:function(){},internal_loop:function(){},internal_stop:function(){},internal_pause:function(){},toggle:function(){this.set_playing(!this.get_playing()),this.get_playing()?this.get_looping()?this.loop():this.play():this.pause()},get_playing:function(){return this.playing},get_paused:function(){return this.paused},get_loaded:function(){return this.loaded},get_info:function(){return this.info},set_info:function(t){return this.info=t},get_pan:function(){return this.pan},get_pitch:function(){return this.pitch},get_volume:function(){return this.volume},get_looping:function(){return this.looping},get_position:function(){return this.position},get_position_bytes:function(){return this.position_bytes},get_length_bytes:function(){return this.length_bytes},get_duration:function(){return 0},set_playing:function(t){return this.playing=t},set_paused:function(t){return this.paused=t},set_loaded:function(t){return this.loaded=t},set_pan:function(t){return this.pan=t},set_pitch:function(t){return this.pitch=t},set_volume:function(t){return this.volume=t},set_position:function(t){return this.position=t},set_looping:function(t){return this.looping=t},set_position_bytes:function(t){return this.position_bytes=t},__class__:sr,__properties__:{set_position_bytes:"set_position_bytes",get_position_bytes:"get_position_bytes",get_length_bytes:"get_length_bytes",get_duration:"get_duration",set_position:"set_position",get_position:"get_position",set_looping:"set_looping",get_looping:"get_looping",set_pan:"set_pan",get_pan:"get_pan",set_volume:"set_volume",get_volume:"get_volume",set_pitch:"set_pitch",get_pitch:"get_pitch",set_info:"set_info",get_info:"get_info",set_loaded:"set_loaded",get_loaded:"get_loaded",set_paused:"set_paused",get_paused:"get_paused",set_playing:"set_playing",get_playing:"get_playing"}};var nr=function(t,e,i){null==i&&(i=!1),sr.call(this,t,e,i)};n["snow.modules.howlerjs.sound.Sound"]=nr,nr.__name__=["snow","modules","howlerjs","sound","Sound"],nr.__super__=sr,nr.prototype=e(sr.prototype,{set_info:function(t){return null!=this.get_info()&&this.destroy(),this.info=null,null==t?(S.trace("    i / sound / not creating sound, info was null",{fileName:"Sound.hx",lineNumber:29,className:"snow.modules.howlerjs.sound.Sound",methodName:"set_info"}),this.get_info()):(this.info=t,this.set_loaded(!0),this.get_info())},set_pan:function(t){return null!=this.get_info()&&null!=this.get_info().handle&&this.get_info().handle.pos3d(this.get_pan()),this.pan=t},set_volume:function(t){return null!=this.get_info()&&null!=this.get_info().handle&&this.get_info().handle.volume(t),this.volume=t},set_pitch:function(t){return null!=this.get_info()&&null!=this.get_info().handle&&this.get_info().handle.rate(t),this.pitch=t},set_position:function(t){return null!=this.get_info()&&null!=this.get_info().handle&&this.get_info().handle.pos(t),this.position=t},get_position:function(){return null!=this.get_info()&&null!=this.get_info().handle?this.get_info().handle.pos():this.position},get_duration:function(){return null!=this.get_info()&&null!=this.get_info().handle?this.get_info().handle._duration:0},play:function(){null!=this.get_info()&&null!=this.get_info().handle&&(this.set_playing(!0),this.set_looping(!1),this.get_info().handle.loop(!1),this.get_info().handle.play(),null!=this.get_info()&&null!=this.get_info().handle&&(this.get_info().handle.rate(this.get_pitch()),this.get_info().handle.volume(this.get_volume()),this.get_info().handle.pos3d(this.get_pan())))},loop:function(){null!=this.get_info()&&null!=this.get_info().handle&&(this.set_playing(!0),this.set_looping(!0),this.get_info().handle.loop(!0),this.get_info().handle.play(),null!=this.get_info()&&null!=this.get_info().handle&&(this.get_info().handle.rate(this.get_pitch()),this.get_info().handle.volume(this.get_volume()),this.get_info().handle.pos3d(this.get_pan())))},stop:function(){this.set_playing(!1),null!=this.get_info()&&null!=this.get_info().handle&&this.get_info().handle.stop()},pause:function(){null!=this.get_info()&&null!=this.get_info().handle&&this.get_info().handle.pause()},destroy:function(){null!=this.get_info()&&null!=this.get_info().handle&&this.get_info().handle.unload(),this.system.kill(this)},ensure_parameters:function(){null!=this.get_info()&&null!=this.get_info().handle&&(this.get_info().handle.rate(this.get_pitch()),this.get_info().handle.volume(this.get_volume()),this.get_info().handle.pos3d(this.get_pan()))},__class__:nr});var rr=function(){};n["snow.modules.opengl.web.GL"]=rr,rr.__name__=["snow","modules","opengl","web","GL"],rr.__properties__={get_version:"get_version"},rr.versionString=function(){var t=rr.current_context.getParameter(7938),e=rr.current_context.getParameter(35724),i=rr.current_context.getParameter(7937),s=rr.current_context.getParameter(7936);return"/ "+t+" / "+e+" / "+i+" / "+s+" /"},rr.activeTexture=function(t){rr.current_context.activeTexture(t)},rr.attachShader=function(t,e){rr.current_context.attachShader(t,e)},rr.bindAttribLocation=function(t,e,i){rr.current_context.bindAttribLocation(t,e,i)},rr.bindBuffer=function(t,e){rr.current_context.bindBuffer(t,e)},rr.bindFramebuffer=function(t,e){rr.current_context.bindFramebuffer(t,e)},rr.bindRenderbuffer=function(t,e){rr.current_context.bindRenderbuffer(t,e)},rr.bindTexture=function(t,e){rr.current_context.bindTexture(t,e)},rr.blendColor=function(t,e,i,s){rr.current_context.blendColor(t,e,i,s)},rr.blendEquation=function(t){rr.current_context.blendEquation(t)},rr.blendEquationSeparate=function(t,e){rr.current_context.blendEquationSeparate(t,e)},rr.blendFunc=function(t,e){rr.current_context.blendFunc(t,e)},rr.blendFuncSeparate=function(t,e,i,s){rr.current_context.blendFuncSeparate(t,e,i,s)},rr.bufferData=function(t,e,i){rr.current_context.bufferData(t,e,i)},rr.bufferSubData=function(t,e,i){rr.current_context.bufferSubData(t,e,i)},rr.checkFramebufferStatus=function(t){return rr.current_context.checkFramebufferStatus(t)},rr.clear=function(t){rr.current_context.clear(t)},rr.clearColor=function(t,e,i,s){rr.current_context.clearColor(t,e,i,s)},rr.clearDepth=function(t){rr.current_context.clearDepth(t)},rr.clearStencil=function(t){rr.current_context.clearStencil(t)},rr.colorMask=function(t,e,i,s){rr.current_context.colorMask(t,e,i,s)},rr.compileShader=function(t){rr.current_context.compileShader(t)},rr.compressedTexImage2D=function(t,e,i,s,n,r,o){rr.current_context.compressedTexImage2D(t,e,i,s,n,r,o)},rr.compressedTexSubImage2D=function(t,e,i,s,n,r,o,a){rr.current_context.compressedTexSubImage2D(t,e,i,s,n,r,o,a)},rr.copyTexImage2D=function(t,e,i,s,n,r,o,a){rr.current_context.copyTexImage2D(t,e,i,s,n,r,o,a)},rr.copyTexSubImage2D=function(t,e,i,s,n,r,o,a){rr.current_context.copyTexSubImage2D(t,e,i,s,n,r,o,a)},rr.createBuffer=function(){return rr.current_context.createBuffer()},rr.createFramebuffer=function(){return rr.current_context.createFramebuffer()},rr.createProgram=function(){return rr.current_context.createProgram()},rr.createRenderbuffer=function(){return rr.current_context.createRenderbuffer()},rr.createShader=function(t){return rr.current_context.createShader(t)},rr.createTexture=function(){return rr.current_context.createTexture()},rr.cullFace=function(t){rr.current_context.cullFace(t)},rr.deleteBuffer=function(t){rr.current_context.deleteBuffer(t)},rr.deleteFramebuffer=function(t){rr.current_context.deleteFramebuffer(t)},rr.deleteProgram=function(t){rr.current_context.deleteProgram(t)},rr.deleteRenderbuffer=function(t){rr.current_context.deleteRenderbuffer(t)},rr.deleteShader=function(t){rr.current_context.deleteShader(t)},rr.deleteTexture=function(t){rr.current_context.deleteTexture(t)},rr.depthFunc=function(t){rr.current_context.depthFunc(t)},rr.depthMask=function(t){rr.current_context.depthMask(t)},rr.depthRange=function(t,e){rr.current_context.depthRange(t,e)},rr.detachShader=function(t,e){rr.current_context.detachShader(t,e)},rr.disable=function(t){rr.current_context.disable(t)},rr.disableVertexAttribArray=function(t){rr.current_context.disableVertexAttribArray(t)},rr.drawArrays=function(t,e,i){rr.current_context.drawArrays(t,e,i)},rr.drawElements=function(t,e,i,s){rr.current_context.drawElements(t,e,i,s)},rr.enable=function(t){rr.current_context.enable(t)},rr.enableVertexAttribArray=function(t){rr.current_context.enableVertexAttribArray(t)},rr.finish=function(){rr.current_context.finish()},rr.flush=function(){rr.current_context.flush()},rr.framebufferRenderbuffer=function(t,e,i,s){rr.current_context.framebufferRenderbuffer(t,e,i,s)},rr.framebufferTexture2D=function(t,e,i,s,n){rr.current_context.framebufferTexture2D(t,e,i,s,n)},rr.frontFace=function(t){rr.current_context.frontFace(t)},rr.generateMipmap=function(t){rr.current_context.generateMipmap(t)},rr.getActiveAttrib=function(t,e){return rr.current_context.getActiveAttrib(t,e)},rr.getActiveUniform=function(t,e){return rr.current_context.getActiveUniform(t,e)},rr.getAttachedShaders=function(t){return rr.current_context.getAttachedShaders(t)},rr.getAttribLocation=function(t,e){return rr.current_context.getAttribLocation(t,e)},rr.getBufferParameter=function(t,e){return rr.current_context.getBufferParameter(t,e)},rr.getContextAttributes=function(){return rr.current_context.getContextAttributes()},rr.getError=function(){return rr.current_context.getError()},rr.getExtension=function(t){return rr.current_context.getExtension(t)},rr.getFramebufferAttachmentParameter=function(t,e,i){return rr.current_context.getFramebufferAttachmentParameter(t,e,i)},rr.getParameter=function(t){return rr.current_context.getParameter(t)},rr.getProgramInfoLog=function(t){return rr.current_context.getProgramInfoLog(t)},rr.getProgramParameter=function(t,e){return rr.current_context.getProgramParameter(t,e)},rr.getRenderbufferParameter=function(t,e){return rr.current_context.getRenderbufferParameter(t,e)},rr.getShaderInfoLog=function(t){return rr.current_context.getShaderInfoLog(t)},rr.getShaderParameter=function(t,e){return rr.current_context.getShaderParameter(t,e)},rr.getShaderPrecisionFormat=function(t,e){return rr.current_context.getShaderPrecisionFormat(t,e)},rr.getShaderSource=function(t){return rr.current_context.getShaderSource(t)},rr.getSupportedExtensions=function(){return rr.current_context.getSupportedExtensions()},rr.getTexParameter=function(t,e){return rr.current_context.getTexParameter(t,e)},rr.getUniform=function(t,e){return rr.current_context.getUniform(t,e)},rr.getUniformLocation=function(t,e){return rr.current_context.getUniformLocation(t,e)},rr.getVertexAttrib=function(t,e){return rr.current_context.getVertexAttrib(t,e)},rr.getVertexAttribOffset=function(t,e){return rr.current_context.getVertexAttribOffset(t,e)},rr.hint=function(t,e){rr.current_context.hint(t,e)},rr.isBuffer=function(t){return rr.current_context.isBuffer(t)},rr.isEnabled=function(t){return rr.current_context.isEnabled(t)},rr.isFramebuffer=function(t){return rr.current_context.isFramebuffer(t)},rr.isProgram=function(t){return rr.current_context.isProgram(t)},rr.isRenderbuffer=function(t){return rr.current_context.isRenderbuffer(t)},rr.isShader=function(t){return rr.current_context.isShader(t)},rr.isTexture=function(t){return rr.current_context.isTexture(t)},rr.lineWidth=function(t){rr.current_context.lineWidth(t)},rr.linkProgram=function(t){rr.current_context.linkProgram(t)},rr.pixelStorei=function(t,e){rr.current_context.pixelStorei(t,e)},rr.polygonOffset=function(t,e){rr.current_context.polygonOffset(t,e)},rr.readPixels=function(t,e,i,s,n,r,o){rr.current_context.readPixels(t,e,i,s,n,r,o)},rr.renderbufferStorage=function(t,e,i,s){rr.current_context.renderbufferStorage(t,e,i,s)},rr.sampleCoverage=function(t,e){rr.current_context.sampleCoverage(t,e)},rr.scissor=function(t,e,i,s){rr.current_context.scissor(t,e,i,s)},rr.shaderSource=function(t,e){rr.current_context.shaderSource(t,e)},rr.stencilFunc=function(t,e,i){rr.current_context.stencilFunc(t,e,i)},rr.stencilFuncSeparate=function(t,e,i,s){rr.current_context.stencilFuncSeparate(t,e,i,s)},rr.stencilMask=function(t){rr.current_context.stencilMask(t)},rr.stencilMaskSeparate=function(t,e){rr.current_context.stencilMaskSeparate(t,e)},rr.stencilOp=function(t,e,i){rr.current_context.stencilOp(t,e,i)},rr.stencilOpSeparate=function(t,e,i,s){rr.current_context.stencilOpSeparate(t,e,i,s)},rr.texImage2D=function(t,e,i,s,n,r,o,a,h){rr.current_context.texImage2D(t,e,i,s,n,r,o,a,h)},rr.texParameterf=function(t,e,i){rr.current_context.texParameterf(t,e,i)},rr.texParameteri=function(t,e,i){rr.current_context.texParameteri(t,e,i)},rr.texSubImage2D=function(t,e,i,s,n,r,o,a,h){rr.current_context.texSubImage2D(t,e,i,s,n,r,o,a,h)},rr.uniform1f=function(t,e){rr.current_context.uniform1f(t,e)},rr.uniform1fv=function(t,e){rr.current_context.uniform1fv(t,e)},rr.uniform1i=function(t,e){rr.current_context.uniform1i(t,e)},rr.uniform1iv=function(t,e){rr.current_context.uniform1iv(t,e)},rr.uniform2f=function(t,e,i){rr.current_context.uniform2f(t,e,i)},rr.uniform2fv=function(t,e){rr.current_context.uniform2fv(t,e)},rr.uniform2i=function(t,e,i){rr.current_context.uniform2i(t,e,i)},rr.uniform2iv=function(t,e){rr.current_context.uniform2iv(t,e)},rr.uniform3f=function(t,e,i,s){rr.current_context.uniform3f(t,e,i,s)},rr.uniform3fv=function(t,e){rr.current_context.uniform3fv(t,e)},rr.uniform3i=function(t,e,i,s){rr.current_context.uniform3i(t,e,i,s)},rr.uniform3iv=function(t,e){rr.current_context.uniform3iv(t,e)},rr.uniform4f=function(t,e,i,s,n){rr.current_context.uniform4f(t,e,i,s,n)},rr.uniform4fv=function(t,e){rr.current_context.uniform4fv(t,e)},rr.uniform4i=function(t,e,i,s,n){rr.current_context.uniform4i(t,e,i,s,n)},rr.uniform4iv=function(t,e){rr.current_context.uniform4iv(t,e)},rr.uniformMatrix2fv=function(t,e,i){rr.current_context.uniformMatrix2fv(t,e,i)},rr.uniformMatrix3fv=function(t,e,i){rr.current_context.uniformMatrix3fv(t,e,i)},rr.uniformMatrix4fv=function(t,e,i){rr.current_context.uniformMatrix4fv(t,e,i)},rr.useProgram=function(t){rr.current_context.useProgram(t)},rr.validateProgram=function(t){rr.current_context.validateProgram(t)},rr.vertexAttrib1f=function(t,e){rr.current_context.vertexAttrib1f(t,e)},rr.vertexAttrib1fv=function(t,e){rr.current_context.vertexAttrib1fv(t,e)},rr.vertexAttrib2f=function(t,e,i){rr.current_context.vertexAttrib2f(t,e,i)},rr.vertexAttrib2fv=function(t,e){rr.current_context.vertexAttrib2fv(t,e)},rr.vertexAttrib3f=function(t,e,i,s){rr.current_context.vertexAttrib3f(t,e,i,s)},rr.vertexAttrib3fv=function(t,e){rr.current_context.vertexAttrib3fv(t,e)},rr.vertexAttrib4f=function(t,e,i,s,n){rr.current_context.vertexAttrib4f(t,e,i,s,n)},rr.vertexAttrib4fv=function(t,e){rr.current_context.vertexAttrib4fv(t,e)},rr.vertexAttribPointer=function(t,e,i,s,n,r){rr.current_context.vertexAttribPointer(t,e,i,s,n,r)},rr.viewport=function(t,e,i,s){rr.current_context.viewport(t,e,i,s)},rr.get_version=function(){return 7938};var or=function(t,e,i){if(null==i&&(i=0),this.loaded=!1,null==e)throw new ne(Bn.null_assertion("_id was null"));if(null==t)throw new ne(Bn.null_assertion("_system was null"));this.system=t,this.type=i,this.id=e};n["snow.system.assets.Asset"]=or,or.__name__=["snow","system","assets","Asset"],or.prototype={destroy:function(){},__class__:or};var ar=function(t,e,i){or.call(this,t,e,4),this.set_image(i)};n["snow.system.assets.AssetImage"]=ar,ar.__name__=["snow","system","assets","AssetImage"],ar.load=function(t,e){if(null==e)throw new ne(Bn.null_assertion("_id was null"));if(null==t)throw new ne(Bn.null_assertion("_system was null"));return new ar(t,e,null).reload()},ar.load_from_bytes=function(t,e,i){if(null==e)throw new ne(Bn.null_assertion("_id was null"));if(null==i)throw new ne(Bn.null_assertion("_bytes was null"));if(null==t)throw new ne(Bn.null_assertion("_system was null"));return new ar(t,e,null).reload_from_bytes(i)},ar.load_from_pixels=function(t,e,i,s,n){if(null==e)throw new ne(Bn.null_assertion("_id was null"));if(null==n)throw new ne(Bn.null_assertion("_pixels was null"));if(null==t)throw new ne(Bn.null_assertion("_system was null"));var r=t.module.image_info_from_pixels(e,i,s,n);return new ar(t,e,r)},ar.provider=function(t,e){return t.assets.module.image_load_info(e)},ar.processor=function(t,e,i){return null==i?Fn.reject(gr.error("AssetImage processor: data was null")):t.assets.module.image_info_from_bytes(e,i)},ar.__super__=or,ar.prototype=e(or.prototype,{reload:function(){var t=this;return this.loaded=!1,new Fn(function(e,i){var s=t.system.app.io.data_flow(t.system.root+t.id,null,ar.provider);s.then(function(i){t.set_image(i),e(t)}).error(i)})},destroy:function(){this.set_image(null)},reload_from_bytes:function(t){var e=this;return this.loaded=!1,new Fn(function(i,s){var n=e.system.module.image_info_from_bytes(e.id,t);n.then(function(t){e.set_image(t),i(e)}).error(s)})},reload_from_pixels:function(t,e,i){this.loaded=!1,this.set_image(this.system.module.image_info_from_pixels(this.id,t,e,i))},set_image:function(t){return this.loaded=null!=t,this.image=t},__class__:ar,__properties__:{set_image:"set_image"}});var hr=function(t,e,i){or.call(this,t,e,1),this.set_bytes(i)};n["snow.system.assets.AssetBytes"]=hr,hr.__name__=["snow","system","assets","AssetBytes"],hr.load=function(t,e){return new hr(t,e,null).reload()},hr.__super__=or,hr.prototype=e(or.prototype,{reload:function(){var t=this;return new Fn(function(e,i){t.system.app.io.data_flow(t.system.root+t.id).then(function(i){t.set_bytes(i),e(t)}).error(i)})},destroy:function(){this.set_bytes(null)},set_bytes:function(t){return this.loaded=null!=t,this.bytes=t},__class__:hr,__properties__:{set_bytes:"set_bytes"}});var lr=function(t,e,i){or.call(this,t,e,2),this.set_text(i)};n["snow.system.assets.AssetText"]=lr,lr.__name__=["snow","system","assets","AssetText"],lr.load=function(t,e){return new lr(t,e,null).reload()},lr.processor=function(t,e,i){return null==i?Fn.reject(gr.error("AssetText processor: data was null")):Fn.resolve(jn.toBytes(i).toString())},lr.__super__=or,lr.prototype=e(or.prototype,{reload:function(){var t=this;return new Fn(function(e,i){t.system.app.io.data_flow(t.system.root+t.id,lr.processor).then(function(i){t.set_text(i),e(t)}).error(i)})},destroy:function(){this.set_text(null)},set_text:function(t){return this.loaded=null!=t,this.text=t},__class__:lr,__properties__:{set_text:"set_text"}});var _r=function(t,e,i){or.call(this,t,e,3),this.set_json(i)};n["snow.system.assets.AssetJSON"]=_r,_r.__name__=["snow","system","assets","AssetJSON"],_r.load=function(t,e){return new _r(t,e,null).reload()
},_r.processor=function(t,e,i){return null==i?Fn.reject(gr.error("AssetJSON: data was null")):new Fn(function(t,e){var s=null;try{s=JSON.parse(jn.toBytes(i).toString())}catch(n){return n instanceof ne&&(n=n.val),e(gr.parse(n))}return t(s)})},_r.__super__=or,_r.prototype=e(or.prototype,{reload:function(){var t=this;return new Fn(function(e,i){t.system.app.io.data_flow(t.system.root+t.id,_r.processor).then(function(i){t.set_json(i),e(t)}).error(i)})},destroy:function(){this.set_json(null)},set_json:function(t){return this.loaded=null!=t,this.json=t},__class__:_r,__properties__:{set_json:"set_json"}});var ur=function(t){this.manifest_path="manifest",this.root="",this.app=t,this.list=[],this.module=new Xn(this)};n["snow.system.assets.Assets"]=ur,ur.__name__=["snow","system","assets","Assets"],ur.prototype={listed:function(t){return-1!=a.indexOf(this.list,t,0)},path:function(t){return this.root+t},bytes:function(t){return hr.load(this,t)},text:function(t){return lr.load(this,t)},json:function(t){return _r.load(this,t)},image:function(t){return ar.load(this,t)},image_from_bytes:function(t,e){return ar.load_from_bytes(this,t,e)},image_from_pixels:function(t,e,i,s){return ar.load_from_pixels(this,t,e,i,s)},__class__:ur};var cr=function(t){this.active=!1,this.app=t,this.module=new ir(this),this.module.init(),this.sound_list=new V,this.stream_list=new V,this.active=!0};n["snow.system.audio.Audio"]=cr,cr.__name__=["snow","system","audio","Audio"],cr.prototype={create:function(t,e,i){null==i&&(i=!1),null==e&&(e="");var s=this;return""==e&&(e=this.app.make_uniqueid()),S.trace("    i / audio / "+("creating sound named "+e+" (stream: "+(null==i?"null":""+i)+")"),{fileName:"Audio.hx",lineNumber:53,className:"snow.system.audio.Audio",methodName:"create"}),new Fn(function(n,r){var o=s.module.create_sound(t,e,i);o.then(function(t){s.sound_list.set(e,t),i&&s.stream_list.set(e,t),n(t),t.emit("load")}).error(r)})},create_from_bytes:function(t,e,i){null==t&&(t=""),""==t&&(t=this.app.make_uniqueid());var s=this.module.create_sound_from_bytes(t,e,i);if(null==s)throw new ne(Bn.null_assertion("sound was null"));return this.sound_list.set(t,s),s},uncreate:function(t){var e=this.sound_list.get(t);null==e&&S.trace("    i / audio / can't find sound, unable to uncreate, use create first: "+t,{fileName:"Audio.hx",lineNumber:99,className:"snow.system.audio.Audio",methodName:"uncreate"}),e.destroy()},add:function(t){this.sound_list.set(t.name,t),t.is_stream&&this.stream_list.set(t.name,t)},on:function(t,e,i){if("load"==e){var s=this.get(t);if(null!=s&&s.get_loaded())return void i(s)}var n=""+e+cr.splitter+t;null==this.handlers&&(this.handlers=new V),this.handlers.exists(n)||this.handlers.set(n,[]);var r=this.handlers.get(n);if(-1!=a.indexOf(r,i,0))throw new ne("Audio on event adding the same handler twice");r.push(i),this.handlers.set(n,r)},off:function(t,e,i){if(null!=this.handlers){var s=""+e+cr.splitter+t,n=this.handlers.get(s);null!=n&&(a.remove(n,i),this.handlers.set(s,n))}},get:function(t){var e=this.sound_list.get(t);return e},volume:function(t,e){var i=this.get(t);return null!=i?null!=e?i.set_volume(e):i.get_volume():0},pan:function(t,e){var i=this.get(t);return null!=i?null!=e?i.set_pan(e):i.get_pan():0},pitch:function(t,e){var i=this.get(t);return null!=i?null!=e?i.set_pitch(e):i.get_pitch():0},position:function(t,e){var i=this.get(t);return null!=i?null!=e?i.set_position(e):i.get_position():0},duration:function(t){var e=this.get(t);return null!=e?e.get_duration():0},play:function(t){if(this.active){var e=this.get(t);null!=e&&e.play()}},loop:function(t){if(this.active){var e=this.get(t);null!=e&&e.loop()}},pause:function(t){if(this.active){var e=this.get(t);null!=e&&e.pause()}},stop:function(t){if(this.active){var e=this.get(t);null!=e&&e.stop()}},toggle:function(t){if(this.active){var e=this.get(t);null!=e&&e.toggle()}},kill:function(t){null!=t&&(this.sound_list.remove(t.name),this.stream_list.remove(t.name))},suspend:function(){if(this.active){S.trace("    i / audio / suspending sound context",{fileName:"Audio.hx",lineNumber:354,className:"snow.system.audio.Audio",methodName:"suspend"}),this.active=!1;for(var t=this.stream_list.iterator();t.hasNext();){var e=t.next();e.internal_pause()}this.module.suspend()}},resume:function(){if(!this.active){S.trace("    i / audio / resuming sound context",{fileName:"Audio.hx",lineNumber:372,className:"snow.system.audio.Audio",methodName:"resume"}),this.active=!0,this.module.resume();for(var t=this.stream_list.iterator();t.hasNext();){var e=t.next();e.internal_play()}}},on_event:function(t){this.module.on_event(t),10==t.type?this.suspend():12==t.type&&this.resume()},destroy:function(){this.active=!1;for(var t=this.sound_list.iterator();t.hasNext();){var e=t.next();e.destroy()}this.module.destroy()},update:function(){if(this.active){for(var t=this.sound_list.iterator();t.hasNext();){var e=t.next();e.get_playing()&&e.internal_update()}this.module.update()}},sound_event:function(t,e){var i=""+e+cr.splitter+t.name;if(null!=this.handlers){var s=this.handlers.get(i);if(null!=s)for(var n=0;n<s.length;){var r=s[n];++n,r(t)}}},__class__:cr};var dr=function(t){this.touch_count=0,this.app=t,this.module=new Qn(this),this.module.init(),this.key_code_pressed=new U,this.key_code_down=new U,this.key_code_released=new U,this.scan_code_pressed=new U,this.scan_code_down=new U,this.scan_code_released=new U,this.mouse_button_pressed=new U,this.mouse_button_down=new U,this.mouse_button_released=new U,this.gamepad_button_pressed=new U,this.gamepad_button_down=new U,this.gamepad_button_released=new U,this.gamepad_axis_values=new U,this.touches_down=new U};n["snow.system.input.Input"]=dr,dr.__name__=["snow","system","input","Input"],dr.prototype={keypressed:function(t){return this.key_code_pressed.h.hasOwnProperty(t)},keyreleased:function(t){return this.key_code_released.h.hasOwnProperty(t)},keydown:function(t){return this.key_code_down.h.hasOwnProperty(t)},scanpressed:function(t){return this.scan_code_pressed.h.hasOwnProperty(t)},scanreleased:function(t){return this.scan_code_released.h.hasOwnProperty(t)},scandown:function(t){return this.scan_code_down.h.hasOwnProperty(t)},mousepressed:function(t){return this.mouse_button_pressed.h.hasOwnProperty(t)},mousereleased:function(t){return this.mouse_button_released.h.hasOwnProperty(t)},mousedown:function(t){return this.mouse_button_down.h.hasOwnProperty(t)},gamepadpressed:function(t,e){var i=this.gamepad_button_pressed.h[t];return null!=i?i.h.hasOwnProperty(e):!1},gamepadreleased:function(t,e){var i=this.gamepad_button_released.h[t];return null!=i?i.h.hasOwnProperty(e):!1},gamepaddown:function(t,e){var i=this.gamepad_button_down.h[t];return null!=i?i.h.hasOwnProperty(e):!1},gamepadaxis:function(t,e){var i=this.gamepad_axis_values.h[t];return null!=i&&i.h.hasOwnProperty(e)?i.h[e]:0},dispatch_key_down_event:function(t,e,i,s,n,r){i||(this.key_code_pressed.h[t]=!1,this.key_code_down.h[t]=!0,this.scan_code_pressed.h[e]=!1,this.scan_code_down.h[e]=!0),this.app.host.onkeydown(t,e,i,s,n,r)},dispatch_key_up_event:function(t,e,i,s,n,r){this.key_code_released.h[t]=!1,this.key_code_down.remove(t),this.scan_code_released.h[e]=!1,this.scan_code_down.remove(e),this.app.host.onkeyup(t,e,i,s,n,r)},dispatch_text_event:function(t,e,i,s,n,r){this.app.host.ontextinput(t,e,i,s,n,r)},dispatch_mouse_move_event:function(t,e,i,s,n,r){this.app.host.onmousemove(t,e,i,s,n,r)},dispatch_mouse_down_event:function(t,e,i,s,n){this.mouse_button_pressed.h[i]=!1,this.mouse_button_down.h[i]=!0,this.app.host.onmousedown(t,e,i,s,n)},dispatch_mouse_up_event:function(t,e,i,s,n){this.mouse_button_released.h[i]=!1,this.mouse_button_down.remove(i),this.app.host.onmouseup(t,e,i,s,n)},dispatch_mouse_wheel_event:function(t,e,i,s){this.app.host.onmousewheel(t,e,i,s)},dispatch_touch_down_event:function(t,e,i,s){this.touches_down.h.hasOwnProperty(i)||(this.touch_count++,this.touches_down.h[i]=!0),this.app.host.ontouchdown(t,e,i,s)},dispatch_touch_up_event:function(t,e,i,s){this.app.host.ontouchup(t,e,i,s),this.touches_down.remove(i)&&this.touch_count--},dispatch_touch_move_event:function(t,e,i,s,n,r){this.app.host.ontouchmove(t,e,i,s,n,r)},dispatch_gamepad_axis_event:function(t,e,i,s){if(!this.gamepad_axis_values.h.hasOwnProperty(t)){var n=new U;this.gamepad_axis_values.h[t]=n}var r=this.gamepad_axis_values.h[t];r.set(e,i),this.app.host.ongamepadaxis(t,e,i,s)},dispatch_gamepad_button_down_event:function(t,e,i,s){if(!this.gamepad_button_pressed.h.hasOwnProperty(t)){var n=new U;this.gamepad_button_pressed.h[t]=n}if(!this.gamepad_button_down.h.hasOwnProperty(t)){var r=new U;this.gamepad_button_down.h[t]=r}var o=this.gamepad_button_pressed.h[t];o.set(e,!1);var a=this.gamepad_button_down.h[t];a.set(e,!0),this.app.host.ongamepaddown(t,e,i,s)},dispatch_gamepad_button_up_event:function(t,e,i,s){if(!this.gamepad_button_released.h.hasOwnProperty(t)){var n=new U;this.gamepad_button_released.h[t]=n}if(!this.gamepad_button_down.h.hasOwnProperty(t)){var r=new U;this.gamepad_button_down.h[t]=r}var o=this.gamepad_button_released.h[t];o.set(e,!1);var a=this.gamepad_button_down.h[t];a.remove(e),this.app.host.ongamepadup(t,e,i,s)},dispatch_gamepad_device_event:function(t,e,i){this.app.host.ongamepaddevice(t,e,i)},listen:function(t){this.module.listen(t)},unlisten:function(t){this.module.unlisten(t)},on_event:function(t){this.module.on_event(t)},on_gamepad_added:function(t){this.module.gamepad_add(t.which)},on_gamepad_removed:function(t){this.module.gamepad_remove(t.which)},update:function(){this.module.update(),this._update_keystate(),this._update_gamepadstate(),this._update_mousestate()},destroy:function(){this.module.destroy()},_update_mousestate:function(){for(var t=this.mouse_button_pressed.keys();t.hasNext();){var e=t.next();this.mouse_button_pressed.h[e]?this.mouse_button_pressed.remove(e):this.mouse_button_pressed.h[e]=!0}for(var i=this.mouse_button_released.keys();i.hasNext();){var s=i.next();this.mouse_button_released.h[s]?this.mouse_button_released.remove(s):this.mouse_button_released.h[s]=!0}},_update_gamepadstate:function(){for(var t=this.gamepad_button_pressed.iterator();t.hasNext();)for(var e=t.next(),i=e.keys();i.hasNext();){var s=i.next();e.h[s]?e.remove(s):e.h[s]=!0}for(var n=this.gamepad_button_released.iterator();n.hasNext();)for(var r=n.next(),o=r.keys();o.hasNext();){var a=o.next();r.h[a]?r.remove(a):r.h[a]=!0}},_update_keystate:function(){for(var t=this.key_code_pressed.keys();t.hasNext();){var e=t.next();this.key_code_pressed.h[e]?this.key_code_pressed.remove(e):this.key_code_pressed.h[e]=!0}for(var i=this.key_code_released.keys();i.hasNext();){var s=i.next();this.key_code_released.h[s]?this.key_code_released.remove(s):this.key_code_released.h[s]=!0}for(var n=this.scan_code_pressed.keys();n.hasNext();){var r=n.next();this.scan_code_pressed.h[r]?this.scan_code_pressed.remove(r):this.scan_code_pressed.h[r]=!0}for(var o=this.scan_code_released.keys();o.hasNext();){var a=o.next();this.scan_code_released.h[a]?this.scan_code_released.remove(a):this.scan_code_released.h[a]=!0}},__class__:dr};var fr=function(t){this.string_save_prefix="slot",this.app=t,this.module=new Jn(this),this.module.init()};n["snow.system.io.IO"]=fr,fr.__name__=["snow","system","io","IO"],fr.prototype={url_open:function(t){this.module.url_open(t)},data_load:function(t,e){return this.module.data_load(t,e)},data_save:function(t,e,i){return this.module.data_save(t,e,i)},data_flow:function(t,e,i){var n=this;return null==i&&(i=s(this,this.default_provider)),new Fn(function(s,r){i(n.app,t).then(function(i){null!=e?e(n.app,t,i).then(s,r):s(i)}).error(r)})},string_save_path:function(t){return null==t&&(t=0),this.module.string_save_path(t)},string_save:function(t,e,i){null==i&&(i=0);var s=this.string_slots_sync(i),n=window.btoa(t);if(null==e)s.remove(n);else{var r=window.btoa(e);null!=Ar[n]?s.setReserved(n,r):s.h[n]=r}var o=N.run(s);return o=window.btoa(o),this.module.string_slot_save(i,o)},string_load:function(t,e){null==e&&(e=0);var i,s=this.string_slots_sync(e),n=window.btoa(t);return i=null!=Ar[n]?s.getReserved(n):s.h[n],null==i?null:window.atob(i)},string_destroy:function(t){return null==t&&(t=0),null==this.string_slots?this.string_slots=new U:this.string_slots.remove(t),this.module.string_slot_destroy(t)},string_slots_sync:function(t){null==t&&(t=0),null==this.string_slots&&(this.string_slots=new U);var e=this.string_slots.h[t];if(null==e){var i=this.module.string_slot_load(t);null==i?e=new V:(i=window.atob(i),e=R.run(i)),this.string_slots.h[t]=e}return e},default_provider:function(t,e){return this.module.data_load(e,null)},on_event:function(t){this.module.on_event(t)},update:function(){this.module.update()},destroy:function(){this.module.destroy()},__class__:fr};var pr=function(t,e){this.internal_resize=!1,this.internal_position=!1,this.minimized=!1,this.closed=!0,this.auto_render=!0,this.auto_swap=!0,this.height=0,this.width=0,this.y=0,this.x=0,this.fullscreen=!1,this.grab=!1,this.bordered=!0,this.title="snow window",this.set_max_size({x:0,y:0}),this.set_min_size({x:0,y:0}),this.system=t,this.asked_config=e,this.config=e,null==this.config.x&&(this.config.x=536805376),null==this.config.y&&(this.config.y=536805376),this.system.module.create(this.system.app.config.render,e,s(this,this.on_window_created))};n["snow.system.window.Window"]=pr,pr.__name__=["snow","system","window","Window"],pr.prototype={on_window_created:function(t,e,i){return this.id=e,this.handle=t,null==this.handle?void S.trace("   i / window / failed to create window",{fileName:"Window.hx",lineNumber:92,className:"snow.system.window.Window",methodName:"on_window_created"}):(this.closed=!1,this.config=i.config,this.system.app.config.render=i.render_config,this.internal_position=!0,this.set_x(this.config.x),this.set_y(this.config.y),this.internal_position=!1,this.internal_resize=!0,this.set_width(this.config.width),this.set_height(this.config.height),this.internal_resize=!1,void this.on_event({type:1,window_id:e,timestamp:Nn.core.timestamp(),event:{}}))},on_event:function(t){var e=t.type;if(null!=e)switch(e){case 5:this.internal_position=!0,this.set_position(t.event.x,t.event.y),this.internal_position=!1;break;case 6:this.internal_resize=!0,this.set_size(t.event.x,t.event.y),this.internal_resize=!1;break;case 7:this.internal_resize=!0,this.set_size(t.event.x,t.event.y),this.internal_resize=!1;break;case 8:this.minimized=!0;break;case 10:this.minimized=!1}null!=this.onevent&&this.onevent(t)},update:function(){null==this.handle||this.closed||this.system.module.update_window(this)},render:function(){if(!this.minimized&&!this.closed&&null!=this.handle){if(this.system.module.render(this),null!=this.onrender)return this.onrender(this),void(this.auto_swap&&this.swap());rr.current_context.clearColor(0,0,0,1),rr.current_context.clear(16384),this.auto_swap&&this.swap()}},swap:function(){null==this.handle||this.closed||this.minimized||this.system.module.swap(this)},destroy:function(){this.closed=!0,null!=this.handle&&(this.system.remove(this),this.system.module.destroy_window(this),this.handle=null)},close:function(){this.closed=!0,null!=this.handle&&this.system.module.close(this)},show:function(){null!=this.handle&&(this.closed=!1,this.system.module.show(this))},simple_message:function(t,e){null==e&&(e=""),null!=this.handle&&this.system.module.simple_message(this,t,e)},get_fullscreen:function(){return this.fullscreen},set_fullscreen:function(t){return null!=this.handle&&this.system.module.fullscreen(this,t),this.fullscreen=t},get_bordered:function(){return this.bordered},get_grab:function(){return this.grab},get_max_size:function(){return this.max_size},get_min_size:function(){return this.min_size},get_title:function(){return this.title},set_title:function(t){return null!=this.handle&&this.system.module.set_title(this,t),this.title=t},set_x:function(t){return this.x=t,null==this.handle||this.internal_position||this.system.module.set_position(this,this.x,this.y),this.x},set_y:function(t){return this.y=t,null==this.handle||this.internal_position||this.system.module.set_position(this,this.x,this.y),this.y},set_width:function(t){return this.width=t,null==this.handle||this.internal_resize||this.system.module.set_size(this,this.width,this.height),this.width},set_height:function(t){return this.height=t,null==this.handle||this.internal_resize||this.system.module.set_size(this,this.width,this.height),this.height},set_cursor_position:function(t,e){null==this.handle||this.closed||this.system.module.set_cursor_position(this,t,e)},set_position:function(t,e){var i=this.internal_position;this.internal_position=!0,this.set_x(t),this.set_y(e),this.internal_position=i,null==this.handle||this.internal_position||this.system.module.set_position(this,this.x,this.y)},set_size:function(t,e){var i=this.internal_resize;this.internal_resize=!0,this.set_width(t),this.set_height(e),this.internal_resize=i,null==this.handle||this.internal_resize||this.system.module.set_size(this,t,e)},set_max_size:function(t){return null!=this.get_max_size()&&null!=this.handle&&this.system.module.set_max_size(this,t.x,t.y),this.max_size=t},set_min_size:function(t){return null!=this.get_min_size()&&null!=this.handle&&this.system.module.set_min_size(this,t.x,t.y),this.min_size=t},set_bordered:function(t){return null!=this.handle&&this.system.module.bordered(this,t),this.bordered=t},set_grab:function(t){return null!=this.handle&&this.system.module.grab(this,t),this.grab=t},__class__:pr,__properties__:{set_min_size:"set_min_size",get_min_size:"get_min_size",set_max_size:"set_max_size",get_max_size:"get_max_size",set_height:"set_height",set_width:"set_width",set_y:"set_y",set_x:"set_x",set_fullscreen:"set_fullscreen",get_fullscreen:"get_fullscreen",set_grab:"set_grab",get_grab:"get_grab",set_bordered:"set_bordered",get_bordered:"get_bordered",set_title:"set_title",get_title:"get_title"}};var mr=function(t){this.window_count=0,this.app=t,this.window_list=new U,this.window_handles=new G,this.module=new tr(this),this.module.init()};n["snow.system.window.Windowing"]=mr,mr.__name__=["snow","system","window","Windowing"],mr.prototype={create:function(t){var e=new pr(this,t);return this.window_list.h[e.id]=e,this.window_handles.set(e.handle,e.id),this.window_count++,this.module.listen(e),(null==t.no_input||0==t.no_input)&&this.app.input.listen(e),e},remove:function(t){this.window_list.remove(t.id),this.window_handles.remove(t.handle),this.window_count--,this.module.unlisten(t),(null==t.config.no_input||0==t.config.no_input)&&this.app.input.unlisten(t)},window_from_handle:function(t){if(null!=this.window_handles.h.__keys__[t.__id__]){var e=this.window_handles.h[t.__id__];return this.window_list.h[e]}return null},window_from_id:function(t){return this.window_list.h[t]},enable_vsync:function(t){return this.module.system_enable_vsync(t)},enable_cursor:function(t){this.module.system_enable_cursor(t)},enable_cursor_lock:function(t){this.module.system_lock_cursor(t)},display_count:function(){return this.module.display_count()},display_mode_count:function(t){return this.module.display_mode_count(t)},display_native_mode:function(t){return this.module.display_native_mode(t)},display_current_mode:function(t){return this.module.display_current_mode(t)},display_mode:function(t,e){return this.module.display_mode(t,e)},display_bounds:function(t){return this.module.display_bounds(t)},display_name:function(t){return this.module.display_name(t)},on_event:function(t){if(5==t.type){var e=t.window,i=this.window_list.h[e.window_id];null!=i&&i.on_event(e)}},update:function(){this.module.update();for(var t=this.window_list.iterator();t.hasNext();){var e=t.next();e.update()}for(var i=this.window_list.iterator();i.hasNext();){var s=i.next();s.auto_render&&s.render()}},destroy:function(){this.module.destroy()},__class__:mr};var gr=n["snow.types.Error"]={__ename__:["snow","types","Error"],__constructs__:["error","init","windowing","parse"]};gr.error=function(t){var e=["error",0,t];return e.__enum__=gr,e.toString=r,e},gr.init=function(t){var e=["init",1,t];return e.__enum__=gr,e.toString=r,e},gr.windowing=function(t){var e=["windowing",2,t];return e.__enum__=gr,e.toString=r,e},gr.parse=function(t){var e=["parse",3,t];return e.__enum__=gr,e.toString=r,e};var vr,yr=0;Array.prototype.indexOf&&(a.indexOf=function(t,e,i){return Array.prototype.indexOf.call(t,e,i)}),n.Math=Math,String.prototype.__class__=n.String=String,String.__name__=["String"],n.Array=Array,Array.__name__=["Array"],Date.prototype.__class__=n.Date=Date,Date.__name__=["Date"];var wr=n.Int={__name__:["Int"]},xr=n.Dynamic={__name__:["Dynamic"]},br=n.Float=Number;br.__name__=["Float"];var kr=n.Bool=Boolean;kr.__ename__=["Bool"];var zr=n.Class={__name__:["Class"]},Er={};null==Array.prototype.map&&(Array.prototype.map=function(t){for(var e=[],i=0,s=this.length;s>i;){var n=i++;e[n]=t(this[n])}return e}),null==Array.prototype.filter&&(Array.prototype.filter=function(t){for(var e=[],i=0,s=this.length;s>i;){var n=i++,r=this[n];t(r)&&e.push(r)}return e}),I.content=[{name:"version",data:"MS4wLjAtYWxwaGEuMQ"},{name:"default.vert.glsl",data:"YXR0cmlidXRlIHZlYzMgdmVydGV4UG9zaXRpb247CmF0dHJpYnV0ZSB2ZWMyIHZlcnRleFRDb29yZDsKYXR0cmlidXRlIHZlYzQgdmVydGV4Q29sb3I7CmF0dHJpYnV0ZSB2ZWMzIHZlcnRleE5vcm1hbDsKCnZhcnlpbmcgdmVjMiB0Y29vcmQ7CnZhcnlpbmcgdmVjNCBjb2xvcjsKCnVuaWZvcm0gbWF0NCBwcm9qZWN0aW9uTWF0cml4Owp1bmlmb3JtIG1hdDQgbW9kZWxWaWV3TWF0cml4OwoKdm9pZCBtYWluKHZvaWQpIHsKCiAgICBnbF9Qb3NpdGlvbiA9IHByb2plY3Rpb25NYXRyaXggKiBtb2RlbFZpZXdNYXRyaXggKiB2ZWM0KHZlcnRleFBvc2l0aW9uLCAxLjApOwogICAgdGNvb3JkID0gdmVydGV4VENvb3JkOwogICAgY29sb3IgPSB2ZXJ0ZXhDb2xvcjsKICAgICAgICAvL2htbSEgSSB0aGluayBzaGFkZXJzIGFyZSBjb21waWxlZCBvcHRpbWlzZWQsIHJlbW92aW5nIHVudXNlZCB2YWx1ZXMgd2hpY2ggbWVhbnMKICAgICAgICAvL3RoYXQgdGhlIHNoYWRlcnMgZ2V0VmVydGV4Tm9ybWFsIGF0dHJpYnV0ZSByZXR1cm5zIGludmFsaWQgKC0xKSB2YWx1ZXMhCiAgICB2ZWMzIG4gPSB2ZXJ0ZXhOb3JtYWw7CiAgICBnbF9Qb2ludFNpemUgPSAxLjA7Cgp9"},{name:"build",data:"Kzk2N2I2MjMyYmQ"},{name:"default.frag.glsl",data:"dmFyeWluZyB2ZWMyIHRjb29yZDsKdmFyeWluZyB2ZWM0IGNvbG9yOwoKdm9pZCBtYWluKCkgewogICAgZ2xfRnJhZ0NvbG9yID0gY29sb3I7Cn0"},{name:"default.frag.textured.glsl",data:"dW5pZm9ybSBzYW1wbGVyMkQgdGV4MDsKdmFyeWluZyB2ZWMyIHRjb29yZDsKdmFyeWluZyB2ZWM0IGNvbG9yOwoKdm9pZCBtYWluKCkgewogICAgdmVjNCB0ZXhjb2xvciA9IHRleHR1cmUyRCh0ZXgwLCB0Y29vcmQpOwogICAgLy8gZmxvYXQgbHVtaW5vc2l0eSA9ICh0ZXhjb2xvci5yICsgdGV4Y29sb3IuZyArIHRleGNvbG9yLmIpIC8gMy4wOwogICAgLy8gdmVjNCBncmF5ID0gdmVjNChsdW1pbm9zaXR5LGx1bWlub3NpdHksbHVtaW5vc2l0eSwxKTsKICAgIC8vIHZlYzQgb2NvbG9yID0gdmVjNCh0ZXhjb2xvci5yLCB0ZXhjb2xvci5nLCB0ZXhjb2xvci5iLCAxKTsKICAgIC8vIHZlYzQgdXZjb2xvciA9IHZlYzQodGNvb3JkLngsIHRjb29yZC55LCAodGNvb3JkLngrdGNvb3JkLnkpKjIuMCwgMSk7CiAgICAvLyB2ZWM0IHdoaXRlID0gdmVjNCgxLCAxLCAxLCAwLjYpOwogICAgLy8gZ2xfRnJhZ0NvbG9yID0gZ3JheSAqICgodGNvb3JkLngrdGNvb3JkLnkpLzIuMCk7CiAgICBnbF9GcmFnQ29sb3IgPSBjb2xvciAqIHRleGNvbG9yOyAvL3ZlYzQoMCwwLjksMC42LDEpOyA7CiAgICAvLyBnbF9GcmFnQ29sb3IgPSB2ZWM0KGdsX1BvaW50Q29vcmQueCwgZ2xfUG9pbnRDb29yZC55LCAwLCAxKTsKICAgIC8vIHZlYzQgY2MgPSB1dmNvbG9yICogZ3JheTsKICAgIC8vIGdsX0ZyYWdDb2xvciA9IHRleGNvbG9yOwp9"},{name:"default.frag.bitmapfont.glsl",data:"I2RlZmluZSBPVVRMSU5FIDEKI2RlZmluZSBHTE9XIDEKI2RlZmluZSBTVVBFUlNBTVBMRSAxCgp1bmlmb3JtIHNhbXBsZXIyRCB0ZXgwOwp2YXJ5aW5nIHZlYzIgdGNvb3JkOwp2YXJ5aW5nIHZlYzQgY29sb3I7Cgp1bmlmb3JtIGZsb2F0IHNtb290aG5lc3M7CnVuaWZvcm0gZmxvYXQgdGhpY2tuZXNzOwoKdW5pZm9ybSB2ZWM0IG91dGxpbmVfY29sb3I7CnVuaWZvcm0gZmxvYXQgb3V0bGluZTsKCnVuaWZvcm0gdmVjNCBnbG93X2NvbG9yOwp1bmlmb3JtIGZsb2F0IGdsb3dfdGhyZXNob2xkOwp1bmlmb3JtIGZsb2F0IGdsb3dfYW1vdW50OwoKCmZsb2F0IGVkZ2UoZmxvYXQgdmFsdWUsIGZsb2F0IGFtb3VudCwgZmxvYXQgdCkgewogICAgcmV0dXJuIHNtb290aHN0ZXAodmFsdWUgLSBhbW91bnQsIHZhbHVlICsgYW1vdW50LCB0KTsKfQoKZmxvYXQgZ2V0KHZlYzIgdXYsIGZsb2F0IHdpZHRoKSB7CiAgICBmbG9hdCB0ZXhhID0gdGV4dHVyZTJEKHRleDAsIHV2KS5hOwogICAgcmV0dXJuIHNtb290aHN0ZXAoMC41IC0gd2lkdGgsIDAuNSArIHdpZHRoLCB0ZXhhKTsKfQoKdm9pZCBtYWluKCkgewoKLy9iYXNpYyBzZGYKCiAgICBmbG9hdCBkaXN0ID0gdGV4dHVyZTJEKHRleDAsIHRjb29yZCkuYTsKICAgICAgICAvL2Z3aWR0aCBrZWVwcyB3aWR0aCBzaW1pbGFyIGRlc3BpdGUgc2NhbGluZywgc2VlIGJlbG93IGZvciBvcHRpb25zCiAgICBmbG9hdCBzbW9vdGhhbXQgPSBzbW9vdGhuZXNzICogZndpZHRoKGRpc3QpOwogICAgLy8gZmxvYXQgc21vb3RoYW10ID0gc21vb3RobmVzcyAqIGxlbmd0aCh2ZWMyKGRGZHgoZGlzdCksIGRGZHkoZGlzdCkpKTsKCiAgICAgICAgLy9jYWxjdWxhdGUgdGhlIGVkZ2Ugc21vb3RoaW5nCiAgICBmbG9hdCBhbHBoYSA9IGVkZ2UoMS4wIC0gdGhpY2tuZXNzLCBzbW9vdGhhbXQsIGRpc3QpOwoKLy9zdXBlciBzYW1wbGluZwoKICAgICAgICAjaWYgU1VQRVJTQU1QTEUgPT0gMQoKICAgICAgICAgICAgICAgIC8vdGhlc2UgdmFsdWVzIGNhbiBiZSBleHBvc2VkIGxhdGVyCiAgICAgICAgICAgICAgICAvL3RoZSBjdXJyZW50IGJlaW5nIDAuMjUvc3FydCgyKQogICAgICAgICAgICBmbG9hdCBmYWN0b3IgPSAwLjE3Njc3NjY5NTM7CiAgICAgICAgICAgIGZsb2F0IHNhbXBsZWFtdCA9IDAuNTsKICAgICAgICAgICAgICAgIC8vdGhpcyBpcyBhIHNpbXBsZSBib3ggZmlsdGVyIGFyb3VuZCB0aGUgcG9pbnQsCiAgICAgICAgICAgICAgICAvL3dlIHVzZSBhIHNlcGFyYXRlIHdpZHRoIGZvciBub3cKICAgICAgICAgICAgZmxvYXQgc2FtcGxldyA9IHNhbXBsZWFtdCAqIGZ3aWR0aChkaXN0KTsKICAgICAgICAgICAgdmVjMiBzYW1wbGVvZmZzZXQgPSBmYWN0b3IgKiAoZEZkeCh0Y29vcmQpICsgZEZkeSh0Y29vcmQpKTsKICAgICAgICAgICAgdmVjNCBmbHRyID0gdmVjNCh0Y29vcmQgLSBzYW1wbGVvZmZzZXQsIHRjb29yZCArIHNhbXBsZW9mZnNldCk7CgogICAgICAgICAgICBmbG9hdCB0b3RhbCA9IGdldCggZmx0ci54eSwgc2FtcGxldyApICsgZ2V0KCBmbHRyLnp3LCBzYW1wbGV3ICkgKwogICAgICAgICAgICAgICAgICAgICAgICAgIGdldCggZmx0ci54dywgc2FtcGxldyApICsgZ2V0KCBmbHRyLnp5LCBzYW1wbGV3ICk7CgogICAgICAgICAgICBhbHBoYSA9IChhbHBoYSArIDAuNSAqIHRvdGFsKSAvIDMuMDsKCiAgICAgICAgI2VuZGlmIC8vU1VQRVJTQU1QTEUKCiAgICAgICAgLy90aGUgYmFzZSBjb2xvciArIHNjYWxlZCBieSB0aGUgbmV3IGFscGhhCiAgICB2ZWM0IGZpbmFsQ29sb3IgPSB2ZWM0KGNvbG9yLnJnYiwgY29sb3IuYSAqIGFscGhhKTsKCi8vb3V0bGluZQoKICAgICNpZiBPVVRMSU5FID09IDEKCiAgICAgICAgICAgIC8vd2lwCiAgICAgICAgaWYob3V0bGluZSA+IDAuMCkgewoKICAgICAgICAgICAgLy9yYW5nZSBvZiAxLjAgfiAwLjEsIHdlIGdldCAwIH4gMQogICAgICAgICAgICBmbG9hdCBfb3V0bGluZSA9IDAuOSAtIChvdXRsaW5lICogMC45KTsKICAgICAgICAgICAgZmxvYXQgX291dGxpbmVfYSA9IGVkZ2UoX291dGxpbmUsIHNtb290aGFtdCwgZGlzdCk7CiAgICAgICAgICAgIHZlYzQgX291dGxpbmVfYyA9IHZlYzQob3V0bGluZV9jb2xvci5yZ2IsIG91dGxpbmVfY29sb3IuYSAqIF9vdXRsaW5lX2EpOwoKICAgICAgICAgICAgZmluYWxDb2xvciA9IG1peChfb3V0bGluZV9jLCBmaW5hbENvbG9yLCBhbHBoYSk7CgogICAgICAgIH0gLy9vdXRsaW5lID4gMC4wCgogICAgI2VuZGlmIC8vT1VUTElORQoKLy8gZ2xvdwoKICAgICNpZiBHTE9XID09IDEKCiAgICAgICAgICAgIC8vd2lwCiAgICAgICAgaWYoZ2xvd19hbW91bnQgPiAwLjApIHsKCiAgICAgICAgICAgIC8vOnRvZG86IGV4cG9zZSBvZmZzZXQgZm9yIGRpcmVjdGlvbmFsIHNoYWRvdwogICAgICAgICAgICAvLyB2ZWMyIF9nbG93X29mZnMgPSB2ZWMyKDAsMCk7CiAgICAgICAgICAgIC8vIGZsb2F0IF9nbG93X2Rpc3QgPSB0ZXh0dXJlMkQodGV4MCwgdGNvb3JkIC0gX2dsb3dfb2Zmc2V0KS5hOwoKICAgICAgICAgICAgZmxvYXQgX2dsb3dfYW10ID0gMS4wIC0gZ2xvd19hbW91bnQ7CiAgICAgICAgICAgIGZsb2F0IF9nbG93X2xpbWl0ID0gKF9nbG93X2FtdCAqIGdsb3dfdGhyZXNob2xkKTsKICAgICAgICAgICAgZmxvYXQgX2dsb3dfYSA9IGVkZ2UoX2dsb3dfYW10LCBfZ2xvd19saW1pdCwgZGlzdCk7CiAgICAgICAgICAgIHZlYzQgIF9nbG93X2MgPSB2ZWM0KGdsb3dfY29sb3IucmdiLCBnbG93X2NvbG9yLmEgKiBfZ2xvd19hKTsKCiAgICAgICAgICAgIGZpbmFsQ29sb3IgPSBtaXgoX2dsb3dfYywgZmluYWxDb2xvciwgZmluYWxDb2xvci5hKTsKCiAgICAgICAgfSAvL2dsb3dfYW1vdW50ID4gMAoKICAgICNlbmRpZiAvL0dMT1cKCi8vZG9uZQoKICAgIGdsX0ZyYWdDb2xvciA9IGZpbmFsQ29sb3I7CgoKfSAvL21haW4K"}];var Ar={},Cr=Function("return typeof ArrayBuffer != 'undefined' ? ArrayBuffer : null")()||ae;null==Cr.prototype.slice&&(Cr.prototype.slice=ae.sliceImpl);var Tr=(Function("return typeof DataView != 'undefined' ? DataView : null")()||he,Function("return typeof Uint8Array != 'undefined' ? Uint8Array : null")()||le._new);_.version="dev",_.build="+967b6232bd",z.Element=0,z.PCData=1,z.CData=2,z.Comment=3,z.DocType=4,z.ProcessingInstruction=5,z.Document=6,N.USE_CACHE=!1,N.USE_ENUM_INDEX=!1,N.BASE64="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789%:",R.DEFAULT_RESOLVER=b,R.BASE64="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789%:",L.CHARS="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",L.BYTES=F.ofString(L.CHARS),G.count=0,W.i64tmp=function(){var t,e=new T(0,0);return t=e}(this),Y.escapes=function(){var t,e=new V;return null!=Ar.lt?e.setReserved("lt","<"):e.h.lt="<",null!=Ar.gt?e.setReserved("gt",">"):e.h.gt=">",null!=Ar.amp?e.setReserved("amp","&"):e.h.amp="&",null!=Ar.quot?e.setReserved("quot",'"'):e.h.quot='"',null!=Ar.apos?e.setReserved("apos","'"):e.h.apos="'",t=e}(this),ie.LEN_EXTRA_BITS_TBL=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,-1,-1],ie.LEN_BASE_VAL_TBL=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],ie.DIST_EXTRA_BITS_TBL=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,-1,-1],ie.DIST_BASE_VAL_TBL=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577],ie.CODE_LENGTHS_POS=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],re.__toStr={}.toString,le.BYTES_PER_ELEMENT=1,ye.update="update dt",ye.renderdt="render dt",ye.game_update="game.update",ye.render="core.render",ye.debug="core.debug",ye.updates="core.updates",ye.events="core.events",ye.audio="core.audio",ye.input="core.input",ye.timer="core.timer",ye.scene="core.scene",ye.debug_batch="batcher.debug_batcher",we.shut_down=!1,Me._level=1,Me._log_width=16,Le.tag_physics="physics",hi.color_red=(new ai).rgb(13369344),hi.color_green=(new ai).rgb(2263108),hi.color_normal=(new ai).rgb(15790320),vi.base_chars="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",vi.base_lookup=[],Ii._save=!1,Oi.red=!0,Oi.black=!1,ns.actuators=[],ns.actuatorsLength=0,ns.addedEvent=!1,ns.update_timer=0,ns.current_time=0,hs.defaultActuator=ns,hs.defaultEase=rs.get_easeOut(),hs.targetLibraries=new G,zs.two_pi=6.283185307179586,Es._PI_OVER_180=.017453292519943278,Es._180_OVER_PI=57.29577951308238,Rs.minCodePoint=0,Rs.maxCodePoint=1114111,Rs.minHighSurrogate=55296,Rs.maxHighSurrogate=56319,Rs.minLowSurrogate=56320,Rs.maxLowSurrogate=57343,Us._sequence_key=-1,Us.vert_attribute=0,Us.tcoord_attribute=1,Us.color_attribute=2,Us.normal_attribute=3,sn.default_filter=9729,sn.default_clamp=33071,dn._sequence_key=-1,En.tab_regex=new o("	","gim"),Rn._level=1,Rn._log_width=16,Ln.calls=[],Ln.defers=[],Dn.running_timers=[],Un.BYTES_PER_ELEMENT=4,Gn.BYTES_PER_ELEMENT=4,jn.BYTES_PER_ELEMENT=1,Xn.POT=!0,Zn.dom_shift=16,Zn.dom_ctrl=17,Zn.dom_alt=18,Zn.dom_capslock=20,Zn.dom_pageup=33,Zn.dom_pagedown=34,Zn.dom_end=35,Zn.dom_home=36,Zn.dom_left=37,Zn.dom_up=38,Zn.dom_right=39,Zn.dom_down=40,Zn.dom_printscr=44,Zn.dom_insert=45,Zn.dom_delete=46,Zn.dom_lmeta=91,Zn.dom_rmeta=93,Zn.dom_kp_0=96,Zn.dom_kp_1=97,Zn.dom_kp_2=98,Zn.dom_kp_3=99,Zn.dom_kp_4=100,Zn.dom_kp_5=101,Zn.dom_kp_6=102,Zn.dom_kp_7=103,Zn.dom_kp_8=104,Zn.dom_kp_9=105,Zn.dom_kp_multiply=106,Zn.dom_kp_plus=107,Zn.dom_kp_minus=109,Zn.dom_kp_decimal=110,Zn.dom_kp_divide=111,Zn.dom_kp_numlock=144,Zn.dom_f1=112,Zn.dom_f2=113,Zn.dom_f3=114,Zn.dom_f4=115,Zn.dom_f5=116,Zn.dom_f6=117,Zn.dom_f7=118,Zn.dom_f8=119,Zn.dom_f9=120,Zn.dom_f10=121,Zn.dom_f11=122,Zn.dom_f12=123,Zn.dom_f13=124,Zn.dom_f14=125,Zn.dom_f15=126,Zn.dom_f16=127,Zn.dom_f17=128,Zn.dom_f18=129,Zn.dom_f19=130,Zn.dom_f20=131,Zn.dom_f21=132,Zn.dom_f22=133,Zn.dom_f23=134,Zn.dom_f24=135,Zn.dom_caret=160,Zn.dom_exclaim=161,Zn.dom_quotedbl=162,Zn.dom_hash=163,Zn.dom_dollar=164,Zn.dom_percent=165,Zn.dom_ampersand=166,Zn.dom_underscore=167,Zn.dom_leftparen=168,Zn.dom_rightparen=169,Zn.dom_asterisk=170,Zn.dom_plus=171,Zn.dom_pipe=172,Zn.dom_minus=173,Zn.dom_leftbrace=174,Zn.dom_rightbrace=175,Zn.dom_tilde=176,Zn.dom_audiomute=181,Zn.dom_volumedown=182,Zn.dom_volumeup=183,Zn.dom_comma=188,Zn.dom_period=190,Zn.dom_slash=191,Zn.dom_backquote=192,Zn.dom_leftbracket=219,Zn.dom_rightbracket=221,Zn.dom_backslash=220,Zn.dom_quote=222,Zn.dom_meta=224,Kn.MASK=1073741824,Kn.unknown=0,Kn.key_a=4,Kn.key_b=5,Kn.key_c=6,Kn.key_d=7,Kn.key_e=8,Kn.key_f=9,Kn.key_g=10,Kn.key_h=11,Kn.key_i=12,Kn.key_j=13,Kn.key_k=14,Kn.key_l=15,Kn.key_m=16,Kn.key_n=17,Kn.key_o=18,Kn.key_p=19,Kn.key_q=20,Kn.key_r=21,Kn.key_s=22,Kn.key_t=23,Kn.key_u=24,Kn.key_v=25,Kn.key_w=26,Kn.key_x=27,Kn.key_y=28,Kn.key_z=29,Kn.key_1=30,Kn.key_2=31,Kn.key_3=32,Kn.key_4=33,Kn.key_5=34,Kn.key_6=35,Kn.key_7=36,Kn.key_8=37,Kn.key_9=38,Kn.key_0=39,Kn.enter=40,Kn.escape=41,Kn.backspace=42,Kn.tab=43,Kn.space=44,Kn.minus=45,Kn.equals=46,Kn.leftbracket=47,Kn.rightbracket=48,Kn.backslash=49,Kn.nonushash=50,Kn.semicolon=51,Kn.apostrophe=52,Kn.grave=53,Kn.comma=54,Kn.period=55,Kn.slash=56,Kn.capslock=57,Kn.f1=58,Kn.f2=59,Kn.f3=60,Kn.f4=61,Kn.f5=62,Kn.f6=63,Kn.f7=64,Kn.f8=65,Kn.f9=66,Kn.f10=67,Kn.f11=68,Kn.f12=69,Kn.printscreen=70,Kn.scrolllock=71,Kn.pause=72,Kn.insert=73,Kn.home=74,Kn.pageup=75,Kn["delete"]=76,Kn.end=77,Kn.pagedown=78,Kn.right=79,Kn.left=80,Kn.down=81,Kn.up=82,Kn.numlockclear=83,Kn.kp_divide=84,Kn.kp_multiply=85,Kn.kp_minus=86,Kn.kp_plus=87,Kn.kp_enter=88,Kn.kp_1=89,Kn.kp_2=90,Kn.kp_3=91,Kn.kp_4=92,Kn.kp_5=93,Kn.kp_6=94,Kn.kp_7=95,Kn.kp_8=96,Kn.kp_9=97,Kn.kp_0=98,Kn.kp_period=99,Kn.nonusbackslash=100,Kn.application=101,Kn.power=102,Kn.kp_equals=103,Kn.f13=104,Kn.f14=105,Kn.f15=106,Kn.f16=107,Kn.f17=108,Kn.f18=109,Kn.f19=110,Kn.f20=111,Kn.f21=112,Kn.f22=113,Kn.f23=114,Kn.f24=115,Kn.execute=116,Kn.help=117,Kn.menu=118,Kn.select=119,Kn.stop=120,Kn.again=121,Kn.undo=122,Kn.cut=123,Kn.copy=124,Kn.paste=125,Kn.find=126,Kn.mute=127,Kn.volumeup=128,Kn.volumedown=129,Kn.kp_comma=133,Kn.kp_equalsas400=134,Kn.international1=135,Kn.international2=136,Kn.international3=137,Kn.international4=138,Kn.international5=139,Kn.international6=140,Kn.international7=141,Kn.international8=142,Kn.international9=143,Kn.lang1=144,Kn.lang2=145,Kn.lang3=146,Kn.lang4=147,Kn.lang5=148,Kn.lang6=149,Kn.lang7=150,Kn.lang8=151,Kn.lang9=152,Kn.alterase=153,Kn.sysreq=154,Kn.cancel=155,Kn.clear=156,Kn.prior=157,Kn.return2=158,Kn.separator=159,Kn.out=160,Kn.oper=161,Kn.clearagain=162,Kn.crsel=163,Kn.exsel=164,Kn.kp_00=176,Kn.kp_000=177,Kn.thousandsseparator=178,Kn.decimalseparator=179,Kn.currencyunit=180,Kn.currencysubunit=181,Kn.kp_leftparen=182,Kn.kp_rightparen=183,Kn.kp_leftbrace=184,Kn.kp_rightbrace=185,Kn.kp_tab=186,Kn.kp_backspace=187,Kn.kp_a=188,Kn.kp_b=189,Kn.kp_c=190,Kn.kp_d=191,Kn.kp_e=192,Kn.kp_f=193,Kn.kp_xor=194,Kn.kp_power=195,Kn.kp_percent=196,Kn.kp_less=197,Kn.kp_greater=198,Kn.kp_ampersand=199,Kn.kp_dblampersand=200,Kn.kp_verticalbar=201,Kn.kp_dblverticalbar=202,Kn.kp_colon=203,Kn.kp_hash=204,Kn.kp_space=205,Kn.kp_at=206,Kn.kp_exclam=207,Kn.kp_memstore=208,Kn.kp_memrecall=209,Kn.kp_memclear=210,Kn.kp_memadd=211,Kn.kp_memsubtract=212,Kn.kp_memmultiply=213,Kn.kp_memdivide=214,Kn.kp_plusminus=215,Kn.kp_clear=216,Kn.kp_clearentry=217,Kn.kp_binary=218,Kn.kp_octal=219,Kn.kp_decimal=220,Kn.kp_hexadecimal=221,Kn.lctrl=224,Kn.lshift=225,Kn.lalt=226,Kn.lmeta=227,Kn.rctrl=228,Kn.rshift=229,Kn.ralt=230,Kn.rmeta=231,Kn.mode=257,Kn.audionext=258,Kn.audioprev=259,Kn.audiostop=260,Kn.audioplay=261,Kn.audiomute=262,Kn.mediaselect=263,Kn.www=264,Kn.mail=265,Kn.calculator=266,Kn.computer=267,Kn.ac_search=268,Kn.ac_home=269,Kn.ac_back=270,Kn.ac_forward=271,Kn.ac_stop=272,Kn.ac_refresh=273,Kn.ac_bookmarks=274,Kn.brightnessdown=275,Kn.brightnessup=276,Kn.displayswitch=277,Kn.kbdillumtoggle=278,Kn.kbdillumdown=279,Kn.kbdillumup=280,Kn.eject=281,Kn.sleep=282,Kn.app1=283,Kn.app2=284,Kn.scancode_names=[null,null,null,null,"A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","1","2","3","4","5","6","7","8","9","0","Enter","Escape","Backspace","Tab","Space","-","=","[","]","\\","#",";","'","`",",",".","/","CapsLock","F1","F2","F3","F4","F5","F6","F7","F8","F9","F10","F11","F12","PrintScreen","ScrollLock","Pause","Insert","Home","PageUp","Delete","End","PageDown","Right","Left","Down","Up","Numlock","Keypad /","Keypad *","Keypad -","Keypad +","Keypad Enter","Keypad 1","Keypad 2","Keypad 3","Keypad 4","Keypad 5","Keypad 6","Keypad 7","Keypad 8","Keypad 9","Keypad 0","Keypad .",null,"Application","Power","Keypad =","F13","F14","F15","F16","F17","F18","F19","F20","F21","F22","F23","F24","Execute","Help","Menu","Select","Stop","Again","Undo","Cut","Copy","Paste","Find","Mute","VolumeUp","VolumeDown",null,null,null,"Keypad ,","Keypad = (AS400)",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,"AltErase","SysReq","Cancel","Clear","Prior","Enter","Separator","Out","Oper","Clear / Again","CrSel","ExSel",null,null,null,null,null,null,null,null,null,null,null,"Keypad 00","Keypad 000","ThousandsSeparator","DecimalSeparator","CurrencyUnit","CurrencySubUnit","Keypad (","Keypad )","Keypad {","Keypad }","Keypad Tab","Keypad Backspace","Keypad A","Keypad B","Keypad C","Keypad D","Keypad E","Keypad F","Keypad XOR","Keypad ^","Keypad %","Keypad <","Keypad >","Keypad &","Keypad &&","Keypad |","Keypad ||","Keypad :","Keypad #","Keypad Space","Keypad @","Keypad !","Keypad MemStore","Keypad MemRecall","Keypad MemClear","Keypad MemAdd","Keypad MemSubtract","Keypad MemMultiply","Keypad MemDivide","Keypad +/-","Keypad Clear","Keypad ClearEntry","Keypad Binary","Keypad Octal","Keypad Decimal","Keypad Hexadecimal",null,null,"Left Ctrl","Left Shift","Left Alt","Left Meta","Right Ctrl","Right Shift","Right Alt","Right Meta",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,"ModeSwitch","AudioNext","AudioPrev","AudioStop","AudioPlay","AudioMute","MediaSelect","WWW","Mail","Calculator","Computer","AC Search","AC Home","AC Back","AC Forward","AC Stop","AC Refresh","AC Bookmarks","BrightnessDown","BrightnessUp","DisplaySwitch","KBDIllumToggle","KBDIllumDown","KBDIllumUp","Eject","Sleep"],Wn.unknown=0,Wn.enter=13,Wn.escape=27,Wn.backspace=8,Wn.tab=9,Wn.space=32,Wn.exclaim=33,Wn.quotedbl=34,Wn.hash=35,Wn.percent=37,Wn.dollar=36,Wn.ampersand=38,Wn.quote=39,Wn.leftparen=40,Wn.rightparen=41,Wn.asterisk=42,Wn.plus=43,Wn.comma=44,Wn.minus=45,Wn.period=46,Wn.slash=47,Wn.key_0=48,Wn.key_1=49,Wn.key_2=50,Wn.key_3=51,Wn.key_4=52,Wn.key_5=53,Wn.key_6=54,Wn.key_7=55,Wn.key_8=56,Wn.key_9=57,Wn.colon=58,Wn.semicolon=59,Wn.less=60,Wn.equals=61,Wn.greater=62,Wn.question=63,Wn.at=64,Wn.leftbracket=91,Wn.backslash=92,Wn.rightbracket=93,Wn.caret=94,Wn.underscore=95,Wn.backquote=96,Wn.key_a=97,Wn.key_b=98,Wn.key_c=99,Wn.key_d=100,Wn.key_e=101,Wn.key_f=102,Wn.key_g=103,Wn.key_h=104,Wn.key_i=105,Wn.key_j=106,Wn.key_k=107,Wn.key_l=108,Wn.key_m=109,Wn.key_n=110,Wn.key_o=111,Wn.key_p=112,Wn.key_q=113,Wn.key_r=114,Wn.key_s=115,Wn.key_t=116,Wn.key_u=117,Wn.key_v=118,Wn.key_w=119,Wn.key_x=120,Wn.key_y=121,Wn.key_z=122,Wn.capslock=Wn.from_scan(Kn.capslock),Wn.f1=Wn.from_scan(Kn.f1),Wn.f2=Wn.from_scan(Kn.f2),Wn.f3=Wn.from_scan(Kn.f3),Wn.f4=Wn.from_scan(Kn.f4),Wn.f5=Wn.from_scan(Kn.f5),Wn.f6=Wn.from_scan(Kn.f6),Wn.f7=Wn.from_scan(Kn.f7),Wn.f8=Wn.from_scan(Kn.f8),Wn.f9=Wn.from_scan(Kn.f9),Wn.f10=Wn.from_scan(Kn.f10),Wn.f11=Wn.from_scan(Kn.f11),Wn.f12=Wn.from_scan(Kn.f12),Wn.printscreen=Wn.from_scan(Kn.printscreen),Wn.scrolllock=Wn.from_scan(Kn.scrolllock),Wn.pause=Wn.from_scan(Kn.pause),Wn.insert=Wn.from_scan(Kn.insert),Wn.home=Wn.from_scan(Kn.home),Wn.pageup=Wn.from_scan(Kn.pageup),Wn["delete"]=127,Wn.end=Wn.from_scan(Kn.end),Wn.pagedown=Wn.from_scan(Kn.pagedown),Wn.right=Wn.from_scan(Kn.right),Wn.left=Wn.from_scan(Kn.left),Wn.down=Wn.from_scan(Kn.down),Wn.up=Wn.from_scan(Kn.up),Wn.numlockclear=Wn.from_scan(Kn.numlockclear),Wn.kp_divide=Wn.from_scan(Kn.kp_divide),Wn.kp_multiply=Wn.from_scan(Kn.kp_multiply),Wn.kp_minus=Wn.from_scan(Kn.kp_minus),Wn.kp_plus=Wn.from_scan(Kn.kp_plus),Wn.kp_enter=Wn.from_scan(Kn.kp_enter),Wn.kp_1=Wn.from_scan(Kn.kp_1),Wn.kp_2=Wn.from_scan(Kn.kp_2),Wn.kp_3=Wn.from_scan(Kn.kp_3),Wn.kp_4=Wn.from_scan(Kn.kp_4),Wn.kp_5=Wn.from_scan(Kn.kp_5),Wn.kp_6=Wn.from_scan(Kn.kp_6),Wn.kp_7=Wn.from_scan(Kn.kp_7),Wn.kp_8=Wn.from_scan(Kn.kp_8),Wn.kp_9=Wn.from_scan(Kn.kp_9),Wn.kp_0=Wn.from_scan(Kn.kp_0),Wn.kp_period=Wn.from_scan(Kn.kp_period),Wn.application=Wn.from_scan(Kn.application),Wn.power=Wn.from_scan(Kn.power),Wn.kp_equals=Wn.from_scan(Kn.kp_equals),Wn.f13=Wn.from_scan(Kn.f13),Wn.f14=Wn.from_scan(Kn.f14),Wn.f15=Wn.from_scan(Kn.f15),Wn.f16=Wn.from_scan(Kn.f16),Wn.f17=Wn.from_scan(Kn.f17),Wn.f18=Wn.from_scan(Kn.f18),Wn.f19=Wn.from_scan(Kn.f19),Wn.f20=Wn.from_scan(Kn.f20),Wn.f21=Wn.from_scan(Kn.f21),Wn.f22=Wn.from_scan(Kn.f22),Wn.f23=Wn.from_scan(Kn.f23),Wn.f24=Wn.from_scan(Kn.f24),Wn.execute=Wn.from_scan(Kn.execute),Wn.help=Wn.from_scan(Kn.help),Wn.menu=Wn.from_scan(Kn.menu),Wn.select=Wn.from_scan(Kn.select),Wn.stop=Wn.from_scan(Kn.stop),Wn.again=Wn.from_scan(Kn.again),Wn.undo=Wn.from_scan(Kn.undo),Wn.cut=Wn.from_scan(Kn.cut),Wn.copy=Wn.from_scan(Kn.copy),Wn.paste=Wn.from_scan(Kn.paste),Wn.find=Wn.from_scan(Kn.find),Wn.mute=Wn.from_scan(Kn.mute),Wn.volumeup=Wn.from_scan(Kn.volumeup),Wn.volumedown=Wn.from_scan(Kn.volumedown),Wn.kp_comma=Wn.from_scan(Kn.kp_comma),Wn.kp_equalsas400=Wn.from_scan(Kn.kp_equalsas400),Wn.alterase=Wn.from_scan(Kn.alterase),Wn.sysreq=Wn.from_scan(Kn.sysreq),Wn.cancel=Wn.from_scan(Kn.cancel),Wn.clear=Wn.from_scan(Kn.clear),Wn.prior=Wn.from_scan(Kn.prior),Wn.return2=Wn.from_scan(Kn.return2),Wn.separator=Wn.from_scan(Kn.separator),Wn.out=Wn.from_scan(Kn.out),Wn.oper=Wn.from_scan(Kn.oper),Wn.clearagain=Wn.from_scan(Kn.clearagain),Wn.crsel=Wn.from_scan(Kn.crsel),Wn.exsel=Wn.from_scan(Kn.exsel),Wn.kp_00=Wn.from_scan(Kn.kp_00),Wn.kp_000=Wn.from_scan(Kn.kp_000),Wn.thousandsseparator=Wn.from_scan(Kn.thousandsseparator),Wn.decimalseparator=Wn.from_scan(Kn.decimalseparator),Wn.currencyunit=Wn.from_scan(Kn.currencyunit),Wn.currencysubunit=Wn.from_scan(Kn.currencysubunit),Wn.kp_leftparen=Wn.from_scan(Kn.kp_leftparen),Wn.kp_rightparen=Wn.from_scan(Kn.kp_rightparen),Wn.kp_leftbrace=Wn.from_scan(Kn.kp_leftbrace),Wn.kp_rightbrace=Wn.from_scan(Kn.kp_rightbrace),Wn.kp_tab=Wn.from_scan(Kn.kp_tab),Wn.kp_backspace=Wn.from_scan(Kn.kp_backspace),Wn.kp_a=Wn.from_scan(Kn.kp_a),Wn.kp_b=Wn.from_scan(Kn.kp_b),Wn.kp_c=Wn.from_scan(Kn.kp_c),Wn.kp_d=Wn.from_scan(Kn.kp_d),Wn.kp_e=Wn.from_scan(Kn.kp_e),Wn.kp_f=Wn.from_scan(Kn.kp_f),Wn.kp_xor=Wn.from_scan(Kn.kp_xor),Wn.kp_power=Wn.from_scan(Kn.kp_power),Wn.kp_percent=Wn.from_scan(Kn.kp_percent),Wn.kp_less=Wn.from_scan(Kn.kp_less),Wn.kp_greater=Wn.from_scan(Kn.kp_greater),Wn.kp_ampersand=Wn.from_scan(Kn.kp_ampersand),Wn.kp_dblampersand=Wn.from_scan(Kn.kp_dblampersand),Wn.kp_verticalbar=Wn.from_scan(Kn.kp_verticalbar),Wn.kp_dblverticalbar=Wn.from_scan(Kn.kp_dblverticalbar),Wn.kp_colon=Wn.from_scan(Kn.kp_colon),Wn.kp_hash=Wn.from_scan(Kn.kp_hash),Wn.kp_space=Wn.from_scan(Kn.kp_space),Wn.kp_at=Wn.from_scan(Kn.kp_at),Wn.kp_exclam=Wn.from_scan(Kn.kp_exclam),Wn.kp_memstore=Wn.from_scan(Kn.kp_memstore),Wn.kp_memrecall=Wn.from_scan(Kn.kp_memrecall),Wn.kp_memclear=Wn.from_scan(Kn.kp_memclear),Wn.kp_memadd=Wn.from_scan(Kn.kp_memadd),Wn.kp_memsubtract=Wn.from_scan(Kn.kp_memsubtract),Wn.kp_memmultiply=Wn.from_scan(Kn.kp_memmultiply),Wn.kp_memdivide=Wn.from_scan(Kn.kp_memdivide),Wn.kp_plusminus=Wn.from_scan(Kn.kp_plusminus),Wn.kp_clear=Wn.from_scan(Kn.kp_clear),Wn.kp_clearentry=Wn.from_scan(Kn.kp_clearentry),Wn.kp_binary=Wn.from_scan(Kn.kp_binary),Wn.kp_octal=Wn.from_scan(Kn.kp_octal),Wn.kp_decimal=Wn.from_scan(Kn.kp_decimal),Wn.kp_hexadecimal=Wn.from_scan(Kn.kp_hexadecimal),Wn.lctrl=Wn.from_scan(Kn.lctrl),Wn.lshift=Wn.from_scan(Kn.lshift),Wn.lalt=Wn.from_scan(Kn.lalt),Wn.lmeta=Wn.from_scan(Kn.lmeta),Wn.rctrl=Wn.from_scan(Kn.rctrl),Wn.rshift=Wn.from_scan(Kn.rshift),Wn.ralt=Wn.from_scan(Kn.ralt),Wn.rmeta=Wn.from_scan(Kn.rmeta),Wn.mode=Wn.from_scan(Kn.mode),Wn.audionext=Wn.from_scan(Kn.audionext),Wn.audioprev=Wn.from_scan(Kn.audioprev),Wn.audiostop=Wn.from_scan(Kn.audiostop),Wn.audioplay=Wn.from_scan(Kn.audioplay),Wn.audiomute=Wn.from_scan(Kn.audiomute),Wn.mediaselect=Wn.from_scan(Kn.mediaselect),Wn.www=Wn.from_scan(Kn.www),Wn.mail=Wn.from_scan(Kn.mail),Wn.calculator=Wn.from_scan(Kn.calculator),Wn.computer=Wn.from_scan(Kn.computer),Wn.ac_search=Wn.from_scan(Kn.ac_search),Wn.ac_home=Wn.from_scan(Kn.ac_home),Wn.ac_back=Wn.from_scan(Kn.ac_back),Wn.ac_forward=Wn.from_scan(Kn.ac_forward),Wn.ac_stop=Wn.from_scan(Kn.ac_stop),Wn.ac_refresh=Wn.from_scan(Kn.ac_refresh),Wn.ac_bookmarks=Wn.from_scan(Kn.ac_bookmarks),Wn.brightnessdown=Wn.from_scan(Kn.brightnessdown),Wn.brightnessup=Wn.from_scan(Kn.brightnessup),Wn.displayswitch=Wn.from_scan(Kn.displayswitch),Wn.kbdillumtoggle=Wn.from_scan(Kn.kbdillumtoggle),Wn.kbdillumdown=Wn.from_scan(Kn.kbdillumdown),Wn.kbdillumup=Wn.from_scan(Kn.kbdillumup),Wn.eject=Wn.from_scan(Kn.eject),Wn.sleep=Wn.from_scan(Kn.sleep),Qn._keypress_blacklist=[Wn.backspace,Wn.enter],rr.DEPTH_BUFFER_BIT=256,rr.STENCIL_BUFFER_BIT=1024,rr.COLOR_BUFFER_BIT=16384,rr.POINTS=0,rr.LINES=1,rr.LINE_LOOP=2,rr.LINE_STRIP=3,rr.TRIANGLES=4,rr.TRIANGLE_STRIP=5,rr.TRIANGLE_FAN=6,rr.ZERO=0,rr.ONE=1,rr.SRC_COLOR=768,rr.ONE_MINUS_SRC_COLOR=769,rr.SRC_ALPHA=770,rr.ONE_MINUS_SRC_ALPHA=771,rr.DST_ALPHA=772,rr.ONE_MINUS_DST_ALPHA=773,rr.DST_COLOR=774,rr.ONE_MINUS_DST_COLOR=775,rr.SRC_ALPHA_SATURATE=776,rr.FUNC_ADD=32774,rr.BLEND_EQUATION=32777,rr.BLEND_EQUATION_RGB=32777,rr.BLEND_EQUATION_ALPHA=34877,rr.FUNC_SUBTRACT=32778,rr.FUNC_REVERSE_SUBTRACT=32779,rr.BLEND_DST_RGB=32968,rr.BLEND_SRC_RGB=32969,rr.BLEND_DST_ALPHA=32970,rr.BLEND_SRC_ALPHA=32971,rr.CONSTANT_COLOR=32769,rr.ONE_MINUS_CONSTANT_COLOR=32770,rr.CONSTANT_ALPHA=32771,rr.ONE_MINUS_CONSTANT_ALPHA=32772,rr.BLEND_COLOR=32773,rr.ARRAY_BUFFER=34962,rr.ELEMENT_ARRAY_BUFFER=34963,rr.ARRAY_BUFFER_BINDING=34964,rr.ELEMENT_ARRAY_BUFFER_BINDING=34965,rr.STREAM_DRAW=35040,rr.STATIC_DRAW=35044,rr.DYNAMIC_DRAW=35048,rr.BUFFER_SIZE=34660,rr.BUFFER_USAGE=34661,rr.CURRENT_VERTEX_ATTRIB=34342,rr.FRONT=1028,rr.BACK=1029,rr.FRONT_AND_BACK=1032,rr.CULL_FACE=2884,rr.BLEND=3042,rr.DITHER=3024,rr.STENCIL_TEST=2960,rr.DEPTH_TEST=2929,rr.SCISSOR_TEST=3089,rr.POLYGON_OFFSET_FILL=32823,rr.SAMPLE_ALPHA_TO_COVERAGE=32926,rr.SAMPLE_COVERAGE=32928,rr.NO_ERROR=0,rr.INVALID_ENUM=1280,rr.INVALID_VALUE=1281,rr.INVALID_OPERATION=1282,rr.OUT_OF_MEMORY=1285,rr.CW=2304,rr.CCW=2305,rr.LINE_WIDTH=2849,rr.ALIASED_POINT_SIZE_RANGE=33901,rr.ALIASED_LINE_WIDTH_RANGE=33902,rr.CULL_FACE_MODE=2885,rr.FRONT_FACE=2886,rr.DEPTH_RANGE=2928,rr.DEPTH_WRITEMASK=2930,rr.DEPTH_CLEAR_VALUE=2931,rr.DEPTH_FUNC=2932,rr.STENCIL_CLEAR_VALUE=2961,rr.STENCIL_FUNC=2962,rr.STENCIL_FAIL=2964,rr.STENCIL_PASS_DEPTH_FAIL=2965,rr.STENCIL_PASS_DEPTH_PASS=2966,rr.STENCIL_REF=2967,rr.STENCIL_VALUE_MASK=2963,rr.STENCIL_WRITEMASK=2968,rr.STENCIL_BACK_FUNC=34816,rr.STENCIL_BACK_FAIL=34817,rr.STENCIL_BACK_PASS_DEPTH_FAIL=34818,rr.STENCIL_BACK_PASS_DEPTH_PASS=34819,rr.STENCIL_BACK_REF=36003,rr.STENCIL_BACK_VALUE_MASK=36004,rr.STENCIL_BACK_WRITEMASK=36005,rr.VIEWPORT=2978,rr.SCISSOR_BOX=3088,rr.COLOR_CLEAR_VALUE=3106,rr.COLOR_WRITEMASK=3107,rr.UNPACK_ALIGNMENT=3317,rr.PACK_ALIGNMENT=3333,rr.MAX_TEXTURE_SIZE=3379,rr.MAX_VIEWPORT_DIMS=3386,rr.SUBPIXEL_BITS=3408,rr.RED_BITS=3410,rr.GREEN_BITS=3411,rr.BLUE_BITS=3412,rr.ALPHA_BITS=3413,rr.DEPTH_BITS=3414,rr.STENCIL_BITS=3415,rr.POLYGON_OFFSET_UNITS=10752,rr.POLYGON_OFFSET_FACTOR=32824,rr.TEXTURE_BINDING_2D=32873,rr.SAMPLE_BUFFERS=32936,rr.SAMPLES=32937,rr.SAMPLE_COVERAGE_VALUE=32938,rr.SAMPLE_COVERAGE_INVERT=32939,rr.COMPRESSED_TEXTURE_FORMATS=34467,rr.DONT_CARE=4352,rr.FASTEST=4353,rr.NICEST=4354,rr.GENERATE_MIPMAP_HINT=33170,rr.BYTE=5120,rr.UNSIGNED_BYTE=5121,rr.SHORT=5122,rr.UNSIGNED_SHORT=5123,rr.INT=5124,rr.UNSIGNED_INT=5125,rr.FLOAT=5126,rr.DEPTH_COMPONENT=6402,rr.ALPHA=6406,rr.RGB=6407,rr.RGBA=6408,rr.LUMINANCE=6409,rr.LUMINANCE_ALPHA=6410,rr.UNSIGNED_SHORT_4_4_4_4=32819,rr.UNSIGNED_SHORT_5_5_5_1=32820,rr.UNSIGNED_SHORT_5_6_5=33635,rr.FRAGMENT_SHADER=35632,rr.VERTEX_SHADER=35633,rr.MAX_VERTEX_ATTRIBS=34921,rr.MAX_VERTEX_UNIFORM_VECTORS=36347,rr.MAX_VARYING_VECTORS=36348,rr.MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661,rr.MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660,rr.MAX_TEXTURE_IMAGE_UNITS=34930,rr.MAX_FRAGMENT_UNIFORM_VECTORS=36349,rr.SHADER_TYPE=35663,rr.DELETE_STATUS=35712,rr.LINK_STATUS=35714,rr.VALIDATE_STATUS=35715,rr.ATTACHED_SHADERS=35717,rr.ACTIVE_UNIFORMS=35718,rr.ACTIVE_ATTRIBUTES=35721,rr.SHADING_LANGUAGE_VERSION=35724,rr.CURRENT_PROGRAM=35725,rr.NEVER=512,rr.LESS=513,rr.EQUAL=514,rr.LEQUAL=515,rr.GREATER=516,rr.NOTEQUAL=517,rr.GEQUAL=518,rr.ALWAYS=519,rr.KEEP=7680,rr.REPLACE=7681,rr.INCR=7682,rr.DECR=7683,rr.INVERT=5386,rr.INCR_WRAP=34055,rr.DECR_WRAP=34056,rr.VENDOR=7936,rr.RENDERER=7937,rr.VERSION=7938,rr.NEAREST=9728,rr.LINEAR=9729,rr.NEAREST_MIPMAP_NEAREST=9984,rr.LINEAR_MIPMAP_NEAREST=9985,rr.NEAREST_MIPMAP_LINEAR=9986,rr.LINEAR_MIPMAP_LINEAR=9987,rr.TEXTURE_MAG_FILTER=10240,rr.TEXTURE_MIN_FILTER=10241,rr.TEXTURE_WRAP_S=10242,rr.TEXTURE_WRAP_T=10243,rr.TEXTURE_2D=3553,rr.TEXTURE=5890,rr.TEXTURE_CUBE_MAP=34067,rr.TEXTURE_BINDING_CUBE_MAP=34068,rr.TEXTURE_CUBE_MAP_POSITIVE_X=34069,rr.TEXTURE_CUBE_MAP_NEGATIVE_X=34070,rr.TEXTURE_CUBE_MAP_POSITIVE_Y=34071,rr.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072,rr.TEXTURE_CUBE_MAP_POSITIVE_Z=34073,rr.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074,rr.MAX_CUBE_MAP_TEXTURE_SIZE=34076,rr.TEXTURE0=33984,rr.TEXTURE1=33985,rr.TEXTURE2=33986,rr.TEXTURE3=33987,rr.TEXTURE4=33988,rr.TEXTURE5=33989,rr.TEXTURE6=33990,rr.TEXTURE7=33991,rr.TEXTURE8=33992,rr.TEXTURE9=33993,rr.TEXTURE10=33994,rr.TEXTURE11=33995,rr.TEXTURE12=33996,rr.TEXTURE13=33997,rr.TEXTURE14=33998,rr.TEXTURE15=33999,rr.TEXTURE16=34e3,rr.TEXTURE17=34001,rr.TEXTURE18=34002,rr.TEXTURE19=34003,rr.TEXTURE20=34004,rr.TEXTURE21=34005,rr.TEXTURE22=34006,rr.TEXTURE23=34007,rr.TEXTURE24=34008,rr.TEXTURE25=34009,rr.TEXTURE26=34010,rr.TEXTURE27=34011,rr.TEXTURE28=34012,rr.TEXTURE29=34013,rr.TEXTURE30=34014,rr.TEXTURE31=34015,rr.ACTIVE_TEXTURE=34016,rr.REPEAT=10497,rr.CLAMP_TO_EDGE=33071,rr.MIRRORED_REPEAT=33648,rr.FLOAT_VEC2=35664,rr.FLOAT_VEC3=35665,rr.FLOAT_VEC4=35666,rr.INT_VEC2=35667,rr.INT_VEC3=35668,rr.INT_VEC4=35669,rr.BOOL=35670,rr.BOOL_VEC2=35671,rr.BOOL_VEC3=35672,rr.BOOL_VEC4=35673,rr.FLOAT_MAT2=35674,rr.FLOAT_MAT3=35675,rr.FLOAT_MAT4=35676,rr.SAMPLER_2D=35678,rr.SAMPLER_CUBE=35680,rr.VERTEX_ATTRIB_ARRAY_ENABLED=34338,rr.VERTEX_ATTRIB_ARRAY_SIZE=34339,rr.VERTEX_ATTRIB_ARRAY_STRIDE=34340,rr.VERTEX_ATTRIB_ARRAY_TYPE=34341,rr.VERTEX_ATTRIB_ARRAY_NORMALIZED=34922,rr.VERTEX_ATTRIB_ARRAY_POINTER=34373,rr.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975,rr.VERTEX_PROGRAM_POINT_SIZE=34370,rr.POINT_SPRITE=34913,rr.COMPILE_STATUS=35713,rr.LOW_FLOAT=36336,rr.MEDIUM_FLOAT=36337,rr.HIGH_FLOAT=36338,rr.LOW_INT=36339,rr.MEDIUM_INT=36340,rr.HIGH_INT=36341,rr.FRAMEBUFFER=36160,rr.RENDERBUFFER=36161,rr.RGBA4=32854,rr.RGB5_A1=32855,rr.RGB565=36194,rr.DEPTH_COMPONENT16=33189,rr.STENCIL_INDEX=6401,rr.STENCIL_INDEX8=36168,rr.DEPTH_STENCIL=34041,rr.RENDERBUFFER_WIDTH=36162,rr.RENDERBUFFER_HEIGHT=36163,rr.RENDERBUFFER_INTERNAL_FORMAT=36164,rr.RENDERBUFFER_RED_SIZE=36176,rr.RENDERBUFFER_GREEN_SIZE=36177,rr.RENDERBUFFER_BLUE_SIZE=36178,rr.RENDERBUFFER_ALPHA_SIZE=36179,rr.RENDERBUFFER_DEPTH_SIZE=36180,rr.RENDERBUFFER_STENCIL_SIZE=36181,rr.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048,rr.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049,rr.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050,rr.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051,rr.COLOR_ATTACHMENT0=36064,rr.DEPTH_ATTACHMENT=36096,rr.STENCIL_ATTACHMENT=36128,rr.DEPTH_STENCIL_ATTACHMENT=33306,rr.NONE=0,rr.FRAMEBUFFER_COMPLETE=36053,rr.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054,rr.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055,rr.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057,rr.FRAMEBUFFER_UNSUPPORTED=36061,rr.FRAMEBUFFER_BINDING=36006,rr.RENDERBUFFER_BINDING=36007,rr.MAX_RENDERBUFFER_SIZE=34024,rr.INVALID_FRAMEBUFFER_OPERATION=1286,rr.UNPACK_FLIP_Y_WEBGL=37440,rr.UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441,rr.CONTEXT_LOST_WEBGL=37442,rr.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443,rr.BROWSER_DEFAULT_WEBGL=37444,cr.splitter="  ",u.main()
}("undefined"!=typeof console?console:{log:function(){}});